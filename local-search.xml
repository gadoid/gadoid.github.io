<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>RPCåè®®</title>
    <link href="/2025/05/13/RPC%E5%8D%8F%E8%AE%AE/"/>
    <url>/2025/05/13/RPC%E5%8D%8F%E8%AE%AE/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œæŠ€æœ¯</category>
      
      <category>RPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œæŠ€æœ¯,RPC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WebSocketåè®®</title>
    <link href="/2025/05/13/WebSocket%E5%8D%8F%E8%AE%AE/"/>
    <url>/2025/05/13/WebSocket%E5%8D%8F%E8%AE%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h1><blockquote><p>Ajax æ˜¯é€šè¿‡ JavaScript åœ¨é¡µé¢å†…å‘èµ·å¼‚æ­¥ HTTP è¯·æ±‚ï¼ˆé€šå¸¸ä½¿ç”¨ XMLHttpRequest æˆ– fetchï¼‰ï¼ŒæœåŠ¡ç«¯è¿”å›å“åº”æ•°æ®ï¼ˆç°ä»£å¤šä¸º JSONï¼Œæ—©æœŸä¸º XMLï¼‰ï¼Œå‰ç«¯æ ¹æ®è¿”å›å†…å®¹æ›´æ–°é¡µé¢çš„å±€éƒ¨ DOMï¼Œä»è€Œå®ç°æ— éœ€æ•´é¡µåˆ·æ–°çš„åŠ¨æ€äº¤äº’æ•ˆæœã€‚</p></blockquote><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs jsx">&lt;!<span class="hljs-variable constant_">DOCTYPE</span> html&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Ajax JSON ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>ğŸ§¾ æœåŠ¡å™¨æ•°æ®ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;result&quot;</span>&gt;</span>ç­‰å¾…æ•°æ®ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">getData</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/api/data&#x27;</span>)</span></span><br><span class="language-javascript"><span class="language-xml">        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;ç½‘ç»œå“åº”å¤±è´¥&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">          &#125;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>(); <span class="hljs-comment">// è§£æ JSON æ•°æ®</span></span></span><br><span class="language-javascript"><span class="language-xml">        &#125;)</span></span><br><span class="language-javascript"><span class="language-xml">        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;result&#x27;</span>).<span class="hljs-property">innerText</span> = <span class="hljs-string">`æ¶ˆæ¯ï¼š<span class="hljs-subst">$&#123;data.message&#125;</span>`</span>;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;)</span></span><br><span class="language-javascript"><span class="language-xml">        .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;result&#x27;</span>).<span class="hljs-property">innerText</span> = <span class="hljs-string">&#x27;è¯·æ±‚å¤±è´¥ï¼š&#x27;</span> + error.<span class="hljs-property">message</span>;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-comment">// åˆæ¬¡åŠ è½½ + å®šæ—¶è½®è¯¢</span></span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">getData</span>();</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-built_in">setInterval</span>(getData, <span class="hljs-number">5000</span>);</span></span><br><span class="language-javascript"><span class="language-xml">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<br><br><span class="hljs-comment">// ç®€å•çš„ JSON API</span><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/data&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> result = &#123;<br>    <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;ä½ å¥½ï¼Œè¿™æ˜¯æ¥è‡ªæœåŠ¡å™¨çš„ JSON æ•°æ®ï¼æ—¶é—´ï¼š&#x27;</span> + <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toLocaleTimeString</span>()<br>  &#125;;<br>  res.<span class="hljs-title function_">json</span>(result);<br>&#125;);<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;æœåŠ¡è¿è¡Œåœ¨ &lt;http://localhost:3000&gt;&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><h1 id="Long-Poll"><a href="#Long-Poll" class="headerlink" title="Long Poll"></a>Long Poll</h1><p>Long Poll æ˜¯ç”±å®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œå½“æœåŠ¡ç«¯æ²¡æœ‰ä¿¡æ¯æ›´æ–°æ—¶ï¼Œä¼šå¤„äºé˜»å¡çŠ¶æ€ï¼Œç›´åˆ°æœ‰æ›´æ–°åï¼Œç”±æœåŠ¡å™¨å“åº”ç»™å®¢æˆ·ç«¯</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs jsx">&lt;!<span class="hljs-variable constant_">DOCTYPE</span> html&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Long Polling ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>ğŸ“¡ æ¶ˆæ¯æ¨é€ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span>ç­‰å¾…æœåŠ¡å™¨æ¨é€æ¶ˆæ¯...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">startLongPoll</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/longpoll&#x27;</span>)</span></span><br><span class="language-javascript"><span class="language-xml">        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-title function_">json</span>())</span></span><br><span class="language-javascript"><span class="language-xml">        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">if</span> (data.<span class="hljs-property">message</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;box&#x27;</span>).<span class="hljs-property">innerText</span> = data.<span class="hljs-property">message</span>;</span></span><br><span class="language-javascript"><span class="language-xml">          &#125;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// ä¸è®ºæœ‰æ²¡æœ‰æ¶ˆæ¯ï¼Œç«‹å³å†æ¬¡å‘èµ·è¯·æ±‚</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-title function_">startLongPoll</span>();</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;)</span></span><br><span class="language-javascript"><span class="language-xml">        .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;box&#x27;</span>).<span class="hljs-property">innerText</span> = <span class="hljs-string">&#x27;è¿æ¥å¤±è´¥ï¼Œé‡è¯•ä¸­...&#x27;</span>;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-built_in">setTimeout</span>(startLongPoll, <span class="hljs-number">3000</span>); <span class="hljs-comment">// ç­‰å¾…å†é‡è¯•</span></span></span><br><span class="language-javascript"><span class="language-xml">        &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">startLongPoll</span>();</span></span><br><span class="language-javascript"><span class="language-xml">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"></span><br></code></pre></td></tr></table></figure><p>æœåŠ¡ç«¯</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-comment">// server.js</span><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<br><br><span class="hljs-keyword">let</span> latestMessage = <span class="hljs-string">&#x27;æš‚æ— æ–°æ¶ˆæ¯&#x27;</span>;<br><span class="hljs-keyword">let</span> waitClients = []; <span class="hljs-comment">// æŒ‚èµ·è¯·æ±‚çš„å®¢æˆ·ç«¯åˆ—è¡¨</span><br><br><span class="hljs-comment">// æ¨¡æ‹ŸæœåŠ¡ç«¯æ¨é€ï¼ˆæ¯éš” 10 ç§’æ›´æ–°ä¸€æ¡æ¶ˆæ¯ï¼‰</span><br><span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  latestMessage = <span class="hljs-string">&#x27;æ–°æ¶ˆæ¯æ—¶é—´ï¼š&#x27;</span> + <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toLocaleTimeString</span>();<br><br>  <span class="hljs-comment">// æ‰€æœ‰æŒ‚èµ·çš„è¯·æ±‚ç«‹å³å“åº”</span><br>  waitClients.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">message</span>: latestMessage &#125;));<br>  waitClients = []; <span class="hljs-comment">// æ¸…ç©º</span><br>&#125;, <span class="hljs-number">10000</span>);<br><br><span class="hljs-comment">// Long Poll æ¥å£</span><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/longpoll&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// å°†å“åº”æŒ‚èµ·ï¼Œç­‰å¾…æœåŠ¡ç«¯æœ‰æ›´æ–°åå†å“åº”</span><br>  waitClients.<span class="hljs-title function_">push</span>(res);<br><br>  <span class="hljs-comment">// è¶…æ—¶ä¿æŠ¤ï¼šå¦‚æœ30ç§’åè¿˜æ²¡æœ‰æ¶ˆæ¯ï¼Œåˆ™è¿”å›ç©ºæ•°æ®</span><br>  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> index = waitClients.<span class="hljs-title function_">indexOf</span>(res);<br>    <span class="hljs-keyword">if</span> (index !== -<span class="hljs-number">1</span>) &#123;<br>      waitClients.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);<br>      res.<span class="hljs-title function_">json</span>(&#123; <span class="hljs-attr">message</span>: <span class="hljs-literal">null</span> &#125;); <span class="hljs-comment">// è¡¨ç¤ºæ— æ›´æ–°</span><br>    &#125;<br>  &#125;, <span class="hljs-number">30000</span>);<br>&#125;);<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;æœåŠ¡è¿è¡Œåœ¨ &lt;http://localhost:3000&gt;&#x27;</span>);<br>&#125;);<br><br></code></pre></td></tr></table></figure><h1 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h1><p>WebSocket æ˜¯é€šè¿‡ HTTP è¯·æ±‚å»ºç«‹çš„è¿æ¥ï¼Œåœ¨æˆåŠŸå‡çº§åè®®ååˆ‡æ¢ä¸ºå…¨åŒå·¥é€šä¿¡ï¼Œå…è®¸å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å½¼æ­¤ä¸»åŠ¨å‘é€æ¶ˆæ¯ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-comment">// JS å®¢æˆ·ç«¯</span><br>socket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">&quot;ws://192.168.0.5:18899/ws&quot;</span>,<span class="hljs-string">&quot;echo&quot;</span>);<br><span class="hljs-comment">// åˆ›å»ºwebsocket</span><br>socket.<span class="hljs-property">onopen</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)&#123;<br><span class="hljs-keyword">var</span> target = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;responseText&quot;</span>);<br>target.<span class="hljs-property">value</span> = <span class="hljs-string">&quot;Web Socket è¿æ¥å·²ç»å¼€å¯&quot;</span>;<br>&#125;;<br><span class="hljs-comment">// ç›‘å¬websocketè¿æ¥çš„openäº‹ä»¶</span><br><br>socket.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)&#123;<br><span class="hljs-keyword">var</span> ta = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;responseText&quot;</span>);<br>ta.<span class="hljs-property">value</span> = ta.<span class="hljs-property">value</span> + <span class="hljs-string">&#x27;\\n&#x27;</span> + event.<span class="hljs-property">data</span><br>&#125;;<br><span class="hljs-comment">// è·å–æœåŠ¡ç«¯æ•°æ®</span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">var</span> socket ;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">if</span>(!<span class="hljs-variable language_">window</span>.<span class="hljs-property">WebSocket</span>)&#123;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-variable language_">window</span>.<span class="hljs-property">WebSocket</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">MozWebSocket</span>;</span></span><br><span class="language-javascript"><span class="language-xml">&#125;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">var</span> domain = <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">host</span>;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">if</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">WebSocket</span>)&#123;</span></span><br><span class="language-javascript"><span class="language-xml">socket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">&quot;ws://&quot;</span> + domain +<span class="hljs-string">&quot;/ws&quot;</span> ,<span class="hljs-string">&quot;echo&quot;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">socket.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>)&#123;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">var</span> ta = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;responseText&quot;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">ta.<span class="hljs-property">value</span> = ta.<span class="hljs-property">value</span> + <span class="hljs-string">&#x27;\\n&#x27;</span> + event.<span class="hljs-property">data</span></span></span><br><span class="language-javascript"><span class="language-xml">&#125;;</span></span><br><span class="language-javascript"><span class="language-xml">socket.<span class="hljs-property">onopen</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)&#123;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">var</span> target = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;responseText&quot;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">target.<span class="hljs-property">value</span> = <span class="hljs-string">&quot;Web Socket è¿æ¥å·²å¼€å¯!&quot;</span>;</span></span><br><span class="language-javascript"><span class="language-xml">&#125;;</span></span><br><span class="language-javascript"><span class="language-xml">socket.<span class="hljs-property">onclose</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)&#123;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">var</span> target = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;responseText&quot;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">target.<span class="hljs-property">value</span> = ta.<span class="hljs-property">vale</span> + <span class="hljs-string">&quot;WebSocket å·²æ–­å¼€&quot;</span>;</span></span><br><span class="language-javascript"><span class="language-xml">&#125;;</span></span><br><span class="language-javascript"><span class="language-xml">&#125;<span class="hljs-keyword">else</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;Your browser does not support Web Socket&quot;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">&#125;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">function</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">message</span>)&#123;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">if</span>(!windows.<span class="hljs-property">WebSocket</span>)&#123;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">return</span> ;</span></span><br><span class="language-javascript"><span class="language-xml">&#125;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">if</span> (socket.<span class="hljs-property">readyState</span> == <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">OPEN</span>)&#123;</span></span><br><span class="language-javascript"><span class="language-xml">socket.<span class="hljs-title function_">send</span>(message);</span></span><br><span class="language-javascript"><span class="language-xml">&#125;<span class="hljs-keyword">else</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;The Socket is not open&quot;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">&#125;</span></span><br><span class="language-javascript"><span class="language-xml">&#125;</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>æœåŠ¡å™¨ç«¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// WebSocketæ•°æ®å¸§ç±»å‹</span><br>BinaryWebSocketFrame     å°è£…äºŒè¿›åˆ¶æ•°æ®çš„WebSocketFrameæ•°æ®å¸§<br>TextWebSocketFrame       å°è£…æ–‡æœ¬æ•°æ®çš„WebSocketFrameæ•°æ®å¸§<br>CloseWebSocketFrame      è¡¨ç¤ºä¸€ä¸ªCloseç»“æŸè¯·æ±‚<br>ContinuationWebSocketFrame åˆ†æ‹†ä¸ºå¤šä¸ªWebSocketæ•°æ®å¸§å,ç”¨äºå‘é€åç»­å†…å®¹çš„æ•°æ®å¸§<br>PingWebSocketFrame       å¿ƒè·³å¸§ï¼Œä¸€èˆ¬ç”¨äºå®¢æˆ·ç«¯å‘é€<br>PongWebSocketFrame       å¿ƒè·³å¸§ï¼Œä¸€èˆ¬ç”¨äºæœåŠ¡ç«¯å‘é€<br><br><span class="hljs-comment">// Netty åŒ…è£…ç±»</span><br><br>WebSocketServerProtocolHandler è´Ÿè´£å¼€å¯å¤„ç†æ¡æ‰‹è¿‡ç¨‹ï¼Œä»¥åŠä¿æ´»/å…³é—­å¤„ç†<br>WebSocketServerProtocolHandshakeHandler  è´Ÿè´£è¿›è¡Œåè®®å‡çº§æ¡æ‰‹å¤„ç†<br>WebSocketSocketFrameEncoder    æ•°æ®å¸§ç¼–ç å™¨ï¼Œè´Ÿè´£WebSocketæ•°æ®å¸§ç¼–ç ã€‚<br>WebSocketSocketFrameDecoder    æ•°æ®å¸§è§£ç å™¨ï¼Œè´Ÿè´£WebSocketæ•°æ®å¸§è§£ç <br><br><span class="hljs-comment">// æœåŠ¡ç«¯</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketEchoServer</span>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EchoInitializer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span>&#123;<br><span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> ch.pipeline();<br>pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpRequestDecoder</span>());<br>pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpResponseEncoder</span>());<br>pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpObjectAggregator</span>(<span class="hljs-number">65535</span>));<br>pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocketServerProtocolHandler</span>(<span class="hljs-string">&quot;/ws&quot;</span>,<span class="hljs-string">&quot;echo&quot;</span>,<span class="hljs-literal">true</span>,<span class="hljs-number">10</span>*<span class="hljs-number">1024</span>));<br>pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WebPageHandler</span>());<br>pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TextWebSocketFrameHandler</span>());<br>&#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">(String ip )</span> <span class="hljs-keyword">throws</span> Exception&#123;<br><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">1</span>);<br><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workerGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();<br><span class="hljs-keyword">try</span>&#123;<br><span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();<br>b.group(bossGroup, workerGroup)<br>.channel(NioServerSocketChannel.class)<br>.handler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LoggingHandler</span>(LogLevel.DEBUG))<br>.childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">EchoInitializer</span>());<br><span class="hljs-type">Channel</span> <span class="hljs-variable">ch</span>  <span class="hljs-operator">=</span> b.bind(<span class="hljs-number">18899</span>).sync().channel();<br>log.info(<span class="hljs-string">&quot;WebSocketæœåŠ¡å·²å¯åŠ¨http://&#123;&#125;:&#123;&#125;&quot;</span>,ip,<span class="hljs-number">18899</span>);<br>ch.closeFutrue().sync();<br>&#125;<span class="hljs-keyword">finally</span>&#123;<br>bossGroup.shutdownGracefully();<br>workerGroup.shutdownGracefully();<br>&#125;<br>&#125;<br>&#125;  <br><br><span class="hljs-comment">// å¤„ç†å™¨</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TextWebSocketFrameHandler</span> <span class="hljs-keyword">extends</span> <br><span class="hljs-title class_">SimpleChannelInboundHandler</span>&lt;WebSocketFrame&gt;<br>&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx , WebSocketFrame frame)</span> <span class="hljs-keyword">throws</span> Exception<br>&#123;<br><span class="hljs-keyword">if</span>(frame <span class="hljs-keyword">instanceof</span> TextWebSocektFrame)&#123;<br><span class="hljs-type">String</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> ((TextWebSocketFrame) frame).text();<br>log.debug(<span class="hljs-string">&quot;æœåŠ¡ç«¯æ”¶åˆ°ï¼š&quot;</span>+ request);<br><span class="hljs-type">String</span> <span class="hljs-variable">echo</span> <span class="hljs-operator">=</span> Dateutil.getTime() + <span class="hljs-string">&quot;:&quot;</span> + request;<br><span class="hljs-type">TextWebSocketFream</span> <span class="hljs-variable">echoFrame</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextWebSocketFrame</span>(echo);<br>ctx.channel().writeAndFlush(echoFrame);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;unsupported frame type:&quot;</span> + frame.getClass().getName();<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>(message);<br>&#125;<br>&#125;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">userEventTriggered</span><span class="hljs-params">(ChannelHandlerContext ctx, Object evt)</span> <span class="hljs-keyword">throws</span> Exception<br>&#123;<br><span class="hljs-keyword">if</span>(evt <span class="hljs-keyword">instanceof</span> WebSocketServerProtocolHandler.HandshakeComplete)&#123;<br>ctx.pipeline().remove(WebPageHandler.class);<br>log.debug(<span class="hljs-string">&quot;WebSock HandShakeComplete æ¡æ‰‹æˆåŠŸ&quot;</span>);<br>log.debug(<span class="hljs-string">&quot;æ–°çš„WebSocketå®¢æˆ·ç«¯åŠ å…¥ï¼Œé€šé“ä¸ºï¼š&quot;</span>+ ctx.channel());<br>&#125; <span class="hljs-keyword">else</span> <br>&#123;<br><span class="hljs-built_in">super</span>.userEventTriggered(ctx,evt);<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="WebSocket-å‡çº§è¿‡ç¨‹"><a href="#WebSocket-å‡çº§è¿‡ç¨‹" class="headerlink" title="WebSocket å‡çº§è¿‡ç¨‹"></a>WebSocket å‡çº§è¿‡ç¨‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java">ğŸ§‘ Client                   ğŸŒ Network                   ğŸ–¥ï¸ Server<br><br>    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>    â”‚JS å‘èµ·è¯·æ±‚  â”‚ â”€â”€ GET / Upgrade: websocket â”€â”€â–¶   â”‚HTTP Server  â”‚<br>    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br>                                                      â”‚éªŒè¯ Sec-Key â”‚<br>                                                      â”‚è¿”å› <span class="hljs-number">101</span> å‡çº§â”‚<br>    â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ <span class="hljs-number">101</span> Switching Protocols â”€â”€â”€â”€â”€â”€â”€â”€â”€<br>    â–¼ å‡çº§å®Œæˆ<br><br>ğŸš€ WebSocket å»ºç«‹ï¼ŒåŒå‘é€šä¿¡å¼€å§‹<br>    â‡„ socket.send()<br>    â‡„ socket.onmessage()<br><br>    âŒ å‘é€ Close å¸§<br>    â–¼ TCP è¿æ¥å…³é—­<br><br></code></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯åŸºäºHTTP å‘é€å‡çº§è¯·æ±‚ï¼Œè¯·æ±‚é¦–éƒ¨åŒ…å«ä»¥ä¸‹å†…å®¹ ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">GET /chat HTTP/<span class="hljs-number">1.1</span><br>Host: example.com              <br>Upgrade: websocket                              <span class="hljs-comment">// æŒ‡å®šå‡çº§çš„ç›®æ ‡åè®®</span><br>Connection: Upgrade                             <span class="hljs-comment">// å‘å‡ºå£°æ˜è¯·æ±‚</span><br>Sec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ==     â† å®¢æˆ·ç«¯éšæœºBase64ç¼–ç å€¼<br>Sec-WebSocket-Version: <span class="hljs-number">13</span>                         â† ä½¿ç”¨çš„WebSocketåè®®ç‰ˆæœ¬<br>Sec-WebSocket-Protocol: echo\\r\\n                   â† å¯ä»¥ç”¨äºæè¿°è‡ªå®šä¹‰çš„å­åè®®<br></code></pre></td></tr></table></figure><p>æœåŠ¡ç«¯å“åº”</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">101</span> Switching Protocols                    â† å“åº”ç ä¸º<span class="hljs-number">101</span><br>Upgrade: websocket<br>Connection: Upgrade<br>Sec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo=   â† æœåŠ¡ç«¯è®¡ç®—åçš„ key éªŒè¯ç»“æœ<br>Sec-WebSocket-Protocol: echo\\r\\n                   â† ç”¨äºæè¿°è‡ªå®šä¹‰çš„å­åè®®<br></code></pre></td></tr></table></figure><h3 id="æŠ¥æ–‡æ ¼å¼"><a href="#æŠ¥æ–‡æ ¼å¼" class="headerlink" title="æŠ¥æ–‡æ ¼å¼"></a>æŠ¥æ–‡æ ¼å¼</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-number">0</span>               <span class="hljs-number">1</span>               <span class="hljs-number">2</span>               <span class="hljs-number">3</span>  <br>+---------------+---------------+---------------+---------------+<br>|FIN| RSV1|RSV2|RSV3|  OPCODE   | MASK | Payload <span class="hljs-title function_">length</span> <span class="hljs-params">(<span class="hljs-number">7</span>)</span>     |<br>+---------------+---------------+-------------------------------+<br>|   Extended payload <span class="hljs-title function_">length</span> <span class="hljs-params">(<span class="hljs-number">16</span>/<span class="hljs-number">64</span> bits, optional)</span>              |<br>+---------------------------------------------------------------+<br>|   Masking <span class="hljs-title function_">key</span> <span class="hljs-params">(<span class="hljs-number">32</span> bits, optional)</span>                             |<br>+---------------------------------------------------------------+<br>|   Payload <span class="hljs-title function_">data</span> <span class="hljs-params">(x bytes)</span>                                      |<br>+---------------------------------------------------------------+<br>FIN            <span class="hljs-number">1</span> bit              æ˜¯å¦ä¸ºæ¶ˆæ¯çš„æœ€åä¸€å¸§ï¼ˆ<span class="hljs-number">1</span> è¡¨ç¤ºæ˜¯ï¼‰<br>RSV1~<span class="hljs-number">3</span>        <span class="hljs-number">3</span> bit               é€šå¸¸ä¸º <span class="hljs-number">0</span>ï¼Œä¿ç•™æ‰©å±•ç”¨<br>OPCODE        <span class="hljs-number">4</span> bit              è¡¨ç¤ºå¸§ç±»å‹ï¼ˆè§ä¸‹ï¼‰<br>MASK          <span class="hljs-number">1</span> bit              è¡¨ç¤º Payload æ˜¯å¦è¢«æ©ç ï¼ˆå®¢æˆ·ç«¯å¿…é¡»ä¸º <span class="hljs-number">1</span>ï¼‰<br>Payload length<span class="hljs-number">7</span> bit              è¡¨ç¤ºæ•°æ®é•¿åº¦ï¼ˆ<span class="hljs-number">0</span>~<span class="hljs-number">125</span>ï¼‰<br>ç‰¹æ®Šå€¼ï¼š<span class="hljs-number">126</span> = 16bit æ‰©å±•ï¼Œ<span class="hljs-number">127</span> = 64bit æ‰©å±•<br>Extended Payload Length<span class="hljs-number">0</span>/<span class="hljs-number">2</span>/<span class="hljs-number">8</span> å­—èŠ‚å½“é•¿åº¦ä¸º <span class="hljs-number">126</span> æˆ– <span class="hljs-number">127</span> æ—¶æ‰å‡ºç°<br>Masking key    <span class="hljs-number">4</span> å­—èŠ‚            ä»…å®¢æˆ·ç«¯å‘é€æ—¶å­˜åœ¨ï¼Œç”¨äºè§£ç  payload<br>Payload data  ä»»æ„              çœŸæ­£è¦ä¼ è¾“çš„æ•°æ®ï¼ˆæ–‡æœ¬/äºŒè¿›åˆ¶ï¼‰<br><br></code></pre></td></tr></table></figure><p>OPCODE ï¼ˆæŠ¥æ–‡ç±»å‹ï¼‰</p><table><thead><tr><th>OPCODE</th><th>ç±»å‹</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>0x0</code></td><td>Continuation</td><td>åç»­å¸§ï¼ˆç”¨äºåˆ†ç‰‡ï¼‰</td></tr><tr><td><code>0x1</code></td><td>Text Frame</td><td>æ–‡æœ¬å¸§ï¼ˆUTF-8 ç¼–ç ï¼‰</td></tr><tr><td><code>0x2</code></td><td>Binary Frame</td><td>äºŒè¿›åˆ¶å¸§</td></tr><tr><td><code>0x8</code></td><td>Connection Close</td><td>å…³é—­è¿æ¥</td></tr><tr><td><code>0x9</code></td><td>Ping</td><td>å¿ƒè·³æ¢æµ‹ï¼ˆå®¢æˆ·ç«¯å‘é€ï¼‰</td></tr><tr><td><code>0xA</code></td><td>Pong</td><td>å¿ƒè·³å›åº”</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œæŠ€æœ¯</category>
      
      <category>WebSocket</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œæŠ€æœ¯, WebSocket</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTTPåè®® IV è¯†åˆ«ï¼Œè¿æ¥ï¼Œè®¤è¯ä¸å®‰å…¨</title>
    <link href="/2025/05/13/HTTP%E5%8D%8F%E8%AE%AE-IV-%E8%AF%86%E5%88%AB%EF%BC%8C%E8%BF%9E%E6%8E%A5%EF%BC%8C%E8%AE%A4%E8%AF%81%E4%B8%8E%E5%AE%89%E5%85%A8/"/>
    <url>/2025/05/13/HTTP%E5%8D%8F%E8%AE%AE-IV-%E8%AF%86%E5%88%AB%EF%BC%8C%E8%BF%9E%E6%8E%A5%EF%BC%8C%E8%AE%A4%E8%AF%81%E4%B8%8E%E5%AE%89%E5%85%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="å£°æ˜çš„ï¼Œæ— çŠ¶æ€çš„"><a href="#å£°æ˜çš„ï¼Œæ— çŠ¶æ€çš„" class="headerlink" title="å£°æ˜çš„ï¼Œæ— çŠ¶æ€çš„"></a>å£°æ˜çš„ï¼Œæ— çŠ¶æ€çš„</h1><p>HTTP æœ¬èº«æ˜¯ä¸€ç§å£°æ˜å¼çš„ï¼Œä¸è´Ÿè´£çŠ¶æ€å­˜å‚¨çš„åè®®ã€‚</p><p>å…¶æ„é€ æœ¬èº«åªæä¾›äº†ç®€å•çš„æ§åˆ¶&#x2F;è®¿é—®æµç¨‹ ï¼ˆæ–¹æ³•ï¼Œè·¯å¾„ï¼Œåè®®å·ï¼Œä»¥åŠé¦–éƒ¨çš„æ§åˆ¶å­—æ®µ â†’ çŠ¶æ€ç ï¼Œå“åº”é¦–éƒ¨ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨çš„å“åº”å†…å®¹ï¼‰ã€‚ è¿™ä¸ªè¿‡ç¨‹ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯æè¿°æ€§çš„ï¼Œéœ€è¦å¤–éƒ¨çš„ä»‹è´¨ï¼ˆä¸€èˆ¬æ˜¯ä¸€äº›ä¸­é—´è®¾å¤‡å¦‚å®¢æˆ·ç«¯ä»£ç†ï¼Œç½‘å…³ï¼Œé˜²ç«å¢™ï¼ŒæœåŠ¡ç«¯ç­‰ï¼‰æ ¹æ®å…¶æè¿°æ¥å®Œæˆä¿æ´»ï¼Œå­˜å‚¨ï¼ŒçŠ¶æ€ä¿å­˜ç­‰ä¸€ç³»åˆ—æ‰©å±•åŠŸèƒ½ã€‚</p><h1 id="çŠ¶æ€å­˜å‚¨"><a href="#çŠ¶æ€å­˜å‚¨" class="headerlink" title="çŠ¶æ€å­˜å‚¨"></a>çŠ¶æ€å­˜å‚¨</h1><p>åœ¨é¢å‘åº”ç”¨çš„åè®®ä¸­ï¼ŒçŠ¶æ€å­˜å‚¨æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„å±æ€§ã€‚é€šè¿‡å¯¹çŠ¶æ€çš„å­˜å‚¨ï¼Œå¯ä»¥ä¸ºç”¨æˆ·å’ŒæœåŠ¡ç«¯æä¾›è®¸å¤šæœ‰ç”¨çš„æ‰©å±•ï¼Œå¦‚ç”¨æˆ·çš„ä¸ªæ€§åŒ–å®šåˆ¶ï¼Œä¼šè¯çš„ç®¡ç†ç­‰ã€‚</p><h2 id="HTTPé¦–éƒ¨"><a href="#HTTPé¦–éƒ¨" class="headerlink" title="HTTPé¦–éƒ¨"></a>HTTPé¦–éƒ¨</h2><p>From   ä¸€èˆ¬ä¼šç”¨æ¥æ‰¿è½½ä¸€ä¸ªé‚®ç®±åœ°å€</p><p>User-Agent å‘ŠçŸ¥ç”¨æˆ·æµè§ˆå™¨çš„ç›¸å…³ä¿¡æ¯</p><p>IP åœ°å€</p><p>Authenticate ä¼ è¾“è®¤è¯ç›¸å…³ä¿¡æ¯</p><h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><p>cookieæ˜¯æœåŠ¡å™¨ç«¯åœ¨å®¢æˆ·ç«¯å®‰ç½®çš„å°å‹å­˜å‚¨</p><p>cookieæè¿°äº†ä¸€äº›é”®å€¼ä¿¡æ¯ï¼Œå¯ä»¥ä¾›æœåŠ¡å™¨è¿›è¡Œè®¿é—®æŸ¥è¯¢ç¡®è®¤ç”¨æˆ·çš„ä¿¡æ¯</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-type">NAME</span>=<span class="hljs-keyword">VALUE</span>   é”®å€¼æè¿°<br>Expire       è¿‡æœŸæ—¥æœŸ<br><span class="hljs-keyword">Domain</span>       å®šä¹‰Cookieç”Ÿæ•ˆçš„ä½œç”¨åŸŸ<br><span class="hljs-type">Path</span>         å®šä¹‰åœ¨æŸä¸ªè·¯å¾„ä¸‹Cookieä¼šç”Ÿæ•ˆ<br>Secure       å®šä¹‰åï¼Œåªæœ‰åœ¨TLS/SSLç”Ÿæ•ˆåæ‰ä¼šå‘é€cookie<br></code></pre></td></tr></table></figure><h1 id="è®¤è¯"><a href="#è®¤è¯" class="headerlink" title="è®¤è¯"></a>è®¤è¯</h1><p>Webåº”ç”¨ç¨‹åºæ”¶åˆ°ä¸€æ¡HTTPè¯·æ±‚æŠ¥æ–‡æ—¶ï¼ŒæœåŠ¡å™¨æ²¡æœ‰æŒ‰ç…§è¯·æ±‚æ‰§è¡ŒåŠ¨ä½œï¼Œè€Œæ˜¯ä»¥ä¸€ä¸ªâ€œè®¤è¯è´¨è¯¢â€è¿›è¡Œå“åº”ï¼Œè¦æ±‚ç”¨æˆ·æä¾›ä¸€äº›ä¿å¯†ä¿¡æ¯æ¥è¯´æ˜ä»–æ˜¯è°ï¼Œä»è€Œå¯¹å…¶è¿›è¡Œè´¨è¯¢ã€‚</p><p>ç”¨æˆ·å†æ¬¡å‘èµ·è¯·æ±‚æ—¶ï¼Œè¦é™„ä¸Šä¿å¯†è¯ä¹¦ï¼ˆç”¨æˆ·åå’Œå¯†ç ï¼‰ã€‚å¦‚æœè¯ä¹¦ä¸åŒ¹é…ï¼ŒæœåŠ¡å™¨å¯ä»¥å†æ¬¡è´¨è¯¢å®¢æˆ·ç«¯ï¼Œæˆ–äº§ç”Ÿä¸€æ¡é”™è¯¯ä¿¡æ¯ã€‚å¦‚æœè¯ä¹¦åŒ¹é…ï¼Œå°±å¯ä»¥æ­£å¸¸å®Œæˆè¯·æ±‚äº†ã€‚</p><h2 id="åŸºæœ¬è®¤è¯"><a href="#åŸºæœ¬è®¤è¯" class="headerlink" title="åŸºæœ¬è®¤è¯"></a>åŸºæœ¬è®¤è¯</h2><ol><li>å®¢æˆ·ç«¯å‘é€è®¿é—®è¯·æ±‚</li><li>æœåŠ¡ç«¯è¿”å›æœªæˆæƒï¼Œè¯´æ˜å®¢æˆ·éœ€æ±‚æä¾›å¯¹åº”çš„ç”¨æˆ·åå’Œå¯†ç </li><li>å®¢æˆ·ç«¯é‡æ–°å‘é€å¸¦æœ‰è®¤è¯ä¿¡æ¯çš„è¯·æ±‚</li><li>æœåŠ¡ç«¯éªŒè¯åæ­£ç¡®åˆ™å›å¤è®¤è¯æˆåŠŸçš„å“åº”</li></ol><h2 id="Base-64"><a href="#Base-64" class="headerlink" title="Base-64"></a>Base-64</h2><p>å°† 8ä½æ•°æ®è½¬æ¢ä¸º6ä½ç¼–ç ï¼Œç”¨64ä¸ªå­—ç¬¦é‡æ–°è¡¨ç¤º</p><p>åŸºæœ¬è®¤è¯å­˜åœ¨å¾ˆå¤šç¼ºé™·ï¼Œæ˜æ–‡ä¼ è¾“ï¼Œä»¥åŠåœ¨è¿‡äºå¤æ‚çš„ç½‘ç»œç¯å¢ƒä¸­æœ‰è¢«ç›‘å¬å’Œç¯¡æ”¹æŠ¥æ–‡çš„é£é™©</p><h2 id="æ‘˜è¦è®¤è¯"><a href="#æ‘˜è¦è®¤è¯" class="headerlink" title="æ‘˜è¦è®¤è¯"></a>æ‘˜è¦è®¤è¯</h2><p>å®¢æˆ·ç«¯å‘é€è¯·æ±‚ä¿¡æ¯</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/protected/resource</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>example.com<br></code></pre></td></tr></table></figure><p>æœåŠ¡å™¨å“åº”è¯·æ±‚ï¼Œè¯·æ±‚è¿›è¡Œæˆæƒè®¤è¯</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs routeros">HTTP/1.1 401 Unauthorized<br>WWW-Authenticate: Digest<br>  <span class="hljs-attribute">realm</span>=<span class="hljs-string">&quot;example.com&quot;</span>,<br>  <span class="hljs-attribute">nonce</span>=<span class="hljs-string">&quot;abc123&quot;</span>,             â† æœåŠ¡ç«¯ç”Ÿæˆçš„éšæœºæ•°ï¼Œé˜²æ­¢é‡æ”¾æ”»å‡»<br>  <span class="hljs-attribute">qop</span>=<span class="hljs-string">&quot;auth&quot;</span>,<br>  <span class="hljs-attribute">algorithm</span>=MD5<br><br></code></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯å¯¹æ”¶åˆ°çš„éšæœºæ•° å’Œæœ¬åœ°å¯†ç è¿›è¡ŒMD5è®¡ç®—ï¼Œå“åº”</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Authorization: Digest<br>  <span class="hljs-attribute">username</span>=<span class="hljs-string">&quot;alice&quot;</span>,<br>  <span class="hljs-attribute">realm</span>=<span class="hljs-string">&quot;example.com&quot;</span>,<br>  <span class="hljs-attribute">nonce</span>=<span class="hljs-string">&quot;abc123&quot;</span>,<br>  <span class="hljs-attribute">uri</span>=<span class="hljs-string">&quot;/protected/resource&quot;</span>,<br>  <span class="hljs-attribute">response</span>=<span class="hljs-string">&quot;dcd98b7102dd2f0e8b11...&quot;</span>,  â† ç”±å®¢æˆ·ç«¯è®¡ç®—å‡ºçš„æ‘˜è¦<br>  <span class="hljs-attribute">qop</span>=auth,<br>  <span class="hljs-attribute">nc</span>=00000001,<br>  <span class="hljs-attribute">cnonce</span>=<span class="hljs-string">&quot;xyz789&quot;</span><br><br></code></pre></td></tr></table></figure><h1 id="å­—æ®µä¸åŠŸèƒ½ç‚¹"><a href="#å­—æ®µä¸åŠŸèƒ½ç‚¹" class="headerlink" title="å­—æ®µä¸åŠŸèƒ½ç‚¹"></a>å­—æ®µä¸åŠŸèƒ½ç‚¹</h1><table><thead><tr><th>å­—æ®µå</th><th>æ‰€åœ¨æŠ¥æ–‡</th><th>å…¸å‹ç»„åˆ</th><th>å¯¹åº”åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>Connection</code>+<code>Upgrade</code></td><td>è¯·æ±‚ &amp; å“åº”</td><td><code>Connection: Upgrade</code>,<code>Upgrade: websocket</code></td><td>åè®®å‡çº§æœºåˆ¶ï¼ˆå¦‚ HTTP â†’ WebSocketï¼‰</td></tr><tr><td><code>Host</code></td><td>è¯·æ±‚å¤´</td><td>-</td><td>è™šæ‹Ÿä¸»æœºè·¯ç”±ï¼ˆåŒ IP å¤šåŸŸåæ”¯æŒï¼‰</td></tr><tr><td><code>Content-Type</code>+<code>Content-Length</code></td><td>è¯·æ±‚&#x2F;å“åº”</td><td><code>Content-Type: application/json</code></td><td>è¯·æ±‚ä½“æ ¼å¼æ ‡è¯†ä¸æ•°æ®è¾¹ç•Œæ§åˆ¶</td></tr><tr><td><code>Transfer-Encoding</code></td><td>å“åº”å¤´</td><td><code>Transfer-Encoding: chunked</code></td><td>åˆ†å—ä¼ è¾“æœºåˆ¶ï¼ˆé€‚åˆå¤§æ–‡ä»¶&#x2F;æµå¼å†…å®¹ï¼‰</td></tr><tr><td><code>Cookie</code>+<code>Set-Cookie</code></td><td>è¯·æ±‚ + å“åº”</td><td><code>Set-Cookie: sessionId=abc123</code></td><td>å®¢æˆ·ç«¯ä¼šè¯çŠ¶æ€ç®¡ç†</td></tr><tr><td><code>Authorization</code>+<code>WWW-Authenticate</code></td><td>è¯·æ±‚ + å“åº”</td><td><code>Authorization: Bearer &lt;token&gt;</code></td><td>èº«ä»½éªŒè¯æœºåˆ¶ï¼ˆå¦‚ OAuthã€Basicï¼‰</td></tr><tr><td><code>ETag</code>+<code>If-None-Match</code></td><td>å“åº” + è¯·æ±‚</td><td><code>ETag: &quot;123abc&quot;</code></td><td>åå•†ç¼“å­˜ï¼šåŸºäºå†…å®¹æ ¡éªŒ</td></tr><tr><td><code>Last-Modified</code>+<code>If-Modified-Since</code></td><td>å“åº” + è¯·æ±‚</td><td><code>Last-Modified: Tue, 12 May 2025 10:00:00 GMT</code></td><td>åå•†ç¼“å­˜ï¼šåŸºäºæ—¶é—´æˆ³</td></tr><tr><td><code>Cache-Control</code></td><td>è¯·æ±‚&#x2F;å“åº”</td><td><code>Cache-Control: no-cache</code></td><td>ç¼“å­˜è¡Œä¸ºæ§åˆ¶ï¼ˆæ˜¯å¦ç¼“å­˜ã€æœ€å¤§æ—¶é•¿ï¼‰</td></tr><tr><td><code>Accept</code>+<code>Content-Type</code></td><td>è¯·æ±‚ + å“åº”</td><td><code>Accept: application/json</code></td><td>å†…å®¹åå•†æœºåˆ¶</td></tr><tr><td><code>Accept-Encoding</code>+<code>Content-Encoding</code></td><td>è¯·æ±‚ + å“åº”</td><td><code>Content-Encoding: gzip</code></td><td>å‹ç¼©æ ¼å¼åå•†</td></tr><tr><td><code>Accept-Language</code></td><td>è¯·æ±‚å¤´</td><td>-</td><td>å“åº”è¯­è¨€åå¥½åå•†</td></tr><tr><td><code>Origin</code>+<code>Access-Control-*</code></td><td>è¯·æ±‚ + å“åº”</td><td><code>Access-Control-Allow-Origin: *</code></td><td>CORS è·¨åŸŸè®¿é—®æ§åˆ¶</td></tr><tr><td><code>Referer</code></td><td>è¯·æ±‚å¤´</td><td>-</td><td>æ¥æºè¿½è¸ªã€é˜²ç›—é“¾ã€åˆ†æè·³è½¬</td></tr><tr><td><code>Location</code>+<code>3xx</code>çŠ¶æ€ç </td><td>å“åº”å¤´</td><td><code>Location: &lt;https://new.url</code>&gt;</td><td>é‡å®šå‘æœºåˆ¶</td></tr><tr><td><code>X-Forwarded-For</code></td><td>è¯·æ±‚å¤´</td><td>-</td><td>è·å–å®¢æˆ·ç«¯çœŸå® IPï¼ˆç»ä»£ç†ï¼‰</td></tr><tr><td><code>X-Requested-With</code></td><td>è¯·æ±‚å¤´</td><td><code>X-Requested-With: XMLHttpRequest</code></td><td>AJAX è¯·æ±‚æ ‡è¯†</td></tr></tbody></table><h2 id="é•¿è¿æ¥"><a href="#é•¿è¿æ¥" class="headerlink" title="é•¿è¿æ¥"></a>é•¿è¿æ¥</h2><p>å°†HTTP ä¼šè¯å˜ä¸ºç»´æŒTCPè¿æ¥ï¼Œä»è¯·æ±‚-å“åº”-å…³é—­ å˜ä¸º è¯·æ±‚-å“åº”-ç­‰å¾…è¶…æ—¶-å…³é—­</p><h1 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h1><h1 id="é‡å®šå‘ä¸è´Ÿè½½å‡è¡¡"><a href="#é‡å®šå‘ä¸è´Ÿè½½å‡è¡¡" class="headerlink" title="é‡å®šå‘ä¸è´Ÿè½½å‡è¡¡"></a>é‡å®šå‘ä¸è´Ÿè½½å‡è¡¡</h1><h2 id="HTTPé‡å®šå‘"><a href="#HTTPé‡å®šå‘" class="headerlink" title="HTTPé‡å®šå‘"></a>HTTPé‡å®šå‘</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs">å®ç° ï¼šæœåŠ¡å™¨æ¥æ”¶HTTPè¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›é‡å®šå‘æ¶ˆæ¯ï¼Œå®¢æˆ·ç«¯å°†è¯·æ±‚é‡æ–°å‘é€åˆ°é€‰ä¸­æœåŠ¡å™¨<br>å±€é™ ï¼šæœåŠ¡å™¨éœ€è¦å¯ä»¥å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œä¸”é‡å®šå‘æ­¥éª¤è¾ƒå¤š<br></code></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯ å‘é€è¯·æ±‚æŠ¥æ–‡ ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/hammers.html</span> <span class="hljs-meta">HTTP/1.0</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>www.joes-hardware.com<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/4.51 [en] (X11; U; IRIX 6.2 IP22)<br></code></pre></td></tr></table></figure><p>æœåŠ¡ç«¯å“åº”ä¸€ä¸ªé‡å®šå‘æŠ¥æ–‡</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">HTTP</span>/<span class="hljs-number">1</span>.<span class="hljs-number">0302</span> Redirect<br><span class="hljs-attribute">Server</span>: Stronghold/<span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">2</span> Apache/<span class="hljs-number">1</span>.<span class="hljs-number">3</span>.<span class="hljs-number">6</span><br><span class="hljs-attribute">Location</span>: &lt;http://<span class="hljs-number">161.58.228.45</span>/hammers.html&gt;<br></code></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯æä¾›çš„é‡å®šå‘åœ°å€é‡æ–°å‘é€è¯·æ±‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/hammers.html</span> <span class="hljs-meta">HTTP/1.0</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>161.58.228.45<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/4.51 [en] (X11; U; IRIX 6.2 IP22)<br></code></pre></td></tr></table></figure><h2 id="DNSé‡å®šå‘"><a href="#DNSé‡å®šå‘" class="headerlink" title="DNSé‡å®šå‘"></a>DNSé‡å®šå‘</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm">å®ç° ï¼šDNSæœåŠ¡å™¨å†³å®šURLçš„ä¸»æœºåä¸­è¿”å›<span class="hljs-built_in">IP</span>åœ°å€ä¸­çš„å“ªä¸€ä¸ª<br>å±€é™ ï¼šéœ€è¦é…ç½®DNSæœåŠ¡å™¨<br></code></pre></td></tr></table></figure><h2 id="IP-MACè½¬å‘"><a href="#IP-MACè½¬å‘" class="headerlink" title="IP MACè½¬å‘"></a>IP MACè½¬å‘</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm">å®ç° ï¼šé€šè¿‡ç»‘å®šç›®çš„<span class="hljs-built_in">IP</span>åˆ°å¯¹åº”çš„MACåœ°å€<br>å±€é™ ï¼šåŒä¸€å¹¿æ’­åŸŸå†…<br></code></pre></td></tr></table></figure><h2 id="IP-åœ°å€è½¬å‘"><a href="#IP-åœ°å€è½¬å‘" class="headerlink" title="IP åœ°å€è½¬å‘"></a>IP åœ°å€è½¬å‘</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm">å®ç° ï¼šé€šè¿‡è¯†åˆ«ç›®çš„ç«¯å£ï¼Œé‡å®šå‘<span class="hljs-built_in">IP</span>åœ°å€åˆ°ä»£ç†æˆ–é•œåƒæœåŠ¡å™¨<br>å±€é™ ï¼šæœåŠ¡å™¨æˆ–ä»£ç†çœ‹ä¸åˆ°çœŸæ­£çš„å®¢æˆ·ç«¯<span class="hljs-built_in">IP</span>åœ°å€<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>HTTP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTTP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTTPåè®® III æœåŠ¡ç±»å‹</title>
    <link href="/2025/05/12/HTTP%E5%8D%8F%E8%AE%AE-III-%E6%9C%8D%E5%8A%A1%E7%B1%BB%E5%9E%8B/"/>
    <url>/2025/05/12/HTTP%E5%8D%8F%E8%AE%AE-III-%E6%9C%8D%E5%8A%A1%E7%B1%BB%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<p>åŸºäºHTTPåè®®ï¼ŒæŠ€æœ¯ä¸Šè¿›è¡Œäº†å¤šç§æŠ€æœ¯å®ç°</p><h1 id="WebæœåŠ¡å™¨"><a href="#WebæœåŠ¡å™¨" class="headerlink" title="WebæœåŠ¡å™¨"></a>WebæœåŠ¡å™¨</h1><p>webæœåŠ¡å™¨æ˜¯åŸºäºHttpåè®®çš„æœ€åŸºç¡€å®ç°ï¼šç”¨æˆ·é€šè¿‡æµè§ˆå™¨ä»£ç† å‘é€HTTPè¯·æ±‚ï¼ŒæœåŠ¡ç«¯è§£æè¯·æ±‚æä¾›å¯¹åº”æœåŠ¡ã€‚</p><p>ä¸€ä¸ªåŸºç¡€çš„webæœåŠ¡å™¨å…·å¤‡ä»¥ä¸‹æµç¨‹ ï¼š</p><p>(1) å»ºç«‹è¿æ¥â€”â€”æ¥å—ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥ï¼Œæˆ–è€…å¦‚æœä¸å¸Œæœ›ä¸è¿™ä¸ªå®¢æˆ·ç«¯å»ºç«‹è¿æ¥ï¼Œå°±å°†å…¶å…³é—­ã€‚</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs perl">æœåŠ¡å™¨ä½¿ç”¨ <span class="hljs-keyword">socket</span> åˆ›å»ºç›‘å¬ç«¯å£ï¼ˆå¦‚ TCP <span class="hljs-number">80</span>/<span class="hljs-number">443</span>ï¼‰ï¼Œå¹¶é€šè¿‡ <span class="hljs-keyword">accept</span> æ¥æ”¶å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚ã€‚<br>å®¢æˆ·ç«¯å‘èµ· TCP ä¸‰æ¬¡æ¡æ‰‹ï¼Œè¿æ¥æˆåŠŸåï¼ŒæœåŠ¡å™¨è¿›å…¥è¯·æ±‚å¤„ç†é˜¶æ®µã€‚<br>è¿æ¥å»ºç«‹åï¼Œå¯ä»¥æ ¹æ®å®¢æˆ·ç«¯ IP æˆ–æŠ¥æ–‡å­—æ®µåˆ¤æ–­æ˜¯å¦æ‹’ç»ç»§ç»­æœåŠ¡ï¼ˆä¾‹å¦‚é»‘åå•ã€Header æ ¡éªŒï¼‰ã€‚<br></code></pre></td></tr></table></figure><p>(2)æ¥æ”¶è¯·æ±‚â€”â€”ä»ç½‘ç»œä¸­è¯»å–ä¸€æ¡HTTPè¯·æ±‚æŠ¥æ–‡ã€‚</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs taggerscript">ä» Socket ä¸­è¯»å– HTTP è¯·æ±‚æŠ¥æ–‡ï¼ŒHTTP æ˜¯åŸºäºæ–‡æœ¬åè®®ï¼Œä½¿ç”¨ CRLFï¼ˆ<span class="hljs-symbol">\\</span>r<span class="hljs-symbol">\\</span>nï¼‰æ ‡å¿—å­—æ®µå’Œè¯·æ±‚ç»“æŸã€‚<br>è¯·æ±‚æŠ¥æ–‡åŒ…æ‹¬è¯·æ±‚è¡Œã€å¤´éƒ¨å­—æ®µã€ç©ºè¡Œå’Œå¯é€‰çš„æ¶ˆæ¯ä½“ã€‚<br>Web æœåŠ¡å™¨éœ€æŒ‰ HTTP è¯­æ³•è§£æè¿™äº›å­—æ®µï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªç»“æ„åŒ–çš„è¯·æ±‚å¯¹è±¡ä¾›ä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚<br></code></pre></td></tr></table></figure><p>(3)å¤„ç†è¯·æ±‚â€”â€”å¯¹è¯·æ±‚æŠ¥æ–‡è¿›è¡Œè§£é‡Šï¼Œå¹¶é‡‡å–è¡ŒåŠ¨ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">ç°ä»£ Web æ¡†æ¶ä¼šåŸºäºè¯·æ±‚è·¯å¾„ã€æ–¹æ³•ã€å‚æ•°ç­‰ä¿¡æ¯è¿›è¡Œè·¯ç”±åŒ¹é…ï¼Œå°†è¯·æ±‚åˆ†å‘ç»™å¯¹åº”çš„æ§åˆ¶å™¨å‡½æ•°è¿›è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚<br></code></pre></td></tr></table></figure><p>(4)è®¿é—®èµ„æºâ€”â€”è®¿é—®æŠ¥æ–‡ä¸­æŒ‡å®šçš„èµ„æºã€‚</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm">èµ„æºè®¿é—®å¯ä»¥æ˜¯é™æ€èµ„æºï¼ˆå¦‚ HTMLã€CSSã€å›¾ç‰‡æ–‡ä»¶ï¼‰æˆ–åŠ¨æ€å¤„ç†ï¼ˆå¦‚æ•°æ®åº“æ“ä½œã€ä¸šåŠ¡é€»è¾‘æ‰§è¡Œï¼‰ã€‚<br>æ ¹æ®è¯·æ±‚æ–¹æ³•ï¼ˆ<span class="hljs-meta">GET</span>/POSTï¼‰å’Œ URI è·¯å¾„ï¼Œå†³å®šèµ„æºç±»å‹ä¸è®¿é—®æ–¹å¼ã€‚<br></code></pre></td></tr></table></figure><p>(5)æ„å»ºå“åº”â€”â€”åˆ›å»ºå¸¦æœ‰æ­£ç¡®é¦–éƒ¨çš„HTTPå“åº”æŠ¥æ–‡ã€‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">ä¿®æ”¹æˆ–è€…å…¶ä»–å“åº”åŠæ³•ç¡®å®šåï¼Œæ„é€ åºåˆ—åŒ–å¯¹è±¡ï¼ˆå¦‚<span class="hljs-type">Json</span>ï¼‰ï¼Œä»¥åŠå“åº”å¤´ä¿¡æ¯ã€‚å¯¹å®¢æˆ·ç«¯è¿›è¡Œå“åº”ã€‚<br></code></pre></td></tr></table></figure><p>(6)å‘é€å“åº”â€”â€”å°†å“åº”å›é€ç»™å®¢æˆ·ç«¯ã€‚</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">åº•å±‚ å°† çŠ¶æ€ç  å“åº”å¤´ æ¶ˆæ¯ä½“ ç¼–ç ä¸ºå­—èŠ‚æ•°ç»„ ä»¥<span class="hljs-keyword">CRLF</span>ä½œä¸ºç»“å°¾ï¼Œç”±Socketå‘é€ç»™å®¢æˆ·ç«¯<br></code></pre></td></tr></table></figure><p>(7)è®°å½•äº‹åŠ¡å¤„ç†è¿‡ç¨‹â€”â€”å°†ä¸å·²å®Œæˆäº‹åŠ¡æœ‰å…³çš„å†…å®¹è®°å½•åœ¨ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ã€‚</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm">æœåŠ¡å™¨ä¼šå°†æ¯æ¬¡è¯·æ±‚çš„å¤„ç†è¿‡ç¨‹è®°å½•åˆ°è®¿é—®æ—¥å¿—ä¸­ï¼ŒåŒ…æ‹¬å®¢æˆ·ç«¯ <span class="hljs-built_in">IP</span>ã€è¯·æ±‚è·¯å¾„ã€æ–¹æ³•ã€çŠ¶æ€ç ã€å“åº”æ—¶é—´ç­‰ã€‚<br>æ—¥å¿—æœ‰åŠ©äºé—®é¢˜è¿½è¸ªã€æ€§èƒ½åˆ†æä¸å®‰å…¨ç›‘æ§ã€‚<br></code></pre></td></tr></table></figure><h1 id="ä»£ç†"><a href="#ä»£ç†" class="headerlink" title="ä»£ç†"></a>ä»£ç†</h1><p>Webä»£ç†ï¼ˆproxyï¼‰æœåŠ¡å™¨æ˜¯ç½‘ç»œçš„ä¸­é—´å®ä½“ã€‚ä»£ç†ä½äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ï¼Œæ‰®æ¼”â€œä¸­é—´äººâ€çš„è§’è‰²ï¼Œåœ¨å„ç«¯ç‚¹ä¹‹é—´æ¥å›ä¼ é€HTTPæŠ¥æ–‡</p><p><strong>ä»£ç† ï¼š å®¢æˆ·ç«¯å‘ä»£ç†æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œä»£ç†æœåŠ¡å™¨è½¬å‘ç»™åç«¯çš„å¼•ç”¨æœåŠ¡å™¨</strong></p><p><strong>åå‘ä»£ç†ï¼šå®¢æˆ·ç«¯ä¸æ„ŸçŸ¥ä»£ç†å­˜åœ¨ï¼Œè¯·æ±‚å‘å‘ä»£ç†ï¼Œç”±å…¶ä»£è¡¨åç«¯æœåŠ¡å™¨å¤„ç†è¯·æ±‚ï¼ˆå¦‚ Nginxã€API ç½‘å…³ï¼‰</strong></p><h3 id="ä¸ºä»€ä¹ˆéœ€è¦ä»£ç†"><a href="#ä¸ºä»€ä¹ˆéœ€è¦ä»£ç†" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦ä»£ç†"></a>ä¸ºä»€ä¹ˆéœ€è¦ä»£ç†</h3><ul><li>æ¶ˆæ¯è¿‡æ»¤ï¼Œä»£ç†å¯ä»¥ä½œä¸ºä¸­é—´è¿‡ç¨‹ä¸ºæœ€ç»ˆå®¢æˆ·è¿›è¡Œå†…å®¹ç­›é€‰ã€‚é€šè¿‡æ£€æŸ¥è¯·æ±‚&#x2F;å“åº”å†…å®¹å¯¹ç”¨æˆ·çš„è®¿é—®è¿›è¡Œæ§åˆ¶</li><li>è®¿é—®ç­–ç•¥ï¼Œä»£ç†é€šè¿‡è§£æä¸­é—´æ¶ˆæ¯ï¼Œå¯ä»¥å¯¹ä¸åŒçš„ç”¨æˆ·å®æ–½ä¸åŒçš„è®¿é—®ç­–ç•¥</li><li>é˜²ç«å¢™ï¼Œé€šè¿‡æ£€æŸ¥ä¼ è¾“çš„Httpæ¶ˆæ¯ï¼Œæ¥ç›‘æ§ç½‘ç»œä¸­æ˜¯å¦å­˜åœ¨æ¶æ„ä¿¡æ¯</li><li>webç¼“å­˜ï¼Œä»£ç†ç¼“å­˜ç»´æŠ¤äº†å¸¸ç”¨æ–‡æ¡£çš„æœ¬åœ°å‰¯æœ¬ï¼Œå¹¶å°†å®ƒä»¬æŒ‰éœ€æä¾›ï¼Œä»¥å‡å°‘ç¼“æ…¢ä¸”æ˜‚è´µçš„å› ç‰¹ç½‘é€šä¿¡ã€‚</li><li>åå‘ä»£ç†ï¼Œä»£ç†å¯ä»¥å‡æ‰®WebæœåŠ¡å™¨ã€‚è¿™äº›è¢«ç§°ä¸ºæ›¿ä»£ç‰©ï¼ˆsurrogateï¼‰æˆ–åå‘ä»£ç†ï¼ˆre-verse proxyï¼‰çš„ä»£ç†æ¥æ”¶å‘ç»™WebæœåŠ¡å™¨çš„çœŸå®è¯·æ±‚ï¼Œä½†ä¸WebæœåŠ¡å™¨ä¸åŒçš„æ˜¯ï¼Œå®ƒä»¬å¯ä»¥å‘èµ·ä¸å…¶ä»–æœåŠ¡å™¨çš„é€šä¿¡ï¼Œä»¥ä¾¿æŒ‰éœ€å®šä½æ‰€è¯·æ±‚çš„å†…å®¹ã€‚</li></ul><h1 id="ç¼“å­˜"><a href="#ç¼“å­˜" class="headerlink" title="ç¼“å­˜"></a>ç¼“å­˜</h1><p>ç¼“å­˜æœåŠ¡å™¨ï¼Œç”¨äºåˆ†æ‘Šå¯¹webæœåŠ¡å™¨çš„è®¿é—®å‹åŠ›ï¼Œå…¶æ ¸å¿ƒé€»è¾‘æ˜¯æ”¶åˆ°è¯·æ±‚å</p><p>(1) æ¥æ”¶â€”â€”ç¼“å­˜ä»ç½‘ç»œä¸­è¯»å–æŠµè¾¾çš„è¯·æ±‚æŠ¥æ–‡ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">ç¼“å­˜æ£€æµ‹åˆ°ä¸€æ¡ç½‘ç»œè¿æ¥ä¸Šçš„æ´»åŠ¨ï¼Œè¯»å–è¾“å…¥æ•°æ®ã€‚é«˜æ€§èƒ½çš„ç¼“å­˜ä¼šåŒæ—¶ä»å¤šæ¡è¾“å…¥è¿æ¥ä¸Šè¯»å–æ•°æ®ï¼Œåœ¨æ•´æ¡æŠ¥æ–‡æŠµè¾¾ä¹‹å‰å¼€å§‹å¯¹äº‹åŠ¡è¿›è¡Œå¤„ç†<br></code></pre></td></tr></table></figure><p>(2) è§£æâ€”â€”ç¼“å­˜å¯¹æŠ¥æ–‡è¿›è¡Œè§£æï¼Œæå–å‡ºURLå’Œå„ç§é¦–éƒ¨ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">ç¼“å­˜å°†è¯·æ±‚æŠ¥æ–‡è§£æä¸ºç‰‡æ–­ï¼Œå°†é¦–éƒ¨çš„å„ä¸ªéƒ¨åˆ†æ”¾å…¥æ˜“äºæ“ä½œçš„æ•°æ®ç»“æ„ä¸­ã€‚<br></code></pre></td></tr></table></figure><p>(3) æŸ¥è¯¢â€”â€”ç¼“å­˜æŸ¥çœ‹æ˜¯å¦æœ‰æœ¬åœ°å‰¯æœ¬å¯ç”¨ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±è·å–ä¸€ä»½å‰¯æœ¬ï¼ˆå¹¶å°†å…¶ä¿å­˜åœ¨æœ¬åœ°ï¼‰ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs">æœ¬åœ°å‰¯æœ¬å¯èƒ½å­˜å‚¨åœ¨å†…å­˜ã€æœ¬åœ°ç£ç›˜ï¼Œç”šè‡³é™„è¿‘çš„å¦ä¸€å°è®¡ç®—æœºä¸­ã€‚<br>ä¸“ä¸šçº§çš„ç¼“å­˜ä¼šä½¿ç”¨å¿«é€Ÿç®—æ³•æ¥ç¡®å®šæœ¬åœ°ç¼“å­˜ä¸­æ˜¯å¦æœ‰æŸä¸ªå¯¹è±¡ã€‚<br>å¦‚æœæœ¬åœ°æ²¡æœ‰è¿™ä¸ªæ–‡æ¡£ï¼Œå®ƒå¯ä»¥æ ¹æ®æƒ…å½¢å’Œé…ç½®ï¼Œåˆ°åŸå§‹æœåŠ¡å™¨æˆ–çˆ¶ä»£ç†ä¸­å»å–ï¼Œæˆ–è€…è¿”å›ä¸€æ¡é”™è¯¯ä¿¡æ¯ã€‚<br></code></pre></td></tr></table></figure><p>(4) æ–°é²œåº¦æ£€æµ‹â€”â€”ç¼“å­˜æŸ¥çœ‹å·²ç¼“å­˜å‰¯æœ¬æ˜¯å¦è¶³å¤Ÿæ–°é²œï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±è¯¢é—®æœåŠ¡å™¨æ˜¯å¦æœ‰ä»»ä½•æ›´æ–°ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">HTTPé€šè¿‡ç¼“å­˜å°†æœåŠ¡å™¨æ–‡æ¡£çš„å‰¯æœ¬ä¿ç•™ä¸€æ®µæ—¶é—´ã€‚<br>åœ¨è¿™æ®µæ—¶é—´é‡Œï¼Œéƒ½è®¤ä¸ºæ–‡æ¡£æ˜¯â€œæ–°é²œçš„â€ï¼Œç¼“å­˜å¯ä»¥åœ¨ä¸è”ç³»æœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œç›´æ¥æä¾›è¯¥æ–‡æ¡£ã€‚<br>ä½†ä¸€æ—¦å·²ç¼“å­˜å‰¯æœ¬åœç•™çš„æ—¶é—´å¤ªé•¿ï¼Œè¶…è¿‡äº†æ–‡æ¡£çš„æ–°é²œåº¦é™å€¼ï¼ˆfreshness <span class="hljs-built_in">limit</span>ï¼‰ï¼Œ<br>å°±è®¤ä¸ºå¯¹è±¡â€œè¿‡æ—¶â€äº†ï¼Œåœ¨æä¾›è¯¥æ–‡æ¡£ä¹‹å‰ï¼Œç¼“å­˜è¦å†æ¬¡ä¸æœåŠ¡å™¨è¿›è¡Œç¡®è®¤ï¼Œ<br>ä»¥æŸ¥çœ‹æ–‡æ¡£æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ã€‚å®¢æˆ·ç«¯å‘é€ç»™ç¼“å­˜çš„æ‰€æœ‰è¯·æ±‚é¦–éƒ¨è‡ªèº«éƒ½å¯ä»¥å¼ºåˆ¶ç¼“å­˜è¿›è¡Œå†éªŒè¯ï¼Œ<br>æˆ–è€…å®Œå…¨é¿å…éªŒè¯ï¼Œè¿™ä½¿å¾—äº‹æƒ…å˜å¾—æ›´åŠ å¤æ‚äº†ã€‚<br></code></pre></td></tr></table></figure><p>(5) åˆ›å»ºå“åº”â€”â€”ç¼“å­˜ä¼šç”¨æ–°çš„é¦–éƒ¨å’Œå·²ç¼“å­˜çš„ä¸»ä½“æ¥æ„å»ºä¸€æ¡å“åº”æŠ¥æ–‡ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs">æˆ‘ä»¬å¸Œæœ›ç¼“å­˜çš„å“åº”çœ‹èµ·æ¥å°±åƒæ¥è‡ªåŸå§‹æœåŠ¡å™¨çš„ä¸€æ ·ï¼Œç¼“å­˜å°†å·²ç¼“å­˜çš„æœåŠ¡å™¨å“åº”é¦–éƒ¨ä½œä¸ºå“åº”é¦–éƒ¨çš„èµ·ç‚¹ã€‚<br>ç„¶åç¼“å­˜å¯¹è¿™äº›åŸºç¡€é¦–éƒ¨è¿›è¡Œäº†ä¿®æ”¹å’Œæ‰©å……ã€‚<br>ç¼“å­˜è´Ÿè´£å¯¹è¿™äº›é¦–éƒ¨è¿›è¡Œæ”¹é€ ï¼Œä»¥ä¾¿ä¸å®¢æˆ·ç«¯çš„è¦æ±‚ç›¸åŒ¹é…ã€‚<br></code></pre></td></tr></table></figure><p>(6) å‘é€â€”â€”ç¼“å­˜é€šè¿‡ç½‘ç»œå°†å“åº”å‘å›ç»™å®¢æˆ·ç«¯ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs">ä¸€æ—¦å“åº”é¦–éƒ¨å‡†å¤‡å¥½äº†ï¼Œç¼“å­˜å°±å°†å“åº”å›é€ç»™å®¢æˆ·ç«¯ã€‚<br>å’Œæ‰€æœ‰ä»£ç†æœåŠ¡å™¨ä¸€æ ·ï¼Œä»£ç†ç¼“å­˜è¦ç®¡ç†ä¸å®¢æˆ·ç«¯ä¹‹é—´çš„è¿æ¥ã€‚<br></code></pre></td></tr></table></figure><p>(7) æ—¥å¿—â€”â€”ç¼“å­˜å¯é€‰åœ°åˆ›å»ºä¸€ä¸ªæ—¥å¿—æ–‡ä»¶æ¡ç›®æ¥æè¿°è¿™ä¸ªäº‹åŠ¡ã€‚</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">å¤§å¤šæ•°ç¼“å­˜éƒ½ä¼šä¿å­˜æ—¥å¿—æ–‡ä»¶ä»¥åŠä¸ç¼“å­˜çš„ä½¿ç”¨æœ‰å…³çš„ä¸€äº›ç»Ÿè®¡æ•°æ®ã€‚<br>æ¯ä¸ªç¼“å­˜äº‹åŠ¡ç»“æŸä¹‹åï¼Œç¼“å­˜éƒ½ä¼šæ›´æ–°ç¼“å­˜å‘½ä¸­å’Œæœªå‘½ä¸­æ•°ç›®çš„ç»Ÿè®¡æ•°æ®ï¼ˆä»¥åŠå…¶ä»–ç›¸å…³çš„åº¦é‡å€¼ï¼‰ï¼Œ<br>å¹¶å°†æ¡ç›®æ’å…¥ä¸€ä¸ªç”¨æ¥æ˜¾ç¤ºè¯·æ±‚ç±»å‹ã€<span class="hljs-built_in">URL</span>å’Œæ‰€å‘ç”Ÿäº‹ä»¶çš„æ—¥å¿—æ–‡ä»¶ã€‚<br></code></pre></td></tr></table></figure><h1 id="ç½‘å…³"><a href="#ç½‘å…³" class="headerlink" title="ç½‘å…³"></a>ç½‘å…³</h1><p>ç½‘å…³å¯ä»¥ä½œä¸ºæŸç§ç¿»è¯‘å™¨ä½¿ç”¨ï¼Œå®ƒæŠ½è±¡å‡ºäº†ä¸€ç§èƒ½å¤Ÿåˆ°è¾¾èµ„æºçš„æ–¹æ³•ã€‚ç½‘å…³æ˜¯èµ„æºå’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„ç²˜åˆå‰‚ã€‚åº”ç”¨ç¨‹åºå¯ä»¥ï¼ˆé€šè¿‡HTTPæˆ–å…¶ä»–å·²å®šä¹‰çš„æ¥å£ï¼‰è¯·æ±‚ç½‘å…³æ¥å¤„ç†æŸæ¡è¯·æ±‚ï¼Œç½‘å…³å¯ä»¥æä¾›ä¸€æ¡å“åº”ã€‚</p><p>åº”ç”¨ç¨‹åºç½‘å…³APIå°±æ˜¯é€šç”¨ç½‘å…³æ¥å£ï¼ˆCommon Gateway Interface,CGIï¼‰ã€‚CGIæ˜¯ä¸€ä¸ªæ ‡å‡†æ¥å£é›†ï¼ŒWebæœåŠ¡å™¨å¯ä»¥ç”¨å®ƒæ¥è£…è½½ç¨‹åºä»¥å“åº”å¯¹ç‰¹å®šURLçš„HTTPè¯·æ±‚ï¼Œå¹¶æ”¶é›†ç¨‹åºçš„è¾“å‡ºæ•°æ®ï¼Œå°†å…¶æ”¾åœ¨HTTPå“åº”ä¸­å›é€ã€‚åœ¨è¿‡å»çš„å‡ å¹´ä¸­ï¼Œå•†ä¸šWebæœåŠ¡å™¨æä¾›äº†ä¸€äº›æ›´å¤æ‚çš„æ¥å£ï¼Œä»¥ä¾¿å°†WebæœåŠ¡å™¨è¿æ¥åˆ°åº”ç”¨ç¨‹åºä¸Šå»ã€‚</p><h1 id="éš§é“"><a href="#éš§é“" class="headerlink" title="éš§é“"></a>éš§é“</h1><p>Webéš§é“å…è®¸ç”¨æˆ·é€šè¿‡HTTPè¿æ¥å‘é€éHTTPæµé‡ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨HTTPä¸Šæå¸¦å…¶ä»–åè®®æ•°æ®äº†ã€‚ä½¿ç”¨Webéš§é“æœ€å¸¸è§çš„åŸå› å°±æ˜¯è¦åœ¨HTTPè¿æ¥ä¸­åµŒå…¥éHTTPæµé‡ï¼Œè¿™æ ·ï¼Œè¿™ç±»æµé‡å°±å¯ä»¥ç©¿è¿‡åªå…è®¸Webæµé‡é€šè¿‡çš„é˜²ç«å¢™äº†ã€‚</p><p>éš§é“è¿æ¥è¯·æ±‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">CONNECT</span> <span class="hljs-string">home.netscape.com:443</span> <span class="hljs-meta">HTTP/1.0</span><br><span class="hljs-attribute">User-agent</span><span class="hljs-punctuation">: </span>Mozilla/4.0<br></code></pre></td></tr></table></figure><p>éš§é“è¿æ¥å“åº”</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">HTTP</span>/<span class="hljs-number">1</span>.<span class="hljs-number">0200</span> Connection Established<br><span class="hljs-attribute">Proxy</span>-agent: Netscape-Proxy/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>éš§é“åœ¨å‘å‡ºè¿æ¥è¯·æ±‚åï¼Œä¸å¿…ç­‰å¾…å“åº”ï¼Œå°±ä¼šä»¥éš§é“å½¢å¼å‘é€æ•°æ®åˆ°å¯¹ç«¯ã€‚å¦‚æœæ”¶åˆ°è®¤è¯å“åº”æˆ–å…¶ä»–éæˆåŠŸå“åº”ï¼Œè¯·æ±‚ç«¯éœ€è¦åšå¥½é‡æ–°å‡†å¤‡æ•°æ®çš„å‡†å¤‡ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>HTTP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTTP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTTPåè®® II è¿æ¥</title>
    <link href="/2025/05/11/HTTP%E5%8D%8F%E8%AE%AE-II-%E8%BF%9E%E6%8E%A5/"/>
    <url>/2025/05/11/HTTP%E5%8D%8F%E8%AE%AE-II-%E8%BF%9E%E6%8E%A5/</url>
    
    <content type="html"><![CDATA[<h1 id="åŸºäºTCPåè®®çš„â€œå¯é â€è¿æ¥"><a href="#åŸºäºTCPåè®®çš„â€œå¯é â€è¿æ¥" class="headerlink" title="åŸºäºTCPåè®®çš„â€œå¯é â€è¿æ¥"></a>åŸºäºTCPåè®®çš„â€œå¯é â€è¿æ¥</h1><p>HTTP æ˜¯åŸºäºä¼ è¾“å±‚çš„TCPåè®®è€Œæ„å»ºã€‚</p><p>TCPçš„å¾…å‘é€æ•°æ®ä¼šè¢«æ”¾å…¥SOCKETçš„ç¼“å†²åŒºï¼Œå¹¶ä¸”é€šè¿‡ä¸€äº›æ ‡è®°ä½å’ŒæŒ‡é’ˆå­—æ®µæ¥æ§åˆ¶æ‰€æœ‰ç¼“å†²åŒºä¸­çš„æ•°æ®æœ‰åºå¯é çš„è¢«å‘é€åˆ°å¯¹ç«¯ã€‚</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs coq">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ IP æŠ¥æ–‡å¤´ï¼ˆIPv4ï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚ ç‰ˆæœ¬ (<span class="hljs-number">4</span>b) | <span class="hljs-type">é¦–éƒ¨é•¿åº¦ (4b</span>) | <span class="hljs-type">åŒºåˆ†æœåŠ¡(8b</span>) | <span class="hljs-type">æ€»é•¿åº¦(16b</span>)                   <br>â”‚ æ ‡è¯† (<span class="hljs-number">16</span>b)                | <span class="hljs-type">æ ‡å¿—(3b</span>) | <span class="hljs-type">ç‰‡åç§»(13b</span>)                       <br>â”‚ ç”Ÿå­˜æ—¶é—´ TTL(<span class="hljs-number">8</span>b)         | <span class="hljs-type">åè®® (8b</span>: <span class="hljs-number">0x06</span> è¡¨ç¤º TCP)                      <br>â”‚ é¦–éƒ¨æ ¡éªŒå’Œ (<span class="hljs-number">16</span>b)                                                         <br>â”‚ æº IP åœ°å€ (<span class="hljs-number">32</span>b)                                                         <br>â”‚ ç›®çš„ IP åœ°å€ (<span class="hljs-number">32</span>b)                                                       <br>â”‚ ï¼ˆ+ å¯é€‰é¡¹ï¼‰                                                             <br>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br>                                â†“<br>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ TCP æ®µå¤´ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚ æºç«¯å£ (<span class="hljs-number">16</span>b)                | <span class="hljs-type">ç›®æ ‡ç«¯å£ (16b</span>)                    <br>â”‚ åºåˆ—å· (<span class="hljs-number">32</span>b)                                                  <br>â”‚ ç¡®è®¤å· (<span class="hljs-number">32</span>b)                                                  <br>â”‚ æ•°æ®åç§»(<span class="hljs-number">4</span>b) | <span class="hljs-type">ä¿ç•™(3b</span>) | <span class="hljs-type">æ ‡å¿—ä½(9b</span>: SYN, ACK, etc.)          <br>â”‚ çª—å£å¤§å° (<span class="hljs-number">16</span>b)                                               <br>â”‚ æ ¡éªŒå’Œ (<span class="hljs-number">16</span>b)                                                 <br>â”‚ ç´§æ€¥æŒ‡é’ˆ (<span class="hljs-number">16</span>b)                                               <br>â”‚ ï¼ˆ+ å¯é€‰é¡¹ï¼Œå¦‚MSSã€çª—å£ç¼©æ”¾ã€SACKç­‰ï¼‰                        <br>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br>                                â†“<br>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ HTTP è¯·æ±‚æŠ¥æ–‡ï¼ˆä»¥ GET ä¸ºä¾‹ï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚ èµ·å§‹è¡Œï¼ˆRequest Lineï¼‰                                              <br>â”‚   GET /index.html HTTP/<span class="hljs-number">1.1</span>   â† æ–¹æ³•(å˜é‡é•¿) è·¯å¾„(å˜é‡é•¿) åè®®ç‰ˆæœ¬   <br>â”‚                                                                  <br>â”‚ é¦–éƒ¨å­—æ®µï¼ˆHeadersï¼‰                                              <br>â”‚   Host: www.example.com             â† Key:Valueï¼Œæ¯è¡Œä¸ºä¸€å­—æ®µ       <br>â”‚   User-Agent: curl/<span class="hljs-number">7.64</span><span class="hljs-number">.1</span>                                         <br>â”‚   Accept: */*                                                     <br>â”‚   ...                                                             <br>â”‚                                                                  <br>â”‚ ç©ºè¡Œï¼ˆ\\r\\nï¼‰è¡¨ç¤ºé¦–éƒ¨ç»“æŸ                                          <br>â”‚                                                                  <br>â”‚ å®ä½“ä¸»ä½“ï¼ˆBodyï¼Œå¯é€‰ï¼‰                                           <br>â”‚   ï¼ˆå¦‚POSTä¸­çš„è¡¨å•æ•°æ®ï¼Œå¦‚ x-www-form-urlencoded æ ¼å¼ï¼‰          <br>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br><br></code></pre></td></tr></table></figure><h2 id="Socket"><a href="#Socket" class="headerlink" title="Socket"></a>Socket</h2><p>socketæ˜¯åè®®æ ˆåœ¨æ“ä½œç³»ç»Ÿä¸Šçš„å…·ä½“å®ç°ã€‚è®¾è®¡ä¸ºä¸€ç§é€šç”¨ç½‘ç»œæ¥å£ï¼Œé€šè¿‡å®šä¹‰å…·ä½“çš„åè®®å’Œå“åº”çš„åœ°å€ï¼Œç«¯å£ä¿¡æ¯æ¥å®ç°æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯çš„è¿æ¥ã€‚</p><h2 id="ä¼ è¾“æ€§èƒ½"><a href="#ä¼ è¾“æ€§èƒ½" class="headerlink" title="ä¼ è¾“æ€§èƒ½"></a>ä¼ è¾“æ€§èƒ½</h2><h3 id="DNS-åˆ°-IP-çš„åœ°å€è½¬æ¢"><a href="#DNS-åˆ°-IP-çš„åœ°å€è½¬æ¢" class="headerlink" title="DNS åˆ° IP çš„åœ°å€è½¬æ¢"></a>DNS åˆ° IP çš„åœ°å€è½¬æ¢</h3><p>DNSè§£ææ—¶é—´</p><h3 id="TCP-è¿æ¥æ—¶å»¶"><a href="#TCP-è¿æ¥æ—¶å»¶" class="headerlink" title="TCP è¿æ¥æ—¶å»¶"></a>TCP è¿æ¥æ—¶å»¶</h3><h3 id="è¯·æ±‚æŠ¥æ–‡å¤„ç†"><a href="#è¯·æ±‚æŠ¥æ–‡å¤„ç†" class="headerlink" title="è¯·æ±‚æŠ¥æ–‡å¤„ç†"></a>è¯·æ±‚æŠ¥æ–‡å¤„ç†</h3><h3 id="æ„é€ å“åº”æŠ¥æ–‡"><a href="#æ„é€ å“åº”æŠ¥æ–‡" class="headerlink" title="æ„é€ å“åº”æŠ¥æ–‡"></a>æ„é€ å“åº”æŠ¥æ–‡</h3><h3 id="ç½‘ç»œæ‰°åŠ¨"><a href="#ç½‘ç»œæ‰°åŠ¨" class="headerlink" title="ç½‘ç»œæ‰°åŠ¨"></a>ç½‘ç»œæ‰°åŠ¨</h3>]]></content>
    
    
    <categories>
      
      <category>HTTP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTTP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTTPåè®® I å®šä¹‰</title>
    <link href="/2025/05/11/HTTP%E5%8D%8F%E8%AE%AE-I-%E5%AE%9A%E4%B9%89/"/>
    <url>/2025/05/11/HTTP%E5%8D%8F%E8%AE%AE-I-%E5%AE%9A%E4%B9%89/</url>
    
    <content type="html"><![CDATA[<h1 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h1><p>HTTPï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰æ˜¯ Web åº”ç”¨æœ€åŸºç¡€çš„åº”ç”¨å±‚é€šä¿¡åè®®ï¼Œç”¨äºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“æ–‡æœ¬ã€å›¾åƒã€è§†é¢‘ç­‰ä¿¡æ¯ã€‚</p><h2 id="HTTPåè®®å†…å®¹ä¸å­—æ®µå®šä¹‰"><a href="#HTTPåè®®å†…å®¹ä¸å­—æ®µå®šä¹‰" class="headerlink" title="HTTPåè®®å†…å®¹ä¸å­—æ®µå®šä¹‰"></a>HTTPåè®®å†…å®¹ä¸å­—æ®µå®šä¹‰</h2><ul><li>èµ„æº ï¼š WebæœåŠ¡å™¨æ˜¯Webèµ„æºï¼ˆWeb resourceï¼‰çš„å®¿ä¸»ã€‚Webèµ„æºæ˜¯Webå†…å®¹çš„æºå¤´ã€‚æœ€ç®€å•çš„Webèµ„æºå°±æ˜¯WebæœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„é™æ€æ–‡ä»¶ã€‚</li><li>åª’ä½“ç±»å‹ ï¼šå½“Webæµè§ˆå™¨ä»æœåŠ¡å™¨ä¸­å–å›ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œä¼šå»æŸ¥çœ‹ç›¸å…³çš„MIMEç±»å‹ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦çŸ¥é“åº”è¯¥å¦‚ä½•å¤„ç†è¿™ä¸ªå¯¹è±¡</li><li>URI ï¼š æœåŠ¡å™¨èµ„æºåè¢«ç§°ä¸ºç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆUniform Resource Identifier, URIï¼‰ã€‚URIå°±åƒå› ç‰¹ç½‘ä¸Šçš„é‚®æ”¿åœ°å€ä¸€æ ·ï¼Œåœ¨ä¸–ç•ŒèŒƒå›´å†…å”¯ä¸€æ ‡è¯†å¹¶å®šä½ä¿¡æ¯èµ„æºã€‚</li><li>URL :  URLæè¿°äº†ä¸€å°ç‰¹å®šæœåŠ¡å™¨ä¸ŠæŸèµ„æºçš„ç‰¹å®šä½ç½®ï¼Œä¸€èˆ¬åŒ…å«ä¸‰éƒ¨åˆ† ï¼š 1.åè®®ç±»å‹ 2.ç½‘ç»œåœ°å€ 3.èµ„æºåœ°å€</li><li>äº‹åŠ¡ ï¼š ä¸€ä¸ªHTTPäº‹åŠ¡ç”±ä¸€æ¡ï¼ˆä»å®¢æˆ·ç«¯å‘å¾€æœåŠ¡å™¨çš„ï¼‰è¯·æ±‚å‘½ä»¤å’Œä¸€ä¸ªï¼ˆä»æœåŠ¡å™¨å‘å›å®¢æˆ·ç«¯çš„ï¼‰å“åº”ç»“æœç»„æˆ</li><li>æ–¹æ³• ï¼šHTTPæ”¯æŒå‡ ç§ä¸åŒçš„è¯·æ±‚å‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤è¢«ç§°ä¸ºHTTPæ–¹æ³•ï¼ˆHTTP methodï¼‰ã€‚</li><li>çŠ¶æ€ç  ï¼šæ¯æ¡HTTPå“åº”æŠ¥æ–‡è¿”å›æ—¶éƒ½ä¼šæºå¸¦ä¸€ä¸ªçŠ¶æ€ç ã€‚çŠ¶æ€ç æ˜¯ä¸€ä¸ªä¸‰ä½æ•°å­—çš„ä»£ç ï¼Œå‘ŠçŸ¥å®¢æˆ·ç«¯è¯·æ±‚æ˜¯å¦æˆåŠŸï¼Œæˆ–è€…æ˜¯å¦éœ€è¦é‡‡å–å…¶ä»–åŠ¨ä½œã€‚</li></ul><h3 id="æŠ¥æ–‡ç»“æ„"><a href="#æŠ¥æ–‡ç»“æ„" class="headerlink" title="æŠ¥æ–‡ç»“æ„"></a>æŠ¥æ–‡ç»“æ„</h3><ul><li>èµ·å§‹è¡Œ ï¼š èµ·å§‹è¡ŒæŠ¥æ–‡çš„ç¬¬ä¸€è¡Œå°±æ˜¯èµ·å§‹è¡Œï¼Œåœ¨è¯·æ±‚æŠ¥æ–‡ä¸­ç”¨æ¥è¯´æ˜è¦åšäº›ä»€ä¹ˆï¼Œåœ¨å“åº”æŠ¥æ–‡ä¸­è¯´æ˜å‡ºç°äº†ä»€ä¹ˆæƒ…å†µã€‚</li><li>é¦–éƒ¨å­—æ®µ ï¼šèµ·å§‹è¡Œåé¢æœ‰é›¶ä¸ªæˆ–å¤šä¸ªé¦–éƒ¨å­—æ®µã€‚æ¯ä¸ªé¦–éƒ¨å­—æ®µéƒ½åŒ…å«ä¸€ä¸ªåå­—å’Œä¸€ä¸ªå€¼ï¼Œä¸ºäº†ä¾¿äºè§£æï¼Œä¸¤è€…ä¹‹é—´ç”¨å†’å·ï¼ˆ:ï¼‰æ¥åˆ†éš”ã€‚é¦–éƒ¨ä»¥ä¸€ä¸ªç©ºè¡Œç»“æŸã€‚æ·»åŠ ä¸€ä¸ªé¦–éƒ¨å­—æ®µå’Œæ·»åŠ æ–°è¡Œä¸€æ ·ç®€å•ã€‚</li><li>ä¸»é¢˜ ï¼š ç©ºè¡Œä¹‹åå°±æ˜¯å¯é€‰çš„æŠ¥æ–‡ä¸»ä½“äº†ï¼Œå…¶ä¸­åŒ…å«äº†æ‰€æœ‰ç±»å‹çš„æ•°æ®ã€‚è¯·æ±‚ä¸»ä½“ä¸­åŒ…æ‹¬äº†è¦å‘é€ç»™WebæœåŠ¡å™¨çš„æ•°æ®ï¼›å“åº”ä¸»ä½“ä¸­è£…è½½äº†è¦è¿”å›ç»™å®¢æˆ·ç«¯çš„æ•°æ®ã€‚èµ·å§‹è¡Œå’Œé¦–éƒ¨éƒ½æ˜¯æ–‡æœ¬å½¢å¼ä¸”éƒ½æ˜¯ç»“æ„åŒ–çš„ï¼Œè€Œä¸»ä½“åˆ™ä¸åŒï¼Œä¸»ä½“ä¸­å¯ä»¥åŒ…å«ä»»æ„çš„äºŒè¿›åˆ¶æ•°æ®ï¼ˆæ¯”å¦‚å›¾ç‰‡ã€è§†é¢‘ã€éŸ³è½¨ã€è½¯ä»¶ç¨‹åºï¼‰ã€‚å½“ç„¶ï¼Œä¸»ä½“ä¸­ä¹Ÿå¯ä»¥åŒ…å«æ–‡æœ¬ã€‚</li></ul><h3 id="è¿æ¥"><a href="#è¿æ¥" class="headerlink" title="è¿æ¥"></a>è¿æ¥</h3><p>HTTPæ˜¯å®šä¹‰åœ¨TCP&#x2F;IP åè®®æ ˆä¹‹ä¸Šçš„ã€‚</p><p>åœ¨TCPå±‚ ï¼ŒTCPåè®®æä¾›äº†</p><ul><li>æ— å·®é”™çš„æ•°æ®ä¼ è¾“</li><li>æŒ‰åºä¼ è¾“ï¼ˆæ•°æ®æ€»æ˜¯ä¼šæŒ‰ç…§å‘é€çš„é¡ºåºåˆ°è¾¾ï¼‰</li><li>æœªåˆ†æ®µçš„æ•°æ®æµï¼ˆå¯ä»¥åœ¨ä»»æ„æ—¶åˆ»ä»¥ä»»æ„å°ºå¯¸å°†æ•°æ®å‘é€å‡ºå»ï¼‰</li></ul><p>å†ä»ç½‘ç»œåè®®æ ˆå±‚é¢è€ƒè™‘</p><p>IP ï¼ˆç½‘ç»œå±‚ï¼‰ ï¼š æä¾›äº†æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„è·¯ç”±å¯»å€ï¼ˆå¦‚ä½•å¯¹æœåŠ¡å™¨è¿›è¡Œè®¿é—®ï¼‰</p><p>TCP ï¼ˆä¼ è¾“å±‚ï¼‰ ï¼š æä¾›äº†æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¹‹é—´çš„å¯é é€šä¿¡</p><p>HTTP ï¼ˆåº”ç”¨å±‚ï¼‰ ï¼š æä¾›äº†å†…å®¹ä¼ é€’çš„è·¯å¾„å’Œæ–¹æ³•</p><h3 id="HTTP-å¯»å€è®¿é—®ä¼ è¾“çš„è¿‡ç¨‹"><a href="#HTTP-å¯»å€è®¿é—®ä¼ è¾“çš„è¿‡ç¨‹" class="headerlink" title="HTTP å¯»å€è®¿é—®ä¼ è¾“çš„è¿‡ç¨‹"></a>HTTP å¯»å€è®¿é—®ä¼ è¾“çš„è¿‡ç¨‹</h3><ol><li>å®¢æˆ·ç«¯è¾“å…¥å¾…è®¿é—®çš„URLåœ°å€</li><li>æµè§ˆå™¨å‘å‡ºDNSè¯·æ±‚ï¼Œè§£é‡ŠURLåœ°å€ä¸ºIPåœ°å€</li><li>å¾—åˆ°IPåœ°å€åä¸æœåŠ¡å™¨å»ºç«‹TCPè¿æ¥</li><li>å®¢æˆ·ç«¯æµè§ˆå™¨å‘é€HTTPè¯·æ±‚æŠ¥æ–‡</li><li>æœåŠ¡ç«¯å“åº”HTTPå“åº”æŠ¥æ–‡</li><li>å…³é—­é“¾æ¥ï¼Œæµè§ˆå™¨æ¸²æŸ“HTTPå“åº”æŠ¥æ–‡</li></ol><h3 id="åè®®ç‰ˆæœ¬"><a href="#åè®®ç‰ˆæœ¬" class="headerlink" title="åè®®ç‰ˆæœ¬"></a>åè®®ç‰ˆæœ¬</h3><p>0.9  åè®®åªæ”¯æŒgetæ–¹æ³•</p><p>1.0  æ·»åŠ äº†é¢å¤–çš„è¯·æ±‚æ–¹æ³•</p><p>1.1</p><h3 id="ç»“æ„ç»„ä»¶"><a href="#ç»“æ„ç»„ä»¶" class="headerlink" title="ç»“æ„ç»„ä»¶"></a>ç»“æ„ç»„ä»¶</h3><ul><li>ä»£ç†</li></ul><p>ä»£ç†ä½äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ï¼Œæ¥æ”¶æ‰€æœ‰å®¢æˆ·ç«¯çš„HTTPè¯·æ±‚ï¼Œå¹¶å°†è¿™äº›è¯·æ±‚è½¬å‘ç»™æœåŠ¡å™¨ï¼ˆå¯èƒ½ä¼šå¯¹è¯·æ±‚è¿›è¡Œä¿®æ”¹ä¹‹åè½¬å‘ï¼‰ã€‚</p><ul><li>ç¼“å­˜</li></ul><p>Webç¼“å­˜ï¼ˆWeb cacheï¼‰æˆ–ä»£ç†ç¼“å­˜ï¼ˆproxy cacheï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„HTTPä»£ç†æœåŠ¡å™¨ï¼Œå¯ä»¥å°†ç»è¿‡ä»£ç†ä¼ é€çš„å¸¸ç”¨æ–‡æ¡£å¤åˆ¶ä¿å­˜èµ·æ¥</p><ul><li>ç½‘å…³</li></ul><p>ç½‘å…³ï¼ˆgatewayï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„æœåŠ¡å™¨ï¼Œä½œä¸ºå…¶ä»–æœåŠ¡å™¨çš„ä¸­é—´å®ä½“ä½¿ç”¨ã€‚é€šå¸¸ç”¨äºå°†HTTPæµé‡è½¬æ¢æˆå…¶ä»–çš„åè®®</p><ul><li>éš§é“</li></ul><p>éš§é“ï¼ˆtunnelï¼‰æ˜¯å»ºç«‹èµ·æ¥ä¹‹åï¼Œå°±ä¼šåœ¨ä¸¤æ¡è¿æ¥ä¹‹é—´å¯¹åŸå§‹æ•°æ®è¿›è¡Œç›²è½¬å‘çš„HTTPåº”ç”¨ç¨‹åºã€‚HTTPéš§é“é€šå¸¸ç”¨æ¥åœ¨ä¸€æ¡æˆ–å¤šæ¡HTTPè¿æ¥ä¸Šè½¬å‘éHTTPæ•°æ®ï¼Œè½¬å‘æ—¶ä¸ä¼šçª¥æ¢æ•°æ®ã€‚</p><ul><li>Agentä»£ç†</li></ul><p>ç”¨æˆ·Agentä»£ç†ï¼ˆæˆ–è€…ç®€ç§°ä¸ºAgentä»£ç†ï¼‰æ˜¯ä»£è¡¨ç”¨æˆ·å‘èµ·HTTPè¯·æ±‚çš„å®¢æˆ·ç«¯ç¨‹åºã€‚æ‰€æœ‰å‘å¸ƒWebè¯·æ±‚çš„åº”ç”¨ç¨‹åºéƒ½æ˜¯HTTP Agentä»£ç†ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªæåˆ°è¿‡ä¸€ç§HTTP Agentä»£ç†ï¼šWebæµè§ˆå™¨ï¼Œä½†ç”¨æˆ·Agentä»£ç†è¿˜æœ‰å¾ˆå¤šå…¶ä»–ç±»å‹ã€‚</p><h2 id="æ ¼å¼"><a href="#æ ¼å¼" class="headerlink" title="æ ¼å¼"></a>æ ¼å¼</h2><p>æ‰€æœ‰çš„URL è®¿é—®æ–¹å¼å‡ç¬¦åˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;scheme&gt;:<span class="hljs-comment">//&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;path&gt;; &lt;params&gt;? &lt;query&gt;#&lt;frag&gt;</span><br></code></pre></td></tr></table></figure><p>è¯·æ±‚æŠ¥æ–‡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;method&gt; &lt;request-URL&gt; &lt;version&gt;<br>&lt;headers&gt;<br><br>&lt;entity-body&gt;<br></code></pre></td></tr></table></figure><p>å“åº”æŠ¥æ–‡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;version&gt; &lt;status&gt; &lt;reason-phrase&gt;<br>&lt;headers&gt;<br><br>&lt;entity-body&gt;<br></code></pre></td></tr></table></figure><ul><li>æ–¹æ³•ï¼ˆmethodï¼‰å®¢æˆ·ç«¯å¸Œæœ›æœåŠ¡å™¨å¯¹èµ„æºæ‰§è¡Œçš„åŠ¨ä½œã€‚æ˜¯ä¸€ä¸ªå•ç‹¬çš„è¯ï¼Œæ¯”å¦‚GETã€HEADæˆ–POSTã€‚æœ¬ç« ç¨åå°†è¯¦ç»†ä»‹ç»æ–¹æ³•ã€‚Â·</li><li>è¯·æ±‚URLï¼ˆrequest-URLï¼‰å‘½åäº†æ‰€è¯·æ±‚èµ„æºï¼Œæˆ–è€…URLè·¯å¾„ç»„ä»¶çš„å®Œæ•´URLã€‚å¦‚æœç›´æ¥ä¸æœåŠ¡å™¨è¿›è¡Œå¯¹è¯ï¼Œåªè¦URLçš„è·¯å¾„ç»„ä»¶æ˜¯èµ„æºçš„ç»å¯¹è·¯å¾„ï¼Œé€šå¸¸å°±ä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜â€”â€”æœåŠ¡å™¨å¯ä»¥å‡å®šè‡ªå·±æ˜¯URLçš„ä¸»æœº&#x2F;ç«¯å£ã€‚ç¬¬2ç« è¯¦ç»†åœ°ä»‹ç»äº†URLçš„è¯­æ³•ã€‚Â·</li><li>ç‰ˆæœ¬ï¼ˆversionï¼‰æŠ¥æ–‡æ‰€ä½¿ç”¨çš„HTTPç‰ˆæœ¬ï¼Œå…¶æ ¼å¼çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š<br>HTTP&#x2F;<code>&lt;major&gt;</code>.<code>&lt;minor&gt;</code></li><li>çŠ¶æ€ç ï¼ˆstatus-codeï¼‰è¿™ä¸‰ä½æ•°å­—æè¿°äº†è¯·æ±‚è¿‡ç¨‹ä¸­æ‰€å‘ç”Ÿçš„æƒ…å†µã€‚æ¯ä¸ªçŠ¶æ€ç çš„ç¬¬ä¸€ä½æ•°å­—éƒ½ç”¨äºæè¿°çŠ¶æ€çš„ä¸€èˆ¬ç±»åˆ«ï¼ˆâ€œæˆåŠŸâ€ã€â€œå‡ºé”™â€ç­‰ï¼‰ã€‚</li><li>é¦–éƒ¨ï¼ˆheaderï¼‰å¯ä»¥æœ‰é›¶ä¸ªæˆ–å¤šä¸ªé¦–éƒ¨ï¼Œæ¯ä¸ªé¦–éƒ¨éƒ½åŒ…å«ä¸€ä¸ªåå­—ï¼Œåé¢è·Ÿç€ä¸€ä¸ªå†’å·ï¼ˆ:ï¼‰ï¼Œç„¶åæ˜¯ä¸€ä¸ªå¯é€‰çš„ç©ºæ ¼ï¼Œæ¥ç€æ˜¯ä¸€ä¸ªå€¼ï¼Œæœ€åæ˜¯ä¸€ä¸ªCRLFã€‚é¦–éƒ¨æ˜¯ç”±ä¸€ä¸ªç©ºè¡Œï¼ˆCRLFï¼‰ç»“æŸçš„ï¼Œè¡¨ç¤ºäº†é¦–éƒ¨åˆ—è¡¨çš„ç»“æŸå’Œå®ä½“ä¸»ä½“éƒ¨åˆ†çš„å¼€å§‹ã€‚æœ‰äº›HTTPç‰ˆæœ¬ï¼Œæ¯”å¦‚HTTP&#x2F;1.1ï¼Œè¦æ±‚æœ‰æ•ˆçš„è¯·æ±‚æˆ–å“åº”æŠ¥æ–‡ä¸­å¿…é¡»åŒ…å«ç‰¹å®šçš„é¦–éƒ¨ã€‚</li><li>å®ä½“çš„ä¸»ä½“éƒ¨åˆ†ï¼ˆentity-bodyï¼‰å®ä½“çš„ä¸»ä½“éƒ¨åˆ†åŒ…å«ä¸€ä¸ªç”±ä»»æ„æ•°æ®ç»„æˆçš„æ•°æ®å—</li></ul><h2 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h2><h3 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h3><p>GETæ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ã€‚é€šå¸¸ç”¨äºè¯·æ±‚æœåŠ¡å™¨å‘é€æŸä¸ªèµ„æºã€‚</p><h3 id="HEAD"><a href="#HEAD" class="headerlink" title="HEAD"></a>HEAD</h3><p>HEADæ–¹æ³•ä¸GETæ–¹æ³•çš„è¡Œä¸ºå¾ˆç±»ä¼¼ï¼Œä½†æœåŠ¡å™¨åœ¨å“åº”ä¸­åªè¿”å›é¦–éƒ¨ã€‚ä¸ä¼šè¿”å›å®ä½“çš„ä¸»ä½“éƒ¨åˆ†ã€‚</p><h3 id="PUT"><a href="#PUT" class="headerlink" title="PUT"></a>PUT</h3><p>ä¸GETä»æœåŠ¡å™¨è¯»å–æ–‡æ¡£ç›¸åï¼ŒPUTæ–¹æ³•ä¼šå‘æœåŠ¡å™¨å†™å…¥æ–‡æ¡£ã€‚æœ‰äº›å‘å¸ƒç³»ç»Ÿå…è®¸ç”¨æˆ·åˆ›å»ºWebé¡µé¢ï¼Œå¹¶ç”¨PUTç›´æ¥å°†å…¶å®‰è£…åˆ°WebæœåŠ¡å™¨ä¸Šå»</p><h3 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h3><p>è¡¨å•ä¸­å¡«å¥½çš„æ•°æ®é€šå¸¸ä¼šè¢«é€ç»™æœåŠ¡å™¨ï¼Œç„¶åç”±æœåŠ¡å™¨å°†å…¶å‘é€åˆ°å®ƒè¦å»çš„åœ°æ–¹</p><h3 id="TRACE"><a href="#TRACE" class="headerlink" title="TRACE"></a>TRACE</h3><p>TRACEæ–¹æ³•å…è®¸å®¢æˆ·ç«¯åœ¨æœ€ç»ˆå°†è¯·æ±‚å‘é€ç»™æœåŠ¡å™¨æ—¶ï¼Œçœ‹çœ‹å®ƒå˜æˆäº†ä»€ä¹ˆæ ·å­ã€‚</p><h3 id="OPTIONS"><a href="#OPTIONS" class="headerlink" title="OPTIONS"></a>OPTIONS</h3><p>OPTIONSæ–¹æ³•è¯·æ±‚WebæœåŠ¡å™¨å‘ŠçŸ¥å…¶æ”¯æŒçš„å„ç§åŠŸèƒ½ã€‚å¯ä»¥è¯¢é—®æœåŠ¡å™¨é€šå¸¸æ”¯æŒå“ªäº›æ–¹æ³•ï¼Œæˆ–è€…å¯¹æŸäº›ç‰¹æ®Šèµ„æºæ”¯æŒå“ªäº›æ–¹æ³•</p><h3 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h3><p>è¯·æœåŠ¡å™¨åˆ é™¤è¯·æ±‚URLæ‰€æŒ‡å®šçš„èµ„æº</p><h2 id="çŠ¶æ€ç "><a href="#çŠ¶æ€ç " class="headerlink" title="çŠ¶æ€ç "></a>çŠ¶æ€ç </h2><p>çŠ¶æ€ç ç”¨æ¥æ ‡è®° å“åº”æŠ¥æ–‡å¯¹è¯·æ±‚ç»“æœçš„å¤„ç†æ–¹å¼</p><p>100 -  199 ç»§ç»­ä¼ è¾“ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯éœ€è¦åˆ†æ®µå‘é€ä¸€æ®µè¾ƒé•¿çš„æ¶ˆæ¯æ•°æ®ã€‚</p><p>200 - 299 æˆåŠŸï¼Œè¡¨ç¤ºæœåŠ¡å™¨æˆåŠŸæ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚</p><p>300 - 399 é‡å®šå‘ï¼Œé€šå¸¸æ˜¯èµ„æºå˜æ›´åé€šçŸ¥å®¢æˆ·ç«¯è®¿é—®å¦ä¸€ä¸ªURLåœ°å€ã€‚</p><p>400 - 499 å®¢æˆ·ç«¯å¼‚å¸¸ï¼Œé€šå¸¸æ˜¯ç”±æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚æ¶ˆæ¯ä¸ç¬¦åˆæœåŠ¡ç«¯çš„è¦æ±‚æ‰€å¯¼è‡´ã€‚</p><p>500 - 599 æœåŠ¡ç«¯å¼‚å¸¸ã€‚</p><h2 id="å¤´éƒ¨å­—æ®µ"><a href="#å¤´éƒ¨å­—æ®µ" class="headerlink" title="å¤´éƒ¨å­—æ®µ"></a>å¤´éƒ¨å­—æ®µ</h2><p>å¤´éƒ¨å­—æ®µç”¨äºæè¿° è¯·æ±‚ç«¯çš„èµ„æºè¯·æ±‚ä¿¡æ¯å’ŒæœåŠ¡ç«¯æ‰€èƒ½æä¾›çš„åº”ç”¨æœåŠ¡ä¿¡æ¯ï¼Œåˆ†ä¸º5ç§ç±»å‹</p><p>é€šç”¨é¦–éƒ¨ ï¼šæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½å¯ä»¥æºå¸¦ï¼Œæè¿°ä¸€äº›é€šç”¨çš„åŠŸèƒ½ä¿¡æ¯</p><p>è¯·æ±‚é¦–éƒ¨ ï¼šè¯·æ±‚ç«¯ç‰¹æœ‰çš„ï¼Œä¸€èˆ¬æ˜¯ä¸€äº›åŸºäºè‡ªèº«è¯·æ±‚çš„æè¿°ä¿¡æ¯</p><p>å“åº”é¦–éƒ¨ ï¼šç›¸åº”ç«¯ç‰¹æœ‰çš„ï¼Œä¸€èˆ¬æ˜¯æè¿°æœåŠ¡ç«¯çš„çŠ¶æ€ä¿¡æ¯å’ŒåŠŸèƒ½ä¿¡æ¯</p><p>å®ä½“é¦–éƒ¨ ï¼šç”¨äºæè¿°æ¶ˆæ¯ä½“çš„ä¸€äº›å­—æ®µï¼Œç”¨äºæè¿°æ¶ˆæ¯ä½“çš„æ–‡ä»¶ç±»å‹ï¼Œè¯»å–ç¼–ç æ ¼å¼ç­‰</p><p>æ‰©å±•é¦–éƒ¨ ï¼šä½œç”¨äºHTTPåè®®ä¹‹ä¸Šçš„ä¸€äº›åè®®è‡ªå®šä¹‰å­—æ®µï¼Œç”¨äºä¸ºåŠŸèƒ½å¼€å‘è€…æä¾›æ›´ä¸Šå±‚çš„åº”ç”¨æ„å»º</p><h3 id="é€šç”¨é¦–éƒ¨"><a href="#é€šç”¨é¦–éƒ¨" class="headerlink" title="é€šç”¨é¦–éƒ¨"></a>é€šç”¨é¦–éƒ¨</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">Connection</span>        å…è®¸å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨æŒ‡å®šä¸è¯·æ±‚/å“åº”æœ‰å…³çš„é€‰é¡¹<br><span class="hljs-type">Date</span>              æ—¶é—´/æ—¥æœŸæ ‡å¿—<br>MIME-<span class="hljs-keyword">Version</span>      MIMEç‰ˆæœ¬ä¿¡æ¯<br></code></pre></td></tr></table></figure><h3 id="è¯·æ±‚é¦–éƒ¨"><a href="#è¯·æ±‚é¦–éƒ¨" class="headerlink" title="è¯·æ±‚é¦–éƒ¨"></a>è¯·æ±‚é¦–éƒ¨</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Host              ç»™å‡ºæ¥æ”¶çš„æœåŠ¡å™¨çš„ä¸»æœºåå’Œç«¯å£å·<br>Referer           æè¿°å½“å‰è¯·æ±‚çš„URL<br><span class="hljs-keyword">User</span>-Agent        å‘èµ·è¯·æ±‚çš„åº”ç”¨ç¨‹åº<br><br>Accept            å‘ŠçŸ¥æœåŠ¡å™¨èƒ½å¤Ÿå‘é€å“ªç§åª’ä½“ç±»å‹<br>Accept-Charset    å‘ŠçŸ¥æœåŠ¡å™¨èƒ½å¤Ÿå‘é€å“ªç§å­—ç¬¦é›†<br>Accept-<span class="hljs-keyword">Encoding</span>   å‘ŠçŸ¥æœåŠ¡å™¨èƒ½å¤Ÿå‘é€å“ªç§å­—ç¬¦ç¼–ç æ–¹å¼<br>Accept-<span class="hljs-keyword">Language</span>   å‘ŠçŸ¥æœåŠ¡å™¨èƒ½å¤Ÿå‘é€å“ªç§è¯­è¨€<br><br><span class="hljs-keyword">Authorization</span>     æè¿°ä¸€äº›æˆæƒä¿¡æ¯<br>Cookie            æè¿°ä¸€äº›æœ¬åœ°å­˜å‚¨ä¿¡æ¯<br><br>Proxy-<span class="hljs-keyword">Authorization</span> ä¸ä»£ç†è¿›è¡Œè®¤è¯æ—¶ä½¿ç”¨<br>Proxy-<span class="hljs-keyword">Connection</span>    ä¸ä»£ç†è¿›è¡Œè¿æ¥æ—¶ä½¿ç”¨<br></code></pre></td></tr></table></figure><h3 id="å“åº”é¦–éƒ¨"><a href="#å“åº”é¦–éƒ¨" class="headerlink" title="å“åº”é¦–éƒ¨"></a>å“åº”é¦–éƒ¨</h3><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gams">Age              å“åº”æŒç»­æ—¶é—´<br>Server           å“åº”ç¨‹åºçš„è½¯ä»¶åç§°å’Œç‰ˆæœ¬ä¿¡æ¯<br>Accept-Ranges    æœåŠ¡ç«¯å¯æ¥æ”¶çš„èŒƒå›´ç±»å‹<br>Proxy-Authenticate  ä»£ç†å¯¹å®¢æˆ·ç«¯çš„è´¨è¯¢åˆ—è¡¨<br><span class="hljs-keyword">Set</span>-Cookie          å‘å®¢æˆ·ç«¯è®¾ç½®æœ¬åœ°å­˜å‚¨<br>WWW-Authenticate    æœåŠ¡ç«¯å¯¹å®¢æˆ·ç«¯çš„è´¨è¯¢åˆ—è¡¨<br></code></pre></td></tr></table></figure><h3 id="å®ä½“é¦–éƒ¨"><a href="#å®ä½“é¦–éƒ¨" class="headerlink" title="å®ä½“é¦–éƒ¨"></a>å®ä½“é¦–éƒ¨</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs css">Allow            åˆ—å‡ºäº†å¯ä»¥å¯¹æ­¤å®ä½“æ‰§è¡Œçš„æ–¹æ³•<br>Location         åˆ—å‡ºèµ„æºçš„å®é™…ä½ç½®<br><br><span class="hljs-attribute">Content</span>-Base     ç›¸å¯¹URLä½¿ç”¨çš„åŸºç¡€URL<br><span class="hljs-attribute">Content</span>-Encoding å¯¹ä¸»ä½“æ‰§è¡Œçš„ç¼–ç æ–¹å¼<br><span class="hljs-attribute">Content</span>-Language ç†è§£ä¸»ä½“æ—¶æœ€é€‚å®œä½¿ç”¨çš„è‡ªç„¶è¯­è¨€<br><span class="hljs-attribute">Content</span>-Length   ä¸»ä½“çš„é•¿åº¦æˆ–å°ºå¯¸<br><span class="hljs-attribute">Content</span>-Location èµ„æºæ‰€å¤„çš„ä½ç½®<br><span class="hljs-attribute">Content</span>-MD5      æ ¡éªŒå’Œ<br><span class="hljs-attribute">Content</span>-Range    åœ¨æ•´ä¸ªèµ„æºä¸­æ­¤å®ä½“è¡¨ç¤ºçš„å­—èŠ‚èŒƒå›´<br><span class="hljs-attribute">Content</span>-Type     è¿™ä¸ªä¸»ä½“çš„å¯¹è±¡ç±»å‹<br><br>Expires          å®ä½“çš„è¿‡æœŸæ—¶é—´<br>Last-Modified    æœ€åä¸€æ¬¡è¢«ä¿®æ”¹çš„æ—¥æœŸå’Œæ—¶é—´<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>HTTP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTTP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaç¼–ç¨‹ VIIII è¯»å–ä¸åºåˆ—åŒ–</title>
    <link href="/2025/05/10/Java%E7%BC%96%E7%A8%8B-VIIII-%E8%AF%BB%E5%8F%96%E4%B8%8E%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <url>/2025/05/10/Java%E7%BC%96%E7%A8%8B-VIIII-%E8%AF%BB%E5%8F%96%E4%B8%8E%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="ç¼–ç ä¸è§£ç "><a href="#ç¼–ç ä¸è§£ç " class="headerlink" title="ç¼–ç ä¸è§£ç "></a>ç¼–ç ä¸è§£ç </h1><p>Nettyä¸­ æä¾›äº† ç¼–è§£ç  å·¥å…·</p><p>åŸºæœ¬å®ç°</p><p>é€šè¿‡ç»§æ‰¿ByteToMessageDecoder å¯ä»¥æ”¹å†™å¯¹æ•°æ®çš„å¤„ç†æµç¨‹ã€‚</p><p>å½“æ‰§è¡Œout.add() æ—¶ï¼Œè§£ç å™¨ä¼šç›´æ¥å°†æ·»åŠ çš„å¯¹è±¡äº¤ç»™åç»­çš„handler è¿›è¡Œæ‰§è¡Œï¼Œè¿™å°±æ„å‘³ç€ã€‚æ¯è§£ç å‡ºä¸€ä¸ªå¯¹è±¡ï¼Œåç»­éƒ½ä¼šä¸ºå…¶ä½¿ç”¨handlerè¿›è¡Œä¸€æ¬¡å¤„ç†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Byte2IntegerDecoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ByteToMessageDecoder</span> &#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">decode</span><span class="hljs-params">(ChannelHandlerContext ctx , ByteBuf in, List&lt;Object&gt; out)</span>&#123;<br><span class="hljs-keyword">while</span> (in.readableBytes()&gt;=<span class="hljs-number">4</span>)&#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> in.readInt();<br>Logger.info(<span class="hljs-string">&quot;è§£ç å‡ºä¸€ä¸ªæ•´æ•°:&quot;</span> + i);<br>out.add(i);<br>&#125;<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IntegerProcessHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span>&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx,Object msg)</span>... &#123;<br><span class="hljs-type">Integer</span> <span class="hljs-variable">integer</span> <span class="hljs-operator">=</span> (Integer) msg ;<br>Logger.info(<span class="hljs-string">&quot;æ‰“å°å‡ºä¸€ä¸ªæ•´æ•°: &quot;</span> + integer);<br><br>&#125;<br><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Byte2IntegerDecoderTester</span>&#123;<br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testByteToIntegerDecoder</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">ChannelInitializer</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;EmbeddedChannel&gt;()&#123;<br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(EmbeddedChannel ch)</span>&#123;<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Byte2IntegerDecoder</span>());<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">IntegerProcessHandler</span>());<br>&#125;<br>&#125;;<br><span class="hljs-type">EmbeddedChannel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">EmbeddedChannel</span>(i);<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> ; j&lt; <span class="hljs-number">100</span> ; j++)&#123;<br><span class="hljs-type">Bytebuf</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> Unpooled.buffer();<br>buf.writeInt(j);<br>channel.writeInbound(buf);<br>&#125;<br>...<br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="ReplayingDecoderè§£ç å™¨"><a href="#ReplayingDecoderè§£ç å™¨" class="headerlink" title="ReplayingDecoderè§£ç å™¨"></a>ReplayingDecoderè§£ç å™¨</h2><p>é€šè¿‡ç»§æ‰¿ReplayingDecoder , ä¼ å…¥çš„å¯¹è±¡ä¸å†éœ€è¦åˆ¤æ–­æ•´ä¸ªå¯¹è±¡çš„é•¿åº¦ã€‚</p><p>è€Œå½“é•¿åº¦ä¸è¶³æ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸è¢«ReplayingDecoderæ¥æ”¶ï¼Œç­‰å¾…åç»­çš„æ•°æ®ä¼ å…¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Byte2IntegerReplayDecoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ReplayingDecoder</span>&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">decode</span><span class="hljs-params">(ChannelHandlerContext ctx, Bytebuf in , List&lt;Object&gt; out)</span>&#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> in.readInt();<br>Logger.info(<span class="hljs-string">&quot;è§£ç å‡ºä¸€ä¸ªæ•´æ•°&quot;</span> + i);<br>out.add(i) ;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ•´æ•°çš„åˆ†åŒ…è§£ç "><a href="#æ•´æ•°çš„åˆ†åŒ…è§£ç " class="headerlink" title="æ•´æ•°çš„åˆ†åŒ…è§£ç "></a>æ•´æ•°çš„åˆ†åŒ…è§£ç </h2><p>é€šè¿‡ä½¿ç”¨æšä¸¾ç±»å®šä¹‰çŠ¶æ€ä¿¡æ¯ï¼Œå°†handler çŠ¶æ€åˆå§‹åŒ–ä¸ºPHASE_1</p><p>åç»­æµç¨‹æ‰§è¡Œ ï¼š</p><p>1.å½“ç¬¬ä¸€æ¬¡å¤„ç†æ—¶ çŠ¶æ€ä¸ºPHASE_1 ï¼Œè¯»å–å¹¶å°†ç¬¬ä¸€ä¸ªæ•´æ•°å­˜å‚¨åœ¨handler , å¹¶å°†çŠ¶æ€ç½®ä¸ºPHASE_2</p><p>2.å½“åç»­è¯»å–å°±ç»ªæ—¶ï¼ŒçŠ¶æ€ä¸ºPHASE_2ï¼Œæ‰§è¡ŒPHASE_2é€»è¾‘ï¼Œè¿›è¡Œæ±‚å’Œè¿ç®—ã€‚å‘åç»­handlerä¸­å‘é€æœ€ç»ˆç»“æœã€‚å¹¶å°†çŠ¶æ€ç½®ä¸ºPHASE_1</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IntegerAddDecoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Replaying</span>&lt;IntegerAddDecoder.PHASE&gt;&#123;<br><span class="hljs-keyword">enum</span> <span class="hljs-title class_">PHASE</span> &#123;<br>PHASE_1,<br>PHASE_2<br>&#125;<br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> first ;<br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> second ;<br><span class="hljs-keyword">public</span> <span class="hljs-title function_">IntegerAddDecoder</span><span class="hljs-params">()</span><br>&#123;<br><span class="hljs-built_in">super</span>(PHASE.PHASE_1);<br>&#125;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">decode</span><span class="hljs-params">(ChannelHandlerContext ctx , Bytebuf in ,List&lt;Object&gt; out)</span> <span class="hljs-keyword">throws</span> Exception&#123;<br><span class="hljs-keyword">switch</span> (state())<br>&#123;<br><span class="hljs-keyword">case</span> PHASE_1 :<br>first = in.readInt();<br>checkpoint(PHASE.PHASE_2);<br><span class="hljs-keyword">break</span> ;<br><br><span class="hljs-keyword">case</span> PHASE_2 :<br>second = in.readInt();<br><span class="hljs-type">Integer</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> first + second ;<br>out.add(sum);<br>checkpoint(PHASE.PHASE_1);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">default</span> :<br><span class="hljs-keyword">break</span> ;<br>&#125; <br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å­—ç¬¦çš„åˆ†åŒ…è§£ç "><a href="#å­—ç¬¦çš„åˆ†åŒ…è§£ç " class="headerlink" title="å­—ç¬¦çš„åˆ†åŒ…è§£ç "></a>å­—ç¬¦çš„åˆ†åŒ…è§£ç </h2><p>å’Œ å¯¹æ•°å€¼è®¡ç®—æ—¶çš„å¤„ç†ç±»ä¼¼ï¼Œåœ¨ç¬¬ä¸€é˜¶æ®µå…ˆæ¥æ”¶äº†ä¸€ä¸ªæ•´å‹ ç”¨äºæè¿°åç»­ä¼ å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ï¼Œåœ¨ç¬¬äºŒé˜¶æ®µåˆ™ä»ä¼ å…¥æ•°æ®ä¸­è¯»å–å¯¹åº”çš„é•¿åº¦è§£ç ä¸ºå­—ç¬¦ä¸²ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringReplayDecoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ReplayingDecoder</span>&lt;StringReplayDecoder.PHASE&gt;&#123;<br><span class="hljs-keyword">enum</span> <span class="hljs-title class_">PHASE</span> &#123;<br>PHASE_1 ,<br>PHASE_2 <br>&#125;<br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> length ;<br><span class="hljs-keyword">private</span> <span class="hljs-type">byte</span>[] inBytes ;<br><span class="hljs-keyword">public</span> <span class="hljs-title function_">StringReplayDecoder</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-built_in">super</span>(PHASE.PHASE_1)<br>&#125;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">decode</span><span class="hljs-params">(ChannelHandlerContext ctx , Bytebuf in , List&lt;Object&gt; out )</span> <span class="hljs-keyword">throws</span> Exception &#123;<br><span class="hljs-keyword">switch</span>(state())&#123;<br><span class="hljs-keyword">case</span> PHASE_1 :<br>length = in.readInt();<br>inBytes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[length];<br>checkpoint(PHASE.PHASE_2);<br><span class="hljs-keyword">break</span> ;<br><span class="hljs-keyword">case</span> PHASE_2 :<br>in.readBytes(inBytes , <span class="hljs-number">0</span> ,length);<br>out.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(inBytes, <span class="hljs-string">&quot;UTF-8&quot;</span>));<br>checkpoint(PHASE.PHASE_1);<br><span class="hljs-keyword">break</span> ;<br><span class="hljs-keyword">default</span> :<br><span class="hljs-keyword">break</span> ;<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨ ByteToMessageDecoder</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringIntegerHeaderDecoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ByteToMessageDecoder</span>&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">decode</span><span class="hljs-params">(ChannelHandlerContext channelHandlerContext , Bytebuf buf , List&lt;Object&gt; out)</span>...&#123;<br><span class="hljs-keyword">if</span>(buf.readableBytes()&lt;<span class="hljs-number">4</span>)&#123;<br><span class="hljs-keyword">return</span>; <br>&#125;<br>buf.markReaderIndex();<br><span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> buf.readInt();<br><span class="hljs-keyword">if</span>(buf.readableBytes() &lt; length)&#123;<br>buf.resetReaderIndex();<br><span class="hljs-keyword">return</span> ;<br>&#125;<br><span class="hljs-type">byte</span>[] inBytes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[length];<br>buf.readBytes(inBytes , <span class="hljs-number">0</span> , length);<br>out.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(inBytes , <span class="hljs-string">&quot;UTF-8&quot;</span>));<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="MessageToMessageDecoder"><a href="#MessageToMessageDecoder" class="headerlink" title="MessageToMessageDecoder"></a>MessageToMessageDecoder</h2><p>é€šè¿‡ç»§æ‰¿MessageToMessageDecoder å¯ä»¥å®ŒæˆPOJOå¯¹è±¡é—´çš„ è§£ç è½¬æ¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šä¹‰</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Integer2StringDecoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">MessageToMessageDecoder</span>&lt;Integer&gt; &#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">decode</span><span class="hljs-params">(ChannelHandlerContext ctx , Integer msg , List&lt;Object&gt; out)</span>...&#123;<br>out.add(String.valueOf(msg));<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å†…ç½®è§£ç å™¨"><a href="#å†…ç½®è§£ç å™¨" class="headerlink" title="å†…ç½®è§£ç å™¨"></a>å†…ç½®è§£ç å™¨</h2><p>FixedLengthFrameDecoder  å›ºå®šé•¿åº¦æ•°æ®è§£ç å™¨  å¯¹å›ºå®šé•¿åº¦çš„æ•°æ®è¿›è¡Œè§£ç </p><p>LineBasedFrameDecoder      è¡Œåˆ†å‰²æ•°æ®åŒ…è§£ç å™¨  å°†æ¢è¡Œç¬¦ä½œä¸ºè¾¹ç•Œåˆ†éš”ç¬¦</p><p>DelimiterBasedFrameDecoder  å¯ä»¥è‡ªå®šä¹‰åˆ†éš”ç¬¦ ç”¨äºä½œä¸ºè¾¹ç•Œ</p><p>LengthFieldBasedFrameDecoder è‡ªå®šä¹‰é•¿åº¦æ•°æ®åŒ…è§£ç å™¨ æ ¹æ®åŸæ•°æ®åŒ…ä¸­çš„æ•°æ®é•¿åº¦è¿›è¡Œè§£ç æå–</p><h3 id="è¡Œåˆ†å‰²æ•°æ®åŒ…è§£ç å™¨"><a href="#è¡Œåˆ†å‰²æ•°æ®åŒ…è§£ç å™¨" class="headerlink" title="è¡Œåˆ†å‰²æ•°æ®åŒ…è§£ç å™¨"></a>è¡Œåˆ†å‰²æ•°æ®åŒ…è§£ç å™¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyOpenBoxDecoder</span>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-type">String</span> <span class="hljs-variable">spliter</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;\\r\\n&quot;</span>;<br><span class="hljs-keyword">static</span> <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;string&quot;</span>;<br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testLineBasedFrameDecoder</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-type">ChannelInitializer</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;EmbeddedChannel&gt;()&#123;<br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(EmbeddedChannel ch)</span>&#123;<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LineBasedFrameDecoder</span>(<span class="hljs-number">1024</span>));<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringDecoder</span>());<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringProcessHandler</span>());<br>&#125;<br>&#125;;<br><span class="hljs-type">EmbeddedChannel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">EmbeddedChannel</span>(i);<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> ; j &lt; <span class="hljs-number">100</span> ; j++)&#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">random</span> <span class="hljs-operator">=</span> RandomUtil.randInMod(<span class="hljs-number">3</span>);<br> <span class="hljs-type">Bytebuf</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> Unpooled.buffer();<br> <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">k</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> ; k &lt; random ; k++)&#123;<br> buf.writeBytes(content.getBytes(<span class="hljs-string">&quot;UTF=8&quot;</span>));<br> &#125;<br>buf.writeBytes(spliter.getBytes(<span class="hljs-string">&quot;UTF-8&quot;</span>));<br>channel.writeInbound(buf);<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="DelimiterBasedFrameDecoder"><a href="#DelimiterBasedFrameDecoder" class="headerlink" title="DelimiterBasedFrameDecoder"></a>DelimiterBasedFrameDecoder</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyOpenBoxDecoder</span>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-type">String</span> <span class="hljs-variable">spliter</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;\\t&quot;</span>;<br><span class="hljs-keyword">static</span> <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;string&quot;</span>;<br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testDelimiterBasedFrameDecoder</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-keyword">final</span> <span class="hljs-type">Bytebuf</span> <span class="hljs-variable">delimiter</span> <span class="hljs-operator">=</span> Unpooled.copiedBuffer(spliter.getBytes(<span class="hljs-string">&quot;UTF-8&quot;</span>));<br><span class="hljs-type">ChannelInitializer</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;EmbeddedChannel&gt;()&#123;<br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(EmbeddedChannel ch)</span>&#123;<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DelimiterBasedFrameDecoder</span>(<span class="hljs-number">1024</span>,<span class="hljs-literal">true</span>,delimiter));<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringDecoder</span>());<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringProcessHandler</span>());<br>&#125;<br>&#125;;<br>...<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="LengthFieldBasedFrameDecoder"><a href="#LengthFieldBasedFrameDecoder" class="headerlink" title="LengthFieldBasedFrameDecoder"></a>LengthFieldBasedFrameDecoder</h3><p>LengthFieldBasedFrameDecoder éœ€è¦åˆå§‹åŒ–çš„å€¼</p><ol><li>maxFrameLength å‘é€çš„æ•°æ®åŒ…æœ€å¤§é•¿åº¦</li><li>lengFieldOffset é•¿åº¦å­—æ®µåç§»é‡</li><li>lengthFieldLength é•¿åº¦å­—æ®µæ‰€å å­—èŠ‚æ•°</li><li>lengthAdjustment é•¿åº¦çš„è°ƒæ•´å€¼ å³åœ¨é•¿åº¦ å’Œ å®é™…æ¶ˆæ¯ä½“ä¸­é—´å®šä¹‰çš„å­—æ®µé•¿åº¦</li><li>initialBytesToStrip ä¸¢å¼ƒçš„åˆå§‹å­—èŠ‚æ•°</li></ol><p>é€šè¿‡ä¸Šè¿°åˆå§‹åŒ–å­—æ®µçš„å£°æ˜</p><p>æˆ‘ä»¬å¾—åˆ°äº† 1.åŒ…çš„æœ€å¤§é•¿åº¦ 2.é•¿åº¦å­—æ®µåœ¨åè®®ä¸­å®šä¹‰çš„ä½ç½® 3.é•¿åº¦å­—æ®µçš„é•¿åº¦ 4.é•¿åº¦å­—æ®µåå…¶ä½™å­—æ®µæ‰€å ç”¨çš„é•¿åº¦  5.è¯»å–æ¶ˆæ¯ä½“çš„å®é™…ä½ç½®ã€‚</p><p>äºæ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°LengthFieldBasedFrameDecoder  æœ€ç»ˆå¾—åˆ°çš„æ˜¯ä¸€ä¸ª é•¿åº¦ä¿¡æ¯çš„ä½ç½®å’Œæ¶ˆæ¯ä½“çš„å®é™…é•¿åº¦ä¿¡æ¯ã€‚è¿™æ ·ä¾¿äºæ›´å¥½çš„ç”¨äºæ¥æ”¶å’Œå¤„ç†å®é™…çš„æ¶ˆæ¯ä½“</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyOpenBoxDecoder</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">VERSION</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span> ;<br><span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;String&quot;</span>;<br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testLengthFieldBasedFrameDecoder</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-keyword">final</span> <span class="hljs-type">LengthFieldBasedFrameDecoder</span> <span class="hljs-variable">spliter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LengthFieldBasedFrameDecoder</span>(<span class="hljs-number">1024</span>,<span class="hljs-number">0</span>,<span class="hljs-number">4</span>,<span class="hljs-number">0</span>,<span class="hljs-number">4</span>);<br><span class="hljs-type">ChannelInitializer</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;EmbeddedChannel&gt;()&#123;<br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(EmbeddedChannel ch)</span>&#123;<br>ch.pipeline().addLast(spliter);<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringDecoder</span>(Charset.forName(<span class="hljs-string">&quot;UTF-8&quot;</span>)));<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringProcessHandler</span>());<br>&#125;<br>&#125;;<br><span class="hljs-type">EmbeddedChannel</span> <span class="hljs-variable">Channel</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">EmbeddedChannel</span>();<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> ; j &lt;= <span class="hljs-number">100</span> ; j++)&#123;<br><span class="hljs-type">ByteBuf</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> Unpooled.buffer();<br><span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> j + <span class="hljs-string">&quot;æ¬¡å‘é€-&gt;&quot;</span> + content;<br><span class="hljs-type">byte</span>[] bytes = s.getBytes(<span class="hljs-string">&quot;UTF-8&quot;</span>);<br>buf.writeInt(Bytes.length);<br>buf.writeBytes(bytes);<br>channel.writeInbound(buf);<br>&#125;<br>Thread.sleep(Integer.MAX_VALUE);<br>&#125; <span class="hljs-keyword">catch</span> (InterruptedException e)&#123;<br>e.printStackTrace();<br>&#125; <span class="hljs-keyword">catch</span> (UnsupportedEncodingException e)&#123;<br>e.printStackTrace();<br>&#125;<br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h1 id="Encoder"><a href="#Encoder" class="headerlink" title="Encoder"></a>Encoder</h1><h3 id="MessageToByteEncoder"><a href="#MessageToByteEncoder" class="headerlink" title="MessageToByteEncoder"></a>MessageToByteEncoder</h3><p>å°†ç±»å‹å¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Integer2ByteEncoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">MessageToByteEncoder</span>&lt;Integer&gt;&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">encode</span><span class="hljs-params">(ChannelHandlerContext ctx , Integer msg , ByteBuf out)</span> ... &#123;<br>out.writeInt(msg);<br>Logger.info(<span class="hljs-string">&quot;encoder Integer = &quot;</span> + msg);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="MessageToMessageEncoder"><a href="#MessageToMessageEncoder" class="headerlink" title="MessageToMessageEncoder"></a>MessageToMessageEncoder</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">String2IntergerEncoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">MessageToMessageEncoder</span>&lt;String&gt; &#123;<br><span class="hljs-meta">@Override</span> <br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">encode</span><span class="hljs-params">(ChannelHandlerContext c ,String s , List&lt;Object&gt; list)</span>...&#123;<br><span class="hljs-type">char</span>[] array = s.toCharArray();<br><span class="hljs-keyword">for</span> (<span class="hljs-type">char</span> a : array)&#123;<br><span class="hljs-keyword">if</span> (a &gt;= <span class="hljs-number">48</span> &amp;&amp; a &lt;= <span class="hljs-number">57</span>)&#123;<br>list.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(a));<br>&#125;<br>&#125;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç¼–è§£ç ç»“åˆ"><a href="#ç¼–è§£ç ç»“åˆ" class="headerlink" title="ç¼–è§£ç ç»“åˆ"></a>ç¼–è§£ç ç»“åˆ</h2><p>é€šè¿‡ç»§æ‰¿ByteToMessageCodec é‡å†™ encode å’Œdecode æ–¹æ³•å®Œæˆå¯¹ç¼–è§£ç çš„ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Byte2IntegerCodec</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ByteToMessageCodec</span>&lt;Integer&gt;&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">encode</span><span class="hljs-params">(ChannelHandlerContext ctx , Integer msg , ByteBuf out)</span>... &#123;<br>out.writeInt(msg);<br>System.out.println(<span class="hljs-string">&quot;write Integer = &quot;</span> + msg);<br><br>&#125;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">decode</span><span class="hljs-params">(ChannelHandlerContext ctx , ByteBuf in , List&lt;Object&gt; out)</span>&#123;<br><span class="hljs-keyword">if</span>(in.readableBytes() &gt;= <span class="hljs-number">4</span>)&#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> in.readInt();<br>System.out.println(<span class="hljs-string">&quot;Decoder i = &quot;</span>+i);<br>out.add(i);<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ç»„åˆå…¶åŸºç±» ç»„åˆå®šä¹‰å¥½çš„ ç¼–ç å™¨å’Œè§£ç å™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IntegerDuplexHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">CombinedChannelDuplexHandler</span>&lt;Byte2IntegerDecoder,Integer2ByteEncoder&gt;&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-title function_">IntegerDuplexHandler</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-built_in">super</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Byte2IntegerDecoder</span>(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer2ByteEncoder</span>());<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="åºåˆ—åŒ–å¯¹è±¡"><a href="#åºåˆ—åŒ–å¯¹è±¡" class="headerlink" title="åºåˆ—åŒ–å¯¹è±¡"></a>åºåˆ—åŒ–å¯¹è±¡</h1><h2 id="åŒ…å¤„ç†"><a href="#åŒ…å¤„ç†" class="headerlink" title="åŒ…å¤„ç†"></a>åŒ…å¤„ç†</h2><p>å› ä¸ºTCPè¢«è®¾è®¡ä¸ºé¢å‘è¿æ¥çš„æµå¼ä¼ è¾“ã€‚é€šè¿‡ç¼“å†²åŒºæ¥è¿›è¡ŒåŒ…çš„æ•°æ®æ¥æ”¶å’Œå‘é€ã€‚æ‰€ä»¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œæ— æ³•é€šè¿‡ç±»ä¼¼UDPçš„åŒ…æ”¶å‘è¿‡ç¨‹æ¥ç¡®å®šåŒ…çš„å®Œæ•´å‹ã€‚è€Œéœ€è¦åº”ç”¨å±‚çš„å®ç°æ¥ä¿è¯åŒ…çš„å®Œæ•´æ€§ã€‚</p><h2 id="ç²˜åŒ…å’ŒåŠåŒ…"><a href="#ç²˜åŒ…å’ŒåŠåŒ…" class="headerlink" title="ç²˜åŒ…å’ŒåŠåŒ…"></a>ç²˜åŒ…å’ŒåŠåŒ…</h2><p>ç²˜åŒ… ï¼š æ¥æ”¶ç«¯æ¥æ”¶äº†ä¸€ä¸ªBytebufï¼ŒåŒ…å«äº†å‘é€ç«¯çš„å¤šä¸ªByteBuf,å‘é€ç«¯çš„å¤šä¸ªBytebufåœ¨æ¥æ”¶ç«¯ç²˜åœ¨äº†ä¸€èµ·</p><p>åŠåŒ… ï¼š Recevierå°†Senderçš„ä¸€ä¸ªBytebufæ‹†å¼€äº†æ”¶ï¼Œæ”¶åˆ°å¤šä¸ªç ´ç¢çš„åŒ…ï¼ŒReceiveræ”¶åˆ°äº†Senderçš„ä¸€ä¸ªBytebufçš„ä¸€å°éƒ¨åˆ†</p><p>æ‰€ä»¥è¦ä¿è¯åŒ…çš„å®Œæ•´æ€§ï¼Œéœ€è¦ç”¨åˆ°åºåˆ—åŒ–ä¼ è¾“ã€‚å³é€šè¿‡ä¸€äº›æ ¼å¼åŒ–çš„æ ‡è®°æ¥ç¡®å®šåŒ…ä¸­å­—æ®µçš„èŒƒå›´ï¼Œé€»è¾‘ï¼Œå¼•ç”¨å…³ç³»ã€‚è¿™æ ·åœ¨æ”¶åˆ°åŒ…åå¯ä»¥æ ¹æ®å·²ç»å®šä¹‰å¥½çš„è§„åˆ™ï¼Œå°†å­—èŠ‚æ•°æ®è½¬æ¢ä¸ºæ ¼å¼åŒ–æ•°æ®è¿›è¡Œå¤„ç†</p><p>å¸¸ç”¨åˆ°çš„æ–¹æ³•åŒ…æ‹¬</p><p>è‡ªå®šä¹‰çš„è§£ç å™¨</p><p>é€šè¿‡åœ¨æ”¶å‘ä¸¤ç«¯å®šä¹‰ç¡®å®šçš„åŒ…é•¿å­—æ®µå’Œæ¶ˆæ¯ä½“ä¿¡æ¯ï¼Œåœ¨è§£ç ç«¯é€šè¿‡è¯»å–åŒ…é•¿å­—æ®µï¼Œæ¥å—å¯¹åº”é•¿åº¦çš„æ¶ˆæ¯ä½“ã€‚</p><p>åºåˆ—åŒ–ç»“æ„</p><p>Json</p><p>Protobuf</p><h2 id="Json"><a href="#Json" class="headerlink" title="Json"></a>Json</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JsonMsg</span>&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> id ;<br><span class="hljs-keyword">private</span> String content ;<br><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">convertToJson</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-keyword">return</span> JsonUtil.PojoToJson(<span class="hljs-built_in">this</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> JsonMsg <span class="hljs-title function_">parseFromJson</span><span class="hljs-params">(String json)</span>&#123;<br><span class="hljs-keyword">return</span> JsonUtil.jsonToPoJo(json,JsonMsg.class);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ„å»ºjsonå¯¹è±¡ï¼Œç¼–è§£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JsonMsgDemo</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JsonMsgDemo</span>&#123;<br><span class="hljs-type">JsonMsg</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonMsg</span>();<br>user.setId(<span class="hljs-number">1000</span>);<br>user.setContent(<span class="hljs-string">&quot;Something&quot;</span>);<br><span class="hljs-keyword">return</span> user ;<br>&#125;<br>&#125;<br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAndDesr</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br><span class="hljs-type">JsonMsg</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> buildMsg();<br><span class="hljs-type">String</span> <span class="hljs-variable">json</span> <span class="hljs-operator">=</span> message.convertToJson();<br>Logger.info(<span class="hljs-string">&quot;json:=&quot;</span> + json);<br><span class="hljs-type">JsonMsg</span> <span class="hljs-variable">inMsg</span> <span class="hljs-operator">=</span> JsonMsg.parseFromJson(json);<br>Logger.info(<span class="hljs-string">&quot;id=&quot;</span> + inMsg.getId());<br>Logger.info(<span class="hljs-string">&quot;content:=&quot;</span> + inMsg.getContent());<br>&#125;<br></code></pre></td></tr></table></figure><p>jsonçš„è§£ææ­¥éª¤ä»ç„¶æ˜¯ Head-Content â†’ å°†å­—èŠ‚ç è½¬æ¢ä¸ºå­—ç¬¦ä¸² â†’ å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºåºåˆ—åŒ–å¯¹è±¡ â†’ æå–å¯¹åº”çš„å€¼ã€‚</p><h2 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æœåŠ¡ç«¯</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JsonServer</span> &#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">runServer</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossLoopGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">1</span>);<br><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workerLoopGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();<br><span class="hljs-keyword">try</span> &#123;<br>...<br>b.childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;Socket Channel&gt;()&#123;<br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span>&#123;<br>  ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LengthFieldBasedFrameDecoder</span>(<span class="hljs-number">1024</span>,<span class="hljs-number">0</span>,<span class="hljs-number">4</span>,<span class="hljs-number">0</span>,<span class="hljs-number">4</span>));<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringDecoder</span>(CharsetUtil.UTF_8));<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonMsgDecoder</span>());<br>&#125;<br>&#125;);<br>&#125;<br>&#125;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageDecodeer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span>&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg)</span>...&#123;<br><span class="hljs-type">String</span> <span class="hljs-variable">json</span> <span class="hljs-operator">=</span>(String)msg;<br><span class="hljs-type">JsonMsg</span> <span class="hljs-variable">jsonMsg</span> <span class="hljs-operator">=</span> JsonMsg.parseFromJson(json);<br>Logger.info(<span class="hljs-string">&quot;æ”¶åˆ°ä¸€ä¸ªæ•°æ®åŒ…&quot;</span> + jsonMsg);<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException&#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">port</span> <span class="hljs-operator">=</span> NettyDemoConfig.SOCKET_SERVER_PORT ;<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonServer</span>(port).runServer();<br>&#125;<br><br>&#125;<br><br><span class="hljs-comment">// å®¢æˆ·ç«¯</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JsonSendClient</span> &#123;<br><span class="hljs-keyword">static</span> <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Something&quot;</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">runClient</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workerLoopGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();<br><span class="hljs-keyword">try</span> &#123;<br>...<br>b.handler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;()&#123;<br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span>... &#123;<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LengthFieldPrepender</span>(<span class="hljs-number">4</span>));<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringEncoder</span>(CharsetUtil.UTF_8));<br>&#125;<br>&#125;);<br><span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">f</span> <span class="hljs-operator">=</span> b.connect();<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">1000</span> ; i++)&#123;<br><span class="hljs-type">JsonMsg</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> build(i, i+ <span class="hljs-string">&quot;-&gt;&quot;</span> + content);<br>channel.writeAndFlush(user.convertToJson());<br>Logger.info(<span class="hljs-string">&quot;å‘é€æŠ¥æ–‡ï¼š &quot;</span>+ user.convertToJson());<br>&#125;<br>channel.flush();<br><span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">closeFuture</span> <span class="hljs-operator">=</span> channel.closeFuture();<br>closeFuture.sync();<br>&#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>e.printStackTrace();<br>&#125;<span class="hljs-keyword">finally</span>&#123;<br> ...<br>&#125;<br>&#125;<br><span class="hljs-keyword">public</span> JsonMsg <span class="hljs-title function_">build</span><span class="hljs-params">(<span class="hljs-type">int</span> id, String content)</span>&#123;<br><span class="hljs-type">JsonMsg</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonMsg</span>();<br>user.setId(id);<br>user.setContent(content);<br><span class="hljs-keyword">return</span> user ;<br>&#125;<br>...<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="Protobuf"><a href="#Protobuf" class="headerlink" title="Protobuf"></a>Protobuf</h1><p>æ ¼å¼å®šä¹‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ ¼å¼å®šä¹‰</span><br><span class="hljs-comment">// [å¼€å§‹å¤´éƒ¨å£°æ˜]</span><br>syntax = <span class="hljs-string">&quot;proto3&quot;</span>,<br><span class="hljs-comment">// [å¤´éƒ¨å£°æ˜ç»“æŸ]</span><br><br><span class="hljs-comment">// [å¼€å§‹Javaé€‰é¡¹é…ç½®]</span><br><span class="hljs-type">option</span> <span class="hljs-variable">java_package</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;com.codfish.netty.protocol&quot;</span>;<br><span class="hljs-type">option</span> <span class="hljs-variable">java_outer_classname</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;MsgProtos&quot;</span>;<br><span class="hljs-comment">// [Javaé€‰é¡¹é…ç½®ç»“æŸ]</span><br><br><span class="hljs-comment">// [å¼€å§‹æ¶ˆæ¯å®šä¹‰]</span><br>message Msg &#123;<br><span class="hljs-type">uint32</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> ;<br><span class="hljs-type">string</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span> ;<br>&#125;<br><span class="hljs-comment">// [æ¶ˆæ¯å®šä¹‰ç»“æŸ]</span><br></code></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šè¿°å®šä¹‰æ ¼å¼ å®šä¹‰å‡ºå¯¹åº”çš„.protobufæ–‡ä»¶ï¼Œå†é€šè¿‡å‘mavenä¸­å®‰è£…æ’ä»¶ï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å°†æ‰€æœ‰çš„protobufæ–‡ä»¶ï¼Œä½œä¸ºPOJOç±»åŠ è½½åˆ°è™šæ‹Ÿæœºä¸­ï¼Œå…è®¸å¯¹å…¶è°ƒç”¨ã€‚</p><h2 id="åºåˆ—åŒ–è¿‡ç¨‹"><a href="#åºåˆ—åŒ–è¿‡ç¨‹" class="headerlink" title="åºåˆ—åŒ–è¿‡ç¨‹"></a>åºåˆ—åŒ–è¿‡ç¨‹</h2><p>1 .ä½¿ç”¨toByteArray() æ–¹æ³•å°†å¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚ç æ•°ç»„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProtobufDemo</span> &#123;<br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serAndDesr1</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>MsgProtos.<span class="hljs-type">Msg</span> <span class="hljs-variable">messages</span> <span class="hljs-operator">=</span> buildMsg();<br><span class="hljs-type">byte</span>[] data = message.toByteArray();<br><span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">outputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>();<br>outputStream.write(data);<br>data = outputStream.toByteArray();<br>MsgProtos.<span class="hljs-type">Msg</span> <span class="hljs-variable">inMsg</span> <span class="hljs-operator">=</span> MsgProtos.Msg.parseFrom(data);<br>Logger.info(<span class="hljs-string">&quot;id:= &quot;</span> + inMsg.getId());<br>Logger.info(<span class="hljs-string">&quot;content:= &quot;</span> + inMsg.getContent());<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>ä½¿ç”¨æ–¹æ³•å°†POJOå¯¹è±¡è¯»å‡º&#x2F;å†™å…¥ IOæµ</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProtobufDemo</span>&#123;<br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serAndDesr2</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException&#123;<br>MsgProtos.<span class="hljs-type">Msg</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> buildMsg();<br><span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">outputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>();<br>message.writeTo(outputStream);<br><span class="hljs-type">ByteArrayInputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayInputStream</span>(outputStream.toByteArray());<br>MsgProtos.<span class="hljs-type">Msg</span> <span class="hljs-variable">inMsg</span> <span class="hljs-operator">=</span> MsgProtos.Msg.parseFrom(inputStream);<br>Logger.info(<span class="hljs-string">&quot;id:= &quot;</span> + inMsg.getId());<br>Logger.info(<span class="hljs-string">&quot;content:=&quot;</span> + inMsg.getContent());<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>ä½¿ç”¨writeDelimitedTo(OutputStream) å‘è¾“å‡ºç§åŠ å…¥ å­—èŠ‚æ•°ç»„é•¿åº¦å­—æ®µ</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProtobufDemo</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serAndDesr3</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException&#123;<br>MsgProtos.<span class="hljs-type">Msg</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> buildMsg();<br><span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">outputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>();<br>message.writeDelimitedTo(outputStream) ;<br><span class="hljs-type">ByteArrayInputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayInputStream</span>(outputStream.toByteArray());<br>MsgProtos.<span class="hljs-type">Msg</span> <span class="hljs-variable">inMsg</span> <span class="hljs-operator">=</span> MsgProtos.Msg.parseDelimited(inputStream);<br>Logger.info(<span class="hljs-string">&quot;id:=&quot;</span> + inMsg.getId());<br>Logger.info(<span class="hljs-string">&quot;content:=&quot;</span> + inMsg.getContent());<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Protobuf-è§£ç å™¨"><a href="#Protobuf-è§£ç å™¨" class="headerlink" title="Protobuf è§£ç å™¨"></a>Protobuf è§£ç å™¨</h2><ol><li>ProtobufDecoder å’Œ ProtobufEncoder ç¼–è§£ç å™¨ æä¾› å­—èŠ‚æ•°ç»„åˆ°å­—ç¬¦æ•°ç»„çš„è½¬æ¢è¿‡ç¨‹</li><li>ProtobufVarint32LengthFieldPrepender é•¿åº¦ç¼–ç å™¨ ï¼Œå‰ç½®ä¸€ä¸ªæ•°ç»„é•¿åº¦å€¼ï¼Œåœ¨ç¼–ç å®Œæˆåå¡«å……</li><li>ProtobufVarint32FrameDecoder é•¿åº¦è§£ç å™¨</li></ol><h2 id="åŸºäºprotobufçš„-C-S-æ¶æ„æ¡ˆä¾‹"><a href="#åŸºäºprotobufçš„-C-S-æ¶æ„æ¡ˆä¾‹" class="headerlink" title="åŸºäºprotobufçš„ C-S æ¶æ„æ¡ˆä¾‹"></a>åŸºäºprotobufçš„ C-S æ¶æ„æ¡ˆä¾‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æœåŠ¡ç«¯</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProtoBufserver</span>&#123;<br><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossLoopGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();<br><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workerLoopGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>() ;<br><span class="hljs-keyword">try</span> &#123;<br>b.childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;()&#123;<br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span>&#123;<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProtobufVarint32FrameDecoder</span>());<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProtobufDecoder</span>(MsgProtos.Msg.getDefaultInstance()));<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProtobufBussinessDecoder</span>());<br>&#125;<br>&#125;);<br>&#125;<br><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProtobufBussinessDecoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span>&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx , Object msg )</span>...&#123;<br>MsgProtos.<span class="hljs-type">Msg</span> <span class="hljs-variable">protoMsg</span> <span class="hljs-operator">=</span> (MsgProtos.Msg)msg ;<br>Logger.info(<span class="hljs-string">&quot;æ”¶åˆ°ä¸€ä¸ªprotobuf&quot;</span>) ;<br>&#125;<br>&#125;<br>&#125;<br><br><span class="hljs-comment">// å®¢æˆ·ç«¯</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProtoBufSendClient</span>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Something&quot;</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">runClient</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workerLoopGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();<br><span class="hljs-keyword">try</span>&#123;<br><span class="hljs-comment">// ..</span><br>b.childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;()&#123;<br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span>...&#123;<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProtobufVarint32LengthFieldPrepender</span>());<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProtobufEncoder</span>());<br>&#125;);<br><span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">f</span> <span class="hljs-operator">=</span> b.connect();<br>f.sync();<br><span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> f.channel();<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">1000</span> ; i ++ )&#123;<br>MsgProtos.<span class="hljs-type">Msg</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> build(i, i + <span class="hljs-string">&quot;-&gt;&quot;</span> + content);<br>channel.writeAndFlush(user);<br>Logger.info(<span class="hljs-string">&quot;å‘é€æŠ¥æ–‡æ•°ï¼š&quot;</span> + i);<br>&#125;<br>channel.flush();<br>&#125;<br><span class="hljs-keyword">public</span> MsgProtos.Msg <span class="hljs-title function_">build</span><span class="hljs-params">(<span class="hljs-type">int</span> id ,String content )</span>&#123;<br>MsgProtos.Msg.<span class="hljs-type">Builder</span> <span class="hljs-variable">builder</span> <span class="hljs-operator">=</span> MsgProtos.Msg.newBuilder();<br>builder.setId(id);<br>builder.setContent(content);<br><span class="hljs-keyword">return</span> builder.build();<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException&#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">port</span> <span class="hljs-operator">=</span> NettyDemoConfig.SOCKET_SERVER_PORT;<br><span class="hljs-type">String</span> <span class="hljs-variable">ip</span> <span class="hljs-operator">=</span> NettyDemoConfig.SOCKET_SERVER_IP;<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">ProtoBufSendClient</span>(ip,port).runClient();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaç¼–ç¨‹ VIII Netty</title>
    <link href="/2025/05/08/Java%E7%BC%96%E7%A8%8B-VIII-Netty/"/>
    <url>/2025/05/08/Java%E7%BC%96%E7%A8%8B-VIII-Netty/</url>
    
    <content type="html"><![CDATA[<h1 id="Reactoræ¨¡å¼"><a href="#Reactoræ¨¡å¼" class="headerlink" title="Reactoræ¨¡å¼"></a>Reactoræ¨¡å¼</h1><p>Reactor çº¿ç¨‹ ï¼š è´Ÿè´£å“åº”IO äº‹ä»¶ï¼Œå¹¶åˆ†å‘åˆ°Handlerså¤„ç†å™¨</p><p>Handlers å¤„ç†å™¨ ï¼š éé˜»å¡çš„æ‰§è¡Œä¸šåŠ¡å¤„ç†é€»è¾‘</p><h2 id="Connection-Per-Thread-æ¨¡å¼"><a href="#Connection-Per-Thread-æ¨¡å¼" class="headerlink" title="Connection Per Thread æ¨¡å¼"></a>Connection Per Thread æ¨¡å¼</h2><p>æ¯å½“æ”¶åˆ°ä¸€ä¸ªsocketè¯·æ±‚ã€‚ä¸ºå¯¹åº”è¯·æ±‚å•ç‹¬åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¥è¿›è¡Œ æ•°æ®çš„æ”¶å‘å¤„ç†ã€‚</p><p>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œä¼šåˆ›é€ å‡ºå¤§é‡çš„çº¿ç¨‹ï¼Œ çº¿ç¨‹çš„åˆ›å»ºï¼Œé”€æ¯ï¼Œåˆ‡æ¢ä¼šæ¶ˆè€—å¤§é‡èµ„æº</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConnectionPerThread</span>  <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-type">ServerSocket</span> <span class="hljs-variable">serverSocket</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerSocket</span>(NioDemoConfig.SOCKET_SERVER_PORT);<br><span class="hljs-keyword">while</span>(!Thread.interrupted())&#123;<br><span class="hljs-type">Socket</span> <span class="hljs-variable">socket</span> <span class="hljs-operator">=</span> serverSocket.accept();<br><span class="hljs-type">Handler</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>(socket);<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(handler).start();<br>&#125;<br><br>&#125;<span class="hljs-keyword">catch</span>(IOException ex) &#123;<br>   ...<br>&#125;<br>  <br>&#125;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Handler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br><span class="hljs-keyword">final</span> Socket socket ;<br>Handler(Socket s )&#123;<br>socket = s ;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>)&#123;<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-type">byte</span>[]  input = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">1024</span>];<br>socket.getInputStream().read(input);<br> <span class="hljs-type">byte</span>[]  output = <span class="hljs-literal">null</span>;<br> socket.getOutputStream().write(output)<br>&#125;<span class="hljs-keyword">catch</span> (IOException e) &#123;<br>...<br>&#125;<br>&#125;<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å•çº¿ç¨‹Reactor"><a href="#å•çº¿ç¨‹Reactor" class="headerlink" title="å•çº¿ç¨‹Reactor"></a>å•çº¿ç¨‹Reactor</h2><p>å°†Reactor ä¸ Handlers æ”¾å…¥åŒä¸€ä¸ªçº¿ç¨‹ä¸­</p><p>void attach(Object o)</p><p>å°†å¯¹è±¡é™„åŠ åˆ°é€‰æ‹©é”®</p><p>Object attachment()</p><p>ä»é€‰æ‹©é”®ä¸­å–å‡ºå¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">EchoServerReactor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>Selector selector ;<br>ServerSocketChannel serverSocket ;<br>EchoServerReactor() <span class="hljs-keyword">throws</span> IOException&#123;<br><span class="hljs-comment">// ... æ‰“å¼€é€‰æ‹©å™¨ï¼ŒserverSocket è¿æ¥ç›‘å¬é€šé“</span><br><span class="hljs-comment">// æ³¨å†ŒserverSocketçš„accept ç›‘å¬äº‹ä»¶</span><br><span class="hljs-type">SelectionKey</span> <span class="hljs-variable">sk</span> <span class="hljs-operator">=</span> serverSocket.register(selector,SelectionKey.OP_ACCEPT);<br>sk.attach(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AcceptorHandler</span>());<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span> <span class="hljs-params">()</span> &#123;<br><span class="hljs-comment">// é€‰æ‹©å™¨è½®è¯¢</span><br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-keyword">while</span>(!Thread.interrupted())&#123;<br>selector.select();<br><span class="hljs-type">Set</span> <span class="hljs-variable">selected</span> <span class="hljs-operator">=</span> selector.selectedKeys();<br><span class="hljs-type">Iterator</span> <span class="hljs-variable">it</span> <span class="hljs-operator">=</span> selected.iterator();<br><span class="hljs-keyword">while</span>(it.hasNext())&#123;<br><span class="hljs-type">SelectionKey</span> <span class="hljs-variable">sk</span> <span class="hljs-operator">=</span> it.next();<br>dispatch(sk);<br>&#125;<br>selected.clear();<br>&#125;<br>&#125;<span class="hljs-keyword">catch</span>(IOException ex) &#123; ex.printStackTrace();&#125;<br>&#125;<br><span class="hljs-keyword">void</span> <span class="hljs-title function_">dispatch</span><span class="hljs-params">(SelectionKey k)</span>&#123;<br><span class="hljs-type">Runnable</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> (Runnable)(k.attachment());<br><span class="hljs-keyword">if</span>(handler != <span class="hljs-literal">null</span>)&#123;<br>handler.run()<br>&#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AcceptorHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-type">SocketChannel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> serverSocket.accept();<br><span class="hljs-keyword">if</span> (channel != <span class="hljs-literal">null</span>) <span class="hljs-keyword">new</span> <span class="hljs-title class_">EchoHandler</span>(selector,channel);<br>&#125;<br><br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>å•çº¿ç¨‹Reactor çš„å®ç°é€»è¾‘æ˜¯ï¼Œ å®šä¹‰äº†ç›‘å¬å™¨selector å’Œé€šé“ï¼Œå…ˆæ³¨å†Œä¸€ä¸ªACCEPTäº‹ä»¶æ”¾å…¥Selectorä¸­ï¼Œå½“ç›‘å¬åˆ°æœ‰socketè¿æ¥è¯·æ±‚åï¼Œè§¦å‘å…¶æ‰€é™„å¸¦çš„ç¨‹åºæ¥åˆ›å»ºæ–°çš„channel ç”¨äºå¤„ç†æ–°çš„è¿æ¥è¯·æ±‚ï¼Œå¹¶å°†è¯¥é€šé“åŒæ ·åŠ å…¥åˆ°selectorä¸­ï¼Œè¿™æ ·åœ¨åç»­çš„select() é˜»å¡ä¸­ å³å¯ä»¥ç»§ç»­ç›‘å¬OP_ACCEPTè¯·æ±‚åˆ›å»ºæ–°çš„è¯»å–é€šé“ï¼Œä¹Ÿå¯ä»¥ç›‘å¬è¯»å–é€šé“çš„å°±ç»ªçŠ¶æ€ï¼Œæ¥è¯»å–æ•°æ®</p><p>Reactor :   ç›‘å¬ACCEPTäº‹ä»¶çš„å¤„ç†ç¨‹åº</p><p>Handlers :   è§¦å‘ACCEPTäº‹ä»¶åæ–°åˆ›å»ºçš„ç”¨äºå¤„ç†OP_READçš„å¤„ç†ç¨‹åº</p><p>ç¼ºç‚¹ ï¼š å½“æŸä¸ªHandlersé˜»å¡åï¼Œä¼šå¯¼è‡´çš„æ‰€æœ‰çš„Handleréƒ½è¢«é˜»å¡ï¼Œç”šè‡³å½±å“OP_ACCEPTçš„ç›‘å¬</p><h2 id="å¤šçº¿ç¨‹Reactor"><a href="#å¤šçº¿ç¨‹Reactor" class="headerlink" title="å¤šçº¿ç¨‹Reactor"></a>å¤šçº¿ç¨‹Reactor</h2><p>å°† Handlers ä¸Reactor çº¿ç¨‹éš”ç¦»ï¼Œ å‡å°‘Handlersé˜»å¡æ—¶ï¼Œå¯¹OP_ACCEPTå¤„ç†çš„å½±å“</p><p>åˆ›å»ºå­ååº”å™¨å……åˆ†åˆ©ç”¨å¤šæ ¸å¿ƒèµ„æº</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MultiThreadEchoServerReactor</span>&#123;<br>ServerSocketChannel serverSocket ;<br><span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);<br>Selector[] selectors = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Selector</span>[<span class="hljs-number">2</span>];<br>SubReactor[] subReactors = <span class="hljs-literal">null</span> ;<br>MultiThreadEchoServerReactor() <span class="hljs-keyword">throws</span> IOException &#123;<br>selectors[<span class="hljs-number">0</span>] = Selector.open();<br>selectors[<span class="hljs-number">1</span>] = Selector.open();<br>serverSocket = ServerSocketChannel.open();<br><span class="hljs-type">InetSocketAddress</span> <span class="hljs-variable">address</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">18899</span>);<br>serverSocket.socket().bind(address);<br>serverSocket.configureBlocking(<span class="hljs-literal">false</span>);<br><span class="hljs-type">SelectionKey</span> <span class="hljs-variable">sk</span> <span class="hljs-operator">=</span> serverSocket.register(selectors[<span class="hljs-number">0</span>],OP_ACCEPT);<br>sk.attach(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AcceptorHandler</span>());<br><span class="hljs-type">SubReactor</span> <span class="hljs-variable">subReactor1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SubReactor</span>(selectors[<span class="hljs-number">0</span>]);<br><span class="hljs-type">SubReactor</span> <span class="hljs-variable">subReactor2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SubReactor</span>(selectors[<span class="hljs-number">1</span>]);<br>subReactors = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SubReactor</span>[]&#123;subReactor1,subReactor2&#125;;<br>&#125;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startService</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(subReactors[<span class="hljs-number">0</span>].start());<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(subReactors[<span class="hljs-number">1</span>].start());<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SubReactor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br><span class="hljs-keyword">final</span> Selector selector ;<br><span class="hljs-keyword">public</span> <span class="hljs-title function_">SubReactor</span><span class="hljs-params">(Selector selector)</span>&#123;<br><span class="hljs-built_in">this</span>.selector  = selector ;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-keyword">while</span> (! Thread.interrupted())&#123;<br>selector.select();<br>Set&lt;SelectionKey&gt; keySet = selector.selectedKeys();<br>Iterator&lt;SelectionKey&gt; it = keySet.iterator();<br><span class="hljs-keyword">while</span>(it.hasNext())&#123;<br><span class="hljs-type">SelectionKey</span> <span class="hljs-variable">sk</span> <span class="hljs-operator">=</span> it.next();<br>dispatch(sk);<br>&#125; <br>keySet.clear();<br>&#125;<br>            &#125;<span class="hljs-keyword">catch</span>(IOException e)&#123;<br>ex.printStackTrace();<br>&#125;<br>&#125;<br><span class="hljs-keyword">void</span>  <span class="hljs-title function_">dispatch</span><span class="hljs-params">(SelectionKey sk)</span>&#123;<br><span class="hljs-type">Runnable</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> (Runnable)sk.attachment();<br><span class="hljs-keyword">if</span>(handler != <span class="hljs-literal">null</span>)&#123;<br>handler.run();<br>&#125;<br>&#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AcceptorHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-type">SocketChannel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> serverSocket.accept();<br><span class="hljs-keyword">if</span> (channel != <span class="hljs-literal">null</span>) <span class="hljs-keyword">new</span> <span class="hljs-title class_">MultiThreadEchoHandler</span>(selectors[<span class="hljs-number">1</span>],channel);<br>&#125;<span class="hljs-keyword">catch</span> (IOException e)&#123;<br>e.printStackTrace();<br>&#125;<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args )</span> <span class="hljs-keyword">throws</span> IOException&#123;<br><span class="hljs-type">MultiThreadEchoServerReactor</span> <span class="hljs-variable">server</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MultiThreadEchoServerReactor</span>();<br>server.startService();<br><br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="Netty"><a href="#Netty" class="headerlink" title="Netty"></a>Netty</h1><p>Netty æ˜¯ä¸€ä¸ªåŸºäºJava NIOåº“çš„é«˜æ€§èƒ½ç½‘ç»œæ¡†æ¶</p><p>Nettyä¸­æä¾›äº†ä¸€ä¸ª é›†æˆå™¨ ServerBootstrap ç”¨äºå¯¹æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹è¿›è¡Œé…ç½®ã€‚</p><p>é€šè¿‡åˆ›å»ºEventLoopGroup ç»„ æ¥åˆ›å»ºä¸åŒçš„reactor å’Œ handler</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyDiscardServer</span> &#123;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> serverPort ;<br><span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();<br><span class="hljs-keyword">public</span> <span class="hljs-title function_">NettyDiscardServer</span><span class="hljs-params">(<span class="hljs-type">int</span> port)</span> &#123;<br><span class="hljs-built_in">this</span>.serverPort = port ;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">runServer</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossLoopGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">1</span>);<br><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workerLoopGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();<br><span class="hljs-keyword">try</span> &#123;<br>b.group(bossLoopGroup , workerLoopGroup);<br>b.channel(NioServerSocketChannel.class);<br>b.localAddress(serverPort);<br>b.option(ChannelOption.SO_KEEPALIVE, <span class="hljs-literal">true</span>);<br>b.childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;()&#123;<br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span> <span class="hljs-params">(SocketChannel ch)</span>&#123;<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyDiscardHandler</span>());<br>&#125;<br>&#125;);<br><span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">channelFuture</span> <span class="hljs-operator">=</span> b.bind().sync();<br>Logger.info(<span class="hljs-string">&quot;æœåŠ¡å™¨å¯åŠ¨&quot;</span>);<br><span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">closeFuture</span> <span class="hljs-operator">=</span> channelFuture.channel().closeFuture();<br>closeFuture.sync();<br>&#125; <span class="hljs-keyword">catch</span> (Exception e)&#123;<br>e.printStackTrace();<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br>workerLoopGroup.shutdownGracefully();<br>bossLoopGroup.shutdownGracefully();<br>&#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">port</span> <span class="hljs-operator">=</span>NettyDemoConfig.SOCKET_SERVER_PORT;<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyDiscardServer</span>(port).runServer();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Nettyä¸­æ ¹æ®ä¸åŒçš„åè®®å®šä¹‰äº†ä¸åŒåè®®ç±»å‹channel</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">NioSocketChannel  å¼‚æ­¥éé˜»å¡TCP Socket é€šé“<br>NioServerSocketChannel  å¼‚æ­¥éé˜»å¡TCP Socket æœåŠ¡ç«¯ç›‘å¬é€šé“<br>NioDatagramChannel  å¼‚æ­¥éé˜»å¡ UDP ä¼ è¾“é€šé“<br>NioSctpChannel å¼‚æ­¥éé˜»å¡ Sctp ä¼ è¾“é€šé“<br>NioSctpServerChannel å¼‚æ­¥éé˜»å¡ Sctp æœåŠ¡ç«¯ç›‘å¬é€šé“<br>OioSocketChannel  åŒæ­¥éé˜»å¡TCP Socket é€šé“<br>OioServerSocketChannel  åŒæ­¥éé˜»å¡TCP Socket æœåŠ¡ç«¯ç›‘å¬é€šé“<br>OioDatagramChannel  åŒæ­¥éé˜»å¡ UDP ä¼ è¾“é€šé“<br>OioSctpChannel åŒæ­¥éé˜»å¡ Sctp ä¼ è¾“é€šé“<br>OioSctpServerChannel åŒæ­¥éé˜»å¡ Sctp æœåŠ¡ç«¯ç›‘å¬é€šé“<br></code></pre></td></tr></table></figure><h2 id="Nettyä¸­çš„-Reactor"><a href="#Nettyä¸­çš„-Reactor" class="headerlink" title="Nettyä¸­çš„ Reactor"></a>Nettyä¸­çš„ Reactor</h2><p>Netty ååº”å™¨ä¸­è£…è½½äº†ä¸¤ä¸ªå±æ€§</p><p>SingleThreadEventExecutor (Thread) ç”¨äº å…·ä½“çš„ é€šé“å¤„ç†</p><p>NioEventLoop (Selector) ç”¨äºç›‘å¬æ³¨å†Œåˆ°è¯¥é€‰æ‹©å™¨ä¸­çš„ é€šé“å°±ç»ªçŠ¶æ€</p><p>ä¸€ä¸ªEventLoop å¯ä»¥æ³¨å†Œå¤šä¸ªé€šé“</p><h2 id="Nettyä¸­çš„-Handler"><a href="#Nettyä¸­çš„-Handler" class="headerlink" title="Nettyä¸­çš„ Handler"></a>Nettyä¸­çš„ Handler</h2><p>Nettyä¸­çš„Handler åŒ…å« ChannelInboundHandler å’Œ ChannelOutboundHandler</p><p>ChannelInboundHandler   é€šè¿‡ å®ç° ChannelInboundHandlerAdapter æ¥å®Œæˆï¼Œç”¨äºå¤„ç†æ¥æ”¶åˆ°OP_READ äº‹ä»¶</p><p>ChannelOutboundHandler   é€šè¿‡ å®ç° ChannelOutboundHandlerAdapter æ¥å®Œæˆï¼Œç”¨äºå¤„ç†æ¥æ”¶åˆ°OP_WRITE äº‹ä»¶</p><h2 id="Nettyä¸­çš„pipeline"><a href="#Nettyä¸­çš„pipeline" class="headerlink" title="Nettyä¸­çš„pipeline"></a>Nettyä¸­çš„pipeline</h2><p>Netty çš„æ¯ä¸ªé€šé“éƒ½é…æœ‰ä¸€ä¸ª ChannelPipelineï¼Œå¯ä»¥ä¸²è”å¤šä¸ª Handlerï¼Œå½¢æˆé“¾å¼å¤„ç†ç»“æ„ã€‚</p><p>å…¶å®šä¹‰äº†ä¸€ä¸ªChannelPipeLine ç±»ï¼Œå…¶æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œæ”¯æŒ ï¼š</p><ol><li>åœ¨æ‰§è¡Œå®ŒæŸä¸ªhandler åï¼Œåç»­ä»å­˜åœ¨å…¶ä»–å¤„ç†å™¨ï¼Œäº¤ç”±åç»­å¤„ç†å™¨ç»§ç»­æ‰§è¡Œ</li><li>å½“åç»­æ²¡æœ‰å…¶ä»–å¤„ç†å™¨åï¼ŒIOäº‹ä»¶å¤„ç†å®Œæˆ</li><li>å½“éœ€è¦åœ¨æŸä¸ªå¤„ç†å™¨ä¸­ä¸­æ­¢å¤„ç†ï¼Œå¯ä»¥å°†æµæ°´çº¿ç»ˆæ­¢æ‰§è¡Œ</li></ol><p>å…¥ç«™ IO äº‹ä»¶åªèƒ½äº¤ç”±Inbound å¤„ç†å™¨å¤„ç† ï¼ˆç”±å‰å¾€åï¼‰</p><p>å‡ºç«™ IO äº‹ä»¶åªèƒ½äº¤ç”±Outbound å¤„ç†å™¨å¤„ç† ï¼ˆç”±åå¾€å‰ï¼‰</p><h2 id="å¼•å¯¼ç±»-Bootstrap"><a href="#å¼•å¯¼ç±»-Bootstrap" class="headerlink" title="å¼•å¯¼ç±» Bootstrap"></a>å¼•å¯¼ç±» Bootstrap</h2><p>Nettyæä¾›äº†å¼•å¯¼ç±» æ¥å¸®åŠ©å®Œæˆ client å’Œserver ç«¯çš„è¿æ¥é…ç½®</p><h2 id="çˆ¶å­é€šé“"><a href="#çˆ¶å­é€šé“" class="headerlink" title="çˆ¶å­é€šé“"></a>çˆ¶å­é€šé“</h2><p>NioServerSocketChannel ç”¨äºè¿›è¡Œ è¿æ¥ç›‘å¬</p><p>NioSocketChannel ç”¨äºè¿›è¡Œ æ•°æ®å¤„ç†</p><p>å¯¹äºNettyæ¥è¯´ è´Ÿè´£è¿æ¥ç›‘å¬çš„å«åšçˆ¶é€šé“ï¼Œè€Œåœ¨è¿æ¥å»ºç«‹åè¿›è¡Œæ•°æ®å¤„ç†çš„é€šé“è¢«ç§°ä¸ºå­é€šé“</p><h2 id="EventLoopGroup"><a href="#EventLoopGroup" class="headerlink" title="EventLoopGroup"></a>EventLoopGroup</h2><p>Netty ä¸­çš„Selector å®ç°æ˜¯å¤šçº¿ç¨‹ç‰ˆæœ¬çš„</p><p>æ¯ä¸€ä¸ªEventLoop ç›¸å½“äºä¸€ä¸ªå­ååº”å™¨</p><p>è€Œ é€šè¿‡EventLoopGroup å¯ä»¥åˆ›å»ºä¸€ä¸ª å­ååº”å™¨ç»„ï¼Œåˆ›å»ºå¤šä¸ªçº¿ç¨‹å’Œå¤šä¸ªååº”å™¨ï¼ˆä¸€ ä¸€å¯¹åº”ï¼‰æ¥è¿›è¡ŒIOäº‹ä»¶çš„æŸ¥è¯¢ï¼Œå¤„ç†ï¼Œåˆ†å‘ã€‚</p><h2 id="Bootstrapå¯åŠ¨ä¸é…ç½®"><a href="#Bootstrapå¯åŠ¨ä¸é…ç½®" class="headerlink" title="Bootstrapå¯åŠ¨ä¸é…ç½®"></a>Bootstrapå¯åŠ¨ä¸é…ç½®</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();  <span class="hljs-comment">// åˆ›å»ºå¼•å¯¼ç±»</span><br><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossLoopGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">1</span>) ; <span class="hljs-comment">// boss è½®è¯¢ç»„ ç›‘å¬è¿æ¥è¯·æ±‚</span><br><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workLoopGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(); <span class="hljs-comment">// worker è½®è¯¢ç»„ å¤„ç†å…·ä½“ä¸šåŠ¡</span><br>b.group(bossLoopGroup,workLoopGroup);  <span class="hljs-comment">// å°† ç»„åŠ å…¥å¼•å¯¼ç±»é…ç½®</span><br>b.channel(NioServerSocketChannel.class);  <span class="hljs-comment">// è®¾ç½®é€šé“IOç±»å‹</span><br>b.localAddress(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(port)); <span class="hljs-comment">// è®¾ç½®ç›‘å¬ç«¯å£</span><br>b.option(ChannelOption.SO_KEEPALIVE, <span class="hljs-literal">true</span>);  <span class="hljs-comment">// é…ç½®é€šé“é€‰é¡¹ï¼Œ è¿™é‡Œè®¾ç½®ä¿æ´»ä¸ºtrue</span><br>b.option(ChannelOption.ALLOCATOR, PooledByteBufAllocator.DEFAULT);  <span class="hljs-comment">//</span><br>b.childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;()&#123;<br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span> &#123;<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyDiscardHandler</span>());  <br>&#125;<br>&#125;)<br><br><span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">channelFuture</span> <span class="hljs-operator">=</span> b.bind().sync();  <span class="hljs-comment">// ç»‘å®šåˆ°å¼‚æ­¥ä»»åŠ¡</span><br>Loggger.info(<span class="hljs-string">&quot;æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ&quot;</span>);   <br><br><span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">closeFuture</span> <span class="hljs-operator">=</span> ChannelFuture.channel().closeFuture();<br>closeFuture.sync();          <span class="hljs-comment">// è‡ªæˆ‘é˜»å¡</span><br><br>workLoopGroup.shutdownGracefully();<br>bossLoopGroup.shutdownGracefully();<br><br></code></pre></td></tr></table></figure><h2 id="ChannelOption"><a href="#ChannelOption" class="headerlink" title="ChannelOption"></a>ChannelOption</h2><h3 id="SO-RCVBUF-SO-SNDBUF"><a href="#SO-RCVBUF-SO-SNDBUF" class="headerlink" title="SO_RCVBUF &#x2F; SO_SNDBUF"></a>SO_RCVBUF &#x2F; SO_SNDBUF</h3><p>è®¾ç½®æ”¶å‘ç¼“å†²åŒºå¤§å°</p><h3 id="TCP-NODELAY"><a href="#TCP-NODELAY" class="headerlink" title="TCP_NODELAY"></a>TCP_NODELAY</h3><p>å³æ—¶å‘é€æ•°æ®</p><h3 id="SO-KEEPALIVE"><a href="#SO-KEEPALIVE" class="headerlink" title="SO_KEEPALIVE"></a>SO_KEEPALIVE</h3><p>ä¿æ´»</p><h3 id="SO-REUSEADDR"><a href="#SO-REUSEADDR" class="headerlink" title="SO_REUSEADDR"></a>SO_REUSEADDR</h3><p>å¤ç”¨åœ°å€</p><h3 id="SO-LINGER"><a href="#SO-LINGER" class="headerlink" title="SO_LINGER"></a>SO_LINGER</h3><h3 id="SO-BACKLOG"><a href="#SO-BACKLOG" class="headerlink" title="SO_BACKLOG"></a>SO_BACKLOG</h3><h2 id="Channel"><a href="#Channel" class="headerlink" title="Channel"></a>Channel</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java">ChannelFuture <span class="hljs-title function_">connect</span><span class="hljs-params">(SocketAddress address)</span><br><span class="hljs-comment">// è¿æ¥è¿œç¨‹æœåŠ¡å™¨</span><br>ChannelFuture <span class="hljs-title function_">bind</span><span class="hljs-params">(SocketAddress address)</span><br><span class="hljs-comment">// ç»‘å®šç›‘å¬åœ°å€</span><br>ChannelFuture <span class="hljs-title function_">close</span><span class="hljs-params">()</span> <br><span class="hljs-comment">// å…³é—­é€šé“</span><br>Channel <span class="hljs-title function_">read</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è¯»å–é€šé“æ•°æ®</span><br>Channel <span class="hljs-title function_">write</span><span class="hljs-params">(Object o)</span><br><span class="hljs-comment">// å†™å…¥é€šé“æ•°æ®</span><br>Channel <span class="hljs-title function_">flush</span><span class="hljs-params">()</span><br><span class="hljs-comment">// ç«‹å³å°†æ•°æ®å†™å…¥å¯¹ç«¯ </span><br></code></pre></td></tr></table></figure><h2 id="Handler"><a href="#Handler" class="headerlink" title="Handler"></a>Handler</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java">ChannelInboundHandler  <span class="hljs-comment">// å…¥ç«™å¤„ç†å™¨</span><br>channelRegistered()<br><span class="hljs-comment">// å°†é€šé“æ³¨å†Œåˆ°é€šé“æµæ°´çº¿ä¸­</span><br>channelActive()<br><span class="hljs-comment">// æ¿€æ´»é€šé“</span><br>channelRead();<br><span class="hljs-comment">// å›è°ƒè¿›è¡Œæ•°æ®è¯»å–</span><br>channelReadComplete()<br><span class="hljs-comment">// é€šçŸ¥ç¼“å†²åŒºè¯»å–å®Œæˆ</span><br>channelInactive()<br><span class="hljs-comment">// è¿æ¥æ–­å¼€æˆ–ä¸å¯ç”¨</span><br>exceptionCaught()<br><span class="hljs-comment">// å¼‚å¸¸æ•è·</span><br><br>ChannelOutboundHandler<br><span class="hljs-title function_">bind</span><span class="hljs-params">()</span> <span class="hljs-comment">// ç›‘å¬åœ°å€ç»‘å®š</span><br>connect() <span class="hljs-comment">// è¿æ¥æœåŠ¡ç«¯</span><br>write() <span class="hljs-comment">// é€šçŸ¥åº•å±‚IOå†™å…¥</span><br>flush() <span class="hljs-comment">// æ¸…ç©ºåº•å±‚ç¼“å­˜åŒºï¼Œç«‹å³å†™å‡ºåˆ°å¯¹ç«¯</span><br>disConnect() <span class="hljs-comment">// æ–­å¼€è¿æ¥</span><br>close() <span class="hljs-comment">// å…³é—­åº•å±‚é€šé“</span><br><br></code></pre></td></tr></table></figure><h2 id="ChannelInitializer"><a href="#ChannelInitializer" class="headerlink" title="ChannelInitializer"></a>ChannelInitializer</h2><p>é€šè¿‡æŠ½è±¡æ¥å£å®Œæˆ å°† æ–°çš„handleræ’å…¥çš„ pipeline çš„è¿‡ç¨‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">b.childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;()&#123;<br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span>&#123;<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyDiscardHandler</span>())<br>&#125;<br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h2><p>pipelineçš„å…¥æ ˆå¤„ç†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InPipeline</span>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleInHandlerA</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span>&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg)</span>... &#123;<br>Logger.info(<span class="hljs-string">&quot;å…¥ç«™å¤„ç†A,è¢«å›è°ƒ&quot;</span>);<br><span class="hljs-built_in">super</span>.channelRead(ctx,msg);<br>&#125;<br>&#125;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleInHandlerB</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span>&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg)</span>... &#123;<br>Logger.info(<span class="hljs-string">&quot;å…¥ç«™å¤„ç†B,è¢«å›è°ƒ&quot;</span>);<br><span class="hljs-built_in">super</span>.channelRead(ctx,msg);<br>&#125;<br>&#125;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleInHandlerC</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span>&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg)</span>... &#123;<br>Logger.info(<span class="hljs-string">&quot;å…¥ç«™å¤„ç†C,è¢«å›è°ƒ&quot;</span>);<br><span class="hljs-built_in">super</span>.channelRead(ctx,msg);<br>&#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testPipelineInBound</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">ChannelInitializer</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;EmbeddedChannel&gt;()&#123;<br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(EmbeddedChannel ch)</span>&#123;<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleInHandlerA</span>() );<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleInHandlerB</span>() );<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleInHandlerC</span>() );<br>&#125;<br>&#125;;<br><span class="hljs-type">EmbeddedChannel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">EmbeddedChannel</span>(i);<br><span class="hljs-type">ByteBuf</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> Unpooled.buffer();<br>buf.writeInt(<span class="hljs-number">1</span>);<br>channel.writeInbound(buf);<br>&#125;<br>&#125;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">è¾“å‡º</span><br><span class="hljs-comment">å…¥ç«™å¤„ç†å™¨A : è¢«å›è°ƒ</span><br><span class="hljs-comment">å…¥ç«™å¤„ç†å™¨B : è¢«å›è°ƒ</span><br><span class="hljs-comment">å…¥ç«™å¤„ç†å™¨C : è¢«å›è°ƒ</span><br><span class="hljs-comment">*/</span><br><br></code></pre></td></tr></table></figure><p>pipeline å‡ºç«™å¤„ç†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InPipeline</span>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleOuthandlerA</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelOutboundHandlerAdapter</span>&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelWrite</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg, ChannelPromise promise)</span>... &#123;<br>Logger.info(<span class="hljs-string">&quot;å‡ºç«™å¤„ç†A,è¢«å›è°ƒ&quot;</span>);<br><span class="hljs-built_in">super</span>.channelWrite(ctx,msg,promise);<br>&#125;<br>&#125;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleOutHandlerB</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelOutboundHandlerAdapter</span>&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelWrite</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg, ChannelPromise promise)</span>... &#123;<br>Logger.info(<span class="hljs-string">&quot;å‡ºç«™å¤„ç†B,è¢«å›è°ƒ&quot;</span>);<br><span class="hljs-built_in">super</span>.channelWrite(ctx,msg,promise);<br>&#125;<br>&#125;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleOutHandlerC</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelOutboundHandlerAdapter</span>&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelWrite</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg, ChannelPromise promise)</span>... &#123;<br>Logger.info(<span class="hljs-string">&quot;å‡ºç«™å¤„ç†C,è¢«å›è°ƒ&quot;</span>);<br><span class="hljs-built_in">super</span>.channelWrite(ctx,msg,promise);<br>&#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testPipelineInBound</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">ChannelInitializer</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;EmbeddedChannel&gt;()&#123;<br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(EmbeddedChannel ch)</span>&#123;<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleInHandlerA</span>() );<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleInHandlerB</span>() );<br>ch.pipeline().addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleInHandlerC</span>() );<br>&#125;<br>&#125;;<br><span class="hljs-type">EmbeddedChannel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">EmbeddedChannel</span>(i);<br><span class="hljs-type">ByteBuf</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> Unpooled.buffer();<br>buf.writeInt(<span class="hljs-number">1</span>);<br>channel.writeOutbound(buf);<br>&#125;<br>&#125;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">è¾“å‡º</span><br><span class="hljs-comment">å…¥ç«™å¤„ç†å™¨C : è¢«å›è°ƒ</span><br><span class="hljs-comment">å…¥ç«™å¤„ç†å™¨B : è¢«å›è°ƒ</span><br><span class="hljs-comment">å…¥ç«™å¤„ç†å™¨A : è¢«å›è°ƒ</span><br><span class="hljs-comment">*/</span><br><br></code></pre></td></tr></table></figure><h3 id="ä¸Šä¸‹æ–‡-ChannelHandlerContext"><a href="#ä¸Šä¸‹æ–‡-ChannelHandlerContext" class="headerlink" title="ä¸Šä¸‹æ–‡ ChannelHandlerContext"></a>ä¸Šä¸‹æ–‡ ChannelHandlerContext</h3><p>Nettyä¸­çš„Handler æ˜¯æ— çŠ¶æ€çš„ï¼Œé€šè¿‡ä¸Šä¸‹æ–‡æ¥ç»´æŠ¤</p><p>Channel  Channelpipeline å’Œ ChannelHandlerContext çš„å…³ç³»</p><p>Channel   - &gt;  é€šé“ æ ‡è¯†æŸä¸€ä¸ªsocketè¿æ¥</p><p>Channelpipeline - &gt;  ä¸€æ¡æµæ°´çº¿ ç”¨äºå¯¹channelä¸­çš„æ•°æ®è¿›è¡Œå¤„ç†</p><p>ChannelHandlerContext - &gt; æµæ°´çº¿çš„èŠ‚ç‚¹ï¼Œç”¨äºç»´æŠ¤çŠ¶æ€ä¿¡æ¯å’ŒHandler</p><h3 id="HeadContext-ä¸-TailContext"><a href="#HeadContext-ä¸-TailContext" class="headerlink" title="HeadContext ä¸ TailContext"></a>HeadContext ä¸ TailContext</h3><p>TailContext  æ—¢ä½œä¸ºä¸€ä¸ªä¸Šä¸‹æ–‡å­˜å‚¨å¯¹è±¡ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå…¥ç«™å¤„ç†å™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DefaultChannelPipeline</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ChannelPipeline</span> &#123;<br><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TailContext</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractChannelHandlerContext</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ChannelInboundHandler</span> &#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx , Object msg)</span>&#123;<br>...<br>&#125;<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>HeadContext å³éœ€è¦å®ç° ChannelInboudHandler åˆéœ€è¦å®ç°ChannellnboundHandler</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DefaultChannelPipeline</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ChannelPipeline</span>&#123;<br><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HeadContext</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractChannelHandlerContext</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ChannelInboundHandler</span><br>, ChannelOutBoundHandler &#123;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Unsafe unsafe ; <br><span class="hljs-meta">@Override</span> <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx , Object msg)</span>&#123;<br>ctx.fireChannelRead(msg);<br><br>&#125;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">read</span><span class="hljs-params">(ChannelHandlerContext ctx)</span>&#123;<br>unsafe.beginRead();<br>&#125;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">write</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg , ChannelPromise promise)</span>&#123;<br>unsafe.write(msg , promise);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Pipelineçš„ä¼ é€’"><a href="#Pipelineçš„ä¼ é€’" class="headerlink" title="Pipelineçš„ä¼ é€’"></a>Pipelineçš„ä¼ é€’</h3><p>æ¯ä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡é€šè¿‡findContextInbound() æ¥è·å– é“¾è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œä¹‹åé€šè¿‡è°ƒç”¨next.invokeChannelRead(msg) è¿›è¡Œè°ƒç”¨ï¼Œåœ¨è°ƒç”¨çš„invokeChannelæ–¹æ³•ä¸­ï¼Œå†æ¬¡æŸ¥è¯¢ä¸‹ä¸€ä¸ªé“¾è¡¨å¯¹è±¡å¹¶æ‰§è¡Œ</p><h3 id="Pipelineçš„æˆªæ–­"><a href="#Pipelineçš„æˆªæ–­" class="headerlink" title="Pipelineçš„æˆªæ–­"></a>Pipelineçš„æˆªæ–­</h3><p>å¦‚æœæƒ³å¯¹Pipelineè¿›è¡Œæˆªæ–­ åˆ™å¯ä»¥</p><ol><li>ä¸è°ƒç”¨åŸºç±»çš„channelRead ç»ˆæ­¢æµæ°´çº¿</li><li>æˆ–è€…ä¸è°ƒç”¨ctx.fireChannelRead ä¸­æ–­æŸ¥è¯¢åç»­ä¸Šä¸‹æ–‡çš„è¿‡ç¨‹ï¼Œç›´æ¥è¿”å›ã€‚</li></ol><h3 id="æµæ°´çº¿çƒ­æ’æ‹”"><a href="#æµæ°´çº¿çƒ­æ’æ‹”" class="headerlink" title="æµæ°´çº¿çƒ­æ’æ‹”"></a>æµæ°´çº¿çƒ­æ’æ‹”</h3><p>ChannelPipeline æä¾›äº†ä¸€äº›æ–¹æ³•æ¥å¯¹æµæ°´çº¿ä¸­çš„ä¸Šä¸‹æ–‡è¿›è¡Œå¤„ç†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ChannelPipeline</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Iterable</span> &lt;Entry&lt;String,ChannelHandler&gt;&gt;&#123;<br>ChannelPipeline <span class="hljs-title function_">addFirst</span><span class="hljs-params">(String name , ChannelHandler handler )</span>;<br><br>ChannelPipeline <span class="hljs-title function_">addLast</span><span class="hljs-params">(String name , ChannelHandler handler )</span>;<br><br>ChannelPipeline <span class="hljs-title function_">addBefore</span><span class="hljs-params">(String baseName , String name , ChannelHandler handler )</span>;<br><br>ChannelPipeline <span class="hljs-title function_">addAfter</span><span class="hljs-params">(String baseName , String name , ChannelHandler handler )</span>;<br><br>ChannelPipeline <span class="hljs-title function_">remove</span><span class="hljs-params">(ChannelHandler handler )</span>;<br><br>ChannelPipeline <span class="hljs-title function_">remove</span><span class="hljs-params">(String handler )</span>;<br><br>ChannelPipeline <span class="hljs-title function_">removeFirst</span><span class="hljs-params">()</span>;<br><br>ChannelPipeline <span class="hljs-title function_">removeFirst</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ByteBuf"><a href="#ByteBuf" class="headerlink" title="ByteBuf"></a>ByteBuf</h2><p>ByteBuf æ˜¯ä¸€ä¸ªå­—èŠ‚å®¹å™¨ï¼Œå®šä¹‰äº†ä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼Œå¹¶åœ¨å®¹å™¨å†…åˆ†ä¸º4ä¸ªåŒºåŸŸ</p><ol><li>åºŸå¼ƒ ï¼š å·²ç»è¢«ä½¿ç”¨è¿‡çš„å­—èŠ‚å†…å®¹</li><li>å¯è¯» ï¼š å¾…è¢«è¯»å–çš„å­—èŠ‚å†…å®¹</li><li>å¯å†™ ï¼šå¯ä»¥å‘å…¶ä¸­å†™å…¥çš„åŒºåŸŸ</li><li>æ‰©å®¹ ï¼šå‰©ä½™å¾…ä½¿ç”¨çš„åŒºåŸŸ</li></ol><p>ByteBuf é€šè¿‡3ä¸ªå®šä¹‰æŒ‡é’ˆæ¥ ç•Œå®šè¿™å››ä¸ªåŒºåŸŸ</p><p>readerIndex è¯»æŒ‡é’ˆ æ‰€å¤„ä½ç½® å¼€å§‹å¯ä»¥è¯»å–å­—èŠ‚</p><p>writerIndex å†™æŒ‡é’ˆ æ‰€å¤„ä½ç½®  å¼€å§‹å¯ä»¥å†™å…¥å­—èŠ‚</p><p>maxCapacity æœ€å¤§å®¹é‡ å½“å‰ByteBuf æ”¯æŒçš„æœ€å¤§å®¹é‡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ–¹æ³• </span><br><span class="hljs-comment">// å®¹é‡ ï¼š</span><br>capacity() <span class="hljs-comment">// Bytebufçš„å®¹é‡</span><br>maxCapacity() <span class="hljs-comment">// Bytebufæ”¯æŒçš„æœ€å¤§å®¹é‡</span><br><br><span class="hljs-comment">// å†™å…¥</span><br>isWritable()  <span class="hljs-comment">// æ˜¯å¦å¯å†™</span><br>writableBytes()  <span class="hljs-comment">//å¯å†™å…¥çš„å­—èŠ‚æ•°</span><br>maxWritable()  <span class="hljs-comment">// æœ€å¤§å¯å†™å…¥çš„å­—èŠ‚æ•°</span><br>writeBytes(<span class="hljs-type">byte</span>[] src) <span class="hljs-comment">// æŠŠå…¥å‚srcå­—èŠ‚æ•°ç»„ä¸­çš„æ•°æ®å†™å…¥Bytebuf </span><br>writeType()  <span class="hljs-comment">// å†™å…¥æ•°æ®ç±»å‹çš„æ•°æ®</span><br>setType()  <span class="hljs-comment">// è®¾ç½®åŸºç¡€æ•°æ®ç±»å‹</span><br>markWriterIndex()<br>resetWriterIndex() <span class="hljs-comment">// å­˜å‚¨å†™å…¥ä½ç½®æŒ‡é’ˆ / æ¢å¤å†™æŒ‡é’ˆ</span><br><br><span class="hljs-comment">// è¯»å–</span><br>isReadable() <span class="hljs-comment">// æ˜¯å¦å¯è¯»</span><br>readableBytes() <span class="hljs-comment">// å¯è¯»çš„å­—èŠ‚æ•°</span><br>readBytes(<span class="hljs-type">byte</span>[] dst) <span class="hljs-comment">// å°†ByteBufä¸­çš„æ•°æ®è¯»åˆ° æ•°ç»„dstä¸­</span><br>readType() <span class="hljs-comment">// ä»¥æŸç§æ•°æ®ç±»å‹è¯»å–</span><br>getType()  <span class="hljs-comment">// è·å–å½“å‰çš„æ•°æ®ç±»å‹</span><br>markReaderIndex()<br>resetReaderIndex()  <span class="hljs-comment">// å­˜å‚¨å½“å‰çš„è¯»æŒ‡é’ˆ / æ¢å¤è¯»æŒ‡é’ˆ</span><br></code></pre></td></tr></table></figure><h3 id="æ± åŒ–ä¸éæ± åŒ–"><a href="#æ± åŒ–ä¸éæ± åŒ–" class="headerlink" title="æ± åŒ–ä¸éæ± åŒ–"></a>æ± åŒ–ä¸éæ± åŒ–</h3><p>æ± åŒ–å’Œéæ± åŒ–çš„åŒºåˆ«åœ¨äºå†…å­˜çš„åˆ†é…ä¸å›æ”¶ç­–ç•¥ä¸åŒã€‚æ± åŒ–æ˜¯åœ¨åˆå§‹åŒ–æ—¶é¢„å…ˆåˆ†é…ä¸€å—å›ºå®šå¤§å°çš„å†…å­˜åŒºåŸŸï¼Œåç»­çš„ <code>ByteBuf</code> å®ä¾‹å‡é€šè¿‡åœ¨è¿™å—å†…å­˜ä¸­è¿›è¡Œåˆ‡ç‰‡å’Œå¤ç”¨æ¥å®Œæˆåˆ†é…ä¸é‡Šæ”¾ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œéæ± åŒ–åˆ™åœ¨æ¯æ¬¡åˆ›å»º <code>ByteBuf</code> æ—¶éƒ½ç›´æ¥ç”³è¯·æ–°çš„å†…å­˜ï¼Œä½¿ç”¨å®Œæ¯•åå†äº¤ç”±ç³»ç»Ÿé‡Šæ”¾ã€‚</p><p>æ± åŒ–çš„ä¼˜åŠ¿åœ¨äºæ˜¾è‘—å‡å°‘äº†å†…å­˜åˆ†é…å’Œå›æ”¶çš„å¼€é”€ï¼Œé™ä½äº†å†…å­˜ç¢ç‰‡åŒ–é£é™©ï¼Œæå‡äº†æ€§èƒ½ï¼Œé€‚åˆé«˜å¹¶å‘ã€é«˜é¢‘ç‡çš„åœºæ™¯ï¼›ä½†å…¶ç¼ºç‚¹æ˜¯åˆå§‹å†…å­˜å ç”¨è¾ƒé«˜ã€‚éæ± åŒ–è™½ç„¶æŒ‰éœ€åˆ†é…ï¼Œåˆå§‹å†…å­˜å ç”¨å°ï¼Œä½†åœ¨é¢‘ç¹åˆ›å»ºå’Œé”€æ¯æ—¶ä¼šå¸¦æ¥è¾ƒå¤§æ€§èƒ½è´Ÿæ‹…ï¼Œå®¹æ˜“äº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼Œæ›´é€‚ç”¨äºä½é¢‘è®¿é—®æˆ–çŸ­ç”Ÿå‘½å‘¨æœŸçš„ç¼“å­˜åœºæ™¯ã€‚</p><h3 id="å †å†…å­˜å’Œç›´æ¥å†…å­˜ï¼ˆç³»ç»Ÿï¼‰"><a href="#å †å†…å­˜å’Œç›´æ¥å†…å­˜ï¼ˆç³»ç»Ÿï¼‰" class="headerlink" title="å †å†…å­˜å’Œç›´æ¥å†…å­˜ï¼ˆç³»ç»Ÿï¼‰"></a>å †å†…å­˜å’Œç›´æ¥å†…å­˜ï¼ˆç³»ç»Ÿï¼‰</h3><p>åœ¨ç¼“å†²åŒºç®¡ç†ä¸­ï¼Œé™¤äº†æ± åŒ–ä¸éæ± åŒ–çš„åˆ†é…ç­–ç•¥ï¼Œåº•å±‚è¿˜æ¶‰åŠå…·ä½“å†…å­˜ç±»å‹çš„é€‰æ‹©ï¼Œä¸»è¦åˆ†ä¸ºï¼š<strong>Java å †å†…å­˜ï¼ˆheap bufferï¼‰</strong> å’Œ  <strong>ç³»ç»Ÿç›´æ¥å†…å­˜ï¼ˆdirect buffer &#x2F; off-heapï¼‰</strong> ã€‚äºŒè€…åœ¨ä½¿ç”¨ä¸­å„æœ‰ä¼˜åŠ¿ä¸é™åˆ¶ã€‚</p><p>ä½¿ç”¨å †å†…å­˜ï¼ˆHeap Bufferï¼‰</p><p>å †å†…å­˜æ˜¯ JVM ç®¡ç†çš„å†…å­˜ï¼Œ<code>ByteBuf</code> å®ä¾‹å®é™…åˆ†é…åœ¨ Java å †ä¸Šï¼Œå…¶ç”Ÿå‘½å‘¨æœŸç”± GC æ§åˆ¶ã€‚</p><p> <strong>ä¼˜ç‚¹</strong> ï¼š</p><ul><li>åˆ†é…å¼€é”€å°ï¼Œåˆ†é…å¿«ï¼ˆä½¿ç”¨ JVM è‡ªå¸¦çš„å †å†…å­˜åˆ†é…å™¨ï¼‰</li><li>ä¸ JVM æ•°æ®ç»“æ„å…¼å®¹æ€§å¥½ï¼Œè¯»å–æ•°æ®ä¸éœ€è¦é¢å¤–å¤åˆ¶</li><li>GC å¯è‡ªåŠ¨å›æ”¶ï¼Œé€‚åˆç”Ÿå‘½å‘¨æœŸä¸ç¡®å®šçš„ç¼“å­˜</li></ul><p> <strong>ç¼ºç‚¹</strong> ï¼š</p><ul><li><strong>éœ€è¦å°†æ•°æ®ä»å †å¤åˆ¶åˆ°å†…æ ¸ç©ºé—´</strong> ï¼Œæ‰èƒ½é€šè¿‡ <code>SocketChannel.write()</code> ç­‰å‘é€æ•°æ®ï¼ˆå³æ¶‰åŠä¸€æ¬¡å†…å­˜å¤åˆ¶ï¼‰</li><li>åœ¨é«˜é¢‘ IO åœºæ™¯ä¸­å¯èƒ½å¢åŠ  CPU ä½¿ç”¨ç‡å’Œ GC å‹åŠ›</li><li>é•¿æœŸè¿è¡Œä¸­å®¹æ˜“é€ æˆ GC pauseï¼Œå½±å“å®æ—¶æ€§</li></ul><p>ä½¿ç”¨ç³»ç»Ÿç›´æ¥å†…å­˜ï¼ˆDirect Bufferï¼‰</p><p>ç›´æ¥å†…å­˜ä½äº JVM å †å¤–ï¼Œç”±æ“ä½œç³»ç»Ÿç®¡ç†ï¼Œé€šè¿‡ <code>sun.misc.Unsafe</code> æˆ– <code>ByteBuffer.allocateDirect()</code> åˆ†é…ã€‚Netty å°è£…åç”¨äºå®ç°é›¶æ‹·è´ï¼ˆzero-copyï¼‰ä¼ è¾“ã€‚</p><p> <strong>ä¼˜ç‚¹</strong> ï¼š</p><ul><li>é¿å…å †ä¸å†…æ ¸ç¼“å†²åŒºä¹‹é—´çš„å¤åˆ¶ï¼Œæé«˜ IO æ€§èƒ½</li><li>æ”¯æŒ DMAï¼ˆDirect Memory Accessï¼‰ç­‰åº•å±‚ä¼˜åŒ–æœºåˆ¶</li><li>é¿å… GC ç®¡ç†ï¼Œå‡å°‘é•¿æ—¶é—´è¿è¡Œç³»ç»Ÿçš„ GC å‹åŠ›</li></ul><p> <strong>ç¼ºç‚¹</strong> ï¼š</p><ul><li>åˆ†é…æˆæœ¬é«˜ï¼ˆç³»ç»Ÿè°ƒç”¨å¼€é”€ï¼‰ï¼Œé‡Šæ”¾æ…¢ï¼ˆä¸æ˜¯ GC è‡ªåŠ¨ç®¡ç†ï¼‰</li><li>å®¹æ˜“å†…å­˜æ³„æ¼ï¼šè‹¥ä¸ä¸»åŠ¨é‡Šæ”¾æˆ–æ± åŒ–ï¼Œå †å¤–å†…å­˜ä¸å¯å›æ”¶</li><li>å¯¹è°ƒè¯•å’Œç›‘æ§ä¸å‹å¥½ï¼šGC æ—¥å¿—å’Œå†…å­˜åˆ†æå·¥å…·æ— æ³•è¿½è¸ª</li></ul><h3 id="Bytebuf-æµ…æ‹·è´"><a href="#Bytebuf-æµ…æ‹·è´" class="headerlink" title="Bytebuf æµ…æ‹·è´"></a>Bytebuf æµ…æ‹·è´</h3><p>ByteBuf slice()</p><p>ByteBuf slice(int index,int length)</p><p>ä½¿ç”¨ä¸Šè¿°æ–¹æ³•å¯¹å¯¹è±¡è¿›è¡Œæµ…æ‹·è´</p><p>æ‹·è´åçš„åˆ‡ç‰‡ æ˜¯å½“å‰å·²è¢«è¯»å–Bytebufçš„é•¿åº¦å¤§å°ã€‚</p><p>è¯»æŒ‡é’ˆ è¢«è®¾ç½®ä¸º 0 ï¼Œ å†™æŒ‡é’ˆå’Œæœ€å¤§å®¹é‡éƒ½ä¸ºåˆ‡ç‰‡çš„è¯»ä½ç½®</p><p>ä½¿ç”¨duplicate() æ¥è¿›è¡Œå¯¹åŸå¯¹è±¡çš„æ•´ä½“å¤åˆ¶ã€‚</p><p>ä¸Šè¿°æ–¹æ³•éƒ½æ˜¯å¯¹åŸæ•°æ®çš„æµ…å±‚å¤åˆ¶ï¼Œå³æ˜¯å¯¹æŸæ®µå­˜å‚¨çš„å¼•ç”¨ã€‚å½“åŸå¯¹è±¡è¢«é‡Šæ”¾åå°±ä¸å†èƒ½è¢«ä½¿ç”¨äº†ã€‚å¯ä»¥é€šè¿‡å¢åŠ å¼•ç”¨è®¡æ•°çš„æ–¹å¼æ¥ä¿æŒå¯¹è±¡çš„å¯ç”¨çŠ¶æ€ã€‚</p><h2 id="é›¶æ‹·è´"><a href="#é›¶æ‹·è´" class="headerlink" title="é›¶æ‹·è´"></a>é›¶æ‹·è´</h2><p>Netty æä¾›äº†å¤šç§æ–¹æ³• å¸®åŠ©ç¨‹åºå‡å°‘å†…å­˜å¤åˆ¶</p><ol><li>CompositeByteBufç»„åˆç¼“å†²åŒºç±»ã€‚å°†å¤šä¸ªByteBufåˆå¹¶ä¸ºä¸€ä¸ªé€»è¾‘ä¸Šçš„Bytebuf</li><li>Nettyæä¾›äº† æµ…å±‚å¤åˆ¶æ“ä½œï¼Œå¯ä»¥å°†ByteBuffåˆ†è§£ä¸ºå¤šä¸ªå…±äº«åŒä¸€å­˜å‚¨åŒºåŸŸçš„ByteBuf</li><li>å¯ä»¥ç›´æ¥å°†æ–‡ä»¶ç¼“å†²åŒºçš„æ•°æ®å‘é€åˆ°ç›®æ ‡é€šé“ï¼Œé¿å…é€šé“å’Œç¼“å†²ä¹‹é—´çš„å¤šæ¬¡å¤åˆ¶</li><li>æä¾›äº†ä¸€ç³»åˆ—åŒ…è£…ç±»ï¼Œé¿å…è½¬æ¢è¿‡ç¨‹ä¸­çš„å†…å­˜æ‹·è´ã€‚</li><li>é€šè¿‡ä½¿ç”¨ç›´æ¥å†…å­˜è¿›è¡Œsocketè¯»å†™ï¼Œå‡å°‘äº†ä»JVMåˆ°ç›´æ¥å†…å­˜çš„æ‹·è´è¿‡ç¨‹</li></ol><h3 id="CompositeByteBuf"><a href="#CompositeByteBuf" class="headerlink" title="CompositeByteBuf"></a>CompositeByteBuf</h3><p>é€šè¿‡åˆå¹¶å¤šä¸ªBytebufé˜Ÿå½¢ï¼Œé‡æ–°ç»„ç»‡ä»–ä»¬çš„å…³ç³»ï¼Œå¢åŠ äº†æŸ¥è¯¢è¿‡ç¨‹ï¼Œä½†æ˜¯å‡å°‘äº†åˆ›å»ºæ–°çš„è°ƒç”¨å¯¹è±¡çš„å¤åˆ¶è¿‡ç¨‹</p><h3 id="WrappedBuffer"><a href="#WrappedBuffer" class="headerlink" title="WrappedBuffer()"></a>WrappedBuffer()</h3><p>é€šè¿‡å°†åŸå§‹ç±»å‹æ•°ç»„åŒ…è£…ä¸ºå¯¹è±¡ï¼Œå‡å°‘å¯¹è±¡åˆ›å»ºè¿‡ç¨‹</p><h1 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyEchoServer</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">runServer</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossLoopGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">1</span>);<br><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workLoopGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();<br><span class="hljs-comment">// çœç•¥ 1.ååº”å™¨è½®è¯¢ç»„ 2.é€šé“ç±»å‹ 4.é€šé“é€‰é¡¹</span><br>b.childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;()&#123;<br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span> ... &#123;<br>ch.pipeline().addLast(NettyEchoServerHandler.INSTANCE);<br>&#125;<br>&#125;);<br><span class="hljs-comment">// çœç•¥å¯åŠ¨ï¼Œç­‰å¾…ï¼Œå…³é—­</span><br>&#125;<br><span class="hljs-comment">// mainæ–¹æ³•è°ƒç”¨</span><br>&#125;<br><br><span class="hljs-comment">// ServerHandler å®ç°</span><br><span class="hljs-meta">@ChannelHandler</span>.Sharable<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyEchoServerHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">NettyEchoServerHandler</span> <span class="hljs-variable">INSTANCE</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyEchoServerHandler</span>();<br><br><span class="hljs-meta">@Override</span> <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx , Object msg)</span>...&#123;<br><span class="hljs-type">ByteBuf</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> (ByteBuf) msg;<br>Logger.info(<span class="hljs-string">&quot;msg type : &quot;</span> +(in.hasArray() ? <span class="hljs-string">&quot;å †å†…å­˜&quot;</span>:<span class="hljs-string">&quot;ç›´æ¥å†…å­˜&quot;</span>));<br><span class="hljs-type">int</span> <span class="hljs-variable">len</span> <span class="hljs-operator">=</span> in.readableBytes();<br><span class="hljs-type">byte</span>[] arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[len];<br>in.getBytes(<span class="hljs-number">0</span>,arr);<br>Logger.info(<span class="hljs-string">&quot;Server received:&quot;</span> + <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(arr,<span class="hljs-string">&quot;UTF-8&quot;</span>));<br>Logger.info(<span class="hljs-string">&quot;å†™å›å‰ï¼Œmsg.refCnt:&quot;</span> +((ByteBuf) msg).refCnt());<br><span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">f</span> <span class="hljs-operator">=</span> ctx.writeAndFlush(msg);<br>f.addListener((ChannelFuture futureListener)-&gt;&#123;<br>Logger.info(<span class="hljs-string">&quot;å†™å›åï¼Œmsg.refCnt:&quot;</span> + ((ByteBuf) msg).refCnt());<br>&#125;);<br>&#125; <br>&#125;<br><br><span class="hljs-comment">// å®¢æˆ·ç«¯</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyEchoClient</span>&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> serverPort ;<br><span class="hljs-keyword">private</span> String serverIp ;<br><span class="hljs-type">Bootstrap</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bootstrap</span>();<br><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">NettyEchoClient</span><span class="hljs-params">(String ip , <span class="hljs-type">int</span> port)</span>&#123;<br><span class="hljs-built_in">this</span>.serverPort = port ;<br><span class="hljs-built_in">this</span>.serverIp = ip ;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">runClient</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workerLoopGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();<br><span class="hljs-keyword">try</span>&#123;<br>b.group(workerLoopGroup);<br>b.channel(NioSocketChannel.class);<br>b.remoteAddress(serverIp,serverPort);<br>b.option(ChannelOption.ALLOCATOR, PooledByteBufAllocator.DEFAULT);<br>b.handler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;()&#123;<br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel  ch)</span>...&#123;<br>ch.pipeline().addLast(NettyEchoClientHandler.INSTANCE);<br>&#125;<br>&#125;);<br><span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">f</span> <span class="hljs-operator">=</span> b.connect();<br>f.addListener((ChannelFuture futureListener)-&gt;<br>&#123;<br><span class="hljs-keyword">if</span>(futureListener.isSuccess())&#123;<br>Logger.info(<span class="hljs-string">&quot;è¿æ¥æˆåŠŸ&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span> &#123;<br>Logger.info(<span class="hljs-string">&quot;è¿æ¥å¤±è´¥&quot;</span>);<br>&#125;<br>&#125;);<br>f.sync();<br><span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> f.channel();<br><span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>Print.tcfo(<span class="hljs-string">&quot;è¯·è¾“å…¥å‘é€å†…å®¹:&quot;</span>);<br><span class="hljs-keyword">while</span> (scanner.hasNext())&#123;<br><span class="hljs-type">String</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> scanner.next();<br><span class="hljs-type">byte</span>[] bytes = (Dateutil.getNow() + <span class="hljs-string">&quot;&gt;&gt;&quot;</span> + next).getBytes(<span class="hljs-string">&quot;UTF-8&quot;</span>);<br><span class="hljs-type">ByteBuf</span> <span class="hljs-variable">buffer</span> <span class="hljs-operator">=</span> channel.alloc().buffer();<br>buffer.writeBytes(bytes);<br>channel.writeAndFlush(buffer); <br>Print.tcfo(<span class="hljs-string">&quot;è¯·è¾“å…¥å‘é€å†…å®¹&quot;</span>)ï¼›<br>&#125;<br>&#125; <span class="hljs-keyword">catch</span> (Exception e)&#123;<br>e.printStackTrace();<br>&#125; <span class="hljs-keyword">finally</span>&#123;<br>workerLoopGroup.shutdownGracefully();<br>&#125;<br>&#125;<br><span class="hljs-comment">// mainæ–¹æ³•</span><br><br>&#125;<br><br><span class="hljs-comment">// å®¢æˆ·ç«¯handler</span><br><br><span class="hljs-meta">@ChannelHandler</span>.Sharable<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyEchoClientHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">NettyEchoClientHandler</span> <span class="hljs-variable">INSTANCE</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyEchoClientHandler</span>();<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx , Object msg)</span>...&#123;<br><span class="hljs-type">ByteBuf</span> <span class="hljs-variable">byteBuf</span> <span class="hljs-operator">=</span> (ByteBuf)msg;<br><span class="hljs-type">int</span> <span class="hljs-variable">len</span>  <span class="hljs-operator">=</span>  byteBuf.readableBytes();<br><span class="hljs-type">byte</span>[] arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[len];<br>byteBuf.getBytes(<span class="hljs-number">0</span>,arr);<br>Logger.info(<span class="hljs-string">&quot;client received :&quot;</span> + <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(arr,<span class="hljs-string">&quot;UTF-8&quot;</span>));<br><br>byteBuf.release();  <br><br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaç¼–ç¨‹ VII IO</title>
    <link href="/2025/05/07/Java%E7%BC%96%E7%A8%8B-VII-IO/"/>
    <url>/2025/05/07/Java%E7%BC%96%E7%A8%8B-VII-IO/</url>
    
    <content type="html"><![CDATA[<h1 id="IO"><a href="#IO" class="headerlink" title="IO"></a>IO</h1><p>IO æ˜¯ç³»ç»Ÿä¸­â€œè¾“å…¥&#x2F;è¾“å‡ºâ€ï¼ˆInput&#x2F;Outputï¼‰çš„ç®€ç§°ï¼Œé€šå¸¸æŒ‡ä»£æ“ä½œç³»ç»Ÿæ‰§è¡Œè¯»å†™æ“ä½œçš„æ•´ä¸ªè¿‡ç¨‹ã€‚åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œç”¨æˆ·ç¨‹åºå’Œå†…æ ¸ç¨‹åºä¹‹é—´å­˜åœ¨ä¸¥æ ¼çš„æƒé™éš”ç¦»ï¼Œåˆ†åˆ«å¤„äºâ€œç”¨æˆ·æ€â€å’Œâ€œå†…æ ¸æ€â€ã€‚</p><ul><li><strong>ç”¨æˆ·æ€</strong>ä¸»è¦ç”¨äºè¿è¡Œç”¨æˆ·åŠ è½½åˆ°å†…å­˜ä¸­çš„åº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬æ•°æ®å¤„ç†å’Œé€»è¾‘æ‰§è¡Œã€‚</li><li><strong>å†…æ ¸æ€</strong>åˆ™è´Ÿè´£ç®¡ç†ç³»ç»Ÿèµ„æºï¼Œå…¶æ ¸å¿ƒæ˜¯ä»¥ <code>task_struct</code> ä¸ºä»£è¡¨çš„æ•°æ®ç»“æ„ï¼Œç”¨äºæè¿°è¿›ç¨‹ä¿¡æ¯ï¼Œå¹¶ä¸å†…æ ¸å„ä¸ªå­ç³»ç»Ÿï¼ˆå¦‚æ–‡ä»¶ç³»ç»Ÿã€å†…å­˜ç®¡ç†ã€è®¾å¤‡é©±åŠ¨ç­‰ï¼‰äº¤äº’ï¼ŒåŒæ—¶è®°å½•ç”¨æˆ·è¿›ç¨‹ä¸å†…æ ¸èµ„æºä¹‹é—´çš„ç»‘å®šå…³ç³»ã€‚</li></ul><p>å½“ç”¨æˆ·ç¨‹åºéœ€è¦æ‰§è¡Œè¯»å†™ç­‰ IO æ“ä½œæ—¶ï¼Œä¼šé€šè¿‡ç³»ç»Ÿè°ƒç”¨æ¥å£å‘èµ·è¯·æ±‚ã€‚è¿™ä¸€è¯·æ±‚ä¼šå¼•å‘æƒé™åˆ‡æ¢ï¼Œå³ä»ç”¨æˆ·æ€â€œé™·å…¥â€ï¼ˆtrapï¼‰åˆ°å†…æ ¸æ€ï¼Œç”±å†…æ ¸ä»£è¡¨åº”ç”¨ç¨‹åºæ“ä½œåº•å±‚èµ„æºï¼ˆå¦‚æ–‡ä»¶ã€ç¡¬ç›˜ã€å†…å­˜ï¼‰ï¼Œä»¥ä¿éšœç³»ç»Ÿå®‰å…¨æ€§å’Œç¨³å®šæ€§ï¼Œé˜²æ­¢ç”¨æˆ·ç¨‹åºç›´æ¥è®¿é—®æˆ–ç ´åå…³é”®å†…å­˜åŒºåŸŸã€‚</p><h3 id="ä¸€ä¸ªå…¸å‹çš„æ–‡ä»¶å†™å…¥æµç¨‹å¦‚ä¸‹ï¼š"><a href="#ä¸€ä¸ªå…¸å‹çš„æ–‡ä»¶å†™å…¥æµç¨‹å¦‚ä¸‹ï¼š" class="headerlink" title="ä¸€ä¸ªå…¸å‹çš„æ–‡ä»¶å†™å…¥æµç¨‹å¦‚ä¸‹ï¼š"></a>ä¸€ä¸ªå…¸å‹çš„æ–‡ä»¶å†™å…¥æµç¨‹å¦‚ä¸‹ï¼š</h3><ol><li>ç”¨æˆ·ç¨‹åºåˆ›å»ºæ–‡ä»¶æŠ½è±¡å¯¹è±¡ï¼Œå†…æ ¸åˆ›å»ºåº•å±‚æ–‡ä»¶èµ„æºï¼›</li><li>é€šè¿‡ç³»ç»Ÿè°ƒç”¨è¿›å…¥å†…æ ¸æ€ï¼Œç”±å†…æ ¸åˆ›å»ºç›¸åº”çš„åº•å±‚æ–‡ä»¶ç»“æ„ï¼Œå¹¶è¿”å›ä¸€ä¸ª <strong>æ–‡ä»¶æè¿°ç¬¦</strong> ï¼ˆfile descriptorï¼‰ï¼›</li><li>ç”¨æˆ·ç¨‹åºä½¿ç”¨è¯¥æè¿°ç¬¦ï¼Œåœ¨ç”¨æˆ·æ€åˆ›å»ºæµå¯¹è±¡ç”¨äºæ•°æ®å†™å…¥ï¼›</li><li>å½“å†™å…¥å‘ç”Ÿæ—¶ï¼Œå†æ¬¡è§¦å‘ç³»ç»Ÿè°ƒç”¨ï¼Œè¦æ±‚å†…æ ¸å°†æ•°æ®å†™å…¥å¯¹åº”çš„æ–‡ä»¶æˆ–è®¾å¤‡ï¼›</li><li>æ•°æ®ä»ç”¨æˆ·æ€å¤åˆ¶åˆ°å†…æ ¸æ€ç¼“å†²åŒºï¼Œå†ç”±å†…æ ¸å®Œæˆå®é™…çš„å†™å…¥ï¼›</li><li>å¦‚æœæ˜¯è¯»å–æ“ä½œï¼Œåˆ™ç”±å†…æ ¸å°†æ–‡ä»¶å†…å®¹ä»ç£ç›˜åŠ è½½åˆ°å†…æ ¸ç¼“å†²åŒºï¼Œå†å¤åˆ¶å›ç”¨æˆ·æ€å†…å­˜ï¼›</li><li>ç”¨æˆ·æ€ç¨‹åºéšåå¯ä»¥å¯¹è¿™äº›æ•°æ®è¿›è¡Œå­—èŠ‚æµæˆ–å­—ç¬¦æµçš„å¤„ç†ã€‚</li></ol><p>ç”±ä¸Šè¿°æµç¨‹æˆ‘ä»¬å¯ä»¥çœ‹åˆ° I&#x2F;O æµç¨‹å­˜åœ¨ä»¥ä¸‹æ€§èƒ½ç“¶é¢ˆ ï¼š</p><ol><li>é˜»å¡ é˜»å¡æ˜¯æŒ‡åº”ç”¨ç¨‹åºåœ¨æ‰§è¡Œ I&#x2F;O æ“ä½œæ—¶ï¼Œå¦‚æœæ•°æ®è¿˜æœªå‡†å¤‡å¥½ï¼ˆå¦‚æ–‡ä»¶æœªè¯»å®Œã€ç£ç›˜è¿˜åœ¨å¯»å€ã€ç½‘ç»œæ•°æ®è¿˜æœªåˆ°è¾¾ï¼‰ï¼Œè¿›ç¨‹ä¼šè¿›å…¥ <strong>ç­‰å¾…çŠ¶æ€</strong> ï¼Œæ— æ³•ç»§ç»­æ‰§è¡Œï¼Œç›´åˆ° I&#x2F;O æ“ä½œå®Œæˆä¸ºæ­¢ã€‚</li><li>ç”¨æˆ·æ€ä¸å†…æ ¸æ€çš„åˆ‡æ¢å±äºä¸€ç§â€œä¸Šä¸‹æ–‡åˆ‡æ¢â€ï¼ŒæŒ‡æ“ä½œç³»ç»Ÿåœ¨æ‰§è¡Œç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œéœ€è¦ä¿å­˜å½“å‰ç”¨æˆ·æ€çš„æ‰§è¡Œç¯å¢ƒï¼ˆå¯„å­˜å™¨ã€ç¨‹åºè®¡æ•°å™¨ã€æ ˆæŒ‡é’ˆç­‰ï¼‰ï¼Œåˆ‡æ¢åˆ°å†…æ ¸æ€å¹¶åŠ è½½å†…æ ¸çš„è¿è¡Œç¯å¢ƒã€‚</li><li>åœ¨ç”¨æˆ·æ€å’Œå†…æ ¸æ€ä¹‹é—´çš„æ•°æ®äº¤äº’å¹¶ä¸æ˜¯â€œå…±äº«å†…å­˜â€ï¼Œè€Œæ˜¯é€šè¿‡ æ˜¾å¼å¤åˆ¶ï¼ˆcopyï¼‰å®ç°ã€‚é€šå¸¸å‘ç”Ÿåœ¨è¯»å†™æ–‡ä»¶æˆ–ç½‘ç»œæ•°æ®æ—¶ã€‚</li></ol><h1 id="IOæ¨¡å‹"><a href="#IOæ¨¡å‹" class="headerlink" title="IOæ¨¡å‹"></a>IOæ¨¡å‹</h1><h2 id="åŒæ­¥é˜»å¡IO"><a href="#åŒæ­¥é˜»å¡IO" class="headerlink" title="åŒæ­¥é˜»å¡IO"></a>åŒæ­¥é˜»å¡IO</h2><p>ç”¨æˆ·ç©ºé—´ ä¸»åŠ¨å‘èµ·ï¼Œéœ€è¦ç­‰å¾…å†…æ ¸IO æ“ä½œå½»åº•å®Œæˆæ‰è¿”å›åˆ°ç”¨æˆ·ç©ºé—´çš„IO</p><p>æµç¨‹</p><ol><li>å‘èµ·å¯åŠ¨è°ƒç”¨read,ç”¨æˆ·æ€çº¿ç¨‹é˜»å¡</li><li>å†…æ ¸æ”¶åˆ°readç³»ç»Ÿè°ƒç”¨ï¼Œè¿›è¡Œæ•°æ®å‡†å¤‡ã€‚</li><li>å†…æ ¸ç­‰åˆ°å®Œæ•´æ•°æ®åˆ°è¾¾ï¼Œå°†æ•°æ®ä»å†…æ ¸ç¼“å†²åŒºæ‹·è´åˆ°ç”¨æˆ·ç¼“å†²åŒº</li><li>å†…æ ¸è¿”å›åç”¨æˆ·çº¿ç¨‹è§£é™¤é˜»å¡çŠ¶æ€ï¼Œé‡æ–°è¿è¡Œ</li></ol><p>ä¼˜ç‚¹ ï¼š å®ç°ç®€å•</p><p>ç¼ºç‚¹ ï¼šæ¯ä¸ªè¿æ¥éƒ½ä½¿ç”¨è‡ªå·±çš„çº¿ç¨‹è¿›è¡ŒIO æ“ä½œï¼Œé«˜å¹¶å‘åœºæ™¯ä¸‹  åˆ‡æ¢å¼€é”€å’Œé˜»å¡ä¼šå¯¼è‡´æ€§èƒ½å¾ˆä½</p><p>å†…æ ¸æ€å‡†å¤‡æ•°æ®å’Œå¤åˆ¶æ•°æ®æ˜¯åŒæ­¥è¿›è¡Œçš„ï¼Œç›´åˆ°æ•°æ®å¯è¯»åæ‰è¿”å›</p><h2 id="åŒæ­¥éé˜»å¡IO"><a href="#åŒæ­¥éé˜»å¡IO" class="headerlink" title="åŒæ­¥éé˜»å¡IO"></a>åŒæ­¥éé˜»å¡IO</h2><p>ç”¨æˆ·ç©ºé—´ç¨‹åºä¸éœ€è¦ç­‰å¾…å†…æ ¸IOæ“ä½œå½»åº•å®Œæˆï¼Œå¯ä»¥ç«‹å³è¿”å›ç”¨æˆ·ç©ºé—´æ‰§è¡Œåç»­å‘½ä»¤ã€‚</p><p>æµç¨‹</p><ol><li>ç”¨æˆ·çº¿ç¨‹ å‘ å†…æ ¸å‘èµ·æŸ¥è¯¢è¯·æ±‚ï¼ŒæŸ¥è¯¢å†…æ ¸ç¼“å†²åŒºæ˜¯å¦å­˜åœ¨æ•°æ®</li><li>å‘èµ·ç³»ç»Ÿè°ƒç”¨ï¼ŒæŸ¥è¯¢å†…æ ¸ç¼“å†²åŒºæ˜¯å¦å­˜åœ¨æ•°æ®ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›ä¸€ä¸ªè°ƒç”¨å¤±è´¥ä¿¡æ¯</li><li>å¦‚æœå­˜åœ¨æ•°æ®ï¼Œå°†å†…æ ¸ç¼“å†²åŒºä¸­çš„æ•°æ®å¤åˆ¶åˆ°ç”¨æˆ·ç¼“å†²åŒºï¼Œè¿™æ—¶é˜»å¡ç”¨æˆ·æ€çº¿ç¨‹ï¼Œç›´åˆ°å¤åˆ¶å®Œæˆè¿”å›ç³»ç»Ÿè°ƒç”¨æˆåŠŸ</li></ol><p>ä¼˜ç‚¹ ï¼š é€šè¿‡ä¸æ–­æŸ¥è¯¢æ£€æŸ¥ç¼“å­˜çŠ¶æ€ï¼Œä¸éœ€è¦é˜»å¡çº¿ç¨‹</p><p>ç¼ºç‚¹ ï¼šä¸æ–­çš„å‘å†…æ ¸è¯·æ±‚æŸ¥è¯¢ä¼šå¢åŠ ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€</p><h2 id="IOå¤šè·¯å¤ç”¨"><a href="#IOå¤šè·¯å¤ç”¨" class="headerlink" title="IOå¤šè·¯å¤ç”¨"></a>IOå¤šè·¯å¤ç”¨</h2><p>é€šè¿‡select&#x2F;epoll ä½¿å¾—ä¸€ä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶ç›‘å¬å¤šä¸ªèµ„æºæè¿°ç¬¦ï¼Œä¸€æ—¦æŸä¸ªå°±ç»ªåå°±å¯ä»¥å°†å¯¹åº”çš„èµ„æºæè¿°ç¬¦è¿”å›ï¼Œä¾›ç”¨æˆ·ç©ºé—´ç¨‹åºä½¿ç”¨</p><p>æµç¨‹</p><ol><li>é€‰æ‹©å™¨æ³¨å†Œã€‚å°†éœ€è¦readæ“ä½œçš„ ç›®æ ‡æ–‡ä»¶æè¿°ç¬¦æå‰æ³¨å†Œåˆ°Linuxçš„select&#x2F;epollé€‰æ‹©å™¨ä¸­ï¼Œ</li><li>å°±ç»ªçŠ¶æ€çš„è½®è¯¢ã€‚é€šè¿‡é€‰æ‹©å™¨çš„æŸ¥è¯¢æ–¹æ³•ï¼ŒæŸ¥è¯¢æ‰€æœ‰æå‰æ³¨å†Œè¿‡çš„ç›®æ ‡æ–‡ä»¶æè¿°ç¬¦I&#x2F;Oå°±ç»ªçŠ¶æ€ã€‚è¿”å›ä¸€ä¸ªå°±ç»ªçš„socketåˆ—è¡¨å’Œå°±ç»ªäº‹ä»¶ï¼Œæç¤ºç”¨æˆ·çº¿ç¨‹I&#x2F;Oå°±ç»ª</li><li>ç”¨æˆ·çº¿ç¨‹å¾—åˆ°äº†å°±ç»ªçš„socketåˆ—è¡¨ï¼Œå‘å¯¹åº”çš„è¿æ¥å‘èµ·ç³»ç»Ÿè°ƒç”¨ï¼Œé˜»å¡çº¿ç¨‹ï¼Œä»å†…æ ¸å¤åˆ¶æ•°æ®ï¼Œå°†æ•°æ®ä»å†…æ ¸ç¼“å†²åŒºå¤åˆ¶åˆ°ç”¨æˆ·ç¼“å†²åŒº</li><li>å¤åˆ¶å®Œæˆåï¼Œå†…æ ¸è¿”å›ç»“æœï¼Œç”¨æˆ·çº¿ç¨‹è§£é™¤é˜»å¡çŠ¶æ€ï¼Œç”¨æˆ·çº¿ç¨‹è¯»å–åˆ°äº†æ•°æ®ç»§ç»­æ‰§è¡Œã€‚</li></ol><p>ä¼˜ç‚¹ ï¼šä¸€ä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶å¤„ç†è®¸å¤šè¯»å†™è¿æ¥ï¼Œä½¿å¾—ç”¨æˆ·ä¸å¿…ç»´æŠ¤å¤§é‡çš„çº¿ç¨‹</p><p>ç¼ºç‚¹ ï¼šselect åœ¨ç›‘å¬äº‹ä»¶æ—¶ ä»ç„¶æ˜¯é˜»å¡çš„ã€‚ä½† epoll æ”¯æŒè¾¹ç¼˜è§¦å‘ï¼Œå¯ç»“åˆéé˜»å¡é€šé“å®ç°é«˜æ€§èƒ½ IO</p><h2 id="å¼‚æ­¥IO"><a href="#å¼‚æ­¥IO" class="headerlink" title="å¼‚æ­¥IO"></a>å¼‚æ­¥IO</h2><p>å†…æ ¸ç©ºé—´æˆä¸ºä¸»åŠ¨è°ƒç”¨è€…ï¼Œå½“èµ„æºå‡†å¤‡å°±ç»ªæ—¶å‘ç”¨æˆ·çº¿ç¨‹é€šçŸ¥ èµ„æºå°±ç»ª</p><p>æµç¨‹</p><ol><li>ç”¨æˆ·å‘èµ·readç³»ç»Ÿè°ƒç”¨ï¼Œä¸é˜»å¡åç»­é€»è¾‘</li><li>å†…æ ¸å¼€å§‹I&#x2F;O ç¬¬ä¸€ä¸ªé˜¶æ®µï¼Œå‡†å¤‡æ•°æ®ï¼Œå†…æ ¸å°†æ•°æ®ä»å†…æ ¸å¤åˆ¶åˆ°ç”¨æˆ·ç¼“å†²åŒº</li><li>å†…æ ¸å‘ç”¨æˆ·çº¿ç¨‹å‘é€ä¿¡å·ï¼Œé€šçŸ¥ç”¨æˆ·çº¿ç¨‹æ•°æ®å·²ç»å¤åˆ¶åˆ°ç¼“å†²åŒº</li><li>ç”¨æˆ·çº¿ç¨‹è¯»å–ç¼“å†²åŒºæ•°æ®ï¼Œç»§ç»­åç»­ä»»åŠ¡</li></ol><p>ä¼˜ç‚¹ ï¼š IOè¿‡ç¨‹éé˜»å¡ï¼ŒçœŸæ­£çš„å¼‚æ­¥è°ƒç”¨</p><p>ç¼ºç‚¹ ï¼š éœ€è¦è¿›è¡Œäº‹åŠ¡çš„æ³¨å†Œä¸æ¥æ”¶ï¼Œéœ€è¦æ“ä½œç³»ç»Ÿæ”¯æŒ</p><h1 id="NIO"><a href="#NIO" class="headerlink" title="NIO"></a>NIO</h1><p>java æä¾›äº†éé˜»å¡IO åº“   NIO</p><p>æ ¸å¿ƒç»„ä»¶</p><p>Channel  é€šé“</p><p>Buffer  ç¼“å†²åŒº</p><p>Selector é€‰æ‹©å™¨</p><h2 id="ç¼“å†²åŒºï¼ˆBufferï¼‰"><a href="#ç¼“å†²åŒºï¼ˆBufferï¼‰" class="headerlink" title="ç¼“å†²åŒºï¼ˆBufferï¼‰"></a>ç¼“å†²åŒºï¼ˆBufferï¼‰</h2><p>Buffer æ˜¯ä¸€ä¸ªéçº¿ç¨‹å®‰å…¨ç±»</p><p>capacity  è¯»å†™å®¹é‡                     è®¾ç½®buffer åˆ›å»ºçš„ç±»å‹æ•°ç»„çš„æœ€å¤§å®¹é‡</p><p>position  è®°å½•è¯»å†™ä½ç½®             åœ¨è¯»å†™è¿‡ç¨‹ä¸­è®°å½•å½“å‰å†™å…¥&#x2F;è¯»å‡ºçš„ä½ç½®</p><p>limit         è¯»å†™çš„æœ€å¤§ä¸Šé™         è®°å½•å®é™…å†™å…¥çš„å®¹é‡&#x2F;å®é™…è¯»å–çš„æœ€å¤§å†…å®¹</p><p>mark        è¯»å†™ä½ç½®è®°å½•ç¼“å­˜    æš‚æ—¶å­˜å‚¨positionçš„ä½ç½®</p><p>allocate()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserBuffer</span><br>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-type">IntBuffer</span> <span class="hljs-variable">intBuffer</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">allocateTest</span><span class="hljs-params">()</span>&#123;<br>intBuffer = IntBuffer.allocate(<span class="hljs-number">20</span>);<br>    ...<br>&#125;<br>&#125;<br><span class="hljs-comment">// åˆ›å»ºåä¼šå®šä¹‰å¥½ .capacity = 20 , .position = 0 , .limit = 20</span><br></code></pre></td></tr></table></figure><p>put()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserBuffer</span><br>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-type">IntBuffer</span> <span class="hljs-variable">intBuffer</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">putTest</span><span class="hljs-params">()</span><br>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">5</span> ; i++)<br>&#123;<br>intBuffer.put(i);<br>&#125;<br>&#125;<br>&#125;<br><span class="hljs-comment">// å‘bufferä¸­å†™å…¥5ä¸ªæ•°æ® .capacity = 20 , .position = 5 , .limit = 20</span><br></code></pre></td></tr></table></figure><p>flip()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserBuffer</span><br>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-type">IntBuffer</span> <span class="hljs-variable">intBuffer</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">flipTest</span><span class="hljs-params">()</span><br>&#123;<br>intBuffer.flip();<br>&#125;<br>&#125;<br><span class="hljs-comment">// åè½¬buffer .capacity = 20 , .position = 0 , .limit = 5</span><br></code></pre></td></tr></table></figure><p>get()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserBuffer</span><br>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-type">IntBuffer</span> <span class="hljs-variable">intBuffer</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">getTest</span><span class="hljs-params">()</span><br>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">2</span> ; i++)&#123;<br>intBuffer.get();<br>&#125;<br>&#125;<br>&#125;<br><br><span class="hljs-comment">// ä»bufferä¸­å–æ•°æ® .capacity = 20 , .position = 2 , .limit = 5</span><br></code></pre></td></tr></table></figure><p>rewind()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserBuffer</span><br>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-type">IntBuffer</span> <span class="hljs-variable">intBuffer</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rewindTest</span><span class="hljs-params">()</span><br>&#123;<br>intBuffer.rewind();<br>&#125;<br>&#125;<br><br><span class="hljs-comment">// ä»bufferä¸­é‡ç½®å®šä½ .capacity = 20 , .position = 0 , .limit = 5</span><br></code></pre></td></tr></table></figure><p>mark()å’Œ reset()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserBuffer</span><br>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-type">IntBuffer</span> <span class="hljs-variable">intBuffer</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span> ;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reRead</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">5</span> ; i++)&#123;<br><span class="hljs-keyword">if</span>(i == <span class="hljs-number">2</span>)&#123;<br>intBuffer.mark();<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> intBuffer.get();<br>&#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterReset</span><span class="hljs-params">()</span>&#123;<br> intBuffer.reset();<br> <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span> ; i&lt; <span class="hljs-number">5</span> ; i++)&#123;<br> <span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> intBuffer.get();<br> &#125;<br>&#125;<br>&#125;<br><span class="hljs-comment">// ä½¿ç”¨markæ ‡è®° positionä½ç½®ï¼Œä½¿ç”¨reset æ¢å¤positionä½ç½®ï¼Œæ‰“å°ã€‚</span><br></code></pre></td></tr></table></figure><p>clear()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserBuffer</span><br>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-type">IntBuffer</span> <span class="hljs-variable">intBuffer</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span> ;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clearDemo</span><span class="hljs-params">()</span>&#123;<br>intBuffer.clear();<br>&#125;<br>&#125;   <br></code></pre></td></tr></table></figure><h2 id="é€šé“-ï¼ˆChannel-ï¼‰"><a href="#é€šé“-ï¼ˆChannel-ï¼‰" class="headerlink" title="é€šé“ ï¼ˆChannel ï¼‰"></a>é€šé“ ï¼ˆChannel ï¼‰</h2><p>FileChannel æ–‡ä»¶é€šé“</p><p>SocketChannel å¥—æ¥å­—é€šé“</p><p>ServerSocketChannel æœåŠ¡å™¨å¥—æ¥å­—é€šé“</p><p>DatagramChannel æ•°æ®æŠ¥é€šé“</p><h3 id="FileChannel-æ–‡ä»¶é€šé“"><a href="#FileChannel-æ–‡ä»¶é€šé“" class="headerlink" title="FileChannel æ–‡ä»¶é€šé“"></a>FileChannel æ–‡ä»¶é€šé“</h3><p>åˆ›å»ºé€šé“å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(srcFile);<br><span class="hljs-type">FileChannel</span> <span class="hljs-variable">inChannel</span> <span class="hljs-operator">=</span> fis.getChannel();<br><span class="hljs-type">FileOutputStream</span> <span class="hljs-variable">fos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(destFile);<br><span class="hljs-type">FileChannel</span> <span class="hljs-variable">outChannel</span> <span class="hljs-operator">=</span> fos.getChannel();<br><br><span class="hljs-type">RandomAccessFile</span> <span class="hljs-variable">rFile</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RandomAccessFile</span>(<span class="hljs-string">&quot;filename.txt&quot;</span>,<span class="hljs-string">&quot;rw&quot;</span>);<br><span class="hljs-type">FileChannel</span> <span class="hljs-variable">channel</span>  <span class="hljs-operator">=</span> rFile.getChannel();<br></code></pre></td></tr></table></figure><p>è¯»å–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">RandomAccessFile</span> <span class="hljs-variable">aFile</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RandomAccessFile</span>(fileName,<span class="hljs-string">&quot;rw&quot;</span>);<br><span class="hljs-type">FileChannel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> aFile.getChannel();<br><span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(CAPACITY);<br><span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span> <br><span class="hljs-keyword">while</span>((length = channel.read(buf)) != -<span class="hljs-number">1</span>)&#123;<br>... <br>&#125;<br></code></pre></td></tr></table></figure><p>å†™å…¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">buf.flip();<br><span class="hljs-type">int</span> <span class="hljs-variable">outlength</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">while</span>((outlength = outChannel.write(buf)) != <span class="hljs-number">0</span>)&#123;<br>System.out.println(<span class="hljs-string">&quot;å†™å…¥å­—èŠ‚æ•°ï¼š&quot;</span> + outlength);<br>&#125;<br></code></pre></td></tr></table></figure><p>å…³é—­é€šé“</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">channel.close();<br><br>channel.force(<span class="hljs-literal">true</span>); <span class="hljs-comment">// å¼ºåˆ¶åˆ·æ–°</span><br></code></pre></td></tr></table></figure><p>æ¡ˆä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileNIOCopyDemo</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br> nioCopyResourceFile();<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">nioCopyResouceFile</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-type">String</span> <span class="hljs-variable">sourcePath</span> <span class="hljs-operator">=</span> NioDemoConfig.FILE_RESOUCE_SRC_PATH;<br><span class="hljs-type">String</span> <span class="hljs-variable">srcPath</span> <span class="hljs-operator">=</span> IOUtil.getResoucePath(sourcePath);<br>Logger.info(<span class="hljs-string">&quot;srcPath = &quot;</span> + srcPath);<br><br><span class="hljs-type">String</span> <span class="hljs-variable">destPath</span> <span class="hljs-operator">=</span> NioDemoConfig.FILE_RESOURCE_DEST_PATH;<br><span class="hljs-type">String</span> <span class="hljs-variable">destDecodePath</span> <span class="hljs-operator">=</span> IOUtil.builderResourcePath(destPath);<br>Logger.info(<span class="hljs-string">&quot;destDecodePath=&quot;</span> + destDecodePath);<br>nioCopyFile(srcDecodePath , destDecodePath);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">nioCopyFile</span><span class="hljs-params">(String srcPath , String destPath)</span>&#123;<br><span class="hljs-type">File</span> <span class="hljs-variable">srcFile</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(srcPath);<br><span class="hljs-type">File</span> <span class="hljs-variable">destFile</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(destPath);<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-keyword">if</span>(!destFile.exists())&#123;<br>destFile.createNewFile();<br>&#125;<br><span class="hljs-type">long</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br><span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fis</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><span class="hljs-type">FileOutputStream</span> <span class="hljs-variable">fos</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span> ;<br><span class="hljs-type">FileChannel</span> <span class="hljs-variable">inChannel</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span> ;<br><span class="hljs-type">FileChannel</span> <span class="hljs-variable">outChannel</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span> ;<br><span class="hljs-keyword">try</span> &#123;<br>fis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(srcFile);<br>fos = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(destFile);<br>inChannel = fis.getChannel();<br>outChannel = fos.getChannel();<br><span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br><span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(<span class="hljs-number">1024</span>);<br><span class="hljs-keyword">while</span>((length = inChannel.read(buf)) != -<span class="hljs-number">1</span>) &#123;<br>buf.flip();<br><span class="hljs-type">int</span> <span class="hljs-variable">outlength</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">while</span> (( outlength = outChannel.write(buf))!=<span class="hljs-number">0</span> )&#123;<br>buf.clear();<br>&#125;<br>outChannel.force(<span class="hljs-literal">true</span>);<br>&#125;<span class="hljs-keyword">finally</span>&#123;<br>IOUtil.closeQuietly(outChannel);<br>IOUtil.closeQuietly(fos);<br>IOUtil.closeQuietly(inchannel);<br>IOUtil.closeQuietly(fis);<br>&#125;<br><span class="hljs-type">long</span> <span class="hljs-variable">endTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>Logger.info(<span class="hljs-string">&quot;baseå¤åˆ¶æ¯«ç§’æ•°ï¼š&quot;</span> + (endTime - startTime));<br><br>&#125;<span class="hljs-keyword">catch</span> (IOException e)&#123;<br>e.printStackTrace();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="SocketChannel"><a href="#SocketChannel" class="headerlink" title="SocketChannel"></a>SocketChannel</h3><p>åˆ›å»ºéš§é“</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">SocketChannel</span> <span class="hljs-variable">socketChannel</span> <span class="hljs-operator">=</span> SocketChannel.open();<br>socketChannel.configureBlocking(<span class="hljs-literal">false</span>);<br>socketChannel.connect(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">80</span>));<br><span class="hljs-keyword">while</span>(! socketChannel.finishConnect())&#123;<br>&#125;<br><span class="hljs-type">ServerSocketChannel</span> <span class="hljs-variable">server</span> <span class="hljs-operator">=</span> (ServerSocketChannel) key.channel());<br><span class="hljs-type">SocketChannel</span> <span class="hljs-variable">socketChannel</span> <span class="hljs-operator">=</span> server.accept();<br>socketChannel.configureBlocking(<span class="hljs-literal">false</span>);<br></code></pre></td></tr></table></figure><p>è¯»å–é€šé“</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(<span class="hljs-number">1024</span>);<br><span class="hljs-type">int</span> <span class="hljs-variable">bytesRead</span> <span class="hljs-operator">=</span> socketChannel.read(buf);<br></code></pre></td></tr></table></figure><p>å†™å…¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">buffer.flip();<br>socketChannel.write(buffer);<br></code></pre></td></tr></table></figure><p>å…³é—­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">socketChannel.shutdownOutput();<br>IOUtil.closeQuietly(socketChannel);<br></code></pre></td></tr></table></figure><p>æ¡ˆä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NioSendClient</span>&#123;<br><br><span class="hljs-keyword">private</span> <span class="hljs-type">Charset</span> <span class="hljs-variable">charset</span> <span class="hljs-operator">=</span> Charset.forName(<span class="hljs-string">&quot;UTF-8&quot;</span>);<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendFile</span><span class="hljs-params">()</span><br>&#123;<br><span class="hljs-keyword">try</span><br>&#123;<br><span class="hljs-type">String</span> <span class="hljs-variable">sourcePath</span> <span class="hljs-operator">=</span> NioDemoConfig.SOCKET_SEND_FILE;<br><span class="hljs-type">String</span> <span class="hljs-variable">srcPath</span> <span class="hljs-operator">=</span> IOUtil.getResourcePath(sourcePath);<br>Logger.debug(<span class="hljs-string">&quot;srcPath=&quot;</span> + srcPath);<br><br><span class="hljs-type">String</span> <span class="hljs-variable">destFile</span> <span class="hljs-operator">=</span> NioDemoConfig.SOCKET_RECEIVE_FILE;<br>Logger.debug(<span class="hljs-string">&quot;destFile=&quot;</span> + destFile);<br><br><span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(srcPath);<br><span class="hljs-keyword">if</span> (!file.exists())&#123;<br>Logger.debug(<span class="hljs-string">&quot;æ–‡ä»¶ä¸å­˜åœ¨&quot;</span>);<br><span class="hljs-keyword">return</span> ;<br>&#125;<br><span class="hljs-type">FileChannel</span> <span class="hljs-variable">fileChannel</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(file).getChannel();<br><span class="hljs-type">SocketChannel</span> <span class="hljs-variable">socketChannel</span> <span class="hljs-operator">=</span> SocketChannel.open();<br>socketChannel.socket().connect(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">18899</span>));<br>socketChannel.configureBlocking(<span class="hljs-literal">false</span>);<br>Logger.debug(<span class="hljs-string">&quot;Client å·²è¿æ¥&quot;</span>);<br><span class="hljs-keyword">while</span> (!socketChannel.finishConnect())&#123;<br>...<br>&#125;<br><span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buffer</span> <span class="hljs-operator">=</span> sendFileNameAndLength(destFile, file,socketChannel);<br><span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> sendContent(file,fileChannel,socketChannel,buffer);<br><span class="hljs-keyword">if</span> (length == -<span class="hljs-number">1</span>)&#123;<br>IOUtil.closeQuietly(fileChannel);<br>socketChannel.shutdownOutput();<br>IOUtil.closeQuietly(socketChannel);<br>&#125;<br>Logger.debug(<span class="hljs-string">&quot; æ–‡ä»¶ä¼ è¾“æˆåŠŸ &quot;</span>);<br>&#125; <span class="hljs-keyword">catch</span> (Exception e)&#123;<br>e.printStackTrace();<br>&#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">sendContent</span><span class="hljs-params">(File file , FileChannel fileChannel, SocketChannel socketChannel,</span><br><span class="hljs-params">ByteBuffer buffer)</span>  <span class="hljs-keyword">throws</span> IOException&#123;<br>Logger.debug(<span class="hljs-string">&quot;å¼€å§‹ä¼ è¾“æ–‡ä»¶&quot;</span>);<br><span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><span class="hljs-type">long</span> <span class="hljs-variable">progess</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> ;<br><span class="hljs-keyword">while</span> ((length = fileChannel.read(buffer)) &gt;<span class="hljs-number">0</span> )<br>&#123;<br>buffer.flip();<br>socketChannel.write(buffer);<br>buffer.clear();<br>progess += length ;<br>Logger.debug(<span class="hljs-string">&quot;| + &quot;</span> (<span class="hljs-number">100</span> * progress/ file.length()) + <span class="hljs-string">&quot;%|&quot;</span>);<br>&#125;<br><span class="hljs-keyword">return</span> length;<br>&#125;<br><br> <span class="hljs-keyword">public</span> ByteBuffer <span class="hljs-title function_">sendFileNameAndLength</span><span class="hljs-params">(String destFile, File file , SocketChannel socketChannel)</span> <span class="hljs-keyword">throws</span> IOException&#123;<br> <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">fileNameByteBuffer</span> <span class="hljs-operator">=</span> charset.encode(destFile);<br> <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buffer</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(NioDemoConfig.SEND_BUFFER_SIZE);<br> <span class="hljs-type">int</span> <span class="hljs-variable">fileNameLen</span> <span class="hljs-operator">=</span> fileNameByteBuffer.capacity();<br> buffer.putInt(fileNameLen);<br> buffer.flip();<br> socketChannel.write(buffer);<br> buffer.clear();<br> Logger.info(<span class="hljs-string">&quot;å‘é€å®Œæˆ&quot;</span> , fileNameLen);<br> socketChannel.write(fileNameByteBuffer);<br> Logger.info(<span class="hljs-string">&quot;Client æ–‡ä»¶åç§°å‘é€å®Œæˆ&quot;</span>, destFile);<br> buffer.putLong(file.length());<br> buffer.flip();<br> socketChannel.write(buffer);<br> buffer.clear();<br> Logger.info(<span class="hljs-string">&quot;Client æ–‡ä»¶é•¿åº¦å‘é€å®Œæˆ:&quot;</span> , file.length());<br> <span class="hljs-keyword">return</span> buffer ; <br> &#125; <br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="DatagramChannel"><a href="#DatagramChannel" class="headerlink" title="DatagramChannel"></a>DatagramChannel</h3><p>è·å–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">DatagramChannel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> DatagramChannel.open();<br>datagramChannel.configureBlocking(<span class="hljs-literal">false</span>);<br><br>channel.socket().bind(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-number">18080</span>));<br></code></pre></td></tr></table></figure><p>è¯»å–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(<span class="hljs-number">1024</span>);<br><span class="hljs-type">SocketAddress</span> <span class="hljs-variable">clientAddr</span> <span class="hljs-operator">=</span> datagramChannel.receive(buf);<br></code></pre></td></tr></table></figure><p>å†™å…¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">buffer.flip();<br>dChannel.send(buffer,<span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">18899</span>));<br>buffer.clear();<br></code></pre></td></tr></table></figure><p>å…³é—­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">dChannel.close();<br></code></pre></td></tr></table></figure><p>æ¡ˆä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å®¢æˆ·ç«¯ :</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UDPClient</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException&#123;<br><span class="hljs-type">DatagramChannel</span> <span class="hljs-variable">dChannel</span> <span class="hljs-operator">=</span> DatagramChannel.open();<br>dChannel.configureBlocking(<span class="hljs-literal">false</span>);<br><span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buffer</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(NioDemoConfig.SEND_BUFFER_SIZE);<br><span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>Print.tcfo(<span class="hljs-string">&quot;è¯·è¾“å…¥å‘é€å†…å®¹&quot;</span>);<br><span class="hljs-keyword">while</span>(scanner.hasNext())&#123;<br><span class="hljs-type">String</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> scanner.next();<br>buffer.put((Dateutil.getNow() + <span class="hljs-string">&quot;&gt;&gt;&quot;</span> + next).getBytes();<br>buffer.flip();<br>dChannel.send(buffer,<span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">18899</span>));<br>buffer.clear();<br>&#125;<br>dChannel.close();<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException&#123;<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">UDPClient</span>().send();<br>&#125;<br>&#125;<br><span class="hljs-comment">// å®¢æˆ·ç«¯ :</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UDPServer</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">receive</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException&#123;<br><span class="hljs-type">DatagramChannel</span> <span class="hljs-variable">datagramChannel</span> <span class="hljs-operator">=</span> DatagramChannel.open();<br>datagramChannel.configureBlocking(<span class="hljs-literal">false</span>);<br>datagramChannel.bind(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">18899</span>));<br>Print.tcfo(<span class="hljs-string">&quot;UDP æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ&quot;</span>);<br><span class="hljs-type">Selector</span> <span class="hljs-variable">selector</span> <span class="hljs-operator">=</span> Selector.open();<br>datagramChannel.register(selector, SelectionKey.OP_READ);<br><span class="hljs-keyword">while</span>(selector.select()&gt;<span class="hljs-number">0</span>)&#123;<br>Iterator&lt;SelectionKey&gt; iterator = selector.selectedKeys().iterator();<br><span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buffer</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(NioDemoConfig.SEND_BUFFER_SIZE);<br><span class="hljs-keyword">while</span>(iterator.hasNext())&#123;<br><span class="hljs-type">SelectionKey</span> <span class="hljs-variable">selectionKey</span> <span class="hljs-operator">=</span> iterator.next();<br><span class="hljs-keyword">if</span>(selectionKey.isReadable())&#123;<br><span class="hljs-type">SocketAddress</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> datagramChannel.receive(buffer);<br>buffer.flip();<br>Print.tcfo(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(buffer.array(),<span class="hljs-number">0</span>,buffer.limit));<br>buffer.clear();<br>&#125;<br>&#125;<br>iterator.remove();<br>&#125;<br>selector.close();<br>datagramChannel.close();<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException&#123;<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">UDPServer</span>().receive();<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="é€‰æ‹©å™¨-Selector"><a href="#é€‰æ‹©å™¨-Selector" class="headerlink" title="é€‰æ‹©å™¨  (Selector)"></a>é€‰æ‹©å™¨  (Selector)</h2><p>å°†é€šé“æ³¨å†Œåˆ°é€‰æ‹©å™¨ï¼Œé€šè¿‡é€‰æ‹©å™¨ç›‘å¬IOäº‹ä»¶</p><p>1  å¯è¯» SelectionKey.OP_READ (  é€šé“æœ‰æ•°æ®å¯è¯» )</p><p>2 å¯å†™ SelectionKey.OP_WRITE ( é€šé“æœ‰æ•°æ®å¯å†™ )</p><p>3 è¿æ¥ SelectionKey.OP_CONNECT ( è¿æ¥å»ºç«‹ )</p><p>4 æ¥æ”¶ SelectionKey.OP_ACCEPT ( æœ‰æ–°çš„è¿æ¥åˆ°æ¥ )</p><p>åˆ›å»º selector</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Selector</span> <span class="hljs-variable">selector</span> <span class="hljs-operator">=</span> Selector.open();<br><br><span class="hljs-comment">//è·å–é€šé“</span><br><span class="hljs-type">ServerSocketChannel</span> <span class="hljs-variable">serverSocketChannel</span> <span class="hljs-operator">=</span> ServerSocketChannel.open();<br><span class="hljs-comment">//è®¾ç½®éé˜»å¡</span><br>serverSocketChannel.configureBlocking(<span class="hljs-literal">false</span>);<br><span class="hljs-comment">//ç»‘å®šè¿æ¥</span><br>serverSocketChannel.bind(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-number">18899</span>));<br><span class="hljs-comment">//å°†é€šé“æ³¨å†Œåˆ°é€‰æ‹©å™¨ï¼Œè®¾ç½®ç›‘å¬äº‹ä»¶</span><br>serverSocketChannel.register(selector,SelectionKey.OP_ACCEPT);<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">while</span> (selector.select() &gt; <span class="hljs-number">0</span>)&#123;<br><span class="hljs-type">Set</span> <span class="hljs-variable">selectedKeys</span> <span class="hljs-operator">=</span> selector.selectedKeys();<br><span class="hljs-type">Iterator</span> <span class="hljs-variable">keyIterator</span> <span class="hljs-operator">=</span> selectedKeys.iterator();<br><span class="hljs-keyword">while</span>(keyIterator.hasNext())&#123;<br><span class="hljs-type">SelectionKey</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> keyIterator.next();<br><span class="hljs-keyword">if</span>(key.isAcceptable())&#123;<br><span class="hljs-comment">//</span><br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key.isConnectable())&#123;<br><span class="hljs-comment">//</span><br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key.isReadable())&#123;<br><span class="hljs-comment">//</span><br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key.isWritable())&#123;<br>  <span class="hljs-comment">//</span><br>&#125; <br>keyIterator.remove();<br>&#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure><p>å®ç°discardæœåŠ¡å™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å®¢æˆ·ç«¯</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NioDiscardClient</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startServer</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException&#123;<br><span class="hljs-type">Selector</span> <span class="hljs-variable">selector</span> <span class="hljs-operator">=</span> Selector.open();<br><span class="hljs-type">ServerSocketChannel</span> <span class="hljs-variable">serverSocketChannel</span> <span class="hljs-operator">=</span> ServerSocketChannel.open();<br>serverSocketChannel.configureBlocking(<span class="hljs-literal">false</span>);<br>serverSocketChannel.bind(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-number">18899</span>));<br>Logger.info(<span class="hljs-string">&quot;æœåŠ¡å™¨å¯åŠ¨&quot;</span>);<br>serverSocketChannel.register(selector,selectionKey.OP_ACCEPT);<br><span class="hljs-keyword">while</span>(selector.select()&gt;<span class="hljs-number">0</span>)&#123;<br>Iterator&lt;SelectionKey&gt; selectedKeys = selector.selectedKeys().iterator();<br><span class="hljs-keyword">while</span> (selectedKeys.hasNext())&#123;<br><span class="hljs-type">SelectionKey</span> <span class="hljs-variable">selectedKey</span> <span class="hljs-operator">=</span> selectedKeys.next();<br><span class="hljs-keyword">if</span>(selectedKey.isAcceptable())&#123;<br><span class="hljs-type">SocketChannel</span> <span class="hljs-variable">socketChannel</span> <span class="hljs-operator">=</span> serverSocketChannel.accept();<br>socketChannel.configureBlocking(<span class="hljs-literal">false</span>);<br>socketChannel.register(selector, SelectionKey.OP_READ);<br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (selectedKey.isReadable())&#123;<br><span class="hljs-type">SocketChannel</span> <span class="hljs-variable">socketChannel</span> <span class="hljs-operator">=</span> (SocketChannel) selectedKey.channel();<br><span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">byteBuffer</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(<span class="hljs-number">1024</span>);<br><span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> ;<br><span class="hljs-keyword">while</span>((length = socketChannel.read(byteBuffer))&gt;<span class="hljs-number">0</span>)&#123;<br>byteBuffer.flip();<br>Logger.info(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(byteBuffer.array(),<span class="hljs-number">0</span>,length));<br>byteBuffer.clear();<br>&#125;<br>socketChannel.close();<br>&#125;<br>selectedKeys.remove();<br>&#125;<br>&#125;<br>serverSocketChannel.close();<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException&#123;<br>startServer();<br>&#125;<br><br>&#125;<br><br><span class="hljs-comment">// æœåŠ¡ç«¯</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NioReceiveServer</span>&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">RECEIVE_PATH</span> <span class="hljs-operator">=</span> NioDemoConfig.SOCKET_RECEIVE_PATH;<br><span class="hljs-keyword">private</span> <span class="hljs-type">Charset</span> <span class="hljs-variable">charset</span> <span class="hljs-operator">=</span> Charset.forName(<span class="hljs-string">&quot;UTF-8&quot;</span>);<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span><br>&#123;<br>    String fileName ;<br>    <span class="hljs-type">long</span> fileLength ;<br>    <span class="hljs-type">long</span> startTime  ;<br>    InetSocketAddress remoteAddress ;<br>    FileChannel outChannel ;<br>    <span class="hljs-type">long</span> receiveLength ;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isFinished</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> receiveLength &gt;= fileLength ;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buffer</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(NioDemoConfig.SERVER_BUFFER_SIZE);<br>Map&lt;SelectableChannel , Client&gt; clientMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;SelectableChannel , Client&gt;();<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startServer</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException<br>&#123;<br>    <span class="hljs-type">Selector</span> <span class="hljs-variable">selector</span> <span class="hljs-operator">=</span> Selector.open();<br>    <span class="hljs-type">ServerSocketChannel</span> <span class="hljs-variable">serverChannel</span> <span class="hljs-operator">=</span> ServerSocketChannel.open();<br>    <span class="hljs-type">ServerSocket</span> <span class="hljs-variable">serverSocket</span> <span class="hljs-operator">=</span> serverChannel.socket();<br>    serverSocket.configureBlocking(<span class="hljs-literal">false</span>);<br>    <span class="hljs-type">InetSocketAddress</span> <span class="hljs-variable">address</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InetSocketAddress</span>(<span class="hljs-number">18899</span>);<br>    serverSocket.bind(address);<br>    serverChannel.register(selector , SelectionKey.OP_ACCEPT);<br>    Print.tcfo(<span class="hljs-string">&quot;server is listening ...&quot;</span>);<br>    <span class="hljs-keyword">while</span>(selector.select() &gt;<span class="hljs-number">0</span> )&#123;<br>        Iterator&lt;SelectionKey&gt; it = selector.selectedKeys().iterator();<br>        <span class="hljs-keyword">while</span>(it.hasNext())&#123;<br>                <span class="hljs-type">SelectionKey</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> it.next();<br>                <span class="hljs-keyword">if</span>(key.isAcceptable())&#123;<br>                    <span class="hljs-type">ServerSocketChannel</span> <span class="hljs-variable">server</span> <span class="hljs-operator">=</span> (ServerSocketChannel)key.channel();<br>                    <span class="hljs-type">SocketChannel</span> <span class="hljs-variable">socketChannel</span> <span class="hljs-operator">=</span> server.accept();<br>                    <span class="hljs-keyword">if</span> (socketChannel == <span class="hljs-literal">null</span>) <span class="hljs-keyword">continue</span> ;<br>                    socketChannel.configureBlocking(<span class="hljs-literal">false</span>);<br>                    <span class="hljs-type">SelectionKey</span> <span class="hljs-variable">selectionKey</span> <span class="hljs-operator">=</span> socketChannel.register(selector,SelectionKey.OP_READ);<br>                    <span class="hljs-type">Client</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Client</span>();<br>                    client.remoteAddress = (InetSocketAddress)socketChannel.getRemoteAddress();<br>                    clientMap.put(socketChannel,client);<br>                    Logger.debug(socketChannel.getRemoteAddress()+<span class="hljs-string">&quot;è¿æ¥æˆåŠŸ ...&quot;</span>);<br>                    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key.isReadable())&#123;<br>                            processData(key);<br>                    &#125; <br>                    it.remove();<br>                &#125;<br>        &#125;  <br>    &#125;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processData</span> <span class="hljs-params">(SelectionKey key)</span> <span class="hljs-keyword">throws</span> IOException <br>&#123;<br>    <span class="hljs-type">Client</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> clientMap.get(key.channel());<br>    <span class="hljs-type">SocketChannel</span> <span class="hljs-variable">socketChannel</span> <span class="hljs-operator">=</span> (SocketChannel)key.channel();<br>    <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        buffer.clear();<br>        <span class="hljs-keyword">while</span>((num = socketChannel.read(buffer)) &gt; <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> == client.fileName)&#123; <br>                <span class="hljs-keyword">if</span>(buffer.capacity() &lt; <span class="hljs-number">4</span>)&#123;<br>                    <span class="hljs-keyword">continue</span>;<br>                &#125;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">fileNameLen</span> <span class="hljs-operator">=</span> buffer.getInt();<br>            <span class="hljs-type">byte</span>[] fileNameBytes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[fileNameLen];<br>            buffer.get(fileNameBytes);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">fileName</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(fileNameBytes,charset);<br>            <span class="hljs-type">File</span> <span class="hljs-variable">dirctory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(RECEIVE_PATH);<br>            <span class="hljs-keyword">if</span> (!dirctory.exists())&#123; <br>                dirctory.mkdirs();<br>            &#125;<br>            Logger.info(<span class="hljs-string">&quot;NIO ä¼ è¾“ç›®æ ‡dir ï¼š &quot;</span>+ dirctory);<br>            client.fileName = fileName;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">fullName</span> <span class="hljs-operator">=</span> dirctory.getAbsolutePath() + File.separator + fileName;<br>            Logger.info(<span class="hljs-string">&quot;NIO ä¼ è¾“ç›®æ ‡æ–‡ä»¶ï¼š&quot;</span> + fullName);<br>            <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(fullName.trim());<br>            <span class="hljs-keyword">if</span> (!file.exists())&#123;<br>                file.createNewFile();<br>            &#125;<br>            <span class="hljs-type">FileChannel</span> <span class="hljs-variable">fileChannel</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(file).getChannel();<br>            client.outChannel = fileChannel;<br>            <span class="hljs-keyword">if</span>(buffer.capacity() &lt; <span class="hljs-number">8</span>)&#123;<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            <span class="hljs-type">long</span> <span class="hljs-variable">fileLength</span> <span class="hljs-operator">=</span> buffer.getLong();<br>            client.fileLength = fileLength;<br>            client.startTime = System.currentTimeMillis();<br>            Logger.info(<span class="hljs-string">&quot;ä¼ è¾“å¼€å§‹&quot;</span>);<br>            client.receiveLength += buffer.capacity();<br>            <span class="hljs-keyword">if</span>(buffer.capacity() &gt; <span class="hljs-number">0</span>)&#123;<br>                client.outChannel.write(buffer);<br>            &#125;<span class="hljs-keyword">if</span> (client.isFinished())&#123;<br>                finished(key,client);<br>            &#125;<br>            buffer.clear();<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            client.receiveLength += buffer.capacity();<br>            client.outChannel.write(buffer);<br>            <span class="hljs-keyword">if</span> (client.isFinished())&#123;<br>                finished(key,client);<br>            &#125;<br>            buffer.clear();<br>        &#125;<br>    &#125;key.cancel();<br>    &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>        key.cancel();<br>        e.printStackTrace();<br>        <span class="hljs-keyword">return</span> ;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(num == <span class="hljs-number">0</span> )&#123;<br>        finished(key,client);<br>        buffer.clear();<br>    &#125;<br>&#125;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">finished</span><span class="hljs-params">(SelectionKey key,Client client)</span>&#123;<br>    ImageOutputStreamImpl.closeQuietly(client.outChannel);<br>    Logger.info(<span class="hljs-string">&quot;ä¼ è¾“ç»“æŸ&quot;</span>);<br>    key.cancel();<br>    Logger.debug(<span class="hljs-string">&quot;æ–‡ä»¶ä¼ è¾“æˆåŠŸ,File Name : &quot;</span>+ client.fileName);<br>    Logger.debug(<span class="hljs-string">&quot;æ–‡ä»¶ä¼ è¾“æˆåŠŸ,File Length : &quot;</span>+ client.fileLength);<br>    <span class="hljs-type">long</span> <span class="hljs-variable">endTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis(); <br>    Logger.debug(<span class="hljs-string">&quot;æ–‡ä»¶ä¼ è¾“æˆåŠŸ,File Speed : &quot;</span>+ client.fileLength/(endTime - client.startTime));<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException&#123;<br>    <span class="hljs-type">NioReceiveServer</span> <span class="hljs-variable">server</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioReceiveServer</span>();<br>    server.startServer();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaç¼–ç¨‹ VI ç½‘ç»œç¼–ç¨‹</title>
    <link href="/2025/04/29/Java%E7%BC%96%E7%A8%8B-VI-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/"/>
    <url>/2025/04/29/Java%E7%BC%96%E7%A8%8B-VI-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="Socket"><a href="#Socket" class="headerlink" title="Socket"></a>Socket</h1><p>socketæä¾›äº†ä¸å¤–éƒ¨ç½‘ç»œé€šä¿¡çš„ç½‘ç»œæ¥å£</p><h2 id="InetAddress"><a href="#InetAddress" class="headerlink" title="InetAddress"></a>InetAddress</h2><p>InetAddress æä¾›äº†ä¸€äº›è·å–ipåœ°å€ä¿¡æ¯çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> InetAddress <span class="hljs-title function_">getByName</span><span class="hljs-params">(String host)</span>     <br><span class="hljs-keyword">static</span> InetAddress[] getAllByName(String host)  <span class="hljs-comment">// ä¸ºç»™å®šä¸»æœºååˆ›å»ºä¸€ä¸ªInetAddresså¯¹è±¡</span><br><span class="hljs-keyword">static</span> InetAddress <span class="hljs-title function_">getLocalHost</span><span class="hljs-params">()</span>  <span class="hljs-comment">// ä¸ºæœ¬åœ°ä¸»æœºåˆ›å»ºä¸€ä¸ªInetAddresså¯¹è±¡</span><br><span class="hljs-type">byte</span>[] getAddress()         <span class="hljs-comment">// è·å–æ•°å­—å‹åœ°å€çš„å­—èŠ‚æ•°ç»„</span><br>String <span class="hljs-title function_">getHostAddress</span><span class="hljs-params">()</span>     <span class="hljs-comment">// ä»¥å­—ç¬¦ä¸²è¿”å›ä¸»æœºåœ°å€</span><br>String <span class="hljs-title function_">getHostName</span><span class="hljs-params">()</span>        <span class="hljs-comment">// è¿”å›ä¸»æœºå</span><br></code></pre></td></tr></table></figure><h2 id="åˆ›å»ºä¸€ä¸ªSocket-Server"><a href="#åˆ›å»ºä¸€ä¸ªSocket-Server" class="headerlink" title="åˆ›å»ºä¸€ä¸ªSocket Server"></a>åˆ›å»ºä¸€ä¸ªSocket Server</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.* ;<br><span class="hljs-keyword">import</span> java.net.*;<br><span class="hljs-keyword">import</span> java.nio.charset.StandardCharsets;<br><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Echoserver</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception&#123; <br>        <span class="hljs-keyword">try</span>(<span class="hljs-type">var</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerSocket</span>(<span class="hljs-number">8189</span>))&#123;<br>            <span class="hljs-keyword">try</span>(<span class="hljs-type">Socket</span> <span class="hljs-variable">incoming</span> <span class="hljs-operator">=</span> s.accept())&#123;<br>                <span class="hljs-type">InputStream</span> <span class="hljs-variable">inStream</span> <span class="hljs-operator">=</span> incoming.getInputStream();<br>                <span class="hljs-type">OutputStream</span> <span class="hljs-variable">outStream</span> <span class="hljs-operator">=</span> incoming.getOutputStream();<br>                <span class="hljs-keyword">try</span>(<span class="hljs-type">var</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(inStream, StandardCharsets.UTF_8))&#123;<br>                    <span class="hljs-type">var</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PrintWriter</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OutputStreamWriter</span>(outStream,StandardCharsets.UTF_8),<span class="hljs-literal">true</span>);<br>                    out.println(<span class="hljs-string">&quot;Hello! Enter BYE to exit.&quot;</span>);<br>                    <span class="hljs-type">var</span> <span class="hljs-variable">done</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>                    <span class="hljs-keyword">while</span>(!done&amp;&amp;in.hasNextLine())&#123;<br>                        <span class="hljs-type">String</span> <span class="hljs-variable">line</span> <span class="hljs-operator">=</span> in.nextLine();<br>                        out.println(<span class="hljs-string">&quot;Echo:&quot;</span>+line);<br>                        <span class="hljs-keyword">if</span>(line.trim().equals(<span class="hljs-string">&quot;BYE&quot;</span>))<br>                            done = <span class="hljs-literal">true</span>;<br>                    &#125;<br>                &#125;<br>            &#125;<br>      <br>        &#125;;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>å½“å‰çš„æœåŠ¡å™¨ åªèƒ½æ¥å—ä¸€ä¸ªç”¨æˆ·è¯·æ±‚ï¼Œä½¿ç”¨ å¤šçº¿ç¨‹å°†å®ƒæ”¹é€ ä¸ºæ¥å—å¤šä¸ªç”¨æˆ·è¯·æ±‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.* ;<br><span class="hljs-keyword">import</span> java.net.*;<br><span class="hljs-keyword">import</span> java.nio.charset.StandardCharsets;<br><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Echoserver</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception&#123; <br>        <span class="hljs-keyword">try</span>(<span class="hljs-type">var</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerSocket</span>(<span class="hljs-number">8189</span>))&#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br>                <span class="hljs-type">Socket</span> <span class="hljs-variable">incoming</span> <span class="hljs-operator">=</span> s.accept();<br>                <span class="hljs-type">Runnable</span> <span class="hljs-variable">thread_mission</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadedHandler</span>(incoming);<br>                <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(thread_mission);<br>                t.start();<br>            &#125;<br>        &#125;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>    <span class="hljs-keyword">private</span> Socket incoming;<br>    ThreadedHandler(Socket incoming)&#123;<br>        <span class="hljs-built_in">this</span>.incoming = incoming;<br>    &#125;<br>    <span class="hljs-meta">@Override</span> <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">InputStream</span> <span class="hljs-variable">inStream</span> <span class="hljs-operator">=</span> incoming.getInputStream();<br>            <span class="hljs-type">OutputStream</span> <span class="hljs-variable">outStream</span> <span class="hljs-operator">=</span> incoming.getOutputStream();<br>            <span class="hljs-keyword">try</span>(<span class="hljs-type">var</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(inStream, StandardCharsets.UTF_8))&#123;<br>                <span class="hljs-type">var</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PrintWriter</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OutputStreamWriter</span>(outStream,StandardCharsets.UTF_8),<span class="hljs-literal">true</span>);<br>                <span class="hljs-comment">//flush å¼ºåˆ¶å°†ç¼“å­˜åŒºæ•°æ®å‘é€å‡ºå»ã€‚</span><br>                out.println(<span class="hljs-string">&quot;Hello! Enter BYE to exit.&quot;</span>);<br>                <span class="hljs-type">var</span> <span class="hljs-variable">done</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>                <span class="hljs-keyword">while</span>(!done&amp;&amp;in.hasNextLine())&#123;<br>                    <span class="hljs-type">String</span> <span class="hljs-variable">line</span> <span class="hljs-operator">=</span> in.nextLine();<br>                    out.println(<span class="hljs-string">&quot;Echo:&quot;</span>+line);<br>                    <span class="hljs-keyword">if</span>(line.trim().equals(<span class="hljs-string">&quot;BYE&quot;</span>))<br>                        done = <span class="hljs-literal">true</span>;<br>                &#125;<br>            &#125;<span class="hljs-keyword">catch</span>(Exception e)&#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºTCPç«¯å£è™½ç„¶æ˜¯å›ºå®šçš„ï¼Œä½†æ“ä½œç³»ç»Ÿé€šè¿‡ä¸ºæ¯ä¸ªè¿æ¥åˆ†é…å”¯ä¸€çš„ socketï¼ˆåŸºäºå››å…ƒç»„æ ‡è¯†ï¼‰æ¥å®ç°å¤šä¸ªè¿æ¥å…±ç”¨ä¸€ä¸ªç›‘å¬ç«¯å£ã€‚åº”ç”¨ç¨‹åºé€šå¸¸ä¸ºæ¯ä¸ª socket å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æˆ–äº‹ä»¶å¾ªç¯è¿›è¡Œæ•°æ®å¤„ç†ï¼Œä»è€Œå®ç°é«˜å¹¶å‘è¿æ¥çš„å¤„ç†ã€‚</p><h2 id="åŠå…³é—­"><a href="#åŠå…³é—­" class="headerlink" title="åŠå…³é—­"></a>åŠå…³é—­</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java">tar (<span class="hljs-type">var</span> <span class="hljs-variable">socket</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Socket</span>(host,port))&#123;<br><span class="hljs-type">var</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(socket.getInputStream(),StandardCharsets.UTF_8);<br><span class="hljs-type">var</span> <span class="hljs-variable">writer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PrintWriter</span>(socket.getOutputStream());<br>writer.print(...);<br>writer.flush();<br>socket.shutdownOutput();<br><span class="hljs-keyword">while</span>(in.hasNextLine() !=<span class="hljs-literal">null</span> )<br>&#123;<br><span class="hljs-type">String</span> <span class="hljs-variable">line</span> <span class="hljs-operator">=</span> in.next.line;<br>...<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p>javaæä¾›äº†url å¯¹è±¡æ¥å¯¹web æ•°æ®çš„è®¿é—®åœ°å€è¿›è¡Œå°è£…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">InputStream</span> <span class="hljs-variable">inStream</span> <span class="hljs-operator">=</span> url.OpenStream();<br><span class="hljs-type">var</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(inStream,StandardCharsets.UTF-<span class="hljs-number">8</span>);<br></code></pre></td></tr></table></figure><p>urlconnection</p><p>ä»urlä¸­è·å–æ›´å¤šçš„å†…å®¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">URLConnection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> url.openConnecton();<br></code></pre></td></tr></table></figure><p>URL</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">InputStream <span class="hljs-title function_">openStream</span><span class="hljs-params">()</span><br>URLConnection <span class="hljs-title function_">openConnection</span><span class="hljs-params">()</span><br></code></pre></td></tr></table></figure><p>URLConnection</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">setDoInput</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è®¾ç½®æ¥æ”¶æ•°æ®çŠ¶æ€</span><br><span class="hljs-type">boolean</span> <span class="hljs-title function_">getDoInput</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è·å–æ¥æ”¶æŠ¤æ•°æ®çš„çŠ¶æ€</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">setDoOutput</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è®¾ç½®åˆ›å»ºå‘é€æµ</span><br><span class="hljs-type">boolean</span> <span class="hljs-title function_">getDoOutput</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è·å–å‘é€æµçš„çŠ¶æ€</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">setIfModifiedSince</span><span class="hljs-params">(<span class="hljs-type">long</span> time)</span><br><span class="hljs-comment">// è·å–æŸä¸ªæ—¶é—´ç‚¹ä¾èµ–ä¿®æ”¹çš„æ•°æ®</span><br><span class="hljs-type">long</span> <span class="hljs-title function_">getIfModifiedSince</span><span class="hljs-params">()</span><br><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">setConnectTimeout</span><span class="hljs-params">()</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">getConnectTimeout</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è®¾ç½®è¿æ¥çš„è¶…æ—¶æ—¶é—´</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">getReadTimeout</span><span class="hljs-params">()</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">setReadTimeout</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è®¾ç½®è¯»å–æ•°æ®çš„è¶…æ—¶æ—¶é—´</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">setRequestProperty</span><span class="hljs-params">(String key ,String value)</span><br>Map&lt;String,List&lt;String&gt;&gt; <span class="hljs-title function_">getRequestProperties</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è®¾ç½® /è¯»å– è¯·æ±‚å¤´ä¸­çš„å±æ€§</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">connect</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è¿æ¥è¿œç¨‹èµ„æºå¹¶è·å–å¤´éƒ¨ä¿¡æ¯</span><br>Map&lt;String, List&lt;String&gt;&gt; <span class="hljs-title function_">getHeaderFields</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è·å–å“åº”å¤´æ˜ å°„è¡¨</span><br>String <span class="hljs-title function_">getHeaderFileKey</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span><br>String <span class="hljs-title function_">getHeaderField</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span><br><span class="hljs-comment">// è·å–ç¬¬nä¸ªå“åº”å¤´çš„é”®/å€¼ä¿¡æ¯</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">getContentLength</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è·å–å†…å®¹é•¿åº¦</span><br>String <span class="hljs-title function_">getConnentType</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è·å–å†…å®¹çš„ç±»å‹</span><br>String <span class="hljs-title function_">getContentEncoding</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è·å–ç¼–ç ä¿¡æ¯</span><br><span class="hljs-type">long</span> <span class="hljs-title function_">getDate</span><span class="hljs-params">()</span><br><span class="hljs-type">long</span> <span class="hljs-title function_">getExpiration</span><span class="hljs-params">()</span><br><span class="hljs-type">long</span> <span class="hljs-title function_">getLastModifed</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è·å–åˆ›å»ºæ—¥æœŸï¼Œè¶…æ—¶æ—¥æœŸå’Œæœ€åä¸€æ¬¡ä¿®æ”¹çš„æ—¥æœŸ</span><br>InputStream <span class="hljs-title function_">getInputStream</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è·å–ä¸€ä¸ªè¾“å…¥æµ</span><br>OutputStream <span class="hljs-title function_">getOutputStream</span><span class="hljs-params">()</span><br><span class="hljs-comment">// è·å–ä¸€ä¸ªè¾“å‡ºæµ</span><br>Object <span class="hljs-title function_">getContent</span><span class="hljs-params">()</span><br></code></pre></td></tr></table></figure><h2 id="HTTP-å®¢æˆ·ç«¯"><a href="#HTTP-å®¢æˆ·ç«¯" class="headerlink" title="HTTP å®¢æˆ·ç«¯"></a>HTTP å®¢æˆ·ç«¯</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">HttpClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> HttpClient.newHttpClient()<br><span class="hljs-type">HttpClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> HttpClient.newBuilder().followRedirects(HttpClient.Redirect.ALWAYS).build()<br><span class="hljs-type">HttpClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> HttpClient.newBuilder().uri(<span class="hljs-keyword">new</span> <span class="hljs-title class_">URI</span>(<span class="hljs-string">&quot;&lt;http://horstmann.com&gt;&quot;</span>)).GET().build()<br><span class="hljs-comment">// åˆ›å»º getè¯·æ±‚</span><br><span class="hljs-type">HttpClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> HttpClient.newBuilder().uri(<span class="hljs-keyword">new</span> <span class="hljs-title class_">URL</span>(url)).POST(HttpRequest.BodyPublishers.ofString(jsonString)).build())<br><span class="hljs-comment">// åˆ›å»º postè¯·æ±‚</span><br></code></pre></td></tr></table></figure><p>é€šè¿‡ HttpResponse æ¥æ”¶å®¢æˆ·ç«¯å“åº”</p><p>HttpResponse<code>&lt;T&gt;</code> ç±» æ¥æ”¶ä¸€ä¸ª ç»è¿‡å“åº”å¤„ç†å™¨ï¼ˆHttpResponse.BodyHandlers.ofString()ï¼‰å¤„ç†çš„å“åº”å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">HttpResponse&lt;String&gt; response = client.send(request,HttpResponse.BodyHandlers.ofString());<br></code></pre></td></tr></table></figure><p>é€šè¿‡HttpResponses è¿˜å¯ä»¥è·å–å¤´ä¿¡æ¯å’ŒçŠ¶æ€ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> <span class="hljs-variable">status</span> <span class="hljs-operator">=</span> response.statusCode();       <span class="hljs-comment">// è·å–çŠ¶æ€ç ä¿¡æ¯</span><br><span class="hljs-type">HttpHeaders</span> <span class="hljs-variable">responseHeaders</span> <span class="hljs-operator">=</span> response.headers();   <span class="hljs-comment">// è·å–å“åº”å¤´</span><br>Map&lt;String,List&lt;String&gt;&gt; headerMap = responseHeaders.map();  <span class="hljs-comment">// è·å–å“åº”å¤´çš„æ˜ å°„ä¿¡æ¯</span><br>Optional&lt;String&gt; lastModified = responseHeaders.firstValue(<span class="hljs-string">&quot;Last-Modified&quot;</span>); <span class="hljs-comment">// è·å–å…·ä½“çš„å­—æ®µ</span><br><br><span class="hljs-type">ExecutorSevice</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executor.newCachedThreadPool();  <span class="hljs-comment">//åˆ›å»ºçº¿ç¨‹æ± </span><br><span class="hljs-type">HttpClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> HttpClient.newBuilder().executor(executor).build();  <span class="hljs-comment">// åˆ›å»ºclientæ”¾å…¥çº¿ç¨‹æ± </span><br><br><span class="hljs-type">HttpRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> HttpRequest.newBuilder().uri(uri).GET().build();<br>client.sendAsync(request, HttpResponse.BodyHandlers.ofString())  <br>.thenAccept(response-&gt;);  <span class="hljs-comment">// åˆ›å»ºå¼‚æ­¥å“åº”ï¼Œåˆ›å»ºè¯·æ±‚ï¼Œä½¿ç”¨client å‘é€è¯¥è¯·æ±‚ï¼Œå¹¶é€šè¿‡thenAccept</span><br><span class="hljs-comment">//  æ¥å¤„ç†å¾—åˆ°å“åº”åçš„ä»»åŠ¡</span><br></code></pre></td></tr></table></figure><p>æ–¹æ³•ç­¾å</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java">HttpClient <br><span class="hljs-keyword">static</span> HttpClient <span class="hljs-title function_">newHttpClient</span><span class="hljs-params">()</span><br><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªé»˜è®¤çš„HttpClientå¯¹è±¡</span><br><span class="hljs-keyword">static</span> HttpClient.Builder <span class="hljs-title function_">newBuilder</span><span class="hljs-params">()</span><br><span class="hljs-comment">// åœ¨æµä¸­åˆ›å»ºä¸€ä¸ªHttpClient å¯¹è±¡</span><br>&lt;T&gt; HttpResponse&lt;T&gt; <span class="hljs-title function_">send</span><span class="hljs-params">(HttpRequest request , HttpResponse.BodyHandler&lt;T&gt; responseBodyHandler)</span><br><span class="hljs-comment">// client å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ªHttpResponseå¯¹è±¡</span><br>&lt;T&gt; CompletableFuture&lt;HttpResponse&lt;T&gt;&gt; <span class="hljs-title function_">sendAsync</span><span class="hljs-params">(HttpRequest request, HttpResponse.BodyHandler </span><br><span class="hljs-params">// ä½¿ç”¨sendAsync å‘é€ä¸€ä¸ªå¼‚æ­¥è¯·æ±‚ï¼Œ åç»­ä½¿ç”¨thenAcceptæ¥æ”¶å¼‚æ­¥å“åº”çš„å¤„ç†</span><br><span class="hljs-params">&lt;T&gt; responseBodyHandler )</span><br><br>HttpClient.Builder<br>HttpClient <span class="hljs-title function_">build</span><span class="hljs-params">()</span><br><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªHttpClient å®ä¾‹ï¼ˆç»ˆç»“æ–¹æ³•ï¼‰</span><br>HttpClient.Builder <span class="hljs-title function_">followRedirects</span><span class="hljs-params">(HttpClient.Redirect policy(ALWAYS, NEVR,NORMAL)</span>)<br><span class="hljs-comment">// è®¾ç½®å®¢æˆ·ç«¯æ¥æ”¶é‡å®šå‘çš„ç­–ç•¥</span><br>HttpClient.Builder <span class="hljs-title function_">executor</span><span class="hljs-params">(Executor executor)</span><br><span class="hljs-comment">// å°†å®¢æˆ·ç«¯åŠ å…¥æŒ‡å®šçš„æ‰§è¡Œå™¨</span><br><br>HttpRequest<br>HttpRequest.Builder <span class="hljs-title function_">newBuilder</span><span class="hljs-params">()</span><br><span class="hljs-comment">// æµå¼è°ƒç”¨åˆ›å»ºä¸€ä¸ªrequestè¯·æ±‚</span><br>HttpRequest.Builder<br>HttpRequest <span class="hljs-title function_">build</span><span class="hljs-params">()</span><br><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªHttpRequest å®ä¾‹ ï¼ˆç»ˆç»“æ–¹æ³•ï¼‰</span><br>HttpRequest.Builder <span class="hljs-title function_">uri</span><span class="hljs-params">(URI uri)</span><br><span class="hljs-comment">// æµå¼è°ƒç”¨ä¸­æŒ‡å®šuri</span><br>HttpRequest.Builder <span class="hljs-title function_">GET</span><span class="hljs-params">()</span><br><span class="hljs-comment">// æŒ‡å®šhttp getæ–¹æ³•</span><br>HttpRequest.Builder <span class="hljs-title function_">DELETE</span><span class="hljs-params">()</span><br><span class="hljs-comment">// æŒ‡å®š http delete æ–¹æ³•</span><br>HttpRequest.Builder <span class="hljs-title function_">POST</span><span class="hljs-params">(HttpRequest.BodyPublisher bodyPublisher)</span><br><span class="hljs-comment">// æŒ‡å®š http post æ–¹æ³• æ¥æ”¶ä¸€ä¸ªè¯·æ±‚ä½“</span><br>HttpRequest.Builder <span class="hljs-title function_">PUT</span><span class="hljs-params">(HttpRequest.BodyPublisher bodyPublisher)</span><br><span class="hljs-comment">// æŒ‡å®š http put æ–¹æ³• æ¥æ”¶ä¸€ä¸ªè¯·æ±‚å¤´</span><br>HttpResponse<br>T <span class="hljs-title function_">body</span><span class="hljs-params">()</span><br><span class="hljs-comment">// äº§ç”Ÿå“åº”ä½“</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">statusCode</span><span class="hljs-params">()</span><br><span class="hljs-comment">// çŠ¶æ€ç </span><br>HttpHeaders <span class="hljs-title function_">headers</span><span class="hljs-params">()</span><br><span class="hljs-comment">// å“åº”å¤´</span><br><br>HttpHeaders<br>Map&lt;String , List&lt;String&gt;&gt; <span class="hljs-title function_">map</span><span class="hljs-params">()</span><br><span class="hljs-comment">// é€šè¿‡map è·å– httpheaders çš„æ˜ å°„</span><br>Optional&lt;String&gt; <span class="hljs-title function_">firstValue</span><span class="hljs-params">(String name)</span><br><span class="hljs-comment">// è·å– å¤´ä¸­å±æ€§çš„ç¬¬ä¸€ä¸ªå€¼</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaç¼–ç¨‹ V å¹¶å‘</title>
    <link href="/2025/04/29/Java%E7%BC%96%E7%A8%8B-V-%E5%B9%B6%E5%8F%91/"/>
    <url>/2025/04/29/Java%E7%BC%96%E7%A8%8B-V-%E5%B9%B6%E5%8F%91/</url>
    
    <content type="html"><![CDATA[<h1 id="çº¿ç¨‹"><a href="#çº¿ç¨‹" class="headerlink" title="çº¿ç¨‹"></a>çº¿ç¨‹</h1><p>åœ¨javaä¸­ï¼Œé€šè¿‡å®ç°Runnableæ¥å£ï¼Œå¯ä»¥å®ç°å¤šçº¿ç¨‹çš„åˆ›å»º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Thread_Test</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Runnable</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> ()-&gt;&#123;System.out.println(Thread.currentThread().getName());&#125;;<br>        <span class="hljs-type">Runnable</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> ()-&gt;&#123;System.out.println(Thread.currentThread().getName());&#125;;<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(t1);<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(t2);<br>        m.start();<br>        s.start();<br>    &#125;<br>&#125;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * è¾“å‡º</span><br><span class="hljs-comment"> * Thread-1</span><br><span class="hljs-comment"> * Thread-0</span><br><span class="hljs-comment"> */</span><br></code></pre></td></tr></table></figure><h2 id="ç«æ€æ¡ä»¶"><a href="#ç«æ€æ¡ä»¶" class="headerlink" title="ç«æ€æ¡ä»¶"></a>ç«æ€æ¡ä»¶</h2><p>å½“æœ‰å¤šä¸ªçº¿ç¨‹éœ€è¦å…±äº«å¯¹åŒä¸€æ•°æ®çš„å­˜å–ï¼Œå¹¶ä¸”éƒ½è°ƒç”¨äº†è¦å¯¹å¯¹è±¡è¿›è¡Œä¿®æ”¹çš„æ–¹æ³•ï¼Œå°±ä¼šå‘ç”Ÿç«æ€æ¡ä»¶ã€‚å› ä¸ºè¿™äº›æ–¹æ³•æ˜¯éåŸå­çš„ ï¼Œå³ è¯»-å¤„ç†-å­˜å‚¨ å¹¶éæ˜¯åŒä¸€ä¸ªæ“ä½œï¼Œè¿™æ—¶å°±ä¼šå¯¼è‡´è¯»å–çš„æ•°æ®å¯èƒ½åœ¨å¤šä¸ªçº¿ç¨‹é—´è¢«å¤„ç†ï¼Œå¯¼è‡´æœ€ç»ˆçš„ç»“æœä¸ç¨³å®šã€‚</p><h2 id="é”"><a href="#é”" class="headerlink" title="é”"></a>é”</h2><p>é€šè¿‡å®šä¹‰é”ç»“æ„ï¼Œå°†ä¸€ç³»åˆ—æ“ä½œå˜ä¸ºåŸå­åŒ–æ“ä½œï¼Œå³åœ¨è¿™ä¸€äº›åˆ—æ“ä½œè¢«å®Œå…¨æ‰§è¡Œå‰ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•å¯¹è¿™ä¸ªå…±äº«èµ„æºè¿›è¡Œæ“ä½œã€‚</p><p>æœªåŠ é”ï¼ŒéåŸå­æ“ä½œå¯¼è‡´æ•°æ®å¼‚å¸¸ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Thread_Test</span>&#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        <span class="hljs-type">Runnable</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>                    <span class="hljs-keyword">while</span> (i &lt; <span class="hljs-number">100</span>)&#123;<br>                        count++;<br>                        i++;<br>                        System.out.println(<span class="hljs-string">&quot;thread_name: &quot;</span>+ Thread.currentThread().getName() +<span class="hljs-string">&quot;count : &quot;</span> + count);<br>                        Thread.sleep(<span class="hljs-number">10</span>);   <br>                    &#125;<br>                &#125;<span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;;<br>        <span class="hljs-type">Runnable</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-type">int</span> i= <span class="hljs-number">0</span>;<br>                    <span class="hljs-keyword">while</span> ( i &lt; <span class="hljs-number">100</span>)&#123;<br>                        count++;<br>                        i++;<br>                        System.out.println(<span class="hljs-string">&quot;thread_name: &quot;</span>+ Thread.currentThread().getName() +<span class="hljs-string">&quot;count : &quot;</span> + count);<br>                        Thread.sleep(<span class="hljs-number">10</span>);   <br>                    &#125;<br>                &#125;<span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;;<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(t1);<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(t2);<br>        m.start();<br>        s.start();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹å…±äº«å˜é‡ count åŠ é”ï¼Œç¨‹åºæ­£å¸¸è¿è¡Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">import</span> java.util.concurrent.locks.Lock;<br><span class="hljs-keyword">import</span> java.util.concurrent.locks.ReentrantLock;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Thread_Test</span>&#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        <span class="hljs-type">Runnable</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>                    <span class="hljs-keyword">while</span> (i &lt; <span class="hljs-number">100</span>)&#123;<br>                        lock.lock();<br>                        count++;<br>                        lock.unlock(); <br>                        i++;<br>                        System.out.println(<span class="hljs-string">&quot;thread_name: &quot;</span>+ Thread.currentThread().getName() +<span class="hljs-string">&quot;count : &quot;</span> + count);<br>                        Thread.sleep(<span class="hljs-number">10</span>);   <br><br>                    &#125;<br>                &#125;<span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;;<br>        <span class="hljs-type">Runnable</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-type">int</span> i= <span class="hljs-number">0</span>;<br>                    <span class="hljs-keyword">while</span> ( i &lt; <span class="hljs-number">100</span>)&#123;<br>                        lock.lock();<br>                        count++;<br>                        lock.unlock(); <br>                        i++;<br>                        System.out.println(<span class="hljs-string">&quot;thread_name: &quot;</span>+ Thread.currentThread().getName() +<span class="hljs-string">&quot;count : &quot;</span> + count);<br>                        Thread.sleep(<span class="hljs-number">10</span>);   <br><br>                    &#125;<br>                &#125;<span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;;<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(t1);<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(t2);<br>        m.start();<br>        s.start();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="synchronized-å…³é”®å­—"><a href="#synchronized-å…³é”®å­—" class="headerlink" title="synchronized å…³é”®å­—"></a>synchronized å…³é”®å­—</h2><p>synchronized å…³é”®å­—æœ¬èº«æ˜¯ç”¨æ¥å£°æ˜ä¸€ä¸ªå¯¹è±¡ä½œä¸ºæ•´ä½“æ˜¯åªå¯ä»¥è¢«æŸä¸ªçº¿ç¨‹æ‰€â€œç‹¬å â€çš„ã€‚</p><p>æ‰€ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹æ³•å¯ä»¥å®šä¹‰ä¸åŒçš„æ§åˆ¶å—</p><table><thead><tr><th>ç±»å‹</th><th>åŠ é”å¯¹è±¡</th><th>å½±å“èŒƒå›´</th></tr></thead><tbody><tr><td><code>synchronized</code>å®ä¾‹æ–¹æ³•</td><td>å½“å‰å®ä¾‹ (<code>this</code>)</td><td>åŒä¸€ä¸ªå¯¹è±¡çš„åŒæ­¥æ–¹æ³•äº’æ–¥</td></tr><tr><td><code>synchronized</code>é™æ€æ–¹æ³•</td><td>å½“å‰ç±»çš„ <code>Class</code>å¯¹è±¡</td><td>æ‰€æœ‰å®ä¾‹å…±äº«ä¸€æŠŠé”ï¼Œäº’æ–¥</td></tr><tr><td><code>synchronized (obj)</code></td><td>è‡ªå®šä¹‰é”å¯¹è±¡ (<code>obj</code>)</td><td>åªåœ¨ä½¿ç”¨è¿™æŠŠé”çš„ä»£ç å—äº’æ–¥</td></tr></tbody></table><p>é€šè¿‡synchronized æ¥å£°æ˜ä¸€ä¸ªæ–¹æ³•æ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">import</span> java.util.concurrent.locks.Lock;<br><span class="hljs-keyword">import</span> java.util.concurrent.locks.ReentrantLock;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Thread_Test</span>&#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;          <br>        <span class="hljs-type">Runnable</span> <span class="hljs-variable">storer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++)&#123;<br>                        operation(-<span class="hljs-number">5</span>);<br>                        Thread.sleep(<span class="hljs-number">100</span>);<br>                    &#125;<br>                &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br><br>            &#125;;<br>        &#125;;<br>        <span class="hljs-type">Runnable</span> <span class="hljs-variable">getter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++)&#123;<br>                        operation(<span class="hljs-number">5</span>);<br>                        Thread.sleep(<span class="hljs-number">100</span>);<br>                    &#125;<br>                &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>                &#125;<br><br>            &#125;;<br>;<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(storer);<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(getter);<br>        t1.start();<br>        t2.start();<br>    &#125;<br>    <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operation</span><span class="hljs-params">(<span class="hljs-type">int</span> money)</span>&#123;<br>        count = count + money;<br>      <br>        System.out.println(<span class="hljs-string">&quot;current thread : &quot;</span> + Thread.currentThread().getName() + <span class="hljs-string">&quot; , current count : &quot;</span> + count);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Object-çš„é€šçŸ¥-ç­‰å¾…"><a href="#Object-çš„é€šçŸ¥-ç­‰å¾…" class="headerlink" title="Object çš„é€šçŸ¥-ç­‰å¾…"></a>Object çš„é€šçŸ¥-ç­‰å¾…</h2><p>é€šè¿‡åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ¥ï¼Œè¿›è¡Œæ•°æ®å—çš„æ§åˆ¶ï¼Œ<br>æ¯ä¸ªå¯¹è±¡åœ¨JVMä¸­æœ‰ä¸€ä¸ª <strong>ç›‘è§†å™¨é”ï¼ˆMonitorï¼‰</strong> ï¼Œè¿™æ˜¯å®ç°synchronizedå…³é”®å­—èƒŒåçš„åŸºç¡€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Thread_Test</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>(); <span class="hljs-comment">// ç»Ÿä¸€ç›‘è§†å™¨é”</span><br>    <span class="hljs-keyword">static</span> List&lt;Integer&gt; array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(<span class="hljs-number">10</span>);<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Runnable</span> <span class="hljs-variable">producer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) &#123;<br>                        <span class="hljs-keyword">synchronized</span> (lock) &#123;<br>                            <span class="hljs-keyword">while</span> (array.size() == <span class="hljs-number">10</span>) &#123; <br>                                lock.wait(); <span class="hljs-comment">// å¦‚æœæ»¡äº†ï¼Œç­‰å¾…</span><br>                            &#125;<br>                            array.add(<span class="hljs-number">1</span>); <span class="hljs-comment">// æ·»åŠ å…ƒç´ </span><br>                            array.add(<span class="hljs-number">1</span>); <span class="hljs-comment">// æ·»åŠ å…ƒç´ </span><br>                            System.out.println(<span class="hljs-string">&quot;Producer added, size: &quot;</span> + array.size());<br>                            lock.notifyAll(); <span class="hljs-comment">// å”¤é†’ç­‰å¾…çš„çº¿ç¨‹</span><br>                        &#125;<br>                        Thread.sleep(<span class="hljs-number">100</span>); <span class="hljs-comment">// è®©å‡ºCPU</span><br>                    &#125;<br>                &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;;<br><br>        <span class="hljs-type">Runnable</span> <span class="hljs-variable">consumer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) &#123;<br>                        <span class="hljs-keyword">synchronized</span> (lock) &#123;<br>                            <span class="hljs-keyword">while</span> (array.size() &lt;= <span class="hljs-number">0</span>) &#123; <br>                                lock.wait(); <span class="hljs-comment">// å¦‚æœç©ºäº†ï¼Œç­‰å¾…</span><br>                            &#125;<br>                            array.remove(<span class="hljs-number">0</span>); <span class="hljs-comment">// ç§»é™¤å…ƒç´ </span><br>                            System.out.println(<span class="hljs-string">&quot;Consumer removed, size: &quot;</span> + array.size());<br>                            lock.notifyAll(); <span class="hljs-comment">// å”¤é†’ç­‰å¾…çš„çº¿ç¨‹</span><br>                        &#125;<br>                        Thread.sleep(<span class="hljs-number">100</span>);<br>                    &#125;<br>                &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;;<br><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(producer);<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(consumer);<br>        t1.start();<br>        t2.start();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ æ§åˆ¶ç«æ€æ¡ä»¶çš„æ“ä½œæœ‰ä¸¤ç§</p><p>1.lock + condition</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>(); <span class="hljs-comment">// åˆ›å»ºä¸€æŠŠé”</span><br><span class="hljs-type">Condition</span> <span class="hljs-variable">condition</span> <span class="hljs-operator">=</span> lock.newCondition(); <span class="hljs-comment">// åˆ›å»ºä¸€æŠŠæ¡ä»¶ï¼ˆè·Ÿè¿™æŠŠé”ç»‘å®šï¼‰</span><br>lock.lock(); <span class="hljs-comment">// åŠ é”</span><br><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">while</span> (ä¸æ»¡è¶³æ¡ä»¶) &#123;<br>        condition.await(); <span class="hljs-comment">// ç­‰å¾…ï¼Œå¹¶é‡Šæ”¾é”</span><br>    &#125;<br>    <span class="hljs-comment">// æ»¡è¶³æ¡ä»¶åç»§ç»­æ‰§è¡Œ</span><br>    <span class="hljs-comment">// å¤„ç†é€»è¾‘...</span><br>    condition.signalAll(); <span class="hljs-comment">// å”¤é†’å…¶ä»–ç­‰å¾…çº¿ç¨‹</span><br>&#125; <span class="hljs-keyword">finally</span> &#123;<br>    lock.unlock(); <span class="hljs-comment">// é‡Šæ”¾é”</span><br>&#125;<br></code></pre></td></tr></table></figure><p>2.synchronized + å¯¹è±¡å—æ§åˆ¶çš„ç­‰å¾…ï¼Œé€šçŸ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">Thread_Test</span><span class="hljs-params">()</span> &#123;<br>    array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(<span class="hljs-number">10</span>);<br>&#125;<br><br><span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">store</span><span class="hljs-params">()</span><span class="hljs-keyword">throws</span>  InterruptedException&#123;<br>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">this</span>.array.size() &gt;= <span class="hljs-number">10</span>)&#123;<br>        wait();<br>    &#125;<br>    array.add(<span class="hljs-number">1</span>);<br>    System.out.println(array.size());<br>    notifyAll();<br>&#125;<br><span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">remove</span><span class="hljs-params">()</span><span class="hljs-keyword">throws</span> InterruptedException&#123;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">this</span>.array.size() &lt;= <span class="hljs-number">0</span>)&#123;<br>        wait();<br>    &#125;<br>    array.remove(<span class="hljs-number">0</span>);<br>    System.out.println(array.size());<br>    notifyAll();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Callable"><a href="#Callable" class="headerlink" title="Callable"></a>Callable</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//</span><br><span class="hljs-keyword">import</span> java.util.concurrent.Callable;<br><span class="hljs-keyword">import</span> java.util.concurrent.FutureTask;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">callable_test</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">A</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">A</span>();<br>        Callable&lt;Integer&gt; callable = () -&gt; &#123;            <span class="hljs-comment">//å®ç°Callableæ¥å£</span><br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span><span class="hljs-number">0</span>  ;i &lt; <span class="hljs-number">100</span> ; i++)&#123;<br>                a.num++;<br>            &#125;<br>            <span class="hljs-keyword">return</span> a.num;<br>        &#125;;<br>        <span class="hljs-type">var</span> <span class="hljs-variable">futuretask</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FutureTask</span>&lt;Integer&gt;(callable);  <span class="hljs-comment">//å°†Callableä¼ å…¥ futuretask</span><br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(futuretask).start();                      <span class="hljs-comment">// ä¼ å…¥çº¿ç¨‹</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">Integer</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> futuretask.get();                  <span class="hljs-comment">// ä»futuretaskè·å–è¿”å›å€¼</span><br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();  <br>        &#125;<span class="hljs-keyword">finally</span>&#123;<br>            System.out.println(a.num);<br>        &#125;<br>      <br><br>    &#125;  <br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä½¿ç”¨æ‰§è¡Œå™¨"><a href="#ä½¿ç”¨æ‰§è¡Œå™¨" class="headerlink" title="ä½¿ç”¨æ‰§è¡Œå™¨"></a>ä½¿ç”¨æ‰§è¡Œå™¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// newCachedThreadPool               åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± </span><br><span class="hljs-comment">// newFixedThreadPool                åˆ›å»ºä¸€ä¸ªå›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ± </span><br><span class="hljs-comment">// newWorkStealingPool               fork-join ä»»åŠ¡çš„çº¿ç¨‹æ± </span><br><span class="hljs-comment">// newSingleThreadPool               åªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„â€œæ± â€ï¼Œä¼šé¡ºåºåœ°æ‰§è¡Œæäº¤çš„ä»»åŠ¡</span><br><span class="hljs-comment">// newScheduledThreadPool            ç”¨äºè°ƒåº¦æ‰§è¡Œçš„å›ºå®šçº¿ç¨‹æ± </span><br><span class="hljs-comment">// newSingleThreadScheduledExecutor  ç”¨äºè°ƒåº¦æ‰§è¡Œçš„å•çº¿ç¨‹â€œæ± â€</span><br></code></pre></td></tr></table></figure><h3 id="å‘çº¿ç¨‹æ± æäº¤çº¿ç¨‹"><a href="#å‘çº¿ç¨‹æ± æäº¤çº¿ç¨‹" class="headerlink" title="å‘çº¿ç¨‹æ± æäº¤çº¿ç¨‹"></a>å‘çº¿ç¨‹æ± æäº¤çº¿ç¨‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">Future&lt;T&gt; <span class="hljs-title function_">submit</span><span class="hljs-params">(Callable&lt;T&gt; task)</span><br>Future&lt;T&gt; <span class="hljs-title function_">submit</span><span class="hljs-params">(Runable task)</span><br>Future&lt;T&gt; <span class="hljs-title function_">submit</span><span class="hljs-params">(Runable task ,T task)</span><br><br><span class="hljs-type">var</span> <span class="hljs-variable">futuretask</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FutureTask</span>&lt;Integer&gt;(callable);<br><span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newCachedThreadPool();<br>executor.submit(futuretask);<br>executor.shutdown();<br></code></pre></td></tr></table></figure><h1 id="å¼‚æ­¥"><a href="#å¼‚æ­¥" class="headerlink" title="å¼‚æ­¥"></a>å¼‚æ­¥</h1><p>å¼‚æ­¥æœ¬èº«æ˜¯ä¸ºäº†è§£å†³çº¿ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­ çº¿ç¨‹é˜»å¡å¯¼è‡´æ•´ä½“æ‰§è¡Œæ•ˆç‡é™ä½çš„é—®é¢˜ã€‚</p><p>åœ¨æ‰€æœ‰æµç¨‹è¢«ä¸²è¡Œæ‰§è¡Œæ—¶ï¼Œæµç¨‹ä¸­çš„ä»»åŠ¡ç­‰å¾…å“åº”é˜»å¡åç»­ä»»åŠ¡çš„æ‰§è¡Œã€‚</p><h2 id="ComplateFuture"><a href="#ComplateFuture" class="headerlink" title="ComplateFuture"></a>ComplateFuture</h2><h2 id="è¿›ç¨‹"><a href="#è¿›ç¨‹" class="headerlink" title="è¿›ç¨‹"></a>è¿›ç¨‹</h2><p>javaä¸­åˆ›å»ºè¿›ç¨‹</p><p>é€šè¿‡ProcessBuilderæ¥è¿›è¡Œè¿›ç¨‹åˆ›å»ºã€‚</p><p>javaä¸­çš„è¿›ç¨‹åˆ›å»ºæ˜¯å‘æ“ä½œç³»ç»Ÿç”³è¯·åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„è¿›ç¨‹ï¼Œå¹¶ä¸ä¸</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">var</span> <span class="hljs-variable">builder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProcessBuilder</span>(<span class="hljs-string">&quot;gcc&quot;</span>,<span class="hljs-string">&quot;myapp.c&quot;</span>)<br><br>builder = builder.directory(path.toFile());<br><span class="hljs-comment">// æ”¹å˜å·¥ä½œç›®å½•</span><br><span class="hljs-type">OutStream</span> <span class="hljs-variable">processln</span> <span class="hljs-operator">=</span> p.getOutputStream();        <span class="hljs-comment">// æ¥æ”¶æ ‡å‡†è¾“å‡º</span><br><span class="hljs-type">InputStream</span> <span class="hljs-variable">processOut</span> <span class="hljs-operator">=</span> p.getInputStream();      <span class="hljs-comment">// æ¥æ”¶æ ‡å‡†è¾“å…¥</span><br><span class="hljs-type">InputStream</span> <span class="hljs-variable">processError</span> <span class="hljs-operator">=</span> p.getErrorStream();    <span class="hljs-comment">// æ¥æ”¶æ ‡å‡†é”™è¯¯</span><br><br><span class="hljs-type">Process</span> <span class="hljs-variable">process</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProcessBuilder</span>(<span class="hljs-string">&quot;/bin/s&quot;</span>,<span class="hljs-string">&quot;-l&quot;</span>);<br>.directory(Path.of(<span class="hljs-string">&quot;/tmp&quot;</span>).toFile())<br>.start();<br><br><span class="hljs-keyword">try</span> (<span class="hljs-type">var</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(process.getInputStream()))&#123;<br><span class="hljs-keyword">while</span> (in.hasNextLine())<br>System.out.println(in.nextLine());<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> process.waitFor();     <span class="hljs-comment">// ç­‰å¾…è¿›ç¨‹æ‰§è¡Œç»“æœ</span><br><span class="hljs-comment">//æˆ–è€…</span><br><span class="hljs-type">long</span> <span class="hljs-variable">delay</span> <span class="hljs-operator">=</span> ... ;<br><span class="hljs-keyword">if</span> (process.waitfor(delay,TimeUnit.SECONDS))&#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> process.exitValue();<br>...<br>&#125;<span class="hljs-keyword">else</span> &#123; <br>process.destroyForcibly();<br>&#125;<br><br>process.onExit().thenAccept( <br> p-&gt;System.out.println(<span class="hljs-string">&quot;Exit value : &quot;</span>+ p.exitValue()));<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaç¼–ç¨‹ IV æ‰©å±•åŠŸèƒ½</title>
    <link href="/2025/04/29/Java%E7%BC%96%E7%A8%8B-IV-%E6%89%A9%E5%B1%95%E5%8A%9F%E8%83%BD/"/>
    <url>/2025/04/29/Java%E7%BC%96%E7%A8%8B-IV-%E6%89%A9%E5%B1%95%E5%8A%9F%E8%83%BD/</url>
    
    <content type="html"><![CDATA[<h1 id="æµ"><a href="#æµ" class="headerlink" title="æµ"></a>æµ</h1><p>åœ¨java 8 ä¸­ ï¼Œé€šè¿‡åŠ å…¥é»˜è®¤æ–¹æ³•ï¼Œå‘javaçš„æ¥å£ä¸­åŠ å…¥äº†æµå¤„ç†çš„åŠŸèƒ½</p><p>æµå¤„ç†åˆ†ä¸º3ç§ï¼š</p><p>åˆ›å»ºæµ</p><p>ä¿®æ”¹æµå…ƒç´ </p><p>æ¶ˆè´¹æµå…ƒç´ </p><h2 id="æµçš„åˆ›å»º"><a href="#æµçš„åˆ›å»º" class="headerlink" title="æµçš„åˆ›å»º"></a>æµçš„åˆ›å»º</h2><p>ä½¿ç”¨ Stream.of åˆ›å»ºæµå¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.stream.Stream;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CollectionToStream</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        Stream.of(<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bubble</span>(<span class="hljs-number">1</span>),<span class="hljs-keyword">new</span> <span class="hljs-title class_">Bubble</span>(<span class="hljs-number">2</span>),<span class="hljs-keyword">new</span> <span class="hljs-title class_">Bubble</span>(<span class="hljs-number">3</span>)<br>        ).forEach(System.out::println);<br>        Stream.of(<br>            <span class="hljs-string">&quot;It&#x27;s&quot;</span>,<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;wonderful&quot;</span>,<span class="hljs-string">&quot;day&quot;</span>,<span class="hljs-string">&quot;for&quot;</span>,<span class="hljs-string">&quot;pie&quot;</span><br>        );<br>        System.out.println();<br>      <br>    &#125;<br>  <br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Bubble</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> size;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Bubble</span><span class="hljs-params">(<span class="hljs-type">int</span> size)</span> &#123;<br>        <span class="hljs-built_in">this</span>.size = size;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Stream.of ä¼šå°† ä¼ å…¥çš„ åºåˆ—å¯¹è±¡è½¬æ¢ä¸º Spliterator å¯¹è±¡æ¥å¤„ç†è¿™äº›å¯¹è±¡</p><h3 id="ä½¿ç”¨randomåˆ›å»ºæµ"><a href="#ä½¿ç”¨randomåˆ›å»ºæµ" class="headerlink" title="ä½¿ç”¨randomåˆ›å»ºæµ"></a>ä½¿ç”¨randomåˆ›å»ºæµ</h3><p>random ä¼šéšæœºç”Ÿæˆ ç‰¹å®šç±»å‹çš„å¯¹è±¡ï¼Œä½œä¸ºè¿”å›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.* ;<br><span class="hljs-keyword">import</span> java.util.stream.*;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RandomGenerators</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span> <span class="hljs-params">(Stream&lt;T&gt; stream )</span>&#123;<br>        stream<br>        .limit(<span class="hljs-number">4</span>)<br>        .forEach(System.out::println);<br>        System.out.println(<span class="hljs-string">&quot;++++++++++&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Random</span> <span class="hljs-variable">rand</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Random</span>(<span class="hljs-number">47</span>);<br>        show(rand.ints().boxed());           <span class="hljs-comment">// éšæœºäº§ç”Ÿæ•´æ•°</span><br>        show(rand.longs().boxed());           <span class="hljs-comment">// éšæœºäº§ç”Ÿé•¿æ•´å‹</span><br>        show(rand.doubles().boxed());         <span class="hljs-comment">// éšæœºäº§ç”ŸåŒç²¾åº¦æµ®ç‚¹æ•°</span><br>        show(rand.ints(<span class="hljs-number">10</span>,<span class="hljs-number">20</span>).boxed());       <span class="hljs-comment">// éšæœºäº§ç”Ÿ10åˆ°20ä¹‹é—´çš„æ•´æ•°</span><br>        show(rand.longs(<span class="hljs-number">10</span>,<span class="hljs-number">20</span>).boxed());      <span class="hljs-comment">// éšæœºäº§ç”Ÿ10åˆ°20ä¹‹é—´çš„é•¿æ•´å‹</span><br>        show(rand.doubles(<span class="hljs-number">10</span>,<span class="hljs-number">20</span>).boxed());    <span class="hljs-comment">// éšæœºäº§ç”Ÿ10åˆ°20ä¹‹é—´çš„åŒç²¾åº¦æµ®ç‚¹æ•°</span><br>        show(rand.ints(<span class="hljs-number">3</span>,<span class="hljs-number">3</span>,<span class="hljs-number">9</span>).boxed());         <span class="hljs-comment">// éšæœºäº§ç”Ÿ3åˆ°9ä¹‹é—´çš„æ•´æ•°,é•¿åº¦ä¸º3</span><br>        show(rand.longs(<span class="hljs-number">3</span>,<span class="hljs-number">12</span>,<span class="hljs-number">22</span>).boxed());      <span class="hljs-comment">// éšæœºäº§ç”Ÿ12åˆ°22ä¹‹é—´çš„é•¿æ•´å‹,é•¿åº¦ä¸º3</span><br>        show(rand.doubles(<span class="hljs-number">3</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12.3</span>).boxed());  <span class="hljs-comment">// éšæœºäº§ç”Ÿ11åˆ°12.3ä¹‹é—´çš„åŒç²¾åº¦æµ®ç‚¹æ•°,é•¿åº¦ä¸º3</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨rangeæ„é€ æµ"><a href="#ä½¿ç”¨rangeæ„é€ æµ" class="headerlink" title="ä½¿ç”¨rangeæ„é€ æµ"></a>ä½¿ç”¨rangeæ„é€ æµ</h3><p>range æ˜¯å°†æŸä¸ªèŒƒå›´å†…çš„å€¼ä½œä¸ºè¿”å›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> java.util.stream.IntStream.range;<br><br><span class="hljs-comment">//import static java.util.stream.IntStream</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Ranges</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> ;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span> ; i &lt; <span class="hljs-number">20</span> ; i++)&#123;result+=i ;&#125;<br>        System.out.println(result);<br>        result = <span class="hljs-number">0</span> ;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i : range(<span class="hljs-number">10</span>,<span class="hljs-number">20</span>).toArray())&#123;<br>            result+=i ;<br>        &#125;<br>        System.out.println(result);<br>        System.out.println(range(<span class="hljs-number">10</span>,<span class="hljs-number">20</span>).sum());<br>    &#125;   <br>&#125;<br></code></pre></td></tr></table></figure><h3 id="generate"><a href="#generate" class="headerlink" title="generate()"></a>generate()</h3><p>generate æ¥æ”¶ä¸€ä¸ªå®ç°äº†supplierç±»çš„å®ç°ç±»ï¼Œç±»ä¸­å®šä¹‰ äº†ä¸€ä¸ªè·å–æ–¹æ³•æ¥æ¯æ¬¡è·å–ç›®æ ‡å¯¹è±¡ä¸­çš„å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.* ;<br><span class="hljs-keyword">import</span> java.util.function.*;<br><span class="hljs-keyword">import</span> java.util.stream.Collectors;<br><span class="hljs-keyword">import</span> java.util.stream.Stream;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Generator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Supplier</span>&lt;String&gt;&#123;<br>    <span class="hljs-type">Random</span> <span class="hljs-variable">rand</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Random</span>(<span class="hljs-number">35</span>);<br>    <span class="hljs-type">char</span>[] letter = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>.toCharArray();<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">get</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span> + letter[rand.nextInt(letter.length)];<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">word</span> <span class="hljs-operator">=</span> Stream.generate(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Generator</span>())<br>        .limit(<span class="hljs-number">30</span>)<br>        .collect(Collectors.joining());<br>        System.out.println(word);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="iterate"><a href="#iterate" class="headerlink" title="iterate()"></a>iterate()</h3><p>iterate åˆ™æ˜¯ä½œä¸ºä¸€ä¸ªæ¥å£ ï¼Œæ¯æ¬¡é€šè¿‡è°ƒç”¨å‡½æ•°æ¥åˆ›å»ºå€¼ä½œä¸ºå…¶æµçš„è¿”å›ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.stream.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Fibonacci</span>&#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> ;<br>    Stream &lt;Integer&gt; numbers()&#123;<br>        <span class="hljs-keyword">return</span> Stream.iterate(<span class="hljs-number">0</span>,i-&gt;&#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> x+i;<br>            x = i;<br>            <span class="hljs-keyword">return</span> result;<br>        &#125;);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Fibonacci</span>().numbers()<br>        .limit(<span class="hljs-number">10</span>)<br>        .forEach(System.out::println);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="Arrays"><a href="#Arrays" class="headerlink" title="Arrays"></a>Arrays</h3><p>é€šè¿‡Arraysä¸­çš„streamæ–¹æ³•å¯ä»¥å°†æ•°ç»„è½¬æ¢ä¸ºæµ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.utils.*;<br><span class="hljs-keyword">import</span> java.util.stream.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ArrayStreams</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>Arrays.stream(<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">double</span>[] &#123;<span class="hljs-number">3.14159</span>,<span class="hljs-number">2.718</span>,<span class="hljs-number">1.618</span>&#125;)<br>.forEach(n-&gt;System.out.format(<span class="hljs-string">&quot;%f&quot;</span>,n));<br>)<br>System.out.println();<br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="ä¿®æ”¹æµ"><a href="#ä¿®æ”¹æµ" class="headerlink" title="ä¿®æ”¹æµ"></a>ä¿®æ”¹æµ</h2><p>peek() ç”¨äºæŸ¥çœ‹æµè€Œéä¿®æ”¹</p><p>sorted() å¯¹æ•°æ®è¿›è¡Œæ’åº</p><p>distinct() ç§»é™¤é‡å¤å…ƒç´ </p><p>map() å°†å‡½æ•°åº”ç”¨äºæµä¸­çš„å¯¹è±¡</p><p>option() æŸ¥è¯¢å¯¹è±¡ä¸­æ˜¯å¦å­˜åœ¨è¯·æ±‚ç«¯å€¼</p><h2 id="ç»ˆç»“æµ"><a href="#ç»ˆç»“æµ" class="headerlink" title="ç»ˆç»“æµ"></a>ç»ˆç»“æµ</h2><p>toArray() å°†æµè½¬æ¢ä¸ºä¸€ä¸ªæ•°ç»„</p><p>foreach() å¯¹æµä¸­çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œæ‰§è¡Œ</p><p>collect() å°†å…ƒç´ æ”¶é›†åˆ°ä¸€ä¸ªç»“æœé›†åˆä¸­</p><p>reduce() ç»„åˆæ‰€æœ‰å…ƒç´ </p><p>allMatch() åŒ¹é…å…ƒç´ </p><p>findFirst() é€‰æ‹©ä¸€ä¸ªå…ƒç´ </p><p>findAny() è¿”å›ä¸€ä¸ªåŒ…å«æŸä¸ªå…ƒç´ çš„Optional</p><p>count() ç»Ÿè®¡æµä¸­å…ƒç´ çš„æ•°é‡</p><p>min()</p><p>max()</p><h1 id="æ–‡ä»¶çš„æµå¼è¯»å–"><a href="#æ–‡ä»¶çš„æµå¼è¯»å–" class="headerlink" title="æ–‡ä»¶çš„æµå¼è¯»å–"></a>æ–‡ä»¶çš„æµå¼è¯»å–</h1><h3 id="InputStreamï¼ˆæŠ½è±¡ç±»ï¼‰"><a href="#InputStreamï¼ˆæŠ½è±¡ç±»ï¼‰" class="headerlink" title="InputStreamï¼ˆæŠ½è±¡ç±»ï¼‰"></a>InputStreamï¼ˆæŠ½è±¡ç±»ï¼‰</h3><ul><li><code>FileInputStream</code> - ä»æ–‡ä»¶è¯»å–å­—èŠ‚</li><li><code>ByteArrayInputStream</code> - ä»å­—èŠ‚æ•°ç»„è¯»å–å­—èŠ‚</li><li><code>FilterInputStream</code> - è£…é¥°å™¨çš„åŸºç±»<ul><li><code>BufferedInputStream</code> - ä½¿ç”¨ç¼“å†²åŒºæé«˜è¯»å–æ•ˆç‡</li><li><code>DataInputStream</code> - è¯»å–åŸºæœ¬æ•°æ®ç±»å‹</li><li><code>ObjectInputStream</code> - è¯»å–å¯¹è±¡</li></ul></li><li><code>PipedInputStream</code> - ä¸PipedOutputStreamé…å¯¹ï¼Œç”¨äºçº¿ç¨‹é—´é€šä¿¡</li><li><code>SequenceInputStream</code> - å°†å¤šä¸ªInputStreamåˆå¹¶æˆä¸€ä¸ª</li></ul><h3 id="OutputStreamï¼ˆæŠ½è±¡ç±»ï¼‰"><a href="#OutputStreamï¼ˆæŠ½è±¡ç±»ï¼‰" class="headerlink" title="OutputStreamï¼ˆæŠ½è±¡ç±»ï¼‰"></a>OutputStreamï¼ˆæŠ½è±¡ç±»ï¼‰</h3><ul><li><code>FileOutputStream</code> - å‘æ–‡ä»¶å†™å…¥å­—èŠ‚</li><li><code>ByteArrayOutputStream</code> - å‘å­—èŠ‚æ•°ç»„å†™å…¥å­—èŠ‚</li><li><code>FilterOutputStream</code> - è£…é¥°å™¨çš„åŸºç±»<ul><li><code>BufferedOutputStream</code> - ä½¿ç”¨ç¼“å†²åŒºæé«˜å†™å…¥æ•ˆç‡</li><li><code>DataOutputStream</code> - å†™å…¥åŸºæœ¬æ•°æ®ç±»å‹</li><li><code>ObjectOutputStream</code> - å†™å…¥å¯¹è±¡</li><li><code>PrintStream</code> - æ‰“å°å„ç§æ•°æ®å€¼çš„ä¾¿æ·æ–¹å¼ï¼ˆä¾‹å¦‚System.outï¼‰</li></ul></li><li><code>PipedOutputStream</code> - ä¸PipedInputStreamé…å¯¹ï¼Œç”¨äºçº¿ç¨‹é—´é€šä¿¡</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.util.Arrays;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Java I/Oæµç¤ºä¾‹ä»£ç </span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JavaIOExamples</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            byteStreamExample();<br>            characterStreamExample();<br>            bufferedStreamExample();<br>            dataStreamExample();<br>            objectStreamExample();<br>          <br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">byteStreamExample</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fis</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">FileOutputStream</span> <span class="hljs-variable">fos</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>      <br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// åˆ›å»ºè¾“å…¥è¾“å‡ºæµ</span><br>            fis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">&quot;source.txt&quot;</span>);<br>            fos = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;destination.txt&quot;</span>);<br>          <br>            <span class="hljs-comment">// è¯»å–å’Œå†™å…¥</span><br>            <span class="hljs-type">int</span> byteData;<br>            <span class="hljs-keyword">while</span> ((byteData = fis.read()) != -<span class="hljs-number">1</span>) &#123;<br>                fos.write(byteData);<br>            &#125;<br>          <br>            System.out.println(<span class="hljs-string">&quot;æ–‡ä»¶å¤åˆ¶å®Œæˆï¼ˆä½¿ç”¨å­—èŠ‚æµï¼‰&quot;</span>);<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-comment">// å…³é—­èµ„æºï¼ˆå§‹ç»ˆåœ¨finallyå—ä¸­è¿›è¡Œï¼‰</span><br>            <span class="hljs-keyword">if</span> (fis != <span class="hljs-literal">null</span>) fis.close();<br>            <span class="hljs-keyword">if</span> (fos != <span class="hljs-literal">null</span>) fos.close();<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">characterStreamExample</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">FileReader</span> <span class="hljs-variable">fr</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">FileWriter</span> <span class="hljs-variable">fw</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>      <br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// åˆ›å»ºè¾“å…¥è¾“å‡ºæµ</span><br>            fr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileReader</span>(<span class="hljs-string">&quot;source.txt&quot;</span>);<br>            fw = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileWriter</span>(<span class="hljs-string">&quot;destination.txt&quot;</span>);<br>          <br>            <span class="hljs-comment">// è¯»å–å’Œå†™å…¥</span><br>            <span class="hljs-type">int</span> charData;<br>            <span class="hljs-keyword">while</span> ((charData = fr.read()) != -<span class="hljs-number">1</span>) &#123;<br>                fw.write(charData);<br>            &#125;<br>          <br>            System.out.println(<span class="hljs-string">&quot;æ–‡ä»¶å¤åˆ¶å®Œæˆï¼ˆä½¿ç”¨å­—ç¬¦æµï¼‰&quot;</span>);<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-comment">// å…³é—­èµ„æº</span><br>            <span class="hljs-keyword">if</span> (fr != <span class="hljs-literal">null</span>) fr.close();<br>            <span class="hljs-keyword">if</span> (fw != <span class="hljs-literal">null</span>) fw.close();<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">bufferedStreamExample</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">BufferedReader</span> <span class="hljs-variable">br</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">BufferedWriter</span> <span class="hljs-variable">bw</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>      <br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// åˆ›å»ºè¾“å…¥è¾“å‡ºæµ</span><br>            br = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileReader</span>(<span class="hljs-string">&quot;source.txt&quot;</span>));<br>            bw = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedWriter</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileWriter</span>(<span class="hljs-string">&quot;destination.txt&quot;</span>));<br>          <br>            <span class="hljs-comment">// æŒ‰è¡Œè¯»å–å’Œå†™å…¥</span><br>            String line;<br>            <span class="hljs-keyword">while</span> ((line = br.readLine()) != <span class="hljs-literal">null</span>) &#123;<br>                bw.write(line);<br>                bw.newLine(); <span class="hljs-comment">// å†™å…¥ä¸€ä¸ªæ¢è¡Œç¬¦</span><br>            &#125;<br>          <br>            System.out.println(<span class="hljs-string">&quot;æ–‡ä»¶å¤åˆ¶å®Œæˆï¼ˆä½¿ç”¨ç¼“å†²æµï¼‰&quot;</span>);<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-comment">// å…³é—­èµ„æº</span><br>            <span class="hljs-keyword">if</span> (br != <span class="hljs-literal">null</span>) br.close();<br>            <span class="hljs-keyword">if</span> (bw != <span class="hljs-literal">null</span>) bw.close();<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dataStreamExample</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">// å†™å…¥åŸºæœ¬æ•°æ®ç±»å‹</span><br>        <span class="hljs-keyword">try</span> (<span class="hljs-type">DataOutputStream</span> <span class="hljs-variable">dos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;data.bin&quot;</span>))) &#123;<br>            dos.writeInt(<span class="hljs-number">100</span>);<br>            dos.writeFloat(<span class="hljs-number">123.45f</span>);<br>            dos.writeBoolean(<span class="hljs-literal">true</span>);<br>            dos.writeUTF(<span class="hljs-string">&quot;Hello, Java I/O!&quot;</span>);<br>        &#125;<br>        <span class="hljs-comment">// è¯»å–åŸºæœ¬æ•°æ®ç±»å‹</span><br>        <span class="hljs-keyword">try</span> (<span class="hljs-type">DataInputStream</span> <span class="hljs-variable">dis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">&quot;data.bin&quot;</span>))) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">intValue</span> <span class="hljs-operator">=</span> dis.readInt();<br>            <span class="hljs-type">float</span> <span class="hljs-variable">floatValue</span> <span class="hljs-operator">=</span> dis.readFloat();<br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">boolValue</span> <span class="hljs-operator">=</span> dis.readBoolean();<br>            <span class="hljs-type">String</span> <span class="hljs-variable">strValue</span> <span class="hljs-operator">=</span> dis.readUTF();<br>          <br>            System.out.println(<span class="hljs-string">&quot;è¯»å–çš„æ•°æ®ï¼š&quot;</span> + intValue + <span class="hljs-string">&quot;, &quot;</span> + floatValue + <span class="hljs-string">&quot;, &quot;</span> + <br>                               boolValue + <span class="hljs-string">&quot;, &quot;</span> + strValue);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">objectStreamExample</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>        <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªå¯åºåˆ—åŒ–çš„ç±»çš„å®ä¾‹</span><br>        <span class="hljs-type">Person</span> <span class="hljs-variable">person</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>, <span class="hljs-number">30</span>);<br>      <br>        <span class="hljs-comment">// å†™å…¥å¯¹è±¡</span><br>        <span class="hljs-keyword">try</span> (<span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">oos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;person.obj&quot;</span>))) &#123;<br>            oos.writeObject(person);<br>            System.out.println(<span class="hljs-string">&quot;å¯¹è±¡å·²å†™å…¥æ–‡ä»¶&quot;</span>);<br>        &#125;<br>      <br>        <span class="hljs-comment">// è¯»å–å¯¹è±¡</span><br>        <span class="hljs-keyword">try</span> (<span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">ois</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">&quot;person.obj&quot;</span>))) &#123;<br>            <span class="hljs-type">Person</span> <span class="hljs-variable">readPerson</span> <span class="hljs-operator">=</span> (Person) ois.readObject();<br>            System.out.println(<span class="hljs-string">&quot;è¯»å–çš„å¯¹è±¡ï¼š&quot;</span> + readPerson);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;<br>  <br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>        <span class="hljs-built_in">this</span>.age = age;<br>    &#125;<br>  <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Person [name=&quot;</span> + name + <span class="hljs-string">&quot;, age=&quot;</span> + age + <span class="hljs-string">&quot;]&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="å¼‚å¸¸"><a href="#å¼‚å¸¸" class="headerlink" title="å¼‚å¸¸"></a>å¼‚å¸¸</h1><p>ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">testa</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>           <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span>  <span class="hljs-number">1</span>/<span class="hljs-number">0</span>; <br>           System.out.println(<span class="hljs-string">&quot;try&quot;</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            System.out.println(<span class="hljs-string">&quot;catch a error&quot;</span>);  <br>        &#125;<span class="hljs-keyword">finally</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;finally&quot;</span>);<br>        &#125;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ Java ä¸­ï¼Œè¿è¡Œæ—¶å¼‚å¸¸å¯¹è±¡é€šå¸¸ç”± JVM åœ¨æ‰§è¡ŒæŸäº›æ“ä½œæ—¶ï¼ˆå¦‚é™¤ä»¥é›¶ã€ç©ºæŒ‡é’ˆè®¿é—®ã€æ•°ç»„è¶Šç•Œï¼‰ä¸»åŠ¨åˆ›å»ºã€‚ä¸€æ—¦åˆ›å»ºï¼Œå¼‚å¸¸å¯¹è±¡ä¼šé€šè¿‡ JVM çš„å¼‚å¸¸åˆ†å‘æœºåˆ¶æ²¿ç€è°ƒç”¨æ ˆå‘ä¸Šä¼ æ’­ã€‚å½“é‡åˆ°åŒ¹é…çš„ <code>catch</code> å—æ—¶ï¼Œè¯¥å—ä¸­çš„å¼‚å¸¸å˜é‡å¼•ç”¨ï¼ˆå¦‚ <code>catch (IOException e)</code> ä¸­çš„ <code>e</code>ï¼‰å°†è‡ªåŠ¨ä¸è¯¥å¼‚å¸¸å¯¹è±¡ç»‘å®šï¼Œä»è€Œå…è®¸ç¨‹åºå‘˜è®¿é—®å¼‚å¸¸çš„è¯¦ç»†ä¿¡æ¯å¹¶å†³å®šå¦‚ä½•å¤„ç†ã€‚</p><h2 id="è‡ªå®šä¹‰å¼‚å¸¸"><a href="#è‡ªå®šä¹‰å¼‚å¸¸" class="headerlink" title="è‡ªå®šä¹‰å¼‚å¸¸"></a>è‡ªå®šä¹‰å¼‚å¸¸</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Exception</span> &#123;&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InnerException</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SimpleException&#123;<br>        System.out.println(<span class="hljs-string">&quot;Throw SimpleException from f()&quot;</span>);<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleException</span>();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">InnerException</span> <span class="hljs-variable">ie</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InnerException</span>();<br>        <span class="hljs-keyword">try</span>&#123;<br>            ie.f();<br>        &#125;<span class="hljs-keyword">catch</span>(SimpleException e)&#123;<br>            System.out.println(<span class="hljs-string">&quot;Caught it!&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Exception æ˜¯æ‰€æœ‰å¼‚å¸¸ç±»çš„åŸºç±»</p><h1 id="æ–‡ä»¶"><a href="#æ–‡ä»¶" class="headerlink" title="æ–‡ä»¶"></a>æ–‡ä»¶</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.File;<br><span class="hljs-keyword">import</span> java.net.URI;<br><span class="hljs-keyword">import</span> java.nio.file.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PathInfo</span>&#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">(String id ,Object p)</span>&#123;<br>        System.out.println(id+p);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">info</span><span class="hljs-params">(  Path p )</span>&#123;<br>        show(<span class="hljs-string">&quot;toString:\\n &quot;</span>, p);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           <br>        show(<span class="hljs-string">&quot;Exists: &quot;</span>,Files.exists(p));<br>        show(<span class="hljs-string">&quot;RegularFile: &quot;</span>, Files.isRegularFile(p));<br>        show(<span class="hljs-string">&quot;Absolute: &quot;</span>, Files.isDirectory(p));<br>        show(<span class="hljs-string">&quot;FileName: &quot;</span>, p.getFileName());<br>        show(<span class="hljs-string">&quot;Filename : &quot;</span>,p.isAbsolute());<br>        show(<span class="hljs-string">&quot;Parent: &quot;</span>, p.getParent());<br>        show(<span class="hljs-string">&quot;Root: &quot;</span>, p.getRoot());<br>        System.out.println(<span class="hljs-string">&quot;--------------------&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        System.out.println(System.getProperty(<span class="hljs-string">&quot;os.name&quot;</span>));<br>        info(Paths.get(<span class="hljs-string">&quot;C:&quot;</span>,<span class="hljs-string">&quot;path&quot;</span>,<span class="hljs-string">&quot;to&quot;</span>,<span class="hljs-string">&quot;nowhere&quot;</span>,<span class="hljs-string">&quot;NoFile.txt&quot;</span>));<br>        <span class="hljs-type">Path</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> Paths.get(<span class="hljs-string">&quot;PathInfo.java&quot;</span>);<br>        info(p);<br>        <span class="hljs-type">Path</span> <span class="hljs-variable">ap</span> <span class="hljs-operator">=</span> p.toAbsolutePath();<br>        info(ap);<br>        info(ap.getParent());<br>        <span class="hljs-keyword">try</span> &#123;<br>            info(p.getParent());<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            System.out.println(e);<br>        &#125;<br>        <span class="hljs-type">URI</span> <span class="hljs-variable">u</span> <span class="hljs-operator">=</span> p.toUri();<br>        System.out.println(<span class="hljs-string">&quot;URI: &quot;</span> + u);<br>        <span class="hljs-type">Path</span> <span class="hljs-variable">puri</span> <span class="hljs-operator">=</span> Paths.get(u);<br>        System.out.println(Files.exists(puri));<br>        <span class="hljs-type">File</span> <span class="hljs-variable">f</span> <span class="hljs-operator">=</span> puri.toFile();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é€šè¿‡ Pathå¯¹è±¡æ¥ç®¡ç† è·¯å¾„å¯¹è±¡ã€‚é€šè¿‡Fileå¯¹è±¡æ¥ç®¡ç†æ–‡ä»¶å¯¹è±¡ã€‚é€šè¿‡Filesæ¥åˆ¤æ–­è·¯å¾„æŒ‡å‘çš„æ–‡ä»¶ç±»å‹</p><h1 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h1><h2 id="å­—ç¬¦ä¸²å¯¹è±¡"><a href="#å­—ç¬¦ä¸²å¯¹è±¡" class="headerlink" title="å­—ç¬¦ä¸²å¯¹è±¡"></a>å­—ç¬¦ä¸²å¯¹è±¡</h2><p>å­—ç¬¦ä¸²æœ¬èº«æ˜¯å‚¨å­˜åœ¨å †ä¸­çš„ï¼Œå½“è¿›è¡Œå­—ç¬¦ä¸²å¯¹è±¡çš„ä¼ é€’ï¼Œæœ¬è´¨æ˜¯ä¼ é€’äº†è¯¥å­—ç¬¦ä¸²çš„å¼•ç”¨</p><p>è€Œå½“å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥æ“ä½œæ—¶ï¼Œå…¶æµç¨‹æ˜¯ ï¼š</p><p>é€šè¿‡å¼•ç”¨ æŸ¥è¯¢åˆ°å †ä¸­çš„å­—ç¬¦ä¸²ï¼Œè®¡ç®—å¾…æ‹¼æ¥å­—ç¬¦ä¸²çš„å¤§å°ï¼Œç”³è¯·å¯¹åº”å¤§å°ç”µè„‘å†…å­˜ï¼Œå°†æ¯ä¸ªå­—ç¬¦ä¸²å­˜å…¥æ–°çš„å­—ç¬¦æ•°ç»„ä¸­ï¼Œè¿”å›æ–°çš„å¯¹è¯¥å­—ç¬¦æ•°ç»„çš„å¼•ç”¨ã€‚</p><h2 id="å¸¸ç”¨æ–¹æ³•"><a href="#å¸¸ç”¨æ–¹æ³•" class="headerlink" title="å¸¸ç”¨æ–¹æ³•"></a>å¸¸ç”¨æ–¹æ³•</h2><table><thead><tr><th>æ–¹æ³•å</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>length()</code></td><td>è·å–å­—ç¬¦ä¸²é•¿åº¦</td><td><code>&quot;hello&quot;.length()</code></td><td><code>5</code></td></tr><tr><td><code>isEmpty()</code></td><td>æ˜¯å¦ä¸ºç©ºå­—ç¬¦ä¸²</td><td><code>&quot;&quot;.isEmpty()</code></td><td><code>true</code></td></tr><tr><td><code>isBlank()</code></td><td>æ˜¯å¦å…¨ä¸ºç©ºç™½å­—ç¬¦ï¼ˆJava 11+ï¼‰</td><td><code>&quot;  &quot;.isBlank()</code></td><td><code>true</code></td></tr><tr><td><code>charAt(int index)</code></td><td>è·å–æŒ‡å®šä½ç½®å­—ç¬¦</td><td><code>&quot;abc&quot;.charAt(1)</code></td><td><code>&#39;b&#39;</code></td></tr><tr><td><code>equals(String s)</code></td><td>å†…å®¹ç›¸ç­‰ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</td><td><code>&quot;Hi&quot;.equals(&quot;hi&quot;)</code></td><td><code>false</code></td></tr><tr><td><code>equalsIgnoreCase(String s)</code></td><td>å†…å®¹ç›¸ç­‰ï¼ˆå¿½ç•¥å¤§å°å†™ï¼‰</td><td><code>&quot;Hi&quot;.equalsIgnoreCase(&quot;hi&quot;)</code></td><td><code>true</code></td></tr><tr><td><code>compareTo(String s)</code></td><td>å­—å…¸åºæ¯”è¾ƒ</td><td><code>&quot;abc&quot;.compareTo(&quot;bcd&quot;)</code></td><td><code>-1</code></td></tr><tr><td><code>contains(CharSequence s)</code></td><td>æ˜¯å¦åŒ…å«å­ä¸²</td><td><code>&quot;hello&quot;.contains(&quot;ell&quot;)</code></td><td><code>true</code></td></tr><tr><td><code>startsWith(String s)</code></td><td>æ˜¯å¦ä»¥ s å¼€å¤´</td><td><code>&quot;java&quot;.startsWith(&quot;ja&quot;)</code></td><td><code>true</code></td></tr><tr><td><code>endsWith(String s)</code></td><td>æ˜¯å¦ä»¥ s ç»“å°¾</td><td><code>&quot;java&quot;.endsWith(&quot;va&quot;)</code></td><td><code>true</code></td></tr><tr><td><code>indexOf(String s)</code></td><td>ç¬¬ä¸€æ¬¡å‡ºç°ä½ç½®</td><td><code>&quot;hello&quot;.indexOf(&quot;l&quot;)</code></td><td><code>2</code></td></tr><tr><td><code>lastIndexOf(String s)</code></td><td>æœ€åä¸€æ¬¡å‡ºç°ä½ç½®</td><td><code>&quot;hello&quot;.lastIndexOf(&quot;l&quot;)</code></td><td><code>3</code></td></tr><tr><td><code>substring(int begin)</code></td><td>ä»ç´¢å¼•å¼€å§‹æˆªå–</td><td><code>&quot;hello&quot;.substring(2)</code></td><td><code>&quot;llo&quot;</code></td></tr><tr><td><code>substring(int begin, int end)</code></td><td>æˆªå–åŒºé—´ [begin, end)</td><td><code>&quot;hello&quot;.substring(1, 4)</code></td><td><code>&quot;ell&quot;</code></td></tr><tr><td><code>trim()</code></td><td>å»é™¤é¦–å°¾ç©ºæ ¼</td><td><code>&quot;  hi  &quot;.trim()</code></td><td><code>&quot;hi&quot;</code></td></tr><tr><td><code>strip()</code></td><td>å»é™¤é¦–å°¾ Unicode ç©ºç™½ï¼ˆJava 11+ï¼‰</td><td><code>&quot;ã€€hiã€€&quot;.strip()</code></td><td><code>&quot;hi&quot;</code></td></tr><tr><td><code>replace(old, new)</code></td><td>æ›¿æ¢æ‰€æœ‰å­ä¸²</td><td><code>&quot;a-b&quot;.replace(&quot;-&quot;, &quot;:&quot;)</code></td><td><code>&quot;a:b&quot;</code></td></tr><tr><td><code>replaceFirst(regex, new)</code></td><td>æ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹</td><td><code>&quot;abc123&quot;.replaceFirst(&quot;\\\\d&quot;, &quot;X&quot;)</code></td><td><code>&quot;abcX23&quot;</code></td></tr><tr><td><code>replaceAll(regex, new)</code></td><td>æ›¿æ¢æ‰€æœ‰åŒ¹é…é¡¹</td><td><code>&quot;abc123&quot;.replaceAll(&quot;\\\\d&quot;, &quot;&quot;)</code></td><td><code>&quot;abc&quot;</code></td></tr><tr><td><code>toUpperCase()</code></td><td>è½¬å¤§å†™</td><td><code>&quot;java&quot;.toUpperCase()</code></td><td><code>&quot;JAVA&quot;</code></td></tr><tr><td><code>toLowerCase()</code></td><td>è½¬å°å†™</td><td><code>&quot;JAVA&quot;.toLowerCase()</code></td><td><code>&quot;java&quot;</code></td></tr><tr><td><code>split(String regex)</code></td><td>æŒ‰æ­£åˆ™åˆ†å‰²æˆæ•°ç»„</td><td><code>&quot;a,b,c&quot;.split(&quot;,&quot;)</code></td><td><code>[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</code></td></tr><tr><td><code>join(delimiter, ...)</code></td><td>é™æ€æ–¹æ³•ï¼Œè¿æ¥å­—ç¬¦ä¸²</td><td><code>String.join(&quot;-&quot;, &quot;a&quot;, &quot;b&quot;)</code></td><td><code>&quot;a-b&quot;</code></td></tr><tr><td><code>toCharArray()</code></td><td>è½¬ä¸ºå­—ç¬¦æ•°ç»„</td><td><code>&quot;abc&quot;.toCharArray()</code></td><td><code>[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;]</code></td></tr><tr><td><code>valueOf(Object o)</code></td><td>ä»»æ„å¯¹è±¡è½¬å­—ç¬¦ä¸²</td><td><code>String.valueOf(123)</code></td><td><code>&quot;123&quot;</code></td></tr><tr><td><code>matches(regex)</code></td><td>æ˜¯å¦æ•´ä½“åŒ¹é…æ­£åˆ™</td><td><code>&quot;123&quot;.matches(&quot;\\\\d+&quot;)</code></td><td><code>true</code></td></tr><tr><td><code>repeat(int n)</code></td><td>é‡å¤å­—ç¬¦ä¸² n æ¬¡ï¼ˆJava 11+ï¼‰</td><td><code>&quot;a&quot;.repeat(3)</code></td><td><code>&quot;aaa&quot;</code></td></tr><tr><td><code>stripLeading()</code></td><td>å»é™¤å‰å¯¼ç©ºç™½ï¼ˆJava 11+ï¼‰</td><td><code>&quot;  hi&quot;.stripLeading()</code></td><td><code>&quot;hi&quot;</code></td></tr><tr><td><code>stripTrailing()</code></td><td>å»é™¤åå¯¼ç©ºç™½ï¼ˆJava 11+ï¼‰</td><td><code>&quot;hi  &quot;.stripTrailing()</code></td><td><code>&quot;hi&quot;</code></td></tr><tr><td><code>lines()</code></td><td>æ‹†åˆ†ä¸ºè¡Œçš„ Streamï¼ˆJava 11+ï¼‰</td><td><code>&quot;a\\nb\\nc&quot;.lines()</code></td><td><code>Stream&lt;String&gt;</code></td></tr></tbody></table><h2 id="Scannerç±»"><a href="#Scannerç±»" class="headerlink" title="Scannerç±»"></a>Scannerç±»</h2><p>ç”¨äºæ¥æ”¶ ç”¨æˆ·è¾“å…¥</p><table><thead><tr><th>æ–¹æ³•</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>next()</code></td><td>è¯»å–ä¸€ä¸ªå•è¯ï¼ˆé‡åˆ°ç©ºæ ¼&#x2F;æ¢è¡Œåœæ­¢ï¼‰</td></tr><tr><td><code>nextLine()</code></td><td>è¯»å–ä¸€æ•´è¡Œï¼ˆç›´åˆ°å›è½¦ï¼‰</td></tr><tr><td><code>nextInt()</code>&#x2F;<code>nextDouble()</code>&#x2F;<code>nextBoolean()</code></td><td>è¯»å–æ•´æ•°&#x2F;æµ®ç‚¹æ•°&#x2F;å¸ƒå°”å€¼</td></tr><tr><td><code>hasNextInt()</code></td><td>æ£€æŸ¥ä¸‹ä¸€ä¸ªæ˜¯å¦æ˜¯æ•´æ•°</td></tr><tr><td><code>close()</code></td><td>å…³é—­è¾“å…¥æµï¼ˆæœ€ä½³å®è·µï¼‰</td></tr></tbody></table><h1 id="åå°„"><a href="#åå°„" class="headerlink" title="åå°„"></a>åå°„</h1><p>åå°„æ˜¯ä¸€ç§å¯ä»¥å¸®æˆ‘ä»¬è·å–åˆ°å¯¹è±¡å®é™…å®ç°ç±»çš„æ–¹æ³•</p><p>å½“æˆ‘ä»¬è¿›è¡Œäº†å‘ä¸Šè½¬å‹ä¹‹åï¼Œåœ¨å¼•ç”¨å£°æ˜ä¾§ã€‚æˆ‘ä»¬åªèƒ½ä½¿ç”¨å¼•ç”¨è°ƒç”¨åŸºç±»çš„å±æ€§å’Œæ–¹æ³•ã€‚è€Œå½“æˆ‘ä»¬å¸Œæœ›æ‰§è¡Œ å…¶å®é™…å…·æœ‰çš„æ–¹æ³•æ—¶ å°±æ— æ³•æŸ¥çœ‹åˆ°å…¶æ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡åå°„æ¥æŸ¥è¯¢å…¶æœ¬èº«æ‰€å…·å¤‡çš„æ–¹æ³•å’Œå±æ€§ï¼Œå†é€šè¿‡å‘ä¸‹è½¬å‹è°ƒç”¨å¯¹åº”çš„æ–¹æ³•</p><p>å¯ä»¥é€šè¿‡</p><p>type.getclass() è·å–åˆ°ç±»ä¿¡æ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Anmial</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">eat</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;Animal is eating&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Anmial</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();<br>        System.out.println(Cat.class);<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> a.getClass();<br>        System.out.println(c.getName());<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Anmial</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">eat</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;Cat is eating&quot;</span>);<br>        System.out.println(Cat.class);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ›å»ºçš„ å®ä¾‹aé€šè¿‡getClass() è·å–åˆ°çš„ç±»ä¿¡æ¯ä¸º Cat</p><p>ä¹Ÿå¯ä»¥é€šè¿‡ ç±»å­—é¢é‡æŸ¥è¯¢ç±»çš„ç±»å æ¯”å¦‚ Cat.class è¾“å‡º class Cat</p><p>å¯ä»¥é€šè¿‡æ³›å‹ æ¥é™å®š classå¼•ç”¨æ¥æ”¶çš„å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericClassReferences</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">intClass</span> <span class="hljs-operator">=</span> <span class="hljs-type">int</span>.class;<br>        intClass = <span class="hljs-type">double</span>.class;<br>        Class&lt;Integer&gt; genericIntClass = <span class="hljs-type">int</span>.class;<br>        genericIntClass = Integer.class;<br>        <span class="hljs-comment">// genericIntClass = double.class; //ä¸å¯ç”¨</span><br>        System.out.println(intClass);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹åå°„çš„å¼•ç”¨å£°æ˜è¦æ±‚å…¶æ˜¯æŸä¸ªç±»çš„åŸºç±»ï¼Œæ‰€å¼•ç”¨çš„å¯¹è±¡ä»ç„¶æ˜¯å…·ä½“çš„æŸä¸ªå­ç±»ã€‚</p><p>å› ä¸ºå¯¹äºç¼–è¯‘å™¨æ¥è¯´ï¼Œå®ƒåªè®°å½•äº†å·²å£°æ˜å¯¹è±¡çš„ç±»å‹ä¿¡æ¯ï¼Œå½“ä½ è·å–å®ƒçš„åŸºç±»æ—¶ï¼Œå¹¶ä¸æ¸…æ¥šåŸºç±»çš„å†…å®¹ï¼Œè€Œæ¸…æ¥šæ‰€è·å¾—çš„ç±»èŒƒå›´æ˜¯å¤§äºå­ç±»çš„ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨&lt;? super FancyToy&gt;</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericToyTest</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception&#123;<br>        Class&lt;FancyToy&gt; ftc = FancyToy.class;                      <span class="hljs-comment">// è·å–ç±»çš„ç±»å¯¹è±¡</span><br>        <span class="hljs-type">FancyToy</span> <span class="hljs-variable">fancyToy</span> <span class="hljs-operator">=</span> ftc.getConstructor().newInstance();    <span class="hljs-comment">// åˆ›å»ºå®ä¾‹</span><br>        Class &lt;? <span class="hljs-built_in">super</span>  FancyToy&gt; up = ftc.getSuperclass();        <span class="hljs-comment">// è·å–ç±»å¯¹è±¡çš„åŸºç±»</span><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> up.getConstructor().newInstance();            <span class="hljs-comment">// åˆ›å»ºå®ä¾‹</span><br>      <br>        <span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> ftc.getMethod(<span class="hljs-string">&quot;f&quot;</span>);     <span class="hljs-comment">// æŸ¥è¯¢å­ç±»ä¸­çš„æ–¹æ³• f</span><br>        method.invoke(fancyToy);                <span class="hljs-comment">// æ‰§è¡Œ è¾“å‡ºfancy</span><br>        <span class="hljs-type">Method</span> <span class="hljs-variable">method1</span> <span class="hljs-operator">=</span> up.getMethod(<span class="hljs-string">&quot;f&quot;</span>);     <span class="hljs-comment">// æŸ¥è¯¢åŸºç±»ä¸­çš„æ–¹æ³•  f</span><br>        method1.invoke(obj);                    <span class="hljs-comment">// æ‰§è¡Œ è¾“å‡º f</span><br>        <span class="hljs-type">Method</span> <span class="hljs-variable">method1</span> <span class="hljs-operator">=</span> up.getMethod(<span class="hljs-string">&quot;f&quot;</span>);     <span class="hljs-comment">// æŸ¥è¯¢åŸºç±»ä¸­çš„æ–¹æ³•  f</span><br>        method1.invoke(fancyToy);               <span class="hljs-comment">// æ‰§è¡Œ è¾“å‡ºfancy</span><br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Toy</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Toy</span><span class="hljs-params">()</span>&#123;    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;f&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">FancyToy</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Toy</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">FancyToy</span><span class="hljs-params">()</span>&#123; &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;fancy&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆä½¿ç”¨åŸºç±»ä¸­çš„æ–¹æ³•è°ƒç”¨å­ç±»å¯¹è±¡ ä»ç„¶ä¼šæ‰§è¡Œå­ç±»ä¸­çš„å‡½æ•°ï¼Ÿ</p><p>å› ä¸º åœ¨ç±»åŠ è½½è¿‡ç¨‹ä¸­ï¼Œå®ä¾‹æ–¹æ³•è¢«ç»´æŠ¤åœ¨vtableä¸­ï¼Œå¯¹äºå…·ä½“çš„æ–¹æ³•å®ç°æ˜¯åŠ¨æ€ç»‘å®šçš„ã€‚</p><p>è€Œåœ¨åå°„ä¸­ä½¿ç”¨getMethod æ¥æ”¶åˆ°çš„ä¹Ÿæ˜¯ä¸€ä¸ªè®°å½•æœ‰å‡½æ•°åç§»ä¿¡æ¯çš„ç»“æ„ä½“ã€‚</p><p>å½“å¼€å§‹æ‰§è¡Œæ—¶ï¼Œä¼šåœ¨å­ç±»å¯¹è±¡ä¸­æ ¹æ®è¿™ä¸ªåç§»æŸ¥è¯¢å‡½æ•°è¿›è¡Œæ‰§è¡Œã€‚</p><h2 id="åŠ¨æ€ä»£ç†"><a href="#åŠ¨æ€ä»£ç†" class="headerlink" title="åŠ¨æ€ä»£ç†"></a>åŠ¨æ€ä»£ç†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java">InvocationHandlerhanlder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvocationHandler</span>(proxy,method,args)&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable)&#123;<br><span class="hljs-keyword">return</span> method.invoke(target,args);<br>&#125;;<br><br>&#125;<br><br><span class="hljs-comment">// é€šè¿‡åŒ¿åç±»é‡å†™äº†InvocationHandler æ¥å£ã€‚</span><br><br><span class="hljs-type">Proxy</span> <span class="hljs-variable">proxy</span> <span class="hljs-operator">=</span> Proxy.newProxyInstance(target.getclass().getClassLoader(),target.getclass().getInterfaces(),handler);<br><span class="hljs-comment">// å°†è¢«ä»£ç†ç±»çš„åŠ è½½å™¨ä¿¡æ¯å’Œæ¥å£ä¿¡æ¯ä¼ å…¥ã€‚</span><br><span class="hljs-comment">// åç»­é€šè¿‡proxy ä»£ç†æ‰§è¡ŒåŸç±»å‹çš„æ–¹æ³•</span><br><br></code></pre></td></tr></table></figure><p>ç±»å®ç° ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.*;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">InvocationHandler</span> &#123;<br>    Object proxied;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DynamicProxy</span><span class="hljs-params">(Object proxied)</span> &#123;<br>        <span class="hljs-built_in">this</span>.proxied = proxied;<br>    &#125;<br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        System.out.println(<span class="hljs-string">&quot;**** proxy: &quot;</span> + proxy.getClass() + <span class="hljs-string">&quot;, method: &quot;</span> + method + <span class="hljs-string">&quot;, args: &quot;</span> + args);<br>        <span class="hljs-keyword">if</span>(args != <span class="hljs-literal">null</span>)<br>            <span class="hljs-keyword">for</span>(Object arg : args) <br>                System.out.println(<span class="hljs-string">&quot;&quot;</span>+ arg);<br>        <span class="hljs-keyword">return</span> method.invoke(proxied, args);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleDynamicProxy</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">consumer</span><span class="hljs-params">(Interface iface)</span> &#123;<br>        iface.doSomething();<br>        iface.somethingElse(<span class="hljs-string">&quot;bonobo&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">RealObject</span> <span class="hljs-variable">real</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RealObject</span>();<br>        consumer(real);<br>        <span class="hljs-type">Interface</span> <span class="hljs-variable">proxy</span> <span class="hljs-operator">=</span> (Interface) Proxy.newProxyInstance(<br>            Interface.class.getClassLoader(),<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;Interface.class&#125;,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">DynamicProxy</span>(real));<br>        consumer(proxy);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åå°„æä¾›äº†ä¸€ç§åœ¨å¯¹è±¡ä¹‹å¤–æ„å»ºä¸šåŠ¡æµç¨‹çš„è¿‡ç¨‹ã€‚</p><p>é€šè¿‡â€œåå°„â€å’Œâ€œæ¥å£â€ æˆ‘ä»¬å¯ä»¥è¾¾æˆä¸šåŠ¡å’Œæ•°æ®çš„åˆ†ç¦»ã€‚åœ¨æ¡†æ¶è®¾è®¡è¿‡ç¨‹ä¸­åªéœ€è¦å…³æ³¨äºå…·ä½“çš„åŠŸèƒ½å®ç°ï¼Œè€Œå¯¹è±¡åˆ™æ›´åƒæ˜¯ä¸€ç§æ•°æ®ä¾›åº”å•†ã€‚åœ¨æ¯ä¸ªé˜¶æ®µåªéœ€è¦å…³æ³¨å…·ä½“éœ€è¦çš„å­—æ®µå’ŒåŠŸèƒ½ï¼Œè€Œä¸åœ¨éœ€è¦å»å…³æ³¨å¯¹è±¡ã€‚</p><h1 id="æ³›å‹"><a href="#æ³›å‹" class="headerlink" title="æ³›å‹"></a>æ³›å‹</h1><p>æ³›å‹æ˜¯ä¸€ç§ç”¨äºå£°æ˜é€šç”¨ç±»&#x2F;é€šç”¨å‡½æ•°çš„æ‰‹æ®µï¼Œå½“å¸Œæœ›å‘ç±»ä¸­ï¼ˆé€šå¸¸æ˜¯å®¹å™¨ï¼‰ä¸­æ·»åŠ ä¸å®šç±»å‹çš„å¯¹è±¡æ—¶ï¼Œå¯ä»¥å…ˆé€šè¿‡æ³›å‹è¿›è¡Œç±»è®¾è®¡ï¼Œå†åç»­çš„å¯¹è±¡åˆ›å»ºè¿‡ç¨‹ä¸­å†é€šè¿‡å£°æ˜ä¼ å…¥çš„ç±»å‹è¿›è¡Œä½¿ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LinkedStack</span>&lt;E&gt;&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&lt;E&gt;&#123;<br>        E item;<br>        Node&lt;E&gt; next;<br>        Node()&#123;item=<span class="hljs-literal">null</span>;next=<span class="hljs-literal">null</span>;&#125;<br>        Node(E item , Node&lt;E&gt; next)&#123;<br>            <span class="hljs-built_in">this</span>.item=item;<br>            <span class="hljs-built_in">this</span>.next=next;<br>        &#125;<br>        <span class="hljs-type">boolean</span> <span class="hljs-title function_">end</span><span class="hljs-params">()</span>&#123;<br>            <span class="hljs-keyword">return</span> item==<span class="hljs-literal">null</span> &amp;&amp; next==<span class="hljs-literal">null</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">private</span> Node&lt;E&gt; top = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>&lt;&gt;();<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">push</span><span class="hljs-params">(E item)</span>&#123;<br>        top = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>&lt;&gt;(item,top);<br>    &#125;<br>    <span class="hljs-keyword">public</span> E <span class="hljs-title function_">pop</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">E</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> top.item;<br>        <span class="hljs-keyword">if</span>(!top.end())<br>            top = top.next;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>æ³›å‹æœ¬è´¨ä¸Šæ˜¯å¯¹ç¼–è¯‘å™¨ç±»å‹æ£€æŸ¥èƒ½åŠ›çš„ä¸€ç§æ‰©å±•ã€‚é€šè¿‡åœ¨ä»£ç ä¸­å¼•å…¥ç±»å‹å‚æ•°ï¼Œå¼€å‘è€…å¯ä»¥ä¸ºç±»å’Œæ–¹æ³•å¼•å…¥çµæ´»çš„ç±»å‹çº¦æŸï¼Œä½¿å¾—åœ¨å®ä¾‹åŒ–æ—¶ç”±å…·ä½“ç±»å‹æ›¿ä»£è¿™äº›é€šç”¨ç±»å‹ï¼Œä»è€Œå®ç°ç¼–è¯‘æœŸçš„ç±»å‹å®‰å…¨æ£€æŸ¥ã€‚è¿™ä¸ºå®¹å™¨ç±»ç­‰é€šç”¨ç»“æ„æä¾›äº†ä¸€ç§ç»Ÿä¸€è€Œå®‰å…¨çš„ç±»å‹è§£å†³æ–¹æ¡ˆã€‚</p><p>éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼ŒJava æ³›å‹çš„å®ç°æœºåˆ¶åŸºäº <strong>ç±»å‹æ“¦é™¤</strong> ï¼Œå³åœ¨ç¼–è¯‘é˜¶æ®µï¼Œæ‰€æœ‰æ³›å‹ç±»å‹å‚æ•°ä¼šè¢«æ›¿æ¢ä¸ºå…¶é™å®šçš„ä¸Šç•Œç±»å‹ï¼ˆé»˜è®¤ä¸º <code>Object</code>ï¼‰ï¼Œåœ¨ç”Ÿæˆçš„å­—èŠ‚ç ä¸­ä¸å†ä¿ç•™æ³›å‹ç±»å‹ä¿¡æ¯ã€‚å› æ­¤ï¼Œæ³›å‹æ˜¯ä¸€ç§ <strong>ç¼–è¯‘æœŸè¯­æ³•æœºåˆ¶</strong> ï¼Œå¹¶ä¸å±äº JVM çš„è¿è¡Œæ—¶åŠŸèƒ½æ‰©å±•ï¼ŒJVM åœ¨åŠ è½½å’Œæ‰§è¡Œé˜¶æ®µå¯¹æ³›å‹å®Œå…¨æ— æ„Ÿã€‚</p><p>æ³›å‹æ‰€å¸¦æ¥çš„æœ€å¤§ä»·å€¼ä¹‹ä¸€ï¼Œæ˜¯æå‡äº†ç±»ä¸æ–¹æ³•çš„å¤ç”¨æ€§ã€‚é€šè¿‡å¼•å…¥ç±»å‹å‚æ•°ï¼Œå¼€å‘è€…å¯ä»¥åœ¨ä¸ç‰ºç‰²ç±»å‹å®‰å…¨çš„å‰æä¸‹å¤ç”¨é€»è¾‘ä»£ç ã€‚ä¸æ­¤åŒæ—¶ï¼ŒJVM é€šè¿‡æ”¾å¼ƒå¯¹æ³›å‹å‚æ•°çš„è¿è¡Œæ—¶ç±»å‹ä¿ç•™ï¼Œé¿å…äº†ç±»å‹è†¨èƒ€å¸¦æ¥çš„æ€§èƒ½ä¸å…¼å®¹æ€§é—®é¢˜ï¼Œä»è€Œåœ¨è®¾è®¡ä¸Šå–å¾—äº† <strong>ç±»å‹å®‰å…¨æ€§ä¸è¿è¡Œæ•ˆç‡ä¹‹é—´çš„å¹³è¡¡</strong> ã€‚</p><p>å®ƒä¼šåœ¨ç¼–è¯‘é˜¶æ®µ å¯¹æ³›å‹å†…éƒ¨çš„å£°æ˜è¿›è¡Œæ“¦é™¤ï¼Œä½†æ˜¯å¦‚æœä»å†…éƒ¨å…ƒç´ è·å–ç±»ä¿¡æ¯ä»ç„¶å¯ä»¥æ­£å¸¸è·å– ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Frob</span>&#123;<br><br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Fnorkle</span>&#123;<br><br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Quark</span>&lt;Q&gt;&#123;<br><br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Particle</span>&lt;POSITION,MOMENTUM&gt;&#123;<br><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LostInfomation</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        List&lt;Frob&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        list.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Frob</span>());<br>        Map&lt;Frob,Fnorkle&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>        Quark&lt;Fnorkle&gt; quark = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Quark</span>&lt;Fnorkle&gt;();<br>        Particle&lt;Long,Double&gt; p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Particle</span>&lt;&gt;();<br>        System.out.println(list.get(<span class="hljs-number">0</span>).getClass());<br>        System.out.println(Arrays.toString(quark.getClass().getTypeParameters()));<br>        System.out.println(Arrays.toString(p.getClass().getTypeParameters()));<br>        System.out.println(Arrays.toString(list.getClass().getTypeParameters()));<br>        System.out.println(Arrays.toString(map.getClass().getTypeParameters()));<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>è¾“å‡º ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Frob</span>  <span class="hljs-comment">// ä»ç„¶å¯ä»¥è·å–ç±»ä¸­çš„å…ƒç´ ä¿¡æ¯</span><br>[Q]<br>[POSITION, MOMENTUM]<br>[E]<br>[K, V]<br></code></pre></td></tr></table></figure><p>å¯ä»¥ä¸ºæ³›å‹è®¾ç½®è¾¹ç•Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Hasf</span>&gt;<br></code></pre></td></tr></table></figure><h1 id="å†è°ˆå¯¹è±¡"><a href="#å†è°ˆå¯¹è±¡" class="headerlink" title="å†è°ˆå¯¹è±¡"></a>å†è°ˆå¯¹è±¡</h1><p>åœ¨æˆ‘ä»¬æœ€åˆå¯¹javaçš„å†…å­˜æ¨¡å‹è®¨è®ºä¸­ï¼Œå·²ç»çŸ¥é“javaä¸­æ‰€æœ‰è¿›è¡Œçš„å£°æ˜æœ¬è´¨ä¸Šéƒ½æ˜¯å¯¹å †ä¸Šåˆ›å»ºçš„å¯¹è±¡çš„åº”ç”¨ã€‚è¿™ç§å¼•ç”¨å¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ç§å¯ä»¥è¿›è¡Œå®‰å…¨è®¿é—®çš„æŒ‡é’ˆã€‚</p><p>å½“ä½¿ç”¨å¤šä¸ªå£°æ˜æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¤šä¸ªå£°æ˜éƒ½æ˜¯å¯¹åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨åˆ«åï¼Œè¿™æ„å‘³ç€å½“é€šè¿‡æŸä¸ªåˆ«åè·å–ç›®æ ‡å¯¹è±¡å¹¶è¿›è¡Œä¿®æ”¹æ—¶ï¼Œå…¶ä»–çš„åˆ«åå¯¹å¯¹è±¡çš„å±æ€§è¯»å–ä¹Ÿä¼šå‘ç”Ÿä¿®æ”¹ã€‚è¿™æ˜¯å› ä¸ºä»»ä½•ä¸€ä¸ªå¼•ç”¨è¿›è¡Œçš„ä¿®æ”¹éƒ½æ˜¯å¯¹å¼•ç”¨å¯¹è±¡æœ¬ä½“è¿›è¡Œçš„ä¿®æ”¹</p><h2 id="å¼•ç”¨ä¸å€¼"><a href="#å¼•ç”¨ä¸å€¼" class="headerlink" title="å¼•ç”¨ä¸å€¼"></a>å¼•ç”¨ä¸å€¼</h2><p>åœ¨è®¨è®ºâ€œå¼•ç”¨ä¼ é€’â€å’Œâ€œå€¼ä¼ é€’â€æ—¶ï¼Œæœ¬è´¨ä¸Šéœ€è¦å›ç­”ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ï¼š<strong>å‡½æ•°è°ƒç”¨æ—¶ï¼Œåˆ°åº•ä¼ å…¥äº†ä»€ä¹ˆï¼Ÿ</strong></p><p>å›åˆ° C è¯­è¨€çš„è®¾è®¡ï¼Œæ‰€æœ‰å˜é‡åœ¨ä¼ å…¥å‡½æ•°æ—¶ï¼Œéƒ½ä¼šåœ¨æ–°çš„æ ˆå¸§ä¸­åˆ›å»ºä¸€ä¸ªå±€éƒ¨å‰¯æœ¬ã€‚</p><ul><li>å¦‚æœä¼ å…¥çš„æ˜¯æ™®é€šå€¼ï¼ˆå¦‚ <code>int</code>ï¼‰ï¼Œåˆ™åˆ›å»ºçš„æ˜¯å€¼çš„å‰¯æœ¬ï¼›</li><li>å¦‚æœä¼ å…¥çš„æ˜¯æŒ‡é’ˆï¼Œåˆ™åˆ›å»ºçš„æ˜¯æŒ‡é’ˆå€¼ï¼ˆåœ°å€ï¼‰çš„å‰¯æœ¬ã€‚</li></ul><p>ä»ä¸¥æ ¼æ„ä¹‰ä¸Šè®²ï¼Œ <strong>Cè¯­è¨€ä¸­æ‰€æœ‰çš„ä¼ é€’éƒ½æ˜¯å€¼ä¼ é€’</strong> ï¼›åªæ˜¯å½“ä¼ é€’çš„æ˜¯æŒ‡é’ˆæ—¶ï¼Œå¯ä»¥é€šè¿‡æŒ‡é’ˆå‰¯æœ¬é—´æ¥ä¿®æ”¹åŸå§‹å†…å­˜ï¼Œä»è€Œè¡¨ç°å‡ºâ€œå¼•ç”¨æ•ˆæœâ€ã€‚</p><p>åœ¨æ›´ç°ä»£çš„è¯­è¨€ï¼ˆå¦‚ Java å’Œ Pythonï¼‰ä¸­ï¼Œæ‰€æœ‰å¯¹è±¡åœ¨ä¼ é€’æ—¶ï¼Œä¼ å…¥çš„æ˜¯ <strong>å¯¹è±¡å¼•ç”¨çš„å‰¯æœ¬</strong> ã€‚å˜é‡æœ¬èº«æŒæœ‰çš„æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯å¯¹è±¡æœ¬ä½“ã€‚</p><p>å› æ­¤ï¼š</p><ul><li>å¦‚æœåœ¨å‡½æ•°ä¸­ä¿®æ”¹å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡å†…å®¹ï¼Œå¤–éƒ¨å¯¹è±¡ä¹Ÿä¼šè¢«æ”¹å˜ï¼›</li><li>å¦‚æœåœ¨å‡½æ•°ä¸­é‡æ–°èµ‹å€¼ç»™å¼•ç”¨ï¼ˆè®©å¼•ç”¨æŒ‡å‘æ–°çš„å¯¹è±¡ï¼‰ï¼Œåˆ™ä¸ä¼šå½±å“å¤–éƒ¨åŸå¼•ç”¨ã€‚</li></ul><p>æ¥çœ‹ä¸‹é¢ä¸¤ä¸ªä¾‹å­ï¼š</p><ol><li><code>test_plus(a,b)</code><br>ä¼ å…¥çš„æ˜¯æ•´æ•° <code>a</code>ã€<code>b</code> çš„å€¼å‰¯æœ¬ã€‚å‡½æ•°å†…éƒ¨ä¿®æ”¹ <code>a</code>ï¼Œä½†ä¸ä¼šå½±å“å¤–éƒ¨ <code>a</code>ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä¸åŒçš„å±€éƒ¨å˜é‡ã€‚</li><li><code>test_plus1(n)</code><br>ä¼ å…¥çš„æ˜¯å¯¹è±¡ <code>n</code> çš„å¼•ç”¨å‰¯æœ¬ã€‚å‡½æ•°å†…éƒ¨é€šè¿‡ <code>n</code> è®¿é—®å¹¶ä¿®æ”¹äº† <code>n.a</code>ã€‚ç”±äºå‰¯æœ¬å’ŒåŸå¼•ç”¨æŒ‡å‘åŒä¸€å—å¯¹è±¡ï¼Œå› æ­¤å¤–éƒ¨çš„ <code>n.a</code> ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ã€‚</li></ol><p>å› æ­¤ï¼Œåœ¨å¼•ç”¨ä¸å®é™…å¯¹è±¡åˆ†ç¦»çš„è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬åº”æ›´å¤šå…³æ³¨ <strong>å¯¹å¼•ç”¨æŒ‡å‘å¯¹è±¡çš„æ“ä½œ</strong> ï¼Œè€Œä¸æ˜¯å•çº¯åœ°çº ç»“äºä¼ é€’æœºåˆ¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Example</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span> ;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">8</span>  ;<br>        test_plus(a,b);<br>        <span class="hljs-type">Number</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Number</span>(<span class="hljs-number">8</span>,<span class="hljs-number">10</span>);<br>        System.out.println(a);<br>        test_plus1(n);<br>        System.out.println(n.a);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Integer <span class="hljs-title function_">test_plus</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span>&#123;<br>        a = a+b;<br>        <span class="hljs-keyword">return</span> a;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Integer <span class="hljs-title function_">test_plus1</span><span class="hljs-params">(Number n)</span>&#123;<br>        n.a = n.a+n.b;<br>        <span class="hljs-keyword">return</span> n.a;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Number</span>&#123;<br>    <span class="hljs-type">int</span> a ;<br>    <span class="hljs-type">int</span> b ;<br>    Number(<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> b)&#123;<br>        <span class="hljs-built_in">this</span>.a = a;<br>        <span class="hljs-built_in">this</span>.b = b;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å…‹éš†å¯¹è±¡"><a href="#å…‹éš†å¯¹è±¡" class="headerlink" title="å…‹éš†å¯¹è±¡"></a>å…‹éš†å¯¹è±¡</h2><p>æˆ‘ä»¬çŸ¥é“äº†æ‰€æœ‰çš„å‡½æ•°æœ¬è´¨çš„ä¸Šéƒ½æ˜¯åœ¨ä¼ é€’å¼•ç”¨çš„â€œå€¼â€ é‚£ä¹ˆåœ¨æŸäº›å¯¹è±¡ä¸æƒ³è¢«ä¿®æ”¹æ—¶ï¼Œå°±éœ€è¦å¯¹å¯¹è±¡è¿›è¡Œå¤åˆ¶ï¼šåœ¨å †ä¸Šé‡æ–°åˆ›å»ºä¸€ä¸ªç›¸åŒçš„å¯¹è±¡å¹¶å°†å¼•ç”¨æŒ‡å‘å®ƒã€‚</p><p>Javaä¸­æä¾›äº† cloneæ–¹æ³•æ¥åˆ›å»ºå¯¹è±¡ï¼Œä½†æ˜¯clone åªä¼šå¯¹ç›®æ ‡å¯¹è±¡è¿›è¡Œæµ…å±‚å…‹éš†ã€‚å¦‚æœå¯¹è±¡ä¸­å­˜åœ¨å¯¹å…¶ä»–å¯¹è±¡çš„å¼•ç”¨ä»ç„¶æŒ‡å‘å¾—æ˜¯åŒä¸€ä¸ªå¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Duplo</span> <span class="hljs-keyword">implements</span>  <span class="hljs-title class_">Cloneable</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> n ;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Duplo</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> &#123;<span class="hljs-built_in">this</span>.n = n;&#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Duplo <span class="hljs-title function_">clone</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">return</span> (Duplo) <span class="hljs-built_in">super</span>.clone();<br>        &#125; <span class="hljs-keyword">catch</span> (CloneNotSupportedException e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AssertionError</span>();<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getValue</span><span class="hljs-params">()</span>&#123;<span class="hljs-keyword">return</span> n; &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setValue</span><span class="hljs-params">(<span class="hljs-type">int</span> n )</span>&#123;<br>        <span class="hljs-built_in">this</span>.n = n;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span>&#123; <span class="hljs-built_in">this</span>.n++;&#125;<br>    <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> Integer.toString(n);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LocalCopy</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Duplo <span class="hljs-title function_">g</span><span class="hljs-params">(Duplo v)</span>&#123;<br>        v.increment();<br>        <span class="hljs-keyword">return</span> v;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Duplo <span class="hljs-title function_">f</span><span class="hljs-params">(Duplo v)</span>&#123;<br>        v = v.clone();<br>        v.increment();<br>        <span class="hljs-keyword">return</span>  v;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Duplo</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Duplo</span>(<span class="hljs-number">11</span>);<br>        <span class="hljs-type">Duplo</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> g(a);<br>        System.out.println(<span class="hljs-string">&quot;a == b:&quot;</span> + (a==b)+<span class="hljs-string">&quot;\\na=&quot;</span> +a +<span class="hljs-string">&quot;\\nb=&quot;</span> +b+<span class="hljs-string">&quot;\\n&quot;</span>);<br>        <span class="hljs-type">Duplo</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Duplo</span>(<span class="hljs-number">47</span>);<br>        <span class="hljs-type">Duplo</span> <span class="hljs-variable">d</span> <span class="hljs-operator">=</span> f(c);<br>        System.out.println(<span class="hljs-string">&quot;c == d:&quot;</span> + (c==d)+<span class="hljs-string">&quot;\\nc=&quot;</span> +c +<span class="hljs-string">&quot;\\nd=&quot;</span> +d+<span class="hljs-string">&quot;\\n&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h1><h2 id="å®šä¹‰æ³¨è§£"><a href="#å®šä¹‰æ³¨è§£" class="headerlink" title="å®šä¹‰æ³¨è§£"></a>å®šä¹‰æ³¨è§£</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.annotation.*;<br><br><span class="hljs-meta">@Target(ElementType.METHOD)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Test&#123;&#125;<br><br><span class="hljs-comment">// @TargetæŒ‡å®šæ³¨è§£åº”ç”¨çš„ä½ç½®</span><br><span class="hljs-comment">// @Retention æŒ‡å®šæ³¨è§£å¯ç”¨çš„é˜¶æ®µ  æºä»£ç ï¼Œç±»æ–‡ä»¶ï¼Œè¿è¡Œæ—¶</span><br> <br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaç¼–ç¨‹ III é›†åˆ</title>
    <link href="/2025/04/22/Java%E7%BC%96%E7%A8%8B-III-%E9%9B%86%E5%90%88/"/>
    <url>/2025/04/22/Java%E7%BC%96%E7%A8%8B-III-%E9%9B%86%E5%90%88/</url>
    
    <content type="html"><![CDATA[<h1 id="é›†åˆ"><a href="#é›†åˆ" class="headerlink" title="é›†åˆ"></a>é›†åˆ</h1><p>é›†åˆæ˜¯javaä¸­ç”¨æ¥æŒæœ‰å¯¹è±¡çš„ä¸€ç§â€å®¹å™¨â€œã€‚å®ƒå…·ä½“è¡¨ç°ä¸ºå®ç°äº†ä¸¤ä¸ªåŸºæœ¬æ¥å£</p><p><img src="blob:https://111666.best/d4ac7bc3-8f43-4d93-897e-d2595072cb67" alt="image"></p><h2 id="collection"><a href="#collection" class="headerlink" title="collection"></a>collection</h2><p>ä¸€ä¸ªç”±å•ç‹¬å…ƒç´ ç»„æˆçš„åºåˆ—ï¼Œè€Œè¿™äº›å…ƒç´ éœ€è¦ç¬¦åˆä¸€æ¡æˆ–å¤šæ¡è§„åˆ™</p><p>List : å¿…é¡»æŒ‰ç…§å…ƒç´ çš„æ’å…¥é¡ºåºæ¥è¿›è¡Œä¿å­˜</p><p>Set : ä¸­ä¸èƒ½å­˜åœ¨é‡å¤å…ƒç´ </p><p>Queue : æŒ‰ç…§æ’é˜Ÿé¡ºåºè¾“å‡ºå…ƒç´ </p><h2 id="map"><a href="#map" class="headerlink" title="map"></a>map</h2><p>ä¸€ç»„é”®å€¼å¯¹è±¡ï¼Œé€šè¿‡é”®æ¥æŸ¥æ‰¾å€¼ã€‚mapé€šè¿‡ä¸€ä¸ªå¯¹è±¡æ¥æŸ¥æ‰¾å¦ä¸€ä¸ªå¯¹è±¡</p><h2 id="å‘é›†åˆä¸­æ·»åŠ å…ƒç´ "><a href="#å‘é›†åˆä¸­æ·»åŠ å…ƒç´ " class="headerlink" title="å‘é›†åˆä¸­æ·»åŠ å…ƒç´ "></a>å‘é›†åˆä¸­æ·»åŠ å…ƒç´ </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AddingGroups</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>        Collection&lt;Integer&gt; collection = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(Arrays.asList(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>));<br>        Integer[] moreInts = &#123;<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>&#125;;<br>        collection.addAll(Arrays.asList(moreInts));<br>        <span class="hljs-keyword">for</span>(Integer i : collection)&#123;<br>            System.out.println(i);<br>        &#125;<br>        <span class="hljs-comment">// Ragged array</span><br>        List&lt;Integer&gt; list = Arrays.asList(moreInts);<br>        list.set(<span class="hljs-number">0</span>, <span class="hljs-number">99</span>);<br>        System.out.println(list.get(<span class="hljs-number">0</span>));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ‰“å°é›†åˆ"><a href="#æ‰“å°é›†åˆ" class="headerlink" title="æ‰“å°é›†åˆ"></a>æ‰“å°é›†åˆ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.* <br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrintingCollections</span>&#123;<br><span class="hljs-keyword">static</span> Collection <span class="hljs-title function_">fill</span><span class="hljs-params">(Collection&lt; String &gt; collection)</span>&#123;<br>collection.add(<span class="hljs-string">&quot;rat&quot;</span>);<br>collection.add(<span class="hljs-string">&quot;cat&quot;</span>);<br>collection.add(<span class="hljs-string">&quot;dog&quot;</span>);<br>collection.add(<span class="hljs-string">&quot;dog&quot;</span>);<br><span class="hljs-keyword">return</span> collection;<br>&#125;<br><br> <span class="hljs-keyword">static</span>  Map <span class="hljs-title function_">fill</span><span class="hljs-params">(Map&lt;String&gt; map)</span>&#123;<br> map.put(<span class="hljs-string">&quot;rat&quot;</span>,<span class="hljs-string">&quot;Fuzzy&quot;</span>);<br> map.put(<span class="hljs-string">&quot;cat&quot;</span>,<span class="hljs-string">&quot;Rats&quot;</span>);<br> map.put(<span class="hljs-string">&quot;dog&quot;</span>,<span class="hljs-string">&quot;Bosco&quot;</span>);<br> map.put(<span class="hljs-string">&quot;dog&quot;</span>,<span class="hljs-string">&quot;Spot&quot;</span>);<br> <span class="hljs-keyword">return</span> map ;<br>  &#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>System.out.println(fill(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;()));<br>System.out.println(fill(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;()));<br>System.out.println(fill(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Hashset</span>&lt;&gt;()));<br>System.out.println(fill(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeSet</span>&lt;&gt;()));<br>System.out.println(fill(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashSet</span>&lt;&gt;()));<br>System.out.println(fill(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;()));<br>System.out.println(fill(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>&lt;&gt;()));<br>System.out.println(fill(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashMap</span>()));<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="List"><a href="#List" class="headerlink" title="List"></a>List</h2><p>listçš„åˆ›å»ºå’Œå¸¸ç”¨å‡½æ•° ï¼ˆä»¥arraylistä¸ºä¾‹ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs java">    <span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ListExample</span> &#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª Listï¼Œä½¿ç”¨ ArrayList å®ç°ç±»</span><br>List&lt;String&gt; fruits = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <span class="hljs-comment">// 1. add() æ·»åŠ å…ƒç´ </span><br>    fruits.add(<span class="hljs-string">&quot;Apple&quot;</span>);<br>    fruits.add(<span class="hljs-string">&quot;Banana&quot;</span>);<br>    fruits.add(<span class="hljs-string">&quot;Orange&quot;</span>);<br>    fruits.add(<span class="hljs-string">&quot;Grapes&quot;</span>);<br>    System.out.println(<span class="hljs-string">&quot;åŸå§‹åˆ—è¡¨ï¼š&quot;</span> + fruits); <span class="hljs-comment">// [Apple, Banana, Orange, Grapes]</span><br><br>    <span class="hljs-comment">// 2. get(int index) è·å–æŒ‡å®šä½ç½®çš„å…ƒç´ </span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">first</span> <span class="hljs-operator">=</span> fruits.get(<span class="hljs-number">0</span>);<br>    System.out.println(<span class="hljs-string">&quot;ç¬¬ä¸€ä¸ªæ°´æœæ˜¯ï¼š&quot;</span> + first); <span class="hljs-comment">// Apple</span><br><br>    <span class="hljs-comment">// 3. set(int index, E element) æ›¿æ¢æŒ‡å®šä½ç½®çš„å…ƒç´ </span><br>    fruits.set(<span class="hljs-number">1</span>, <span class="hljs-string">&quot;Blueberry&quot;</span>); <span class="hljs-comment">// æ›¿æ¢ Banana</span><br>    System.out.println(<span class="hljs-string">&quot;ä¿®æ”¹åçš„åˆ—è¡¨ï¼š&quot;</span> + fruits); <span class="hljs-comment">// [Apple, Blueberry, Orange, Grapes]</span><br><br>    <span class="hljs-comment">// 4. remove(int index) æ ¹æ®ä¸‹æ ‡åˆ é™¤</span><br>    fruits.remove(<span class="hljs-number">2</span>); <span class="hljs-comment">// åˆ é™¤ Orange</span><br>    System.out.println(<span class="hljs-string">&quot;åˆ é™¤åçš„åˆ—è¡¨ï¼š&quot;</span> + fruits); <span class="hljs-comment">// [Apple, Blueberry, Grapes]</span><br><br>    <span class="hljs-comment">// 5. remove(Object o) æ ¹æ®å¯¹è±¡åˆ é™¤</span><br>    fruits.remove(<span class="hljs-string">&quot;Apple&quot;</span>);<br>    System.out.println(<span class="hljs-string">&quot;åˆ é™¤ Apple åï¼š&quot;</span> + fruits); <span class="hljs-comment">// [Blueberry, Grapes]</span><br><br>    <span class="hljs-comment">// 6. contains(Object o) åˆ¤æ–­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ </span><br>    <span class="hljs-type">boolean</span> <span class="hljs-variable">hasGrapes</span> <span class="hljs-operator">=</span> fruits.contains(<span class="hljs-string">&quot;Grapes&quot;</span>);<br>    System.out.println(<span class="hljs-string">&quot;åŒ…å« Grapesï¼Ÿ&quot;</span> + hasGrapes); <span class="hljs-comment">// true</span><br><br>    <span class="hljs-comment">// 7. size() è¿”å›å…ƒç´ ä¸ªæ•°</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> fruits.size();<br>    System.out.println(<span class="hljs-string">&quot;åˆ—è¡¨é•¿åº¦ï¼š&quot;</span> + size); <span class="hljs-comment">// 2</span><br><br>    <span class="hljs-comment">// 8. isEmpty() åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span><br>    System.out.println(<span class="hljs-string">&quot;åˆ—è¡¨æ˜¯å¦ä¸ºç©ºï¼Ÿ&quot;</span> + fruits.isEmpty()); <span class="hljs-comment">// false</span><br><br>    <span class="hljs-comment">// 9. clear() æ¸…ç©ºåˆ—è¡¨</span><br>    fruits.clear();<br>    System.out.println(<span class="hljs-string">&quot;æ¸…ç©ºåçš„åˆ—è¡¨ï¼š&quot;</span> + fruits); <span class="hljs-comment">// []</span><br><br>    <span class="hljs-comment">// 10. addAll(Collection&lt;? extends E&gt; c) æ·»åŠ ä¸€æ•´ä¸ªé›†åˆ</span><br>    List&lt;String&gt; newFruits = List.of(<span class="hljs-string">&quot;Mango&quot;</span>, <span class="hljs-string">&quot;Peach&quot;</span>, <span class="hljs-string">&quot;Cherry&quot;</span>);<br>    fruits.addAll(newFruits);<br>    System.out.println(<span class="hljs-string">&quot;æ·»åŠ å¤šä¸ªæ°´æœï¼š&quot;</span> + fruits); <span class="hljs-comment">// [Mango, Peach, Cherry]</span><br><br>    <span class="hljs-comment">// 11. indexOf(Object o) è·å–å…ƒç´ ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</span><br>    System.out.println(<span class="hljs-string">&quot;Peach çš„ä½ç½®ï¼š&quot;</span> + fruits.indexOf(<span class="hljs-string">&quot;Peach&quot;</span>)); <span class="hljs-comment">// 1</span><br><br>    <span class="hljs-comment">// 12. for-each éå†</span><br>    <span class="hljs-keyword">for</span> (String fruit : fruits) &#123;<br>        System.out.println(<span class="hljs-string">&quot;æ°´æœï¼š&quot;</span> + fruit);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h2><p>set ä¸­ä¸å…è®¸å‡ºç°é‡å¤çš„å¯¹è±¡å€¼ï¼Œ</p><p>å¸¸ç”¨æ–¹æ³•ç¤ºä¾‹ï¼ˆä»¥hashsetä¸ºä¾‹ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.HashSet;<br><span class="hljs-keyword">import</span> java.util.Set;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SetExample</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª HashSetï¼ˆæœ€å¸¸ç”¨çš„ Set å®ç°ï¼‰</span><br>        Set&lt;String&gt; set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();<br><br>        <span class="hljs-comment">// 1. add(E e) æ·»åŠ å…ƒç´ ï¼ˆä¸ä¼šæ·»åŠ é‡å¤å…ƒç´ ï¼‰</span><br>        set.add(<span class="hljs-string">&quot;Apple&quot;</span>);<br>        set.add(<span class="hljs-string">&quot;Banana&quot;</span>);<br>        set.add(<span class="hljs-string">&quot;Orange&quot;</span>);<br>        set.add(<span class="hljs-string">&quot;Apple&quot;</span>); <span class="hljs-comment">// é‡å¤æ·»åŠ æ— æ•ˆ</span><br><br>        System.out.println(<span class="hljs-string">&quot;é›†åˆå†…å®¹ï¼š&quot;</span> + set); <span class="hljs-comment">// [Banana, Apple, Orange]ï¼ˆæ— åºä¸”ä¸é‡å¤ï¼‰</span><br><br>        <span class="hljs-comment">// 2. contains(Object o) åˆ¤æ–­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ </span><br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">hasApple</span> <span class="hljs-operator">=</span> set.contains(<span class="hljs-string">&quot;Apple&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;åŒ…å« Appleï¼Ÿ&quot;</span> + hasApple); <span class="hljs-comment">// true</span><br><br>        <span class="hljs-comment">// 3. remove(Object o) åˆ é™¤å…ƒç´ </span><br>        set.remove(<span class="hljs-string">&quot;Orange&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;åˆ é™¤ Orange åï¼š&quot;</span> + set); <span class="hljs-comment">// [Banana, Apple]</span><br><br>        <span class="hljs-comment">// 4. size() è·å–é›†åˆä¸­å…ƒç´ ä¸ªæ•°</span><br>        System.out.println(<span class="hljs-string">&quot;é›†åˆå¤§å°ï¼š&quot;</span> + set.size()); <span class="hljs-comment">// 2</span><br><br>        <span class="hljs-comment">// 5. isEmpty() åˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©º</span><br>        System.out.println(<span class="hljs-string">&quot;é›†åˆæ˜¯å¦ä¸ºç©ºï¼Ÿ&quot;</span> + set.isEmpty()); <span class="hljs-comment">// false</span><br><br>        <span class="hljs-comment">// 6. clear() æ¸…ç©ºé›†åˆ</span><br>        set.clear();<br>        System.out.println(<span class="hljs-string">&quot;æ¸…ç©ºåï¼š&quot;</span> + set); <span class="hljs-comment">// []</span><br><br>        <span class="hljs-comment">// 7. addAll(Collection&lt;? extends E&gt; c) æ·»åŠ ä¸€æ•´ä¸ªé›†åˆ</span><br>        Set&lt;String&gt; newSet = Set.of(<span class="hljs-string">&quot;Mango&quot;</span>, <span class="hljs-string">&quot;Peach&quot;</span>, <span class="hljs-string">&quot;Cherry&quot;</span>);<br>        set.addAll(newSet);<br>        System.out.println(<span class="hljs-string">&quot;æ·»åŠ å¤šä¸ªå…ƒç´ ï¼š&quot;</span> + set); <span class="hljs-comment">// [Mango, Peach, Cherry]</span><br><br>        <span class="hljs-comment">// 8. éå† Setï¼ˆä½¿ç”¨å¢å¼º for å¾ªç¯ï¼‰</span><br>        <span class="hljs-keyword">for</span> (String fruit : set) &#123;<br>            System.out.println(<span class="hljs-string">&quot;éå†å…ƒç´ ï¼š&quot;</span> + fruit);<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h2><p>å¸¸ç”¨çš„map æ–¹æ³•ï¼ˆä»¥hashmapä¸ºä¾‹ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MapExample</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª HashMapï¼ˆæœ€å¸¸ç”¨çš„ Map å®ç°ï¼‰</span><br>        Map&lt;String, Integer&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><br>        <span class="hljs-comment">// 1. put(K key, V value) æ·»åŠ é”®å€¼å¯¹</span><br>        map.put(<span class="hljs-string">&quot;Apple&quot;</span>, <span class="hljs-number">3</span>);<br>        map.put(<span class="hljs-string">&quot;Banana&quot;</span>, <span class="hljs-number">2</span>);<br>        map.put(<span class="hljs-string">&quot;Orange&quot;</span>, <span class="hljs-number">5</span>);<br>        map.put(<span class="hljs-string">&quot;Apple&quot;</span>, <span class="hljs-number">4</span>); <span class="hljs-comment">// é‡å¤ keyï¼Œä¼šè¦†ç›–æ—§å€¼</span><br>        System.out.println(<span class="hljs-string">&quot;åŸå§‹ Mapï¼š&quot;</span> + map); <span class="hljs-comment">// &#123;Banana=2, Apple=4, Orange=5&#125;</span><br><br>        <span class="hljs-comment">// 2. get(Object key) æ ¹æ® key è·å– value</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">appleCount</span> <span class="hljs-operator">=</span> map.get(<span class="hljs-string">&quot;Apple&quot;</span>); <br>        System.out.println(<span class="hljs-string">&quot;Apple æ•°é‡ï¼š&quot;</span> + appleCount); <span class="hljs-comment">// 4</span><br><br>        <span class="hljs-comment">// 3. containsKey(Object key) æ˜¯å¦åŒ…å«æŸä¸ª key</span><br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">hasBanana</span> <span class="hljs-operator">=</span> map.containsKey(<span class="hljs-string">&quot;Banana&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;åŒ…å« Bananaï¼Ÿ&quot;</span> + hasBanana); <span class="hljs-comment">// true</span><br><br>        <span class="hljs-comment">// 4. containsValue(Object value) æ˜¯å¦åŒ…å«æŸä¸ª value</span><br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">hasValue5</span> <span class="hljs-operator">=</span> map.containsValue(<span class="hljs-number">5</span>);<br>        System.out.println(<span class="hljs-string">&quot;åŒ…å«å€¼ 5ï¼Ÿ&quot;</span> + hasValue5); <span class="hljs-comment">// true</span><br><br>        <span class="hljs-comment">// 5. remove(Object key) ç§»é™¤æŒ‡å®š key å¯¹åº”çš„æ˜ å°„</span><br>        map.remove(<span class="hljs-string">&quot;Banana&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;ç§»é™¤ Banana åï¼š&quot;</span> + map); <span class="hljs-comment">// &#123;Apple=4, Orange=5&#125;</span><br><br>        <span class="hljs-comment">// 6. size() è¿”å›æ˜ å°„å…³ç³»æ•°é‡</span><br>        System.out.println(<span class="hljs-string">&quot;Map å¤§å°ï¼š&quot;</span> + map.size()); <span class="hljs-comment">// 2</span><br><br>        <span class="hljs-comment">// 7. isEmpty() æ˜¯å¦ä¸ºç©º</span><br>        System.out.println(<span class="hljs-string">&quot;Map æ˜¯å¦ä¸ºç©ºï¼Ÿ&quot;</span> + map.isEmpty()); <span class="hljs-comment">// false</span><br><br>        <span class="hljs-comment">// 8. keySet() è·å–æ‰€æœ‰ key ç»„æˆçš„ Set</span><br>        System.out.println(<span class="hljs-string">&quot;æ‰€æœ‰ keyï¼š&quot;</span> + map.keySet()); <span class="hljs-comment">// [Apple, Orange]</span><br><br>        <span class="hljs-comment">// 9. values() è·å–æ‰€æœ‰ value ç»„æˆçš„ Collection</span><br>        System.out.println(<span class="hljs-string">&quot;æ‰€æœ‰ valueï¼š&quot;</span> + map.values()); <span class="hljs-comment">// [4,</span><br><br></code></pre></td></tr></table></figure><h2 id="Collectionç±»çš„ä½œç”¨"><a href="#Collectionç±»çš„ä½œç”¨" class="headerlink" title="Collectionç±»çš„ä½œç”¨"></a>Collectionç±»çš„ä½œç”¨</h2><p>åœ¨ C&#x2F;C++ è¯­è¨€ä¸­ï¼Œç¨‹åºå‘˜å¸¸å¸¸éœ€è¦æ‰‹åŠ¨ç®¡ç†å†…å­˜ï¼Œå¹¶é€šè¿‡æŒ‡é’ˆæ“ä½œå®ç°æ•°æ®ç»“æ„ï¼ˆå¦‚æ•°ç»„ã€é“¾è¡¨ã€å“ˆå¸Œè¡¨ç­‰ï¼‰çš„åŠ¨æ€å­˜å‚¨ä¸è®¿é—®ã€‚<strong>Java ä¸­çš„ Collection æ¡†æ¶æ­£æ˜¯å¯¹è¿™äº›åº•å±‚å®¹å™¨æœºåˆ¶çš„æŠ½è±¡ä¸å°è£…</strong>ï¼Œæä¾›äº†æ›´å®‰å…¨ã€å¯æ‰©å±•ã€é¢å‘å¯¹è±¡çš„å®¹å™¨è§£å†³æ–¹æ¡ˆã€‚</p><h3 id="Collection-çš„æœ¬è´¨ä¸ä½œç”¨"><a href="#Collection-çš„æœ¬è´¨ä¸ä½œç”¨" class="headerlink" title="Collection çš„æœ¬è´¨ä¸ä½œç”¨"></a>Collection çš„æœ¬è´¨ä¸ä½œç”¨</h3><p>åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œè™½ç„¶ä¸€åˆ‡çš†å¯¹è±¡ï¼Œä½†å¯¹è±¡ä¹‹é—´çš„ç»„ç»‡ã€ç®¡ç†ä¸æ‰¹é‡æ“ä½œä»éœ€å€ŸåŠ©å®¹å™¨ç»“æ„ã€‚Java ä½¿ç”¨ <code>Collection</code> æ¥å£æŠ½è±¡äº†è¿™ç±» <strong>â€œå®¹å™¨å‹å¯¹è±¡â€</strong> çš„åŸºæœ¬è¡Œä¸ºè§„èŒƒï¼Œå®šä¹‰äº†æ•°æ®çš„<strong>æ·»åŠ ã€åˆ é™¤ã€éå†ã€æŸ¥è¯¢</strong>ç­‰æ“ä½œæ–¹å¼ï¼Œç±»ä¼¼äºæ ‡å‡†å®¹å™¨åº“ï¼ˆSTLï¼‰åœ¨ C++ ä¸­çš„è§’è‰²ã€‚</p><h3 id="åº•å±‚ç»“æ„ä¸ä¸‰å¤§ç»å…¸å®ç°"><a href="#åº•å±‚ç»“æ„ä¸ä¸‰å¤§ç»å…¸å®ç°" class="headerlink" title="åº•å±‚ç»“æ„ä¸ä¸‰å¤§ç»å…¸å®ç°"></a>åº•å±‚ç»“æ„ä¸ä¸‰å¤§ç»å…¸å®ç°</h3><p>Java ä¸­å¸¸è§çš„å®¹å™¨å®ç°ï¼Œåº•å±‚æºäºä¸‰ç§ç»å…¸æ•°æ®ç»“æ„ï¼Œæ¯ç§éƒ½é’ˆå¯¹ç‰¹å®šçš„æ“ä½œåœºæ™¯åšå‡ºäº†æ•ˆç‡å–èˆï¼š</p><table><thead><tr><th>å®ç°æ–¹å¼</th><th>åº•å±‚ç»“æ„</th><th>ä¼˜åŠ¿</th><th>åŠ£åŠ¿</th></tr></thead><tbody><tr><td><code>Array</code></td><td>æ•°ç»„</td><td>éšæœºè®¿é—®å¿«ï¼ˆO(1)ï¼‰</td><td>æ’å…¥&#x2F;åˆ é™¤æ•ˆç‡ä½ï¼Œæ‰©å®¹æˆæœ¬é«˜</td></tr><tr><td><code>Linked</code></td><td>é“¾è¡¨</td><td>æ’å…¥&#x2F;åˆ é™¤å¿«ï¼ˆO(1)ï¼‰</td><td>æŸ¥è¯¢æ…¢ï¼ˆO(n)ï¼‰</td></tr><tr><td><code>Hash</code></td><td>å“ˆå¸Œè¡¨</td><td>å¿«é€Ÿå®šä½ï¼ˆO(1) è¿‘ä¼¼ï¼‰</td><td>ä¸æ”¯æŒé¡ºåºï¼Œå¯èƒ½å­˜åœ¨å“ˆå¸Œå†²çª</td></tr></tbody></table><ul><li><strong>æ•°ç»„ï¼ˆArrayï¼‰</strong>ï¼šé€šè¿‡â€œåœ°å€ + åç§»â€çš„æ–¹å¼å®ç°å¿«é€Ÿå®šä½ï¼Œé€‚ç”¨äºé¢‘ç¹æŸ¥è¯¢ä½†ä¸å¸¸å˜åŠ¨çš„åœºæ™¯ã€‚</li><li><strong>é“¾è¡¨ï¼ˆLinked Listï¼‰</strong>ï¼šé€‚åˆé¢‘ç¹æ’å…¥&#x2F;åˆ é™¤ï¼Œä½†ä¸é€‚ç”¨äºå¤§è§„æ¨¡éšæœºè®¿é—®ã€‚</li><li><strong>å“ˆå¸Œè¡¨ï¼ˆHash Tableï¼‰</strong>ï¼šé€šè¿‡å“ˆå¸Œå‡½æ•°å®šä½å­˜å‚¨ä½ç½®ï¼Œå®ç°é«˜æ•ˆçš„é”®å€¼æ˜ å°„æŸ¥è¯¢ã€‚</li></ul><h1 id="Lambdaè¡¨è¾¾å¼"><a href="#Lambdaè¡¨è¾¾å¼" class="headerlink" title="Lambdaè¡¨è¾¾å¼"></a>Lambdaè¡¨è¾¾å¼</h1><p>ä¸€ç§å‡½æ•°å¼çš„æ‰§è¡Œæ–¹å¼ï¼Œåœ¨javaä¸­ å› ä¸ºjavaå®šä¹‰çš„æ¥å£æ˜¯è¦æ±‚æ‰§è¡Œä¸€ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç›´æ¥å®šä¹‰ç¬¦åˆè¯¥æ¥å£ç›®çš„çš„æ–¹æ³•ä½œä¸ºä¸€ä¸ªå¾…æ‰§è¡Œçš„â€œç±»â€äº¤ç»™åº”ç”¨å»è°ƒç”¨æ‰§è¡Œã€‚æœ¬è´¨æ˜¯<strong>ç¼–è¯‘å™¨å¸®ä½ è‡ªåŠ¨åˆ›å»ºäº†ä¸€ä¸ªå®ç°äº†æŸä¸ªå‡½æ•°å¼æ¥å£çš„åŒ¿åå¯¹è±¡ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™ä¸€ä¸ªæ¥å£ç±»å‹çš„å¼•ç”¨å˜é‡</strong>ï¼Œä½ å†é€šè¿‡è¿™ä¸ªå¼•ç”¨å»è°ƒç”¨å®ƒçš„æ–¹æ³•</p><p>ä½¿ç”¨æ–¹æ³• ï¼š å®šä¹‰ä¸€ä¸ªåªæœ‰ä¸€ä¸ªå‡½æ•°ç­¾åçš„æ¥å£ï¼Œåœ¨è°ƒç”¨æ—¶ç›´æ¥å£°æ˜åŸºäºè¯¥æ¥å£çš„å¼•ç”¨ ç„¶å</p><p>() â†’ é‡å†™æ¥å£å®šä¹‰çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LambdaFeastures</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">sayHi</span> <span class="hljs-variable">hi</span> <span class="hljs-operator">=</span> () -&gt; System.out.println(<span class="hljs-string">&quot;hi&quot;</span>);<br>        hi.hi();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">sayHi</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">hi</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹åº”çš„ åŒ¿åç±»å®ç° ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LambdaFeastures</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">sayHi</span> <span class="hljs-variable">hi</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">sayHi</span>() &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hi</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;hi&quot;</span>);<br>    &#125;<br>&#125;<br>&#125;<br>&#125;<br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">sayHi</span>&#123;<br><span class="hljs-keyword">void</span> <span class="hljs-title function_">hi</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaç¼–ç¨‹ II é¢å‘å¯¹è±¡</title>
    <link href="/2025/04/22/Java%E7%BC%96%E7%A8%8B-II-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"/>
    <url>/2025/04/22/Java%E7%BC%96%E7%A8%8B-II-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/</url>
    
    <content type="html"><![CDATA[<h1 id="åˆå§‹åŒ–å’Œæ¸…ç†"><a href="#åˆå§‹åŒ–å’Œæ¸…ç†" class="headerlink" title="åˆå§‹åŒ–å’Œæ¸…ç†"></a>åˆå§‹åŒ–å’Œæ¸…ç†</h1><h2 id="æ„é€ å™¨"><a href="#æ„é€ å™¨" class="headerlink" title="æ„é€ å™¨"></a>æ„é€ å™¨</h2><p>æ„é€ å™¨æ˜¯åœ¨åˆ›å»ºå¯¹è±¡æ—¶ï¼Œå°†ç±»çš„æˆå‘˜å±æ€§è¿›è¡Œåˆå§‹åŒ–è¿‡ç¨‹çš„ä¸€ç§å‡½æ•°</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Rock</span> &#123;<br>Rock()&#123;<br>System.out.print(<span class="hljs-string">&quot;Rock&quot;</span>);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å½“éœ€è¦è¿›è¡Œå®ä¾‹åŒ–åˆ›å»ºæ—¶ï¼Œç±»ä¼šæ ¹æ®ä¼ å…¥çš„å‚æ•°åˆ—è¡¨é€‰æ‹©æ„é€ å™¨è¿›è¡Œå¯¹è±¡çš„åˆå§‹åŒ–ã€‚</p><p>è¿™ä¸ªå«åš æ„é€ å™¨é‡è½½ã€‚ é€šè¿‡ä¸åŒçš„å‡½æ•°åˆ—è¡¨æ¥å†³å®š è°ƒç”¨å“ªä¸ªæ„é€ å™¨ã€‚</p><p>å½“æœªå®šä¹‰æ„é€ å™¨æ—¶ï¼Œå®é™…ä¸Šæ˜¯æ‰§è¡Œäº†ä¸€ä¸ªæ— å‚çš„æ„é€ å™¨ã€‚</p><p><strong>æ„é€ æ–¹æ³•å¹¶ä¸è´Ÿè´£â€œåˆ›å»ºå¯¹è±¡â€æœ¬èº«ï¼Œå®ƒè´Ÿè´£çš„æ˜¯â€œåˆå§‹åŒ–å·²ç»åˆ†é…å¥½çš„å¯¹è±¡â€</strong></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼šâ€newâ€ æ‰æ˜¯çœŸæ­£è´Ÿè´£å¯¹è±¡åˆ›å»ºå’Œå†…å­˜åˆ†é…çš„å…³é”®ï¼Œæ„é€ æ–¹æ³•æ˜¯â€œåå¤„ç†å™¨â€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Rock</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rock</span>();<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rock</span>(<span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rock</span>(<span class="hljs-number">1.0</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Rock</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Rock without parameter&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Rock</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Rock with int parameter&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Rock</span><span class="hljs-params">(<span class="hljs-type">double</span> d)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Rock with double parameter&quot;</span>);<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><h2 id="thiså…³é”®å­—"><a href="#thiså…³é”®å­—" class="headerlink" title="thiså…³é”®å­—"></a>thiså…³é”®å­—</h2><p>åœ¨æ„é€ æ–¹æ³•æˆ–è€…å®ä¾‹æ–¹æ³•ä¸­ï¼Œå¦‚æœéœ€è¦è°ƒç”¨åŒä¸€ä¸ªç±»å®šä¹‰ä¸‹çš„ç»“æ„ï¼ˆå±æ€§&#x2F;æ–¹æ³•ï¼‰</p><p>å¯ä»¥ä½¿ç”¨thiså…³é”®å­—è¿›è¡Œè°ƒç”¨ï¼Œthisä½œä¸ºåˆ›å»ºåçš„å®ä¾‹å¯¹è±¡çš„å¼•ç”¨</p><h2 id="æ„é€ å™¨ä¸­è°ƒç”¨æ„é€ å™¨"><a href="#æ„é€ å™¨ä¸­è°ƒç”¨æ„é€ å™¨" class="headerlink" title="æ„é€ å™¨ä¸­è°ƒç”¨æ„é€ å™¨"></a>æ„é€ å™¨ä¸­è°ƒç”¨æ„é€ å™¨</h2><p>å¿…é¡»åœ¨æ„é€ å™¨çš„ç¬¬ä¸€è¡Œä¸­è°ƒç”¨å¦ä¸€ä¸ªæ„é€ å™¨</p><p>å…¶å®å¾ˆç±»ä¼¼äºpythonä¸­çš„é»˜è®¤å‚æ•°çš„ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Flower</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">petalCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;initial value&quot;</span>;<br>    Flower(<span class="hljs-type">int</span> petals) &#123;<br>        petalCount = petals;<br>        System.out.println(<span class="hljs-string">&quot;Constructor w/ int arg only, petalCount = &quot;</span> + petalCount);<br>    &#125;<br>    Flower(String ss)&#123;<br>        System.out.println(<span class="hljs-string">&quot;Constructor w/ String arg only, s = &quot;</span> + ss);<br>    &#125;<br>    Flower(String s, <span class="hljs-type">int</span> petals) &#123;<br>        <span class="hljs-built_in">this</span>(petals);<br>        <span class="hljs-built_in">this</span>.s = s;<br>        System.out.println(<span class="hljs-string">&quot;String &amp; int args&quot;</span>);<br>    &#125;<br>    Flower() &#123;<br>        <span class="hljs-built_in">this</span>(<span class="hljs-string">&quot;hi&quot;</span>, <span class="hljs-number">47</span>);<br>        System.out.println(<span class="hljs-string">&quot;default constructor&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">printPetalCount</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;petalCount = &quot;</span> + petalCount + <span class="hljs-string">&quot; s = &quot;</span> + s);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Flower</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Flower</span>();<br>        x.printPetalCount();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h2><p>åœ¨Javaä¸­ </p><p>ç±»æˆå‘˜å˜é‡ï¼Œé™æ€æˆå‘˜å˜é‡ã€‚éƒ½ä¼šåœ¨å…¶å…·ä½“çš„è¢«æ‰§è¡Œè¿‡ç¨‹ä¸­è¢«JVMé»˜è®¤åˆå§‹åŒ–</p><p>å€¼ç±»å‹ è¢«åˆå§‹åŒ–ä¸º0 ï¼Œ å¼•ç”¨ç±»å‹è¢«åˆå§‹åŒ–ä¸ºnull</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Flower</span> &#123;<br>    <span class="hljs-type">int</span> petalCount ;<br>    <span class="hljs-keyword">static</span> Piece p ;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Flower</span> <span class="hljs-variable">flower</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Flower</span>();<br>        System.out.println(flower.petalCount);<br>        System.out.println(p);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Piece</span>&#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">90</span>  ;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>è€Œå¯¹äºå±€éƒ¨å˜é‡ ï¼ˆå³å‚ä¸å‡½æ•°æ‰§è¡Œçš„å˜é‡ï¼‰å¿…é¡»åœ¨javaæ–‡ä»¶ä¸­å°±è¿›è¡Œç›¸åº”çš„å˜é‡å®šä¹‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Flower</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sayHello</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">int</span> i  ;<br>        System.out.println(i);<br>    &#125;<br><br>&#125;<br><br><span class="hljs-comment">/* PS D:\Flask_Project&gt; java Flower.java</span><br><span class="hljs-comment"> *Flower.java:9: é”™è¯¯: å¯èƒ½å°šæœªåˆå§‹åŒ–å˜é‡i</span><br><span class="hljs-comment"> *       System.out.println(i);</span><br><span class="hljs-comment"> *                          ^</span><br><span class="hljs-comment"> * 1 ä¸ªé”™è¯¯</span><br><span class="hljs-comment"> * é”™è¯¯: ç¼–è¯‘å¤±è´¥</span><br><span class="hljs-comment"> */</span><br></code></pre></td></tr></table></figure><p>å› ä¸ºåœ¨ç¼–è¯‘æ—¶ </p><p>å¯¹äºç±»çš„è¡Œä¸º ï¼šç¼–è¯‘å™¨ç¡®è®¤ç±»çš„ç»“æ„ï¼Œå¯¹ç±»ä¸­çš„æˆå‘˜å˜é‡è¿›è¡Œåˆå§‹åŒ–</p><p>å¯¹äºæ–¹æ³•çš„è¡Œä¸º ï¼š å…ˆæ„å»ºå±€éƒ¨å˜é‡è¡¨ï¼Œå†å¯¹æ–¹æ³•ä¸­å®šä¹‰çš„ä»£ç è¿›è¡Œæ‰§è¡Œï¼Œå¼ºåˆ¶å±€éƒ¨å˜é‡å¿…é¡»æ‰‹åŠ¨åˆå§‹åŒ–</p><h2 id="åˆå§‹åŒ–ä¸åˆå§‹åŒ–é¡ºåº"><a href="#åˆå§‹åŒ–ä¸åˆå§‹åŒ–é¡ºåº" class="headerlink" title="åˆå§‹åŒ–ä¸åˆå§‹åŒ–é¡ºåº"></a>åˆå§‹åŒ–ä¸åˆå§‹åŒ–é¡ºåº</h2><p>å¯¹äº å˜é‡ é€šè¿‡èµ‹å€¼æ“ä½œç¬¦æ¥è¿›è¡Œå˜é‡çš„åˆå§‹åŒ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InitMethod</span>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">value1</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><span class="hljs-type">int</span> <span class="hljs-variable">value2</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] arg)</span>&#123;<br>&#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObjectInstance</span>&#123;<br><span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;c&#x27;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ–è€…åœ¨å¤–éƒ¨è¿›è¡Œå£°æ˜ï¼Œåœ¨æ„é€ æ–¹æ³•æˆ–è€…åˆå§‹åŒ–ä»£ç å—ä¸­è¿›è¡Œåˆå§‹åŒ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InitMethod</span>&#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> value1 ;<br>    <span class="hljs-type">int</span> value2 ;<br>    <span class="hljs-keyword">static</span> &#123;<br>        value1 = <span class="hljs-number">1</span>;<br>    &#125;<br><br>    &#123;<br>        value2 = <span class="hljs-number">2</span>; <br>    &#125;;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] arg)</span>&#123;<br>        System.out.println(value1);<br>        System.out.println(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InitMethod</span>().value2);<br>    &#125;;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InitMethod</span>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> value1;<br><span class="hljs-type">int</span> value2;  <br>InitMethod()&#123;<br>value1 = <span class="hljs-number">1</span>;<br>value2 = <span class="hljs-number">2</span>; <br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] arg)</span>&#123;<br>&#125;<br><br><br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObjectInstance</span>&#123;<br><span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;c&#x27;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>javaä¸­çš„ å¼•ç”¨å£°æ˜ è™½ç„¶æ˜¯è‡ªç”±çš„ï¼Œä½†æ˜¯å¿…é¡»è¦ä¿è¯ å£°æ˜å‘ç”Ÿåœ¨è°ƒç”¨å‰</p><h2 id="æ•°ç»„åˆå§‹åŒ–"><a href="#æ•°ç»„åˆå§‹åŒ–" class="headerlink" title="æ•°ç»„åˆå§‹åŒ–"></a>æ•°ç»„åˆå§‹åŒ–</h2><p>javaä¸­æ¥å—ä¸¤ç§æ•°ç»„çš„å£°æ˜ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[] a1;<br><span class="hljs-type">int</span> a1[];<br></code></pre></td></tr></table></figure><p>æ•°ç»„å£°æ˜æ˜¯ä¸€ç§å¼•ç”¨ç±»å‹ï¼Œæ‰€ä»¥åˆå§‹åŒ–ä¼šè¢«åˆå§‹åŒ–ä¸ºnullã€‚å¹¶ä¸”a2&#x3D;a1 æ„å‘³ç€a2å’Œa1æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡</p><p>æ•°ç»„çš„åˆ›å»º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[] a1 = &#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>&#125;<br><span class="hljs-type">int</span>[] a2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>[]&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="å¯å˜å‚æ•°åˆ—è¡¨"><a href="#å¯å˜å‚æ•°åˆ—è¡¨" class="headerlink" title="å¯å˜å‚æ•°åˆ—è¡¨"></a>å¯å˜å‚æ•°åˆ—è¡¨</h1><p>é€šè¿‡ type â€¦ object_name æ¥æ¥æ”¶å¤šä¸ªç›¸åŒç±»å‹çš„å¯¹è±¡</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">OptionalTrailingArguments</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">f</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> <span class="hljs-keyword">required</span>,String... trailing</span>)</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;required:&quot;</span>+<span class="hljs-keyword">required</span>+<span class="hljs-string">&quot; &quot;</span>);<br>        <span class="hljs-keyword">for</span>(String s:trailing)&#123;<br>            System.<span class="hljs-keyword">out</span>.println(s+<span class="hljs-string">&quot; &quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] <span class="hljs-keyword">args</span></span>)</span> &#123;<br>        f(<span class="hljs-number">1</span>,<span class="hljs-string">&quot;one&quot;</span>);<br>        f(<span class="hljs-number">2</span>,<span class="hljs-string">&quot;two&quot;</span>,<span class="hljs-string">&quot;three&quot;</span>);<br>        f(<span class="hljs-number">0</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="æšä¸¾ç±»å‹"><a href="#æšä¸¾ç±»å‹" class="headerlink" title="æšä¸¾ç±»å‹"></a>æšä¸¾ç±»å‹</h1><p>å®šä¹‰äº†ä¸€ä¸ªæšä¸¾ã€‚</p><p>æšä¸¾ä¸­çš„å†…å®¹å¯ä»¥ç”¨äºswitchåˆ†æ”¯åˆ¤æ–­</p><p>.values() éå†æšä¸¾ç±»ä¸­çš„å€¼</p><p>.ordinal() è¿”å›å€¼çš„é¡ºåº </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Select</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">for</span>(Option asd : Option.values())&#123;<br>            <span class="hljs-keyword">switch</span> (asd)&#123;<br>                <span class="hljs-keyword">case</span> A:<br>                    System.out.println(<span class="hljs-string">&quot;A&quot;</span>);<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> B:<br>                    System.out.println(<span class="hljs-string">&quot;B&quot;</span>);<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> C:<br>                    System.out.println(<span class="hljs-string">&quot;C&quot;</span>);<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> D:<br>                    System.out.println(<span class="hljs-string">&quot;D&quot;</span>);<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> E:<br>                    System.out.println(<span class="hljs-string">&quot;E&quot;</span>);<br>                <span class="hljs-keyword">default</span>:<br>                    System.out.println(asd.ordinal());<br>                    <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">enum</span>  <span class="hljs-title class_">Option</span>&#123;<br>    A, B, C, D, E, F, G, H, I, J, K, L, M, N, O, P, Q, R, S, T, U, V, W, X, Y, Z<br><br>&#125;<br><br></code></pre></td></tr></table></figure><h1 id="ç±»å‹æ¨æ–­"><a href="#ç±»å‹æ¨æ–­" class="headerlink" title="ç±»å‹æ¨æ–­"></a>ç±»å‹æ¨æ–­</h1><p>åœ¨æ–¹æ³•ä¸­å¯ä»¥ä½¿ç”¨â€varâ€æ¥è¿›è¡Œè‡ªåŠ¨çš„ç±»å‹æ¨æ–­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Plumbus</span>&#123;&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TypeInference</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">hello1</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Hello&quot;</span>;<br>        <span class="hljs-type">var</span> <span class="hljs-variable">hello</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Hello&quot;</span>;<br>        <span class="hljs-type">Plumbus</span> <span class="hljs-variable">plumbus</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Plumbus</span>();<br>        <span class="hljs-type">var</span> <span class="hljs-variable">plumbus1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Plumbus</span>();<br><br>    &#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">staticMethod</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">var</span> <span class="hljs-variable">hello</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Hello&quot;</span>;<br>        <span class="hljs-type">var</span> <span class="hljs-variable">plumbus1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Plumbus</span>();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>ç±»ä¸­çš„å­—æ®µç±»å‹å¿…é¡»åœ¨ç±»åŠ è½½æ—¶é™æ€ç¡®å®šï¼Œä»¥ä¿è¯ç±»çš„å†…å­˜å¸ƒå±€å¯è¢« JVM æ„å»ºã€‚è€Œ <code>var</code> ä¾èµ–ç¼–è¯‘å™¨å¯¹èµ‹å€¼è¡¨è¾¾å¼è¿›è¡Œç±»å‹æ¨å¯¼ï¼Œé€‚ç”¨äºæ–¹æ³•ä½“å†…çš„å±€éƒ¨å˜é‡ï¼Œä¸é€‚åˆç”¨äºç±»å­—æ®µè¿™ç§ç»“æ„æ€§å®šä¹‰ã€‚</p><h1 id="åŒ…"><a href="#åŒ…" class="headerlink" title="åŒ…"></a>åŒ…</h1><p>javaä¸­çš„å¼•ç”¨ç®¡ç†è·¯å¾„æ˜¯é€šè¿‡åŒ…å£°æ˜æ¥å®ç°ã€‚</p><p>é€šè¿‡ åè½¬çš„URL æ¥å®šä¹‰æŸä¸ªæ–‡ä»¶çš„è·¯å¾„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span>  com.codfish.java.Localclass <br><span class="hljs-comment">// æ„å‘³ç€ä»java class pathä¸­æŸ¥è¯¢åˆ° com æ–‡ä»¶å¤¹ä¸‹çš„</span><br>ğŸ“ [classpath]/<br>â””â”€â”€ ğŸ“ com/<br>    â””â”€â”€ ğŸ“ codfish/<br>        â””â”€â”€ ğŸ“ java/<br>            â””â”€â”€ Localclass.java<br><span class="hljs-comment">//æœ€ç»ˆæŸ¥è¯¢åˆ°Localclass.javaè¿™ä¸ªæ–‡ä»¶</span><br><span class="hljs-comment">// æ‰€ä»¥åœ¨ç¯å¢ƒå˜é‡ä¸­æ·»åŠ classpath æ˜¯ç”¨äºæŸ¥è¯¢ javaå·¥ç¨‹çš„æ ¹è·¯å¾„</span><br></code></pre></td></tr></table></figure><h1 id="å®ç°éšè—"><a href="#å®ç°éšè—" class="headerlink" title="å®ç°éšè—"></a>å®ç°éšè—</h1><h2 id="è®¿é—®æ§åˆ¶"><a href="#è®¿é—®æ§åˆ¶" class="headerlink" title="è®¿é—®æ§åˆ¶"></a>è®¿é—®æ§åˆ¶</h2><h3 id="public-å£°æ˜æœ¬ç±»-æ–¹æ³•-æ˜¯ä¸€ä¸ªå¯ä»¥è¢«ä»»æ„è°ƒç”¨çš„ç»„ä»¶"><a href="#public-å£°æ˜æœ¬ç±»-æ–¹æ³•-æ˜¯ä¸€ä¸ªå¯ä»¥è¢«ä»»æ„è°ƒç”¨çš„ç»„ä»¶" class="headerlink" title="public å£°æ˜æœ¬ç±»&#x2F;æ–¹æ³• æ˜¯ä¸€ä¸ªå¯ä»¥è¢«ä»»æ„è°ƒç”¨çš„ç»„ä»¶"></a>public å£°æ˜æœ¬ç±»&#x2F;æ–¹æ³• æ˜¯ä¸€ä¸ªå¯ä»¥è¢«ä»»æ„è°ƒç”¨çš„ç»„ä»¶</h3><h3 id="private-å£°æ˜-æ–¹æ³•-åœ¨æœ¬ç±»ä¹‹å¤–æ˜¯ä¸å¯è§çš„ï¼Œä¸å¯ä»¥è¢«è°ƒç”¨"><a href="#private-å£°æ˜-æ–¹æ³•-åœ¨æœ¬ç±»ä¹‹å¤–æ˜¯ä¸å¯è§çš„ï¼Œä¸å¯ä»¥è¢«è°ƒç”¨" class="headerlink" title="private å£°æ˜ æ–¹æ³• åœ¨æœ¬ç±»ä¹‹å¤–æ˜¯ä¸å¯è§çš„ï¼Œä¸å¯ä»¥è¢«è°ƒç”¨"></a>private å£°æ˜ æ–¹æ³• åœ¨æœ¬ç±»ä¹‹å¤–æ˜¯ä¸å¯è§çš„ï¼Œä¸å¯ä»¥è¢«è°ƒç”¨</h3><h3 id="protect-å…è®¸å­ç±»è°ƒç”¨ç»§æ‰¿çš„çˆ¶ç±»ä¸­å£°æ˜çš„protectæ–¹æ³•"><a href="#protect-å…è®¸å­ç±»è°ƒç”¨ç»§æ‰¿çš„çˆ¶ç±»ä¸­å£°æ˜çš„protectæ–¹æ³•" class="headerlink" title="protect å…è®¸å­ç±»è°ƒç”¨ç»§æ‰¿çš„çˆ¶ç±»ä¸­å£°æ˜çš„protectæ–¹æ³•"></a>protect å…è®¸å­ç±»è°ƒç”¨ç»§æ‰¿çš„çˆ¶ç±»ä¸­å£°æ˜çš„protectæ–¹æ³•</h3><h3 id="defaultï¼ˆæ— å£°æ˜ï¼‰-ç±»-æ–¹æ³•-æœ¬æ–‡ä»¶ä¸­å¯ä»¥ä»»æ„è°ƒç”¨"><a href="#defaultï¼ˆæ— å£°æ˜ï¼‰-ç±»-æ–¹æ³•-æœ¬æ–‡ä»¶ä¸­å¯ä»¥ä»»æ„è°ƒç”¨" class="headerlink" title="defaultï¼ˆæ— å£°æ˜ï¼‰ ç±»&#x2F;æ–¹æ³• æœ¬æ–‡ä»¶ä¸­å¯ä»¥ä»»æ„è°ƒç”¨"></a>defaultï¼ˆæ— å£°æ˜ï¼‰ ç±»&#x2F;æ–¹æ³• æœ¬æ–‡ä»¶ä¸­å¯ä»¥ä»»æ„è°ƒç”¨</h3><p>ç±»åªæœ‰ä¸¤ç§è®¿é—®æƒé™ï¼ˆpublicå’Œ default ï¼‰</p><p>é€šè¿‡è®¿é—®æ§åˆ¶ï¼Œå®ç°äº†ä¸€ç§åŠŸèƒ½å’Œå®ç°çš„è§£è€¦ï¼Œè°ƒç”¨è€…åªéœ€è¦å…³æ³¨å£°æ˜ä¸ºpublicçš„æ–¹æ³•ï¼Œå› ä¸ºä»–ä»¬åªéœ€è¦å…³æ³¨å¯¹è±¡æ‰€æä¾›çš„åŠŸèƒ½ï¼Œè€Œå®ç°è€…æ›´åŠ å…³æ³¨äºprivateæ–¹æ³• æ¥æ›´å¥½çš„ä¼˜åŒ–åŠŸèƒ½çš„å®ç°ã€‚</p><h1 id="å¯¹è±¡è®¾è®¡"><a href="#å¯¹è±¡è®¾è®¡" class="headerlink" title="å¯¹è±¡è®¾è®¡"></a>å¯¹è±¡è®¾è®¡</h1><p>åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­é€šå¸¸æœ‰è¿™æ ·å‡ ç§ å¯¹è±¡çš„å…³è”å…³ç³»</p><h3 id="ç»„åˆï¼ˆhas-aï¼‰"><a href="#ç»„åˆï¼ˆhas-aï¼‰" class="headerlink" title="ç»„åˆï¼ˆhas aï¼‰"></a>ç»„åˆï¼ˆhas aï¼‰</h3><p>å¤šä¸ªå¯¹è±¡ä½œä¸ºå¦ä¸€ä¸ªå¯¹è±¡å…±åŒå®ŒæˆåŠŸèƒ½ã€‚é€šè¿‡ç»„ç»‡è¿™äº›å¯¹è±¡çš„åŠŸèƒ½å’Œæ‰§è¡Œæµç¨‹æ¥å®Œæˆè‡ªèº«çš„åŠŸèƒ½</p><h3 id="ç»§æ‰¿-ï¼ˆis-a"><a href="#ç»§æ‰¿-ï¼ˆis-a" class="headerlink" title="ç»§æ‰¿ ï¼ˆis a)"></a>ç»§æ‰¿ ï¼ˆis a)</h3><p>ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸€ä¸ªå¯¹è±¡çš„å®ç°ï¼Œå…·å¤‡åŸå¯¹è±¡çš„å…¨éƒ¨åŠŸèƒ½å’Œå±æ€§ã€‚åªæ˜¯ä¼šæ ¹æ®ä¸åŒçš„å› ç´ å…·ä½“å®ç°ä¸åŒ</p><h3 id="å§”æ‰˜-ï¼ˆdelegates-toï¼‰"><a href="#å§”æ‰˜-ï¼ˆdelegates-toï¼‰" class="headerlink" title="å§”æ‰˜ ï¼ˆdelegates toï¼‰"></a>å§”æ‰˜ ï¼ˆdelegates toï¼‰</h3><p>ä¸€ä¸ªå¯¹è±¡ä½œä¸ºä¸­é—´ä»£ç†äººï¼Œå°†æŸä¸ªåŠŸèƒ½æŒ‡å®šç»™å¦ä¸€ä¸ªå¯¹è±¡å»å®Œæˆã€‚</p><h1 id="final-å…³é”®å­—"><a href="#final-å…³é”®å­—" class="headerlink" title="final å…³é”®å­—"></a>final å…³é”®å­—</h1><p>finalå…³é”®å­—ç”¨äºå°† å¼•ç”¨ å’Œ ç›®æ ‡è¿›è¡Œç»‘å®š</p><p>final ä¿®é¥°ç±» è¯¥ç±»ä¸èƒ½è¢«ç»§æ‰¿</p><p>final ä¿®é¥°æ–¹æ³• åˆ™ è¯¥æ–¹æ³•ä¸èƒ½è¢«é‡å†™</p><p>final ä¿®é¥°å˜é‡  åªèƒ½åœ¨å£°æ˜å¤„æˆ–è€…æ„é€ å™¨ä¸­åˆå§‹åŒ– åŸºç¡€å˜é‡çš„å€¼ä¸èƒ½è¢«æ›´æ”¹ï¼Œå¼•ç”¨ç±»å‹çš„ final å˜é‡ä¸èƒ½å†æŒ‡å‘å…¶ä»–å¯¹è±¡ï¼Œä½†åŸå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ä»å¯å˜åŒ–ã€‚</p><p>final è®©â€œåå­—ä¸æ‰€æŒ‡å¯¹è±¡â€ä¹‹é—´çš„ç»‘å®š<strong>åœ¨ç¼–è¯‘æœŸæˆ–ç±»åŠ è½½æœŸå°±ç¡®å®šä¸‹æ¥</strong>ï¼Œä¸èƒ½å†åŠ¨æ€æ›´æ¢ï¼Œ<strong>å¤±å»äº† Java ä¸­å¤šæ€æˆ–å»¶è¿Ÿç»‘å®šçš„ä¸€éƒ¨åˆ†å¯èƒ½æ€§</strong>ã€‚</p><h1 id="å¯¹è±¡åˆ›å»ºè¿‡ç¨‹ä¸­çš„åŠ è½½"><a href="#å¯¹è±¡åˆ›å»ºè¿‡ç¨‹ä¸­çš„åŠ è½½" class="headerlink" title="å¯¹è±¡åˆ›å»ºè¿‡ç¨‹ä¸­çš„åŠ è½½"></a>å¯¹è±¡åˆ›å»ºè¿‡ç¨‹ä¸­çš„åŠ è½½</h1><p>å½“åˆ›å»ºå¯¹è±¡æ—¶</p><p>å¦‚æœç±»æœªè¢«åŠ è½½åˆ°jvmä¸­ï¼Œåˆ™éœ€è¦ä»ç±»åˆå§‹åŒ–å¼€å§‹</p><p>æŸ¥è¯¢çˆ¶ç±»æ˜¯å¦è¿›è¡ŒåŠ è½½</p><p>æ‰§è¡Œçˆ¶ç±»é™æ€ä»£ç å—ï¼Œé™æ€å˜é‡ï¼ˆæŒ‰åºåŠ è½½ï¼‰<br>æ‰§è¡Œå­ç±»é™æ€ä»£ç å—ï¼Œé™æ€å˜é‡ï¼ˆæŒ‰åºåŠ è½½ï¼‰</p><p>æ‰§è¡Œçˆ¶ç±»ä»£ç å—ï¼Œæ„é€ æ–¹æ³•ï¼ˆæŒ‰åºåŠ è½½ï¼‰</p><p>æ‰§è¡Œå­ç±»ä»£ç å—ï¼Œæ„é€ æ–¹æ³•ï¼ˆæŒ‰åºåŠ è½½ï¼‰</p><p>è¿”å›æŒ‡å‘æ–°åˆ›å»ºçš„å¼•ç”¨ã€‚ç»“æŸåˆ›å»ºè¿‡ç¨‹</p><h1 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h1><p>å¤šæ€æä¾›äº†å¦ä¸€ä¸ªç»´åº¦çš„æ¥å£ä¸å®ç°åˆ†ç¦»</p><h2 id="å‘ä¸Šè½¬å‹"><a href="#å‘ä¸Šè½¬å‹" class="headerlink" title="å‘ä¸Šè½¬å‹"></a>å‘ä¸Šè½¬å‹</h2><p>åœ¨javaä¸­ å…è®¸å°†ä¸€ä¸ªå¯¹è±¡å£°æ˜ä¸ºå…¶çˆ¶ç±»ã€‚è€Œå½“è°ƒç”¨æ—¶è°ƒç”¨çš„åˆ™æ˜¯å­ç±»ä¸­å®ç°çš„å¯¹åº”çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Polymorphism</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Animal</span> <span class="hljs-variable">animal</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();<br>        animal.makeSound();<br><br>        <span class="hljs-type">Animal</span> <span class="hljs-variable">dog</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();<br>        dog.makeSound();<br><br>        <span class="hljs-type">Animal</span> <span class="hljs-variable">cat</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();<br>        cat.makeSound();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;The animal makes a sound&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Animal</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;The dog barks&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Animal</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;The cat meows&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ„é€ è¿‡ç¨‹ä¸­çš„å‡½æ•°è°ƒç”¨"><a href="#æ„é€ è¿‡ç¨‹ä¸­çš„å‡½æ•°è°ƒç”¨" class="headerlink" title="æ„é€ è¿‡ç¨‹ä¸­çš„å‡½æ•°è°ƒç”¨"></a>æ„é€ è¿‡ç¨‹ä¸­çš„å‡½æ•°è°ƒç”¨</h2><p>åœ¨çˆ¶ç±»æ„é€ å™¨ä¸­è°ƒç”¨è¢«å­ç±»é‡å†™çš„å‡½æ•°ï¼Œä¾ç„¶è°ƒç”¨çš„æ˜¯å­ç±»é‡å†™çš„å‡½æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PolyConstructors</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">RoundGlyph</span>(<span class="hljs-number">5</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Glyph</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Glyph.draw()&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Glyph</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Glyph() before draw()&quot;</span>);<br>        draw();<br>        System.out.println(<span class="hljs-string">&quot;Glyph() after draw()&quot;</span>);<br><br>    &#125;<br>    <br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RoundGlyph</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Glyph</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">radius</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><br>    RoundGlyph(<span class="hljs-type">int</span> r) &#123;<br>        radius = r;<br>        System.out.println(<span class="hljs-string">&quot;RoundGlyph.RoundGlyph(), radius = &quot;</span> + radius);<br>    &#125;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;RoundGlyph.draw(), radius = &quot;</span> + radius);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h1 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h1><h2 id="æŠ½è±¡æ–¹æ³•ä¸æŠ½è±¡ç±»"><a href="#æŠ½è±¡æ–¹æ³•ä¸æŠ½è±¡ç±»" class="headerlink" title="æŠ½è±¡æ–¹æ³•ä¸æŠ½è±¡ç±»"></a>æŠ½è±¡æ–¹æ³•ä¸æŠ½è±¡ç±»</h2><p>ä¸€äº›ç±»çš„è®¾è®¡æ˜¯ä¸ºäº†å®šä¹‰å…±åŒçš„æ ‡å‡†å’Œå½¢å¼ï¼Œå…¶æœ¬èº«ä»¥åŠå®šä¹‰çš„æ–¹æ³•å¹¶ä¸æ˜¯ç”¨æ¥è¿›è¡Œå®ä¾‹åŒ–æˆ–è€…æ–¹æ³•è°ƒç”¨çš„ã€‚è¿™æ ·çš„ç±»è¢«ç§°ä¸ºæŠ½è±¡ç±»ã€‚</p><p>javaä¸­ä¹Ÿæä¾›äº†æŠ½è±¡æ–¹æ³•çš„å£°æ˜</p><p>å­˜åœ¨æŠ½è±¡æ–¹æ³•çš„ç±»è¢«ç§°ä¸ºæŠ½è±¡ç±»</p><p>å½“æœ‰ç±»æƒ³ç»§æ‰¿æŠ½è±¡ç±»æ—¶ï¼Œä½œä¸ºä¸€ä¸ªå®ç°ç±»å¿…é¡»é‡å†™æŠ½è±¡ç±»ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼Œä½œä¸ºæŠ½è±¡ç±»åˆ™å¯ä»¥ç›´æ¥ç»§æ‰¿</p><h2 id="æ¥å£-1"><a href="#æ¥å£-1" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><p>æ¥å£æ˜¯é¢å‘è®¾è®¡çš„ä¸€ç§å®Œå…¨æŠ½è±¡ï¼Œé€šè¿‡å®šä¹‰ä¸€ç³»åˆ—çš„å‡½æ•°ç­¾åï¼Œä½¿å¾—ç¬¦åˆè¯¥è§„åˆ™çš„ç±»èƒ½å¤Ÿå®Œæˆæ¥å£æ‰€æè¿°çš„åŠŸèƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">AnInterface</span> &#123;<br><span class="hljs-keyword">void</span> <span class="hljs-title function_">firstMethod</span><span class="hljs-params">()</span>;<br><span class="hljs-keyword">void</span> <span class="hljs-title function_">secondMetho</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨åç»­çš„javaç‰ˆæœ¬ä¸­ åˆå…è®¸å‘æ¥å£ä¸­æ·»åŠ  é»˜è®¤æ–¹æ³•ã€‚è¿™æ ·å¯ä»¥åœ¨ä¸æ”¹å˜æ¥å£è®¾è®¡çš„åŒæ—¶ï¼Œå‘æ¥å£ä¸­æ‰©å……æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">interfaceIneterfaceWithDefault&#123;<br><span class="hljs-keyword">void</span> <span class="hljs-title function_">firstMethod</span><span class="hljs-params">()</span>;<br><span class="hljs-keyword">void</span> <span class="hljs-title function_">secondMethod</span><span class="hljs-params">()</span>;<br><span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">newMethod</span><span class="hljs-params">()</span>&#123;<br>System.out.println(<span class="hljs-string">&quot;new Method&quot;</span>);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å‘æ¥å£æ·»åŠ é™æ€æ–¹æ³•ï¼Œæ„å‘³ç€æ¥å£å†…å¯ä»¥åŒ…å«ä¾›å®ƒä½¿ç”¨çš„å·¥å…·é›†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Operation</span> &#123;<br><span class="hljs-keyword">void</span> <span class="hljs-title function_">execute</span><span class="hljs-params">()</span>;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">runOps</span><span class="hljs-params">(Operation ... ops)</span>&#123;<br><span class="hljs-keyword">for</span>(Operatoin op : ops)<br>op.execute();<br>&#125;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">(String msg)</span>&#123;<br>System.out.println(msg)<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æŠ½è±¡ç±»ä¸æ¥å£"><a href="#æŠ½è±¡ç±»ä¸æ¥å£" class="headerlink" title="æŠ½è±¡ç±»ä¸æ¥å£"></a>æŠ½è±¡ç±»ä¸æ¥å£</h2><table><thead><tr><th>ç‰¹æ€§</th><th>æ¥å£</th><th>æŠ½è±¡ç±»</th></tr></thead><tbody><tr><td>ç»„åˆ</td><td>å¯ä»¥åœ¨æ–°ç±»ä¸­ç»„åˆå¤šä¸ªæ¥å£</td><td>åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»</td></tr><tr><td>çŠ¶æ€</td><td>ä¸èƒ½åŒ…å«å­—æ®µ</td><td>å¯ä»¥åŒ…å«å­—æ®µ</td></tr><tr><td>é»˜è®¤æ–¹æ³•ä¸æŠ½è±¡æ–¹æ³•</td><td>é»˜è®¤æ–¹æ³•ä¸éœ€è¦åœ¨å­ç±»ä¸­å®ç°</td><td>æŠ½è±¡æ–¹æ³•å¿…é¡»åœ¨å­ç±»é‡Œå®ç°</td></tr><tr><td>æ„é€ å™¨</td><td>ä¸èƒ½æœ‰æ„é€ å™¨</td><td>å¯ä»¥æœ‰æ„é€ å™¨</td></tr><tr><td>è®¿é—®æƒé™</td><td>éšå¼çš„public</td><td>å¯ä»¥ä¸ºprotoct</td></tr></tbody></table><h2 id="å›åˆ°é¢å‘å¯¹è±¡"><a href="#å›åˆ°é¢å‘å¯¹è±¡" class="headerlink" title="å›åˆ°é¢å‘å¯¹è±¡"></a>å›åˆ°é¢å‘å¯¹è±¡</h2><p>åœ¨åº”ç”¨å¼€å‘ä¸­ï¼Œä»è¡¨é¢ä¸Šçœ‹ï¼Œ<strong>ç»§æ‰¿&#x2F;å¤šæ€ã€æŠ½è±¡ç±»&#x2F;æ–¹æ³•ä»¥åŠæ¥å£</strong>ä¼¼ä¹éƒ½èƒ½å®ç°ç±»ä¼¼çš„åŠŸèƒ½ã€‚è¿™ä¸ç¦è®©æˆ‘ä»¬æ€è€ƒï¼šä¸ºä½• Java è¯­è¨€è¿˜è¦æä¾›è¿™äº›å½¼æ­¤ç›¸è¿‘çš„æœºåˆ¶ï¼Ÿ</p><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬ä¸å¦¨å›åˆ°â€œé¢å‘å¯¹è±¡â€çš„æ ¸å¿ƒç†å¿µæ¥æ€è€ƒè¿™ä¸ªé—®é¢˜ã€‚åœ¨å‰æ–‡çš„è®¨è®ºä¸­æˆ‘ä»¬æåˆ°ï¼Œå¯¹è±¡è®¾è®¡çš„å…³é”®åœ¨äºï¼š<strong>å¯¹è±¡çš„è¡Œä¸ºæ˜¯æœåŠ¡äºç‰¹å®šåŠŸèƒ½çš„</strong>ã€‚æ¢è¨€ä¹‹ï¼Œå¯¹è±¡æ‰€æ‹¥æœ‰çš„æ–¹æ³•å’Œå±æ€§ï¼Œå…¶æœ¬è´¨ç›®çš„æ˜¯ä¸ºäº†åœ¨ä¸šåŠ¡ç³»ç»Ÿä¸­æ‰¿è½½åŠŸèƒ½é€»è¾‘ä¸çŠ¶æ€ç»´æŠ¤ã€‚</p><p>åœ¨å®é™…çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œä¸€ä¸ªå¯¹è±¡å¾€å¾€å…·å¤‡å¤šé‡åŠŸèƒ½ã€‚åœ¨æŸäº›ç‰¹å®šæµç¨‹ä¸­ï¼Œå¯¹è±¡è‡ªèº«çš„æ•´ä½“ç»“æ„å¹¶ä¸æ˜¯æœ€å…³é”®çš„ï¼Œ<strong>è€Œæ˜¯å…¶ä¸­æŸä¸ªç‰¹å®šçš„è¡Œä¸ºæˆ–èƒ½åŠ›æ„æˆäº†æµç¨‹çš„æ ¸å¿ƒã€‚</strong>å½“æˆ‘ä»¬åªå…³å¿ƒè¿™ä¸ªç‰¹å®šè¡Œä¸ºæ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨â€œæŠ½è±¡åœ°ä½¿ç”¨è¿™ä¸ªå¯¹è±¡çš„æŸä¸ªåˆ‡é¢â€ã€‚æ­¤æ—¶ï¼Œå¯¹è±¡çš„è¿™ä¸ªæ–¹æ³•å°±æˆä¸ºäº†æˆ‘ä»¬æ‰€å…³æ³¨çš„æŠ½è±¡èƒ½åŠ›â€”â€”<strong>åªè¦å®ç°äº†è¿™ä¸ªæ–¹æ³•ï¼Œæµç¨‹å°±èƒ½æ­£å¸¸è¿è¡Œã€‚</strong></p><p>ä»è¿™ä¸ªè§’åº¦å‡ºå‘ï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°ç†è§£ä¸‰ç§è¯­è¨€æœºåˆ¶çš„åŒºåˆ«ï¼š</p><ul><li><strong>ç»§æ‰¿ä¸å¤šæ€</strong>ï¼šé€šè¿‡ç»§æ‰¿æœºåˆ¶ï¼Œå­ç±»å¯ä»¥åŸºäºçˆ¶ç±»å®ç°ä¸åŒçš„è¡Œä¸ºï¼Œä»è€Œåœ¨ä¸ä¿®æ”¹æ¥å£çš„å‰æä¸‹ï¼Œé€šè¿‡å¤šæ€æ”¯æŒå¤šç§åŠŸèƒ½å®ç°ã€‚è¿™å¼ºè°ƒçš„æ˜¯<strong>â€œå…±æ€§åŸºç¡€ä¸Šçš„å·®å¼‚è¡¨è¾¾â€</strong>ã€‚</li><li><strong>æŠ½è±¡ç±»ä¸æŠ½è±¡æ–¹æ³•</strong>ï¼šå®šä¹‰äº†æŸç±»å¯¹è±¡åœ¨è¡Œä¸ºå’ŒçŠ¶æ€ä¸Šåº”å…·å¤‡çš„â€œæ¨¡æ¿â€ï¼Œä¸ºå­ç±»æä¾›ç»Ÿä¸€çš„ç»“æ„çº¦æŸä¸é»˜è®¤å®ç°ï¼Œå¼ºè°ƒçš„æ˜¯<strong>â€œéƒ¨åˆ†å®ç° + è¡Œä¸ºçº¦æŸâ€</strong>çš„ç»„åˆè®¾è®¡ã€‚</li><li><strong>æ¥å£ï¼ˆInterfaceï¼‰</strong>ï¼šæ¥å£æ›´ä¸“æ³¨äºå®šä¹‰<strong>ä¸€ç»„ä¸ä¸šåŠ¡æµç¨‹ç›¸å…³çš„èƒ½åŠ›</strong>ï¼Œå®ƒå…³æ³¨çš„æ˜¯â€œå¯¹è±¡èƒ½åšä»€ä¹ˆâ€ï¼Œè€Œéâ€œå¯¹è±¡æ˜¯ä»€ä¹ˆâ€ã€‚æ¥å£å¼ºè°ƒçš„æ˜¯<strong>åŠŸèƒ½å¥‘çº¦</strong>ï¼Œä¾¿äºå®ç°è§£è€¦ä¸ç»„åˆã€‚</li></ul><h1 id="å†…éƒ¨ç±»"><a href="#å†…éƒ¨ç±»" class="headerlink" title="å†…éƒ¨ç±»"></a>å†…éƒ¨ç±»</h1><h3 id="æˆå‘˜å†…éƒ¨ç±»ï¼š"><a href="#æˆå‘˜å†…éƒ¨ç±»ï¼š" class="headerlink" title="æˆå‘˜å†…éƒ¨ç±»ï¼š"></a>æˆå‘˜å†…éƒ¨ç±»ï¼š</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Parcell</span>&#123;<br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Content</span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">11</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">value</span><span class="hljs-params">()</span>&#123;<br>            <span class="hljs-keyword">return</span> i;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Destination</span>&#123;                    <span class="hljs-comment">// å†…éƒ¨ç±»å®šä¹‰</span><br>        <span class="hljs-keyword">private</span> String label;<br>        Destination(String whereTo)&#123;<br>            label = whereTo;<br>        &#125;<br>        String <span class="hljs-title function_">readLabel</span><span class="hljs-params">()</span>&#123;<br>            <span class="hljs-keyword">return</span> label;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">ship</span><span class="hljs-params">(String dest)</span>&#123;<br>        <span class="hljs-type">Content</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Content</span>();<br>        <span class="hljs-type">Destination</span> <span class="hljs-variable">d</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Destination</span>(dest);<br>        System.out.println(d.readLabel());<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Parcell</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Parcell</span>();<br>        p.ship(<span class="hljs-string">&quot;Tasmania&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å°†æˆå‘˜å†…éƒ¨ç±»çš„å®ä¾‹ä»¥å‡½æ•°è°ƒç”¨è¿”å›ã€‚å¯ä»¥çœ‹åˆ°-å†…éƒ¨ç±»å¯ä»¥å¯¹ç±»ä¸­çš„ç§æœ‰å±æ€§è¿›è¡Œè°ƒç”¨"><a href="#å°†æˆå‘˜å†…éƒ¨ç±»çš„å®ä¾‹ä»¥å‡½æ•°è°ƒç”¨è¿”å›ã€‚å¯ä»¥çœ‹åˆ°-å†…éƒ¨ç±»å¯ä»¥å¯¹ç±»ä¸­çš„ç§æœ‰å±æ€§è¿›è¡Œè°ƒç”¨" class="headerlink" title="å°†æˆå‘˜å†…éƒ¨ç±»çš„å®ä¾‹ä»¥å‡½æ•°è°ƒç”¨è¿”å›ã€‚å¯ä»¥çœ‹åˆ° å†…éƒ¨ç±»å¯ä»¥å¯¹ç±»ä¸­çš„ç§æœ‰å±æ€§è¿›è¡Œè°ƒç”¨"></a>å°†æˆå‘˜å†…éƒ¨ç±»çš„å®ä¾‹ä»¥å‡½æ•°è°ƒç”¨è¿”å›ã€‚å¯ä»¥çœ‹åˆ° å†…éƒ¨ç±»å¯ä»¥å¯¹ç±»ä¸­çš„ç§æœ‰å±æ€§è¿›è¡Œè°ƒç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sequence</span>&#123;<br>    <span class="hljs-keyword">private</span> Object[] items;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Sequence</span><span class="hljs-params">(<span class="hljs-type">int</span> size)</span>&#123;<br>        items = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[size];<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(Object x)</span>&#123;<br>        <span class="hljs-keyword">if</span>(next &lt; items.length)&#123;<br>            items[next++] = x;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SequenceSelector</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Selector</span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">end</span><span class="hljs-params">()</span>&#123;<br>            <span class="hljs-keyword">return</span> i == items.length;<br>        &#125;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">current</span><span class="hljs-params">()</span>&#123;<br>            <span class="hljs-keyword">return</span> items[i];<br>        &#125;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">next</span><span class="hljs-params">()</span>&#123;<br>            <span class="hljs-keyword">if</span>(i &lt; items.length)&#123;<br>                i++;<br>            &#125;<br>        &#125;<br>        &#125;<br>    <span class="hljs-keyword">public</span> Selector <span class="hljs-title function_">selector</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SequenceSelector</span>();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Sequence</span> <span class="hljs-variable">sequence</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sequence</span>(<span class="hljs-number">10</span>);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++)&#123;<br>            sequence.add(Integer.toString(i));<br>        &#125;<br>        <span class="hljs-type">Selector</span> <span class="hljs-variable">selector</span> <span class="hljs-operator">=</span> sequence.selector();<br>        <span class="hljs-keyword">while</span>(!selector.end())&#123;<br>            System.out.print(selector.current() + <span class="hljs-string">&quot; &quot;</span>);<br>            selector.next();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Selector</span>&#123;<br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">end</span><span class="hljs-params">()</span>;<br>    Object <span class="hljs-title function_">current</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">next</span><span class="hljs-params">()</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="å†…éƒ¨ç±»å¯ä»¥é€šè¿‡-outter-this-è·å–åˆ°å¤–éƒ¨ç±»çš„å®ä¾‹"><a href="#å†…éƒ¨ç±»å¯ä»¥é€šè¿‡-outter-this-è·å–åˆ°å¤–éƒ¨ç±»çš„å®ä¾‹" class="headerlink" title="å†…éƒ¨ç±»å¯ä»¥é€šè¿‡ outter.this è·å–åˆ°å¤–éƒ¨ç±»çš„å®ä¾‹"></a>å†…éƒ¨ç±»å¯ä»¥é€šè¿‡ outter.this è·å–åˆ°å¤–éƒ¨ç±»çš„å®ä¾‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DotThis</span>&#123;<br><span class="hljs-keyword">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">()</span>&#123; System.out.println(<span class="hljs-string">&quot;DotThis.f()&quot;</span>)&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Inner</span>&#123;<br><span class="hljs-keyword">public</span> DotThis <span class="hljs-title function_">outer</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-keyword">return</span> DotThis.<span class="hljs-built_in">this</span> ;<br>&#125;<br>&#125;<br><span class="hljs-keyword">public</span> Inner <span class="hljs-title function_">inner</span><span class="hljs-params">()</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Inner</span>();&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">DotThis</span> <span class="hljs-variable">dt</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DotThis</span>();<br>DotThis.<span class="hljs-type">Inner</span> <span class="hljs-variable">dti</span> <span class="hljs-operator">=</span> dt.inner();<br>dti.outer().f();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è€Œ-å¤–éƒ¨ç±»å¯ä»¥é€šè¿‡-outterçš„å®ä¾‹-new-åˆ›å»ºå†…éƒ¨ç±»çš„å®ä¾‹"><a href="#è€Œ-å¤–éƒ¨ç±»å¯ä»¥é€šè¿‡-outterçš„å®ä¾‹-new-åˆ›å»ºå†…éƒ¨ç±»çš„å®ä¾‹" class="headerlink" title="è€Œ å¤–éƒ¨ç±»å¯ä»¥é€šè¿‡ outterçš„å®ä¾‹ new åˆ›å»ºå†…éƒ¨ç±»çš„å®ä¾‹"></a>è€Œ å¤–éƒ¨ç±»å¯ä»¥é€šè¿‡ outterçš„å®ä¾‹ new åˆ›å»ºå†…éƒ¨ç±»çš„å®ä¾‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DotNew</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Inner</span>&#123;&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">DotNew</span> <span class="hljs-variable">dn</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DotNew</span>();<br>DotNew.<span class="hljs-type">Inner</span> <span class="hljs-variable">dni</span> <span class="hljs-operator">=</span> dn.new.Inner();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å³é€šè¿‡å¤–éƒ¨ç±»çš„.this è·å–å¤–éƒ¨ç±»çš„å®ä¾‹</p><p><a href="http://é€šè¿‡å¤–éƒ¨ç±»å®ä¾‹çš„.new/">é€šè¿‡å¤–éƒ¨ç±»å®ä¾‹çš„.new</a> åˆ›å»ºå†…éƒ¨ç±»çš„å¯¹è±¡</p><h3 id="å±€éƒ¨å†…éƒ¨ç±»"><a href="#å±€éƒ¨å†…éƒ¨ç±»" class="headerlink" title="å±€éƒ¨å†…éƒ¨ç±»"></a>å±€éƒ¨å†…éƒ¨ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Parcel5</span> &#123;<br><span class="hljs-keyword">public</span> Destination <span class="hljs-title function_">destination</span><span class="hljs-params">(String s )</span>&#123;<br><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PDestination</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Destination</span>&#123;<br><span class="hljs-keyword">private</span> String label;<br><span class="hljs-keyword">private</span> <span class="hljs-title function_">PDestination</span><span class="hljs-params">(String whereTo)</span>&#123;<br>label = whereTo;<br>&#125;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">readLabel</span><span class="hljs-params">()</span>&#123;<span class="hljs-keyword">return</span> label;&#125;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PDestination</span>(s);<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">Parcel5</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Parcel5</span>();<br><span class="hljs-type">Destination</span> <span class="hljs-variable">d</span> <span class="hljs-operator">=</span> p.destination(<span class="hljs-string">&quot;Tasmania&quot;</span>);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åŒ¿åå†…éƒ¨ç±»"><a href="#åŒ¿åå†…éƒ¨ç±»" class="headerlink" title="åŒ¿åå†…éƒ¨ç±»"></a>åŒ¿åå†…éƒ¨ç±»</h3><p>åŒ¿åå†…éƒ¨ç±»æä¾›äº† ä¸€ç§å®ç° å³ä¸ç”¨é€šè¿‡æ­£å¼çš„ç±»å£°æ˜ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡å®ç°æ¥å£æ–¹æ³•çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„å¯¹è±¡æ¥è¿›è¡Œä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span>  <span class="hljs-title class_">Parcel7</span>&#123;<br><span class="hljs-keyword">public</span> Contents <span class="hljs-title function_">contents</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Contents</span>()&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">11</span>;<br><span class="hljs-meta">@Override</span> <br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">value</span><span class="hljs-params">()</span>&#123;<span class="hljs-keyword">return</span> i; &#125;<br>&#125;;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">Parcel7</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Parcel7</span>();<br><span class="hljs-type">Contents</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> p.contents();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è®¾è®¡å†…éƒ¨ç±»çš„ç›®çš„-ï¼š"><a href="#è®¾è®¡å†…éƒ¨ç±»çš„ç›®çš„-ï¼š" class="headerlink" title="è®¾è®¡å†…éƒ¨ç±»çš„ç›®çš„ ï¼š"></a>è®¾è®¡å†…éƒ¨ç±»çš„ç›®çš„ ï¼š</h3><h3 id="1-é€»è¾‘å…³è”å’Œä½œç”¨åŸŸç®¡ç†"><a href="#1-é€»è¾‘å…³è”å’Œä½œç”¨åŸŸç®¡ç†" class="headerlink" title="1. é€»è¾‘å…³è”å’Œä½œç”¨åŸŸç®¡ç†"></a>1. <strong>é€»è¾‘å…³è”å’Œä½œç”¨åŸŸç®¡ç†</strong></h3><ul><li>å½“ä¸€ä¸ªç±»çš„å®šä¹‰ä»…å¯¹å¦ä¸€ä¸ªç±»æœ‰æ„ä¹‰æ—¶ï¼Œå°±å¯ä»¥å°†å®ƒå®šä¹‰ä¸ºå†…éƒ¨ç±»ã€‚</li><li>å†…éƒ¨ç±»çš„å­˜åœ¨<strong>å¼ºåŒ–äº†â€œç»„åˆè€Œéç»§æ‰¿â€çš„å…³ç³»</strong>ï¼Œè®©ä½ è¡¨è¾¾â€œè¿™ä¸ªç±»åªå±äºé‚£ä¸ªç±»â€çš„è¯­ä¹‰ã€‚</li></ul><h3 id="2-è®¿é—®å¤–éƒ¨ç±»çš„ç§æœ‰æˆå‘˜"><a href="#2-è®¿é—®å¤–éƒ¨ç±»çš„ç§æœ‰æˆå‘˜" class="headerlink" title="2. è®¿é—®å¤–éƒ¨ç±»çš„ç§æœ‰æˆå‘˜"></a>2. <strong>è®¿é—®å¤–éƒ¨ç±»çš„ç§æœ‰æˆå‘˜</strong></h3><ul><li>å†…éƒ¨ç±»å¯ä»¥<strong>æ— éšœç¢è®¿é—®å¤–éƒ¨ç±»çš„æ‰€æœ‰æˆå‘˜</strong>ï¼ˆåŒ…æ‹¬ <code>private</code> å­—æ®µå’Œæ–¹æ³•ï¼‰ã€‚</li><li>è¿™æä¾›äº†ä¸€ç§çµæ´»çš„æ–¹å¼æ¥â€œå¢å¼ºâ€å¤–éƒ¨ç±»åŠŸèƒ½ï¼Œè€Œ<strong>ä¸ä¾èµ–ç»§æ‰¿</strong>ã€‚</li></ul><h3 id="3-å°è£…å’Œéšè—"><a href="#3-å°è£…å’Œéšè—" class="headerlink" title="3. å°è£…å’Œéšè—"></a>3. <strong>å°è£…å’Œéšè—</strong></h3><ul><li>å†…éƒ¨ç±»æœ¬è´¨ä¸Šæ˜¯<strong>å¤–éƒ¨ç±»çš„ä¸€éƒ¨åˆ†å®ç°ç»†èŠ‚</strong>ï¼Œå¯ä»¥ä¸æš´éœ²ç»™å¤–éƒ¨ç”¨æˆ·ã€‚</li></ul><h3 id="4-å¯¹äº‹ä»¶å¤„ç†-å›è°ƒé€»è¾‘çš„æ”¯æŒ"><a href="#4-å¯¹äº‹ä»¶å¤„ç†-å›è°ƒé€»è¾‘çš„æ”¯æŒ" class="headerlink" title="4. å¯¹äº‹ä»¶å¤„ç†&#x2F;å›è°ƒé€»è¾‘çš„æ”¯æŒ"></a>4. <strong>å¯¹äº‹ä»¶å¤„ç†&#x2F;å›è°ƒé€»è¾‘çš„æ”¯æŒ</strong></h3><ul><li>åœ¨ GUI ç¼–ç¨‹ä¸­ï¼ˆå¦‚ Swingï¼‰ï¼ŒåŒ¿åå†…éƒ¨ç±»ã€å±€éƒ¨å†…éƒ¨ç±»å¸¸ç”¨äºäº‹ä»¶ç›‘å¬å™¨ï¼Œå®ç°å“åº”é€»è¾‘ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaç¼–ç¨‹ I åŸºç¡€</title>
    <link href="/2025/04/21/Java%E7%BC%96%E7%A8%8B-I-%E5%9F%BA%E7%A1%80/"/>
    <url>/2025/04/21/Java%E7%BC%96%E7%A8%8B-I-%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<p>â€”â€”â€”â€” åŸºäºã€ŠOn Javaã€‹  </p><h2 id="ä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ"></a><strong>ä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ</strong></h2><p>åœ¨è®¸å¤šç¼–ç¨‹ä¹¦ç±å’ŒæŠ€æœ¯åšå®¢ä¸­ï¼Œå¯¹è±¡å¸¸è¢«å®šä¹‰ä¸ºâ€œä¸€ä¸ªçœŸå®å­˜åœ¨çš„å®ä½“â€æˆ–â€œæ–¹æ³•å’Œå±æ€§çš„é›†åˆâ€ã€‚</p><p>ç„¶è€Œï¼Œè¿™äº›å®šä¹‰å¾€å¾€åªåœç•™åœ¨è¡¨å±‚ï¼Œå¹¶æœªçœŸæ­£è§£é‡Šâ€œ<strong>ä»€ä¹ˆæ˜¯å¯¹è±¡</strong>â€è¿™ä¸€æ ¸å¿ƒé—®é¢˜ã€‚æ¯”å¦‚ï¼Œâ€œå®ä½“â€æœ¬èº«æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿä¸ºä»€ä¹ˆå±æ€§å’Œæ–¹æ³•çš„ç»„åˆå¯ä»¥ç§°ä¸ºä¸€ä¸ªâ€˜å¯¹è±¡â€™ï¼Ÿå¸¦ç€è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä»è®¾è®¡å±‚é¢é‡æ–°æ€è€ƒå¯¹è±¡çš„æœ¬è´¨ã€‚</p><h3 id="è®¾è®¡å±‚é¢ï¼šå¯¹è±¡æ˜¯é¢å‘ç›®çš„çš„å®ä½“ç‰¹å¾ä¸è¡Œä¸ºçš„æŠ½è±¡ã€‚"><a href="#è®¾è®¡å±‚é¢ï¼šå¯¹è±¡æ˜¯é¢å‘ç›®çš„çš„å®ä½“ç‰¹å¾ä¸è¡Œä¸ºçš„æŠ½è±¡ã€‚" class="headerlink" title="è®¾è®¡å±‚é¢ï¼šå¯¹è±¡æ˜¯é¢å‘ç›®çš„çš„å®ä½“ç‰¹å¾ä¸è¡Œä¸ºçš„æŠ½è±¡ã€‚"></a><strong>è®¾è®¡å±‚é¢ï¼šå¯¹è±¡æ˜¯é¢å‘ç›®çš„çš„å®ä½“ç‰¹å¾ä¸è¡Œä¸ºçš„æŠ½è±¡ã€‚</strong></h3><h3 id="ä»€ä¹ˆæ˜¯å®ä½“ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å®ä½“ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å®ä½“ï¼Ÿ"></a><strong>ä»€ä¹ˆæ˜¯å®ä½“ï¼Ÿ</strong></h3><p>åŠ¨ç‰©æ˜¯ä¸æ˜¯ä¸€ç§å®ä½“ï¼Ÿæˆ¿å±‹æ˜¯ä¸æ˜¯ä¸€ç§å®ä½“ï¼Ÿæˆ¿å±‹ï¼Ÿæ¯”ç‰¹å¸å‘¢ï¼Ÿç¬›å¡å°”çš„â€œæˆ‘æ€æ•…æˆ‘åœ¨â€å‘¢ï¼Ÿ</p><p>å®ä½“å¹¶ä¸ä¸€å®šæ˜¯ä»¥â€œçœŸå®å­˜åœ¨â€ä½œä¸ºå¿…è¦æ¡ä»¶çš„ï¼Œå®ä½“çš„é‡è¦ç‰¹å¾æ˜¯â€œä¸€ç§å¯æè¿°çš„æ¦‚å¿µâ€ã€‚æ¯”å¦‚â€œç‹¬è§’å…½â€æ˜¯ä¸€åªé•¿æœ‰çŠ„è§’å’Œç¿…è†€çš„é©¬ï¼Œæ¯”å¦‚â€œè¥¿æ–¹çš„æ¶é¾™è¦†ç›–æœ‰åšåšçš„é³ç‰‡èƒ½å¤Ÿå–·åç«ç„°â€ã€‚è¿™äº›æ¦‚å¿µçš„é‡ç‚¹ä¸æ˜¯â€œçœŸå®å­˜åœ¨â€ï¼Œè€Œæ˜¯â€œå¯æè¿°â€ã€‚æ¨è€Œå¹¿ä¹‹ï¼Œä¸€äº›æŠ½è±¡æ¦‚å¿µä¹Ÿå¯ä»¥ä½œä¸ºâ€œå®ä½“â€ï¼Œæ¯”å¦‚ FIFOçš„é˜Ÿåˆ—ï¼Œä»£ç†æ¨¡å¼ä¸­çš„ä»£ç†æ¦‚å¿µã€‚</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å®ä½“çš„å®šä¹‰ â€œä¸€ç§å¯æè¿°çš„æ¦‚å¿µâ€ï¼ˆæ— è®ºå®ƒæ˜¯å¦çœŸçš„å­˜åœ¨ï¼‰</p><h3 id="é‚£ä¹ˆä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ"><a href="#é‚£ä¹ˆä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ" class="headerlink" title="é‚£ä¹ˆä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ"></a><strong>é‚£ä¹ˆä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ</strong></h3><p>æˆ‘ä»¬æ°¸è¿œæ²¡åŠæ³•å°†ä¸€ä¸ªå®ä½“å®Œæ•´åœ°ç”¨è®¡ç®—æœºè¯­è¨€å»æè¿°ã€‚ä½†å¯ä»¥å°†ç‰¹å¾å’Œè¡Œä¸ºæŠ½è±¡å‡ºæ¥ï¼Œä½œä¸ºæˆ‘ä»¬ç”¨è®¡ç®—æœºå»æ¨¡æ‹Ÿè¿™ä¸ªç‰©ä½“çš„æ–¹æ³•ã€‚è¿™æš—å«ç€å¯¹è±¡è®¾è®¡æ˜¯é¢å‘åŠŸèƒ½çš„ï¼Œæœ‰å–èˆçš„ã€‚å› ä¸ºæˆ‘ä»¬å®é™…å…³æ³¨çš„ä¸æ˜¯å®ä½“åˆ°åº•æ˜¯æ€ä¹ˆæ ·çš„ï¼Œè€Œæ˜¯å…³æ³¨å®ä½“é€šè¿‡å“ªäº›ç‰¹å¾å’Œè¡Œä¸ºè¾¾æˆäº†æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚å½“æˆ‘ä»¬è€ƒè™‘ä¸€å¤´ç‰›çš„æ—¶å€™ï¼Œåœ¨è™šæ‹Ÿä¸–ç•Œé‡Œï¼Œæˆ‘ä»¬ä¸ä¼šå»è€ƒè™‘ç‰›ä½åœ¨å“ªé‡Œï¼Œä½•æ—¶ä¼‘æ¯ã€‚è€ƒè™‘çš„æ˜¯æˆ‘ä»¬ä¸ºäº†è¾¾æˆç›®çš„ï¼Œéœ€è¦â€ä¾›åº”â€œä»€ä¹ˆï¼Œâ€œäº§å‡ºâ€ä»€ä¹ˆã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨è®¾è®¡æ—¶çœŸæ­£æ„å»ºçš„å¯¹è±¡æ˜¯ä»¥ç›®çš„ä¸ºæ ¸å¿ƒï¼Œå¯¹å®ä½“ç‰¹å¾å’Œè¡Œä¸ºçš„æŠ½è±¡ã€‚ç›®çš„æ˜¯æˆ‘ä»¬çš„æœ€ç»ˆç»“æœï¼Œè€Œå®ä½“çš„ç‰¹å¾å’Œè¡Œä¸ºæ˜¯ä¸ºäº†è¾¾æˆç›®çš„æ‰€å¿…é¡»çš„ç»„ä»¶</p><h3 id="å®ç°å±‚é¢ï¼šå¯¹è±¡æ˜¯ç»è¿‡ç»“æ„åŒ–ç»„ç»‡çš„å†…å­˜ã€‚"><a href="#å®ç°å±‚é¢ï¼šå¯¹è±¡æ˜¯ç»è¿‡ç»“æ„åŒ–ç»„ç»‡çš„å†…å­˜ã€‚" class="headerlink" title="å®ç°å±‚é¢ï¼šå¯¹è±¡æ˜¯ç»è¿‡ç»“æ„åŒ–ç»„ç»‡çš„å†…å­˜ã€‚"></a><strong>å®ç°å±‚é¢ï¼šå¯¹è±¡æ˜¯ç»è¿‡ç»“æ„åŒ–ç»„ç»‡çš„å†…å­˜ã€‚</strong></h3><h3 id="å†…å­˜ä¸å¯¹è±¡"><a href="#å†…å­˜ä¸å¯¹è±¡" class="headerlink" title="å†…å­˜ä¸å¯¹è±¡"></a><strong>å†…å­˜ä¸å¯¹è±¡</strong></h3><p>ç¨‹åºå‘˜å¯¹å†…å­˜å’Œç¨‹åºç»“æ„æ‹¥æœ‰è¿‘ä¹å®Œå…¨çš„æ§åˆ¶æƒã€‚ä»–ä»¬å¯ä»¥è‡ªç”±åœ°å†³å®šæ¯ä¸€ä¸ªå†…å­˜åœ°å€çš„ç”¨é€”ï¼Œè¿™åœ¨ç©ºé—´å—é™çš„åœºæ™¯ä¸­æ˜¾å¾—å°¤ä¸ºé«˜æ•ˆï¼Œå¯ä»¥æœ€å¤§é™åº¦åœ°å‹æ¦¨å‡ºæ¯ä¸€å­—èŠ‚çš„æ½œåŠ›ã€‚ä½†ä¹Ÿå¯¼è‡´äº†ä¸€äº›é—®é¢˜ï¼š</p><p>åœ¨åŠŸèƒ½è®¾è®¡çš„åˆæœŸå°±éœ€è¦å‘¨å…¨çš„è€ƒè™‘å¯¹è±¡ï¼ˆç»“æ„ä½“ï¼‰çš„è®¾è®¡ï¼Œä¸ç„¶ä¼šåŠ å¤§åæœŸçš„ç»´æŠ¤ï¼Œé‡æ„ï¼Œæ–°å¢åŠŸèƒ½çš„å¤æ‚åº¦ã€‚</p><p>ç¼–ç¨‹äººå‘˜å¯¹ç¨‹åºæœ‰ç»å¯¹çš„æƒé™ï¼Œæ„å‘³ç€ç›¸åŒçš„åŠŸèƒ½å¯èƒ½ä¼šè®¾è®¡ä¸åŒçš„ç³»ç»Ÿæ¥å¤„ç†ç›¸åŒçš„æµç¨‹ï¼Œå¦‚å†…å­˜åˆ†é…&#x2F;å›æ”¶ã€‚æ¶ˆæ¯å¤„ç†ã€‚å¯¹äºå¤šäººå¼€å‘çš„å¤§å‹ç³»ç»Ÿä¼šå¢åŠ ç³»ç»Ÿçš„å¤æ‚åº¦ã€‚</p><p>åœ¨è¿™ä¸€å±‚é¢ä¸Šï¼Œä¸€äº›æ›´ç°ä»£çš„ç¼–ç¨‹è¯­è¨€é€‰æ‹©æ”¾å¼ƒäº†Cè¯­è¨€çš„â€œè‡ªç”±â€œï¼Œç°ä»£ç³»ç»Ÿçš„è®¾è®¡éƒ½æ˜¯å±‚æ¬¡åŒ–çš„ï¼Œå½“æˆ‘è¿›è¡Œä¸Šå±‚æ•°æ®çš„å¤„ç†æ—¶ï¼Œä»ç„¶è¦å»å…³å¿ƒæœ€åº•å±‚çš„å†…å­˜æ˜¯å¦‚ä½•æ’å¸ƒçš„æ˜¾ç„¶æ˜¯ä¸€ä¸ªä¸å¤Ÿé«˜æ•ˆçš„åšæ³•ã€‚å› æ­¤å®ƒä»¬å¼€å§‹å»é¢„å®šä¹‰ä¸€äº›ç»“æ„åŒ–çš„å†…å­˜ï¼Œä»â€å†…å­˜äº¤ç»™ä½ ï¼Œä½ æ¥ä»0å¼€å§‹å®Œæˆç³»ç»Ÿâ€œï¼Œåˆ°â€œç”±æˆ‘æä¾›ä¸€äº›åŸºç¡€ç»„ä»¶ï¼Œä½ åœ¨è¿™ä¸ªåŸºç¡€ä¹‹ä¸Šç»„ç»‡ç³»ç»Ÿâ€ã€‚é€šè¿‡å¯¹å†…å­˜å—çš„ç»“æ„åŒ–è®¾è®¡ï¼Œå°†â€œè®¾è®¡-å®ç°â€çš„é—®é¢˜ï¼Œå˜æˆäº†â€œç»„ç»‡-å®ç°â€ã€‚</p><p>å¦ä¸€æ–¹é¢å› ä¸ºæ‰€æœ‰åŸºç¡€æ¨¡å—æ˜¯ç¼–ç¨‹è¯­è¨€é¢„å…ˆå®šä¹‰çš„ï¼Œæ‰€ä»¥åœ¨åæœŸä½¿ç”¨æ—¶ï¼Œä½œä¸ºå†…å­˜-ç³»ç»Ÿçš„ä¸­é—´å±‚ï¼ˆå¦‚ä¸€äº›è™šæ‹Ÿæœºç¨‹åºï¼‰ï¼Œå¯ä»¥å¯¹ç³»ç»Ÿä¸­çš„å†…å­˜ä½¿ç”¨è¿›è¡Œæ›´å¥½çš„æ§åˆ¶ï¼Œè¿™æ ·æ—¢å¯ä»¥é€šè¿‡ç³»ç»Ÿçš„ç®¡ç†ï¼Œå°†å·²åŠ è½½çš„åŠŸèƒ½æ¨¡å—çµæ´»å¤ç”¨ï¼Œä¹Ÿå¯ä»¥æ›´å¥½çš„æä¾›ç³»ç»Ÿçº§çš„ç›‘æ§ç®¡ç†ï¼Œåƒåƒåœ¾å›æ”¶ï¼Œå¯¹è±¡çš„åŠ¨æ€åŠ è½½åˆ›å»ºç­‰ï¼Œå¯¹äºæ›´ä¸Šå±‚çš„ç¼–ç¨‹äººå‘˜æ¥è¯´ï¼Œè¿›è¡Œç±»è®¾è®¡ï¼Œå¯¹è±¡è®¾è®¡ã€‚åè€Œæ˜¯ä¸€äº›é¡ºä¾¿å¸¦æ¥çš„å¥½å¤„ã€‚</p><h3 id="é‚£ä¹ˆä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ï¼Ÿ"><a href="#é‚£ä¹ˆä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ï¼Ÿ" class="headerlink" title="é‚£ä¹ˆä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ï¼Ÿ"></a><strong>é‚£ä¹ˆä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ï¼Ÿ</strong></h3><p>å½“æˆ‘ä»¬æ˜ç™½äº†å¯¹è±¡æ˜¯ä¸€ç§å¯æè¿°çš„æ¦‚å¿µï¼Œå¹¶ä¸”å¯¹è±¡è®¾è®¡çš„æ ¸å¿ƒæ˜¯é¢å‘åŠŸèƒ½çš„ï¼Œä»¥åŠä¸ºä»€ä¹ˆä½¿ç”¨å¯¹è±¡è€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨å†…å­˜æ¥è®¾è®¡æˆ‘ä»¬çš„ç³»ç»Ÿã€‚é‚£ä¹ˆé¢å‘å¯¹è±¡å°±æ˜¯åœ¨è®¾è®¡ç³»ç»Ÿæ—¶ï¼Œé¦–å…ˆå®Œæˆå¯¹ç³»ç»ŸåŠŸèƒ½çš„æŠ½è±¡ï¼Œå°†ç³»ç»Ÿçš„å®ç°å˜ä¸ºå¤šä¸ªæ ¸å¿ƒå¯¹è±¡ä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡å’Œæ–¹æ³•è°ƒç”¨ã€‚å¦‚ï¼š</p><p>å¯¹æ•°æ®è¿›è¡Œå­˜å‚¨å’Œç»´æŠ¤è€Œè®¾è®¡çš„ç±»ï¼Œå¦‚ç”¨æˆ·ç±»ï¼Œä»“åº“ç±»</p><p>å¯¹æ•°æ®ç»„ç»‡ç»“æ„è¿›è¡ŒæŠ½è±¡çš„ç±»ï¼Œå¦‚æ•°æ®åŒ…ç±»ï¼Œå·¥å‚ç±»</p><p>ä»¥æŸç§æ“ä½œæµç¨‹ä¸ºæ ¸å¿ƒå»ºæ¨¡çš„è®¾è®¡çš„ç±»ï¼Œé˜Ÿåˆ—ã€æ ˆ</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬ä¸ä»…æ„å»ºäº†æ›´å…·ç»“æ„åŒ–çš„ç³»ç»Ÿï¼ŒåŒæ—¶ä¹Ÿæå‡äº†ç³»ç»Ÿçš„å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ä¸å¯æ‰©å±•æ€§ â€”â€” è¿™æ­£æ˜¯é¢å‘å¯¹è±¡è®¾è®¡çš„æ ¸å¿ƒä»·å€¼æ‰€åœ¨ã€‚</p><h2 id="ä¸€äº›æ‰©å±•æ€§è®¾è®¡å†…å®¹"><a href="#ä¸€äº›æ‰©å±•æ€§è®¾è®¡å†…å®¹" class="headerlink" title="ä¸€äº›æ‰©å±•æ€§è®¾è®¡å†…å®¹"></a>ä¸€äº›æ‰©å±•æ€§è®¾è®¡å†…å®¹</h2><h3 id="ä¸‡ç‰©çš†å¯¹è±¡"><a href="#ä¸‡ç‰©çš†å¯¹è±¡" class="headerlink" title="ä¸‡ç‰©çš†å¯¹è±¡"></a>ä¸‡ç‰©çš†å¯¹è±¡</h3><p>å…è®¸å‘å¯¹è±¡å‘å‡ºè¯·æ±‚ï¼Œè®©å®ƒæ‰§è¡Œä¸€äº›æ“ä½œï¼Œå¯¹äºä½ æƒ³è¦è§£å†³çš„é—®é¢˜ä¸­çš„ä»»ä½•å…ƒç´ ï¼Œä½ éƒ½å¯ä»¥åœ¨ç¨‹åºä¸­ç”¨å¯¹è±¡æ¥å‘ˆç°</p><h3 id="ä¸€æ®µç¨‹åºå®é™…ä¸Šå°±æ˜¯å¤šä¸ªå¯¹è±¡é€šè¿‡å‘é€æ¶ˆæ¯æ¥é€šçŸ¥å½¼æ­¤è¦å¹²ä»€ä¹ˆ"><a href="#ä¸€æ®µç¨‹åºå®é™…ä¸Šå°±æ˜¯å¤šä¸ªå¯¹è±¡é€šè¿‡å‘é€æ¶ˆæ¯æ¥é€šçŸ¥å½¼æ­¤è¦å¹²ä»€ä¹ˆ" class="headerlink" title="ä¸€æ®µç¨‹åºå®é™…ä¸Šå°±æ˜¯å¤šä¸ªå¯¹è±¡é€šè¿‡å‘é€æ¶ˆæ¯æ¥é€šçŸ¥å½¼æ­¤è¦å¹²ä»€ä¹ˆ"></a>ä¸€æ®µç¨‹åºå®é™…ä¸Šå°±æ˜¯å¤šä¸ªå¯¹è±¡é€šè¿‡å‘é€æ¶ˆæ¯æ¥é€šçŸ¥å½¼æ­¤è¦å¹²ä»€ä¹ˆ</h3><p>é€šè¿‡å°†ç°æœ‰çš„å‡ ä¸ªå¯¹è±¡æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œä½ å°±åˆ›å»ºäº†ä¸€ç§æ–°çš„å¯¹è±¡ã€‚</p><h3 id="æ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰ç±»å‹ã€‚"><a href="#æ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰ç±»å‹ã€‚" class="headerlink" title="æ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰ç±»å‹ã€‚"></a>æ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰ç±»å‹ã€‚</h3><p>æ¯ä¸ªå¯¹è±¡éƒ½æ˜¯é€šè¿‡ç±»ç”Ÿæˆçš„å®ä¾‹ï¼Œç±» å°±ç­‰åŒäº ç±»å‹ï¼Œä¸€ä¸ªç±»æœ€ä¸ºæ˜¾è‘—çš„ç‰¹å¾æ˜¯ ä½ å¯ä»¥å‘é€ä»€ä¹ˆæ¶ˆæ¯ç»™å®ƒ</p><h3 id="åŒä¸€ä¸ªç±»å‹çš„å¯¹è±¡å¯ä»¥æ¥æ”¶ç›¸åŒçš„æ¶ˆæ¯"><a href="#åŒä¸€ä¸ªç±»å‹çš„å¯¹è±¡å¯ä»¥æ¥æ”¶ç›¸åŒçš„æ¶ˆæ¯" class="headerlink" title="åŒä¸€ä¸ªç±»å‹çš„å¯¹è±¡å¯ä»¥æ¥æ”¶ç›¸åŒçš„æ¶ˆæ¯"></a>åŒä¸€ä¸ªç±»å‹çš„å¯¹è±¡å¯ä»¥æ¥æ”¶ç›¸åŒçš„æ¶ˆæ¯</h3><h1 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h1><h2 id="å®šä¹‰ä¸€ä¸ªç±»"><a href="#å®šä¹‰ä¸€ä¸ªç±»" class="headerlink" title="å®šä¹‰ä¸€ä¸ªç±»"></a>å®šä¹‰ä¸€ä¸ªç±»</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ATypeName</span> &#123;<br><span class="hljs-comment">// ç±»å…·ä½“å®ç°</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç±»ä¸­å…è®¸å®šä¹‰ä¸¤ç±»å…ƒç´ -æ–¹æ³•å’Œå±æ€§"><a href="#ç±»ä¸­å…è®¸å®šä¹‰ä¸¤ç±»å…ƒç´ -æ–¹æ³•å’Œå±æ€§" class="headerlink" title="ç±»ä¸­å…è®¸å®šä¹‰ä¸¤ç±»å…ƒç´ : æ–¹æ³•å’Œå±æ€§"></a>ç±»ä¸­å…è®¸å®šä¹‰ä¸¤ç±»å…ƒç´ : æ–¹æ³•å’Œå±æ€§</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DataOnly</span>&#123;<br><span class="hljs-type">int</span> i;<br><span class="hljs-type">double</span> d ;<br><span class="hljs-type">boolean</span> b ;<br>&#125;<br><br><span class="hljs-type">DataOnly</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataOnly</span>();<br><span class="hljs-comment">/* DataOnly    ç±»å£°æ˜</span><br><span class="hljs-comment"> * data        å˜é‡å</span><br><span class="hljs-comment"> * new         å…³é”®å­—ç”¨äº ç”³è¯·å†…å­˜ï¼Œè°ƒç”¨åˆå§‹åŒ–æ–¹æ³•ï¼Œè¿”å›æŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆ</span><br><span class="hljs-comment"> * DataOnly()  è°ƒç”¨ç±»åˆ›å»ºå®ç°çš„å¯¹è±¡</span><br><span class="hljs-comment"> */</span><br></code></pre></td></tr></table></figure><h2 id="é€šè¿‡â€-â€-è®¿é—®å¯¹è±¡çš„æˆå‘˜"><a href="#é€šè¿‡â€-â€-è®¿é—®å¯¹è±¡çš„æˆå‘˜" class="headerlink" title="é€šè¿‡â€.â€ è®¿é—®å¯¹è±¡çš„æˆå‘˜"></a>é€šè¿‡â€.â€ è®¿é—®å¯¹è±¡çš„æˆå‘˜</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">data.i = <span class="hljs-number">47</span>;<br>data.d = <span class="hljs-number">1.1</span>;<br>data.b = <span class="hljs-literal">false</span>;<br></code></pre></td></tr></table></figure><p>åŸºæœ¬ç±»å‹çš„åˆå§‹åŒ–</p><p>javaä¸­ä¼šè‡ªåŠ¨è¿›è¡Œç±»ä¸­å®šä¹‰çš„å˜é‡çš„åˆå§‹åŒ–</p><p>å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡ä¸ä¼šä¸»åŠ¨è¿›è¡Œåˆå§‹åŒ–ï¼Œä½†æ˜¯ä¼šè¢«jvmæ£€æŸ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">boolean</span>           <span class="hljs-literal">false</span> <br><span class="hljs-type">char</span>              \u0000 <span class="hljs-literal">null</span><br><span class="hljs-title function_">byte</span>              <span class="hljs-params">(<span class="hljs-type">byte</span>)</span><span class="hljs-number">0</span><br><span class="hljs-type">short</span>             (<span class="hljs-type">short</span>)<span class="hljs-number">0</span><br><span class="hljs-type">int</span>               <span class="hljs-number">0</span><br><span class="hljs-type">long</span>              <span class="hljs-number">0L</span><br><span class="hljs-type">float</span>             <span class="hljs-number">0.0f</span><br><span class="hljs-type">double</span>            <span class="hljs-number">0.0d</span><br></code></pre></td></tr></table></figure><h1 id="æ–¹æ³•ï¼Œå‚æ•°ä»¥åŠè¿”å›å€¼"><a href="#æ–¹æ³•ï¼Œå‚æ•°ä»¥åŠè¿”å›å€¼" class="headerlink" title="æ–¹æ³•ï¼Œå‚æ•°ä»¥åŠè¿”å›å€¼"></a>æ–¹æ³•ï¼Œå‚æ•°ä»¥åŠè¿”å›å€¼</h1><h2 id="æ–¹æ³•çš„å®šä¹‰"><a href="#æ–¹æ³•çš„å®šä¹‰" class="headerlink" title="æ–¹æ³•çš„å®šä¹‰"></a>æ–¹æ³•çš„å®šä¹‰</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">ReturnType <span class="hljs-title function_">methodName</span><span class="hljs-params">(<span class="hljs-comment">/* å‚æ•°åˆ—è¡¨ */</span>)</span>&#123;<br><span class="hljs-comment">// æ–¹æ³•ä½“</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å®šä¹‰ä¸€ä¸ªå¸¦å‚çš„æ–¹æ³•"><a href="#å®šä¹‰ä¸€ä¸ªå¸¦å‚çš„æ–¹æ³•" class="headerlink" title="å®šä¹‰ä¸€ä¸ªå¸¦å‚çš„æ–¹æ³•"></a>å®šä¹‰ä¸€ä¸ªå¸¦å‚çš„æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> <span class="hljs-title function_">storage</span> <span class="hljs-params">(Strings s)</span>&#123;<br><span class="hljs-keyword">return</span> s.length() * <span class="hljs-number">2</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="static-å…³é”®å­—"><a href="#static-å…³é”®å­—" class="headerlink" title="static å…³é”®å­—"></a>static å…³é”®å­—</h2><p>é€šè¿‡staticå…³é”®å­—æ¥å¯¹ ç±»ä¸­çš„å±æ€§å’Œæ–¹æ³•è¿›è¡Œç®¡ç†ï¼Œä½¿å®ƒä»¬ä»å±äºç±»ï¼Œç›´æ¥ä¸ç±»è¿›è¡Œç»‘å®šã€‚è¿™æ ·åœ¨ä½¿ç”¨æ—¶å¯ä»¥ç›´æ¥é€šè¿‡è°ƒç”¨ç±»æ¥å®Œæˆå¯¹è¿™äº›å±æ€§å’Œæ–¹æ³•çš„è®¾ç½®ä¸ç»‘å®šã€‚</p><p>è¿™é‡Œå¯ä»¥ç»“åˆæˆ‘ä»¬çš„ä¸Šä¸€èŠ‚è¿›è¡Œæ€è€ƒï¼Œå³é€šè¿‡static å…³é”®å­—ä½¿å¾— å¯¹åº”çš„æ–¹æ³•å’Œå±æ€§å­˜å‚¨åœ¨ç±»ç»“æ„ä¸­çš„é™æ€å­—æ®µï¼Œå¹¶ä¸”åœ¨ç±»åŠ è½½é˜¶æ®µå°±é€šè¿‡ç´¢å¼•å®Œæˆäº†ä¸ç±»çš„ç»‘å®šã€‚</p><p>å½“ç±»ä¸­çš„é™æ€å±æ€§æˆ–è€…æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œä¹Ÿä¼šè§¦å‘ç±»çš„åˆå§‹åŒ–</p><p>å®šä¹‰ä¸€ä¸ªé™æ€æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">StaticTest</span>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">47</span> ;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="Javaç¨‹åºçš„ç¤ºä¾‹"><a href="#Javaç¨‹åºçš„ç¤ºä¾‹" class="headerlink" title="Javaç¨‹åºçš„ç¤ºä¾‹"></a>Javaç¨‹åºçš„ç¤ºä¾‹</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//objects/HelloDate.java</span><br><span class="hljs-keyword">import</span> java.util.* ;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloDate</span>&#123;<br><span class="hljs-keyword">public</span> staic <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>System.out.print(<span class="hljs-string">&quot;Hello, it&#x27;s: &quot;</span>)<br>System.out.println(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>&#125;<br>&#125;<br><br><span class="hljs-comment">// import å‘æ–‡ä»¶ä¸­å¯¼å…¥éœ€è¦çš„åº“</span><br><span class="hljs-comment">// public class HelloDate&#123;&#125;  </span><br><span class="hljs-comment">// å£°æ˜ä¸€ä¸ªå…¬æœ‰ç±»ï¼Œè¿™æ„å‘³ç€å…è®¸å…¶ä»–æ‰€æœ‰å¯¹è±¡å¯¹è¿™ä¸ªç±»è¿›è¡Œè®¿é—®</span><br><span class="hljs-comment">// class å®šä¹‰è¿™æ˜¯ä¸€ä¸ªç±» HelloDate ç±»å åç»­æ˜¯è¯¥ç±»çš„ä»£ç å—</span><br><span class="hljs-comment">// public static void main(String[] args)</span><br><span class="hljs-comment">// å®šä¹‰äº†ä¸€ä¸ªé™æ€å…¬æœ‰æ–¹æ³•mainï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯ç”±ä»ç±»ä¸­è°ƒç”¨çš„ã€‚è¿”å›å€¼æ˜¯void</span><br><span class="hljs-comment">// åç»­æ˜¯å‚æ•°åˆ—è¡¨ï¼Œå£°æ˜äº†æ¥æ”¶ä¸€ä¸ªå­—ç¬¦æ•°ç»„ args ä½œä¸ºå‚æ•°ã€‚åç»­æ˜¯å‡½æ•°çš„å‡½æ•°ä½“</span><br><span class="hljs-comment">// System.out.println() </span><br><span class="hljs-comment">// è°ƒç”¨äº†æ¥è‡ªSystem.outåº“ä¸­çš„println() æ–¹æ³•ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¿¡æ¯å¹¶ä¸”åœ¨æ‰“å°åæ¢è¡Œ</span><br><br></code></pre></td></tr></table></figure><p>javaæ–‡ä»¶éœ€è¦è¿›è¡Œä¸€ä¸ªç¼–è¯‘&#x2F;æ‰§è¡Œçš„è¿‡ç¨‹</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs powershell">javac HelloDate.java <span class="hljs-comment"># å°†javaæ–‡ä»¶ç¼–è¯‘ä¸ºå­—èŠ‚ç æ–‡ä»¶HelloData.class</span><br>java HelloData       <span class="hljs-comment"># æ‰§è¡Œç¼–è¯‘åçš„æ–‡ä»¶</span><br><span class="hljs-comment"># åœ¨è¾ƒæ–°ç‰ˆæœ¬çš„java ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨java æ‰§è¡Œjavaæ–‡ä»¶</span><br>java HelloData.java<br><br><span class="hljs-comment"># ä¸¤ç§æƒ…å†µå‡ä¼šè¾“å‡º ï¼š</span><br>Hello , it<span class="hljs-string">&#x27;s Sat Apr 19 16:53:22 CST 2025</span><br></code></pre></td></tr></table></figure><p>ç¼–ç¨‹é£æ ¼ </p><p>ç±»åé€šå¸¸éµå¾ªå¤§é©¼å³°å‘½åæ³•</p><p>ç±»ä¼¼ ï¼š AllTheColosOfTheRainbow  é¦–å­—æ¯å¤§å†™</p><h1 id="æ“ä½œç¬¦"><a href="#æ“ä½œç¬¦" class="headerlink" title="æ“ä½œç¬¦"></a>æ“ä½œç¬¦</h1><h2 id="å·¦å€¼ä¸å³å€¼"><a href="#å·¦å€¼ä¸å³å€¼" class="headerlink" title="å·¦å€¼ä¸å³å€¼"></a>å·¦å€¼ä¸å³å€¼</h2><p>åœ¨ä½¿ç”¨æ“ä½œç¬¦èµ‹å€¼æ—¶ï¼Œéœ€è¦ç¡®å®š â€œ&#x3D;â€ ä¸¤è¾¹çš„èƒ½åŠ›ã€‚</p><p>å·¦å€¼ ï¼š å¿…é¡»æ˜¯ä¸€ä¸ªç‹¬ç‰¹çš„å‘½åå˜é‡</p><p>å³å€¼ ï¼š å¯ä»¥æ˜¯ä»»ä½•å¸¸é‡ï¼Œå˜é‡æˆ–è€…å¯ä»¥äº§ç”Ÿå€¼çš„è¡¨è¾¾å¼</p><p>å·¦å€¼å…·æœ‰ç‰¹æ®Šæ€§ï¼Œå³å¯ä»¥é€šè¿‡å·¦å€¼ç¡®å®šçš„æŸ¥è¯¢åˆ°å³å€¼çš„å†…å®¹</p><p>è€Œå³å€¼å¿…é¡»æ˜¯ä¸€ä¸ªå¯è¿”å›çš„å€¼ã€‚ï¼ˆå³å­˜åœ¨çš„å€¼ï¼‰</p><h2 id="å½“å·¦å€¼æŒ‡å‘ä¸€ä¸ªå¯¹è±¡"><a href="#å½“å·¦å€¼æŒ‡å‘ä¸€ä¸ªå¯¹è±¡" class="headerlink" title="å½“å·¦å€¼æŒ‡å‘ä¸€ä¸ªå¯¹è±¡"></a>å½“å·¦å€¼æŒ‡å‘ä¸€ä¸ªå¯¹è±¡</h2><p>ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Tank</span>&#123;<br><span class="hljs-type">int</span>  level ;<br>  <span class="hljs-comment">// static int level ;</span><br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Assignment</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">Tank</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tank</span>();<br><span class="hljs-comment">//Tank t2 = t1 ;</span><br><span class="hljs-type">Tank</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tank</span>();<br>t1.level = <span class="hljs-number">9</span> ;<br>t2.level = <span class="hljs-number">47</span> ;<br>System.out.println(<span class="hljs-string">&quot;1: t1.level &quot;</span>+t1.level+<span class="hljs-string">&quot;,t2.level: &quot;</span>+ t2.level);<br>t1.level = <span class="hljs-number">27</span>;<br>System.out.println(<span class="hljs-string">&quot;3: t1.level &quot;</span>+t1.level+<span class="hljs-string">&quot;,t2.level: &quot;</span>+ t2.level);<br>&#125;<br>&#125;<br><br><span class="hljs-comment">// æƒ…å†µ1 level æ²¡æœ‰è¢« static ä¿®é¥°ï¼Œé‚£ä¹ˆå®ƒä¼šä½œä¸ºä¸€ä¸ªå®ä¾‹å˜é‡è¢«å¤„ç†ï¼Œ</span><br><span class="hljs-comment">// å½“Tank t1 å’ŒTank t2 åˆ†å¸ƒåˆ›å»ºäº†å¯¹åº”çš„Tank() å¯¹è±¡æ—¶ï¼Œt1.level å’Œt2.levelæ˜¯äº’ç›¸ç‹¬ç«‹çš„</span><br><span class="hljs-comment">// æƒ…å†µ2 å°†levelä½œä¸ºä¸€ä¸ªé™æ€å˜é‡å¤„ç†ï¼Œé‚£ä¹ˆå®ƒä¼šéšç€ç±»åŠ è½½è¢«åˆå§‹åŒ–ä¸º0.</span><br><span class="hljs-comment">// åˆ›å»ºçš„t1,t2ä¸¤ä¸ªå®ä¾‹ä¸­æŸ¥è¯¢åˆ°çš„éƒ½æ˜¯åŒä¸€ä¸ªlevelå˜é‡ï¼Œæ‰€ä»¥å½“t2ä¿®æ”¹levelæ—¶ï¼Œt1ä¸­ä¹Ÿä¼šäº§ç”Ÿå“åº”çš„ä¿®æ”¹</span><br><span class="hljs-comment">// æƒ…å†µ3 åˆ›å»ºäº†t1çš„å¯¹è±¡ï¼Œå¹¶åˆ›å»ºt2æŒ‡å‘t1ã€‚ è¿™æ—¶t1å’Œt2éƒ½æ˜¯å¯¹new Tank()çš„å¼•ç”¨</span><br><span class="hljs-comment">// æ‰€ä»¥å½“t1ä¿®æ”¹äº†levelçš„å€¼æ—¶ï¼Œè¿‡ç¨‹æ˜¯t1 æŸ¥è¯¢åˆ°å®ƒå¼•ç”¨çš„å¯¹è±¡ä¸­levelå˜é‡çš„å€¼ï¼Œå¹¶ä¿®æ”¹</span><br><span class="hljs-comment">// è¿™æ—¶çš„t2ä¹Ÿæ˜¯æŒ‡å‘è¯¥å¯¹è±¡çš„ï¼Œæ‰€ä»¥å½“t1ä¿®æ”¹åï¼Œt2å»æŸ¥è¯¢å˜é‡çš„å€¼æ—¶å·²ç»å˜ä¸ºäº†ä¿®æ”¹åçš„å€¼ã€‚</span><br></code></pre></td></tr></table></figure><p>æ–¹æ³•è°ƒç”¨ä¸­çš„åˆ«é¢é¦†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Letter</span> &#123;<br><span class="hljs-type">char</span> c;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PassObject</span> &#123;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">(Letter y)</span>&#123;<br>y.c = <span class="hljs-string">&#x27;z&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">Letter</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Letter</span>();<br>x.c = <span class="hljs-string">&#x27;a&#x27;</span>;<br>System.out.println(<span class="hljs-string">&quot;1: x.c: &quot;</span>+ x.c);<br>f(x);<br>System.out.println(<span class="hljs-string">&quot;2: x.c: &quot;</span>+ x.c);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å½“ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°çš„å‚æ•°æ—¶ï¼Œå¯¹è¯¥å¯¹è±¡çš„å±æ€§è¿›è¡Œä¿®æ”¹ï¼Œä¹Ÿä¼šå¯¹åŸå¯¹è±¡äº§ç”Ÿä¿®æ”¹ã€‚</p><p>æœ¬è´¨æ˜¯å› ä¸ºå‘å‡½æ•°ä¼ é€’çš„å€¼æœ¬èº«å°±æ˜¯ä¸€ä¸ªå¯¹è±¡çš„åœ°å€ï¼Œå³ä½¿æ˜¯ä½œä¸ºå‰¯æœ¬è¢«ä¼ è¿›å»ï¼Œä»ç„¶ä¼šè·å–åˆ°æºå¯¹è±¡</p><h1 id="ç®—æ•°æ“ä½œç¬¦"><a href="#ç®—æ•°æ“ä½œç¬¦" class="headerlink" title="ç®—æ•°æ“ä½œç¬¦"></a>ç®—æ•°æ“ä½œç¬¦</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.* ;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MathOps</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">Random</span> <span class="hljs-variable">rand</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Random</span>(<span class="hljs-number">47</span>);<br><span class="hljs-type">int</span> i , j , k ;<br>j = rand.nextInt(<span class="hljs-number">100</span>)+<span class="hljs-number">1</span>;<br>System.out.println(<span class="hljs-string">&quot;j : &quot;</span>+ j );<br>k = rand.nextInt(<span class="hljs-number">100</span>)+<span class="hljs-number">1</span>;<br>System.out.println(<span class="hljs-string">&quot;j : &quot;</span>+ j );<br>i = j + k ;<br>System.out.println(<span class="hljs-string">&quot;j + k : &quot;</span> + i );<br>i = j - k ;<br>System.out.println(<span class="hljs-string">&quot;j - k : &quot;</span> + i );<br>i = k / j ;<br>System.out.println(<span class="hljs-string">&quot;j / k : &quot;</span> + i );<br>i = k * j ;<br>System.out.println(<span class="hljs-string">&quot;j * k : &quot;</span> + i );<br>i = k % j ;<br>System.out.println(<span class="hljs-string">&quot;j % k : &quot;</span> + i );<br>j %= k;<br>System.out.println(<span class="hljs-string">&quot;j %= k : &quot;</span> + j );<br><span class="hljs-type">float</span> u,v,w ;<br>v = rand.nextFloat();<br>System.out.pruntln(<span class="hljs-string">&quot;v : &quot;</span>+ v );<br>w = rand.nextFloat();<br>System.out.pruntln(<span class="hljs-string">&quot;w : &quot;</span>+ w );<br>u = v + w ;<br>System.out.pruntln(<span class="hljs-string">&quot;v + w : &quot;</span> + u );<br>u = v - w ;<br>System.out.pruntln(<span class="hljs-string">&quot;v - w : &quot;</span> + u );<br>u = w / v ;<br>System.out.pruntln(<span class="hljs-string">&quot;v / w : &quot;</span> + u );<br>u = w * v ;<br>System.out.pruntln(<span class="hljs-string">&quot;v * w : &quot;</span> + u );<br>u = w % v ;<br>System.out.pruntln(<span class="hljs-string">&quot;v % w : &quot;</span> + u );<br>v %= w;<br>System.out.pruntln(<span class="hljs-string">&quot;v %= w : &quot;</span> + v );<br>&#125;<br>&#125;<br><span class="hljs-comment">// nextInt() è·å–ä¸€ä¸ªéšæœºæ•´æ•°ï¼Œ nextFloat()è·å–ä¸€ä¸ªéšæœºæµ®ç‚¹æ•°</span><br></code></pre></td></tr></table></figure><h1 id="ä¸€å…ƒæ“ä½œç¬¦"><a href="#ä¸€å…ƒæ“ä½œç¬¦" class="headerlink" title="ä¸€å…ƒæ“ä½œç¬¦"></a>ä¸€å…ƒæ“ä½œç¬¦</h1><p>â€œ - â€ åè½¬å˜é‡ç¬¦å·</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">4</span> ;<br><span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> -i ; <span class="hljs-comment">// c = -4 ;</span><br></code></pre></td></tr></table></figure><p>â€œ++â€ è‡ªå¢æ“ä½œç¬¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">4</span> ;<br><span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span> + i++ ;         <span class="hljs-comment">// i++ å…ˆè¿”å›iåŸå€¼å‚ä¸è¿ç®—ï¼Œå†å°†iè‡ªå¢</span><br>System.out.println(<span class="hljs-string">&quot;c: &quot;</span>+c+<span class="hljs-string">&quot;, i: &quot;</span>+i);  <span class="hljs-comment">// è¾“å‡º 6ï¼Œ5</span><br><span class="hljs-type">int</span> <span class="hljs-variable">d</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span> + ++i ;         <span class="hljs-comment">// ++i  å…ˆå¯¹iè¿›è¡Œè‡ªå¢è¿ç®—ï¼Œå†è¿›è¡Œå¤–éƒ¨è¿ç®—</span><br>System.out.println(<span class="hljs-string">&quot;d: &quot;</span>+d+<span class="hljs-string">&quot;, i: &quot;</span>+i);  <span class="hljs-comment">// è¾“å‡º 8, 6</span><br></code></pre></td></tr></table></figure><p>â€œ - - â€ è‡ªå‡è¿ç®— </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">4</span> ;<br><span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span> + i-- ;         <span class="hljs-comment">// i++ å…ˆè¿”å›iåŸå€¼å‚ä¸è¿ç®—ï¼Œå†å°†iè‡ªå¢</span><br>System.out.println(<span class="hljs-string">&quot;c: &quot;</span>+c+<span class="hljs-string">&quot;, i: &quot;</span>+i); <span class="hljs-comment">// è¾“å‡º 6ï¼Œ3</span><br><span class="hljs-type">int</span> <span class="hljs-variable">d</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span> + --i ;         <span class="hljs-comment">// ++i  å…ˆå¯¹iè¿›è¡Œè‡ªå¢è¿ç®—ï¼Œå†è¿›è¡Œå¤–éƒ¨è¿ç®—</span><br>System.out.println(<span class="hljs-string">&quot;d: &quot;</span>+d+<span class="hljs-string">&quot;, i: &quot;</span>+i);  <span class="hljs-comment">// è¾“å‡º 4, 2</span><br></code></pre></td></tr></table></figure><h1 id="äºŒå…ƒè¿ç®—ç¬¦"><a href="#äºŒå…ƒè¿ç®—ç¬¦" class="headerlink" title="äºŒå…ƒè¿ç®—ç¬¦"></a>äºŒå…ƒè¿ç®—ç¬¦</h1><h2 id="å…³ç³»æ“ä½œç¬¦"><a href="#å…³ç³»æ“ä½œç¬¦" class="headerlink" title="å…³ç³»æ“ä½œç¬¦"></a>å…³ç³»æ“ä½œç¬¦</h2><p>â€œ&#x3D;&#x3D;â€ ç”¨äº åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„åœ°å€æ˜¯å¦ä¸€è‡´ï¼Œ</p><p>.equals ç”¨äºåˆ¤æ–­ ä¸¤ä¸ªå¯¹è±¡çš„å€¼æ˜¯å¦ä¸€è‡´</p><p>åœ¨java 9 ä»¥åŠä»¥åçš„ç‰ˆæœ¬ä¸­ ï¼š</p><p>-127 - 127   ä½œä¸ºç¼“å­˜æ•´æ•°å€¼ï¼Œå½“ä½¿ç”¨ value æˆ–valueof æ—¶ï¼Œä¼šä½¿ç”¨åŒä¸€ä¸ªintå¯¹è±¡ã€‚æ‰€ä»¥è¿™æ—¶çš„ valueå’Œ valueOf éƒ½ä¼šè¿”å›true</p><p>128 +  åˆ™éƒ½éœ€è¦é€šè¿‡ new æ¥åˆ›å»º  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Equivalence</span>&#123;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">(String desc , Integer n1 , Integer n2)</span>&#123;<br>System.out.println(desc + <span class="hljs-string">&quot;:&quot;</span>);<br>System.out.println(<br><span class="hljs-string">&quot;%d==%d %b %b%n&quot;</span>, n1 , n2 , n1 == n2 , n1.equals(n2));<br>&#125;<br><span class="hljs-meta">@SuppressWarnings(&quot;deprecation&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">(<span class="hljs-type">int</span> value)</span>&#123;<br><span class="hljs-type">Integer</span> <span class="hljs-variable">i1</span> <span class="hljs-operator">=</span> value ;<br><span class="hljs-type">Integer</span> <span class="hljs-variable">i2</span> <span class="hljs-operator">=</span> value ;<br>show(<span class="hljs-string">&quot;Automatic&quot;</span>,i1,i2);<br><span class="hljs-type">Integer</span> <span class="hljs-variable">r1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(value);<br><span class="hljs-type">Integer</span> <span class="hljs-variable">r2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(value);<br>show(<span class="hljs-string">&quot;new Integer()&quot;</span>,r1,r2);<br><span class="hljs-type">Integer</span> <span class="hljs-variable">v1</span> <span class="hljs-operator">=</span> Integer.valueOf(value);<br><span class="hljs-type">Integer</span> <span class="hljs-variable">v2</span> <span class="hljs-operator">=</span> Integer.valueOf(value);<br>show(<span class="hljs-string">&quot;Integer.valueOf()&quot;</span>, v1 , v2);<br><span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> value ;<br><span class="hljs-type">int</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> value ;<br>System.out.println(<span class="hljs-string">&quot;Primitive int :&quot;</span>);<br>System.out.println(<span class="hljs-string">&quot;%d==%d %b%n&quot;</span>, x, y, x == y);<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>test(<span class="hljs-number">127</span>);<br>test(<span class="hljs-number">128</span>);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="é€»è¾‘è¿ç®—ç¬¦"><a href="#é€»è¾‘è¿ç®—ç¬¦" class="headerlink" title="é€»è¾‘è¿ç®—ç¬¦"></a>é€»è¾‘è¿ç®—ç¬¦</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Bool</span> &#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">Random</span> <span class="hljs-variable">rnd</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Random</span>(<span class="hljs-number">47</span>);<br><span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> rnd.nextInt(<span class="hljs-number">100</span>);<br><span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> rnd.nextInt(<span class="hljs-number">100</span>);<br>System.out.println(<span class="hljs-string">&quot;i=&quot;</span>+i);<br>System.out.println(<span class="hljs-string">&quot;j=&quot;</span>+j);<br>System.out.println(<span class="hljs-string">&quot;i &gt; j is &quot;</span> + (i&gt;j) );<br>System.out.println(<span class="hljs-string">&quot;i &lt; j is &quot;</span> + (i&lt;j) );<br>System.out.println(<span class="hljs-string">&quot;i&gt;=j is &quot;</span> + (i&gt;=j) );<br>System.out.println(<span class="hljs-string">&quot;i&lt;=j is &quot;</span> + (i&lt;=j) );<br>System.out.println(<span class="hljs-string">&quot;i==j is &quot;</span> + (i==j) );<br>System.out.println(<span class="hljs-string">&quot;i!=j is &quot;</span> + (i!=j) );<br>System.out.println(<span class="hljs-string">&quot;i&lt;10 &amp;&amp; j&gt;10 is &quot;</span> + ((i&lt;<span class="hljs-number">10</span>) &amp;&amp; (j&gt;<span class="hljs-number">10</span>))  );<br>System.out.println(<span class="hljs-string">&quot;i&lt;10 || j&gt;10 is &quot;</span> + ((i&lt;<span class="hljs-number">10</span>) || (j&gt;<span class="hljs-number">10</span>))  );<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="çŸ­è·¯"><a href="#çŸ­è·¯" class="headerlink" title="çŸ­è·¯"></a>çŸ­è·¯</h2><p>å½“è¿›è¡Œé€»è¾‘è¿ç®—æ—¶ï¼Œä¸­é—´çš„æŸä¸ªæ¡ä»¶ä¸ºfalse, å°±ä¸ä¼šå†å»æ‰§è¡Œåç»­æ¡ä»¶çš„åˆ¤æ–­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShortCircuit</span> &#123;<br><span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">test1</span><span class="hljs-params">(<span class="hljs-type">int</span> val)</span>&#123;<br>System.out.println(<span class="hljs-string">&quot;test1(&quot;</span>+val+<span class="hljs-string">&quot;)&quot;</span>);<br>System.out.println(<span class="hljs-string">&quot;result: &quot;</span>+(val&lt;<span class="hljs-number">1</span>));<br><span class="hljs-keyword">return</span> val&lt;<span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">test2</span><span class="hljs-params">(<span class="hljs-type">int</span> val)</span>&#123;<br>System.out.println(<span class="hljs-string">&quot;test2(&quot;</span>+val+<span class="hljs-string">&quot;)&quot;</span>);<br>System.out.println(<span class="hljs-string">&quot;result: &quot;</span>+(val&lt;<span class="hljs-number">2</span>));<br><span class="hljs-keyword">return</span> val&lt;<span class="hljs-number">2</span>;<br>&#125;<br><span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">test3</span><span class="hljs-params">(<span class="hljs-type">int</span> val)</span>&#123;<br>System.out.println(<span class="hljs-string">&quot;test3(&quot;</span>+val+<span class="hljs-string">&quot;)&quot;</span>);<br>System.out.println(<span class="hljs-string">&quot;result: &quot;</span>+(val&lt;<span class="hljs-number">3</span>));<br><span class="hljs-keyword">return</span> val&lt;<span class="hljs-number">3</span>;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><span class="hljs-type">boolean</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> test1(<span class="hljs-number">0</span>) &amp;&amp; test2(<span class="hljs-number">2</span>) &amp;&amp; test3(<span class="hljs-number">2</span>);<br>System.out.println(<span class="hljs-string">&quot;expression is &quot;</span> + b);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å­—é¢å€¼"><a href="#å­—é¢å€¼" class="headerlink" title="å­—é¢å€¼"></a>å­—é¢å€¼</h2><p>å¯ä»¥é€šè¿‡ä¸€äº›å­—é¢å€¼æ¥è¡¨ç¤ºæŸäº›å¯¹è±¡çš„ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Literals</span> &#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">i1</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x2f</span>;  <span class="hljs-comment">//åå…­è¿›åˆ¶</span><br>System.out.println(<span class="hljs-string">&quot;i1 : &quot;</span>+Integer.toBinaryString(i1));<br><span class="hljs-type">int</span> <span class="hljs-variable">i2</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x2F</span>; <span class="hljs-comment">//åå…­è¿›åˆ¶</span><br>System.out.println(<span class="hljs-string">&quot;i2 : &quot;</span>+Integer.toBinaryString(i2));<br><span class="hljs-type">int</span> <span class="hljs-variable">i3</span> <span class="hljs-operator">=</span> <span class="hljs-number">0177</span>; <span class="hljs-comment">//å…«è¿›åˆ¶</span><br>System.out.println(<span class="hljs-string">&quot;i3 : &quot;</span>+Integer.toBinaryString(i3));<br><span class="hljs-type">char</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> <span class="hljs-number">0xffff</span>; <span class="hljs-comment">//åå…­è¿›åˆ¶</span><br>System.out.println(<span class="hljs-string">&quot;r : &quot;</span>+Integer.toBinaryString(r));<br><span class="hljs-type">byte</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x7f</span>; <span class="hljs-comment">//å…«è¿›åˆ¶</span><br>System.out.println(<span class="hljs-string">&quot;b : &quot;</span>+Integer.toBinaryString(b));<br><span class="hljs-type">short</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x7fff</span>; <span class="hljs-comment">//åå…­è¿›åˆ¶</span><br>System.out.println(<span class="hljs-string">&quot;s : &quot;</span>+Integer.toBinaryString(s));<br><span class="hljs-type">long</span> <span class="hljs-variable">n1</span> <span class="hljs-operator">=</span> <span class="hljs-number">200L</span>; <br><span class="hljs-type">long</span> <span class="hljs-variable">n2</span> <span class="hljs-operator">=</span> <span class="hljs-number">200l</span>;<br><span class="hljs-type">long</span> <span class="hljs-variable">n3</span> <span class="hljs-operator">=</span> <span class="hljs-number">200</span>;<br>System.out.println(<span class="hljs-string">&quot;n1 : &quot;</span>+Long.toBinaryString(n1));<br>System.out.println(<span class="hljs-string">&quot;n2 : &quot;</span>+Long.toBinaryString(n2));<br>System.out.println(<span class="hljs-string">&quot;n3 : &quot;</span>+Long.toBinaryString(n3));<br><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æŒ‰ä½è¿ç®—å’Œä½è¿ç®—"><a href="#æŒ‰ä½è¿ç®—å’Œä½è¿ç®—" class="headerlink" title="æŒ‰ä½è¿ç®—å’Œä½è¿ç®—"></a>æŒ‰ä½è¿ç®—å’Œä½è¿ç®—</h2><p>æŒ‰ä½è¿ç®—æ˜¯ä»¥äºŒè¿›åˆ¶å½¢å¼ï¼Œå¯¹æ¯ä¸€ä½è¿›è¡Œä¸æˆ–é</p><p>ä½è¿ç®—æ˜¯ç›´æ¥æ“ä½œå€¼çš„ä½ç§»è¿ç®—</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Literals</span> &#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">13</span>;<br><span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span> ;<br>System.out.println((i&amp;j));     <span class="hljs-comment">// ä¸   ä¸åŒè¾“å‡º0, ç›¸åŒè¾“å‡º1 æ‰€ä»¥è¾“å‡º0</span><br>System.out.println((i|j));     <span class="hljs-comment">// æˆ–   æœ‰1å–1  è¾“å‡º 15</span><br>System.out.println((i^j));     <span class="hljs-comment">// é   ä¸åŒè¾“å‡º1, ç›¸åŒè¾“å‡º0 æ‰€ä»¥è¾“å‡º15</span><br>System.out.println((j&lt;&lt;<span class="hljs-number">1</span>));    <span class="hljs-comment">// ä½è¿ç®—   å‘å·¦ç§»1ä½  å³ 01 -&gt; 10</span><br>System.out.println((j&gt;&gt;<span class="hljs-number">1</span>));    <span class="hljs-comment">// ä½è¿ç®—   å‘å³ç§»1ä½  å³ 10 -&gt; 01</span><br><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ä¸‰å…ƒè¿ç®—ç¬¦"><a href="#ä¸‰å…ƒè¿ç®—ç¬¦" class="headerlink" title="ä¸‰å…ƒè¿ç®—ç¬¦"></a>ä¸‰å…ƒè¿ç®—ç¬¦</h1><p>é€šè¿‡ä½¿ç”¨ ï¼Ÿ æ¥è¿›è¡Œåˆ¤æ–­çš„å¿«é€Ÿèµ‹å€¼ ã€‚ è¿™æ—¶è¦æ±‚  ä¸¤ä¸ªå€¼å¿…é¡»å­˜åœ¨è¿”å›å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span>  <span class="hljs-keyword">class</span> <span class="hljs-title class_">Literals</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span> &gt; <span class="hljs-number">3</span> ? <span class="hljs-number">4</span> : <span class="hljs-number">5</span>;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="æµç¨‹æ§åˆ¶"><a href="#æµç¨‹æ§åˆ¶" class="headerlink" title="æµç¨‹æ§åˆ¶"></a>æµç¨‹æ§åˆ¶</h1><h2 id="æ¡ä»¶åˆ¤æ–­è¯­å¥"><a href="#æ¡ä»¶åˆ¤æ–­è¯­å¥" class="headerlink" title="æ¡ä»¶åˆ¤æ–­è¯­å¥"></a>æ¡ä»¶åˆ¤æ–­è¯­å¥</h2><p>if <statement>â€¦ else æ ¹æ®æ¡ä»¶åˆ¤æ–­å†³å®šæ‰§è¡Œçš„æµ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span>  <span class="hljs-keyword">class</span> <span class="hljs-title class_">Literals</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span> ;<br><span class="hljs-keyword">if</span> (a==<span class="hljs-number">3</span>) &#123;<br>System.out.println(<span class="hljs-string">&quot;a is 3&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (a==<span class="hljs-number">4</span>) &#123;<br>System.out.println(<span class="hljs-string">&quot;a is 4&quot;</span>);<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br>System.out.println(<span class="hljs-string">&quot;a is not 3&quot;</span>);<br>&#125;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="è¿­ä»£è¯­å¥"><a href="#è¿­ä»£è¯­å¥" class="headerlink" title="è¿­ä»£è¯­å¥"></a>è¿­ä»£è¯­å¥</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span>  <span class="hljs-keyword">class</span> <span class="hljs-title class_">Literals</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> ;<br><br><span class="hljs-keyword">while</span>(a&gt;<span class="hljs-number">5</span>)&#123;<br>a++;<br>&#125;<br><span class="hljs-comment">// while å¾ªç¯ </span><br><span class="hljs-keyword">do</span> &#123;<br>a++;<br>&#125;<span class="hljs-keyword">while</span>(a&gt;<span class="hljs-number">5</span>);<br><span class="hljs-comment">// do while å¾ªç¯  ä»£ç å—è‡³å°‘ä¼šè¢«æ‰§è¡Œä¸€æ¬¡</span><br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;i&lt;<span class="hljs-number">5</span>;i++)&#123;<br>a++;<br>&#125;<br><span class="hljs-comment">// for å¾ªç¯ , forä¸­å…è®¸ä½¿ç”¨â€œ,â€ å®šä¹‰å¤šä¸ªå€¼</span><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨for â€¦ in æ¥è¿›è¡Œè¿­ä»£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span>  <span class="hljs-keyword">class</span> <span class="hljs-title class_">Literals</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">int</span>[] f = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>&#125;;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> a : f)&#123;<br>System.out.println(a);<br>&#125;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å¾ªç¯ä¸­çš„æ§åˆ¶ç¬¦"><a href="#å¾ªç¯ä¸­çš„æ§åˆ¶ç¬¦" class="headerlink" title="å¾ªç¯ä¸­çš„æ§åˆ¶ç¬¦"></a>å¾ªç¯ä¸­çš„æ§åˆ¶ç¬¦</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">break</span> <span class="hljs-comment">// è·³å‡ºå½“å‰å¾ªç¯</span><br><span class="hljs-keyword">continue</span> <span class="hljs-comment">// è·³è¿‡æœ¬æ¬¡å¾ªç¯çš„åç»­æ­¥éª¤ï¼Œç»§ç»­å¾ªç¯</span><br><span class="hljs-keyword">return</span> <span class="hljs-comment">// ä»å‡½æ•°ä¸­è¿”å›</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">somenum</span><span class="hljs-params">(<span class="hljs-type">int</span> a)</span>&#123;<br><span class="hljs-keyword">while</span> (a &lt; <span class="hljs-number">10</span>)&#123;<br><span class="hljs-keyword">if</span>(a ==<span class="hljs-number">6</span> )&#123;<br>a++;<br><span class="hljs-keyword">continue</span>;        <span class="hljs-comment">// è·³è¿‡åç»­æµç¨‹ï¼Œæ‰§è¡Œä¸‹ä¸€æ¬¡å¾ªç¯</span><br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(a == <span class="hljs-number">7</span>)&#123;<br>a++;<br><span class="hljs-keyword">break</span>;           <span class="hljs-comment">// è·³å‡ºå¾ªç¯</span><br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(a == <span class="hljs-number">8</span>)&#123;<br><span class="hljs-keyword">return</span> a ;       <span class="hljs-comment">//  ç›´æ¥è¿”å›</span><br>&#125;<br>a++;<br>&#125;<br><span class="hljs-keyword">return</span> a ;<br>&#125;<br><br><span class="hljs-comment">// å› ä¸ºå½“a==7æ—¶  aç»§ç»­è‡ªå¢äº† ä¹‹åbreak -&gt; return ã€‚æ‰€ä»¥æœ€åè¾“å‡º 8</span><br></code></pre></td></tr></table></figure><h2 id="swtich-å¤šæ¡ä»¶åˆ†æ”¯æ—¶å¯ä»¥ä½¿ç”¨switch"><a href="#swtich-å¤šæ¡ä»¶åˆ†æ”¯æ—¶å¯ä»¥ä½¿ç”¨switch" class="headerlink" title="swtich å¤šæ¡ä»¶åˆ†æ”¯æ—¶å¯ä»¥ä½¿ç”¨switch"></a>swtich å¤šæ¡ä»¶åˆ†æ”¯æ—¶å¯ä»¥ä½¿ç”¨switch</h2><p>ä¹Ÿå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²è¿›è¡Œåˆ†æ”¯é€‰æ‹©</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">somenum</span><span class="hljs-params">(<span class="hljs-type">int</span> a)</span>&#123;<br><span class="hljs-keyword">while</span> (a &lt;= <span class="hljs-number">10</span>)&#123;<br><span class="hljs-keyword">switch</span>(a)&#123;<br><span class="hljs-keyword">case</span> <span class="hljs-number">6</span> :<br>System.out.println(<span class="hljs-string">&quot;a is 6&quot;</span>);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">7</span> :<br>System.out.println(<span class="hljs-string">&quot;a is 7&quot;</span>);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">8</span> :<br>System.out.println(<span class="hljs-string">&quot;a is 8&quot;</span>);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">9</span> :<br>System.out.println(<span class="hljs-string">&quot;a is 9&quot;</span>);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">default</span> :<br>System.out.println(<span class="hljs-string">&quot;a is not 6,7,8,9&quot;</span>);<br><span class="hljs-keyword">break</span>;<br>&#125;<br>a++;<br>&#125;<br><span class="hljs-keyword">if</span> (a == <span class="hljs-number">10</span>)&#123;<br><span class="hljs-keyword">return</span> a ;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonç¼–ç¨‹ VIIII Webæ¡†æ¶ Flask</title>
    <link href="/2025/04/18/Python%E7%BC%96%E7%A8%8B-VIIII-Web%E6%A1%86%E6%9E%B6-Flask/"/>
    <url>/2025/04/18/Python%E7%BC%96%E7%A8%8B-VIIII-Web%E6%A1%86%E6%9E%B6-Flask/</url>
    
    <content type="html"><![CDATA[<p>è·Ÿç€Flaskæ–‡æ¡£ï¼Œç¼–å†™ä¸€ä¸ªåŸºäºFlaskçš„Web æœåŠ¡å™¨</p><h1 id="å¯åŠ¨Flask"><a href="#å¯åŠ¨Flask" class="headerlink" title="å¯åŠ¨Flask"></a>å¯åŠ¨Flask</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hello_world</span>():<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello,World&quot;</span><br></code></pre></td></tr></table></figure><p>æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> FLASK_APP=hello.py  <br>python -m flask run<br>ä½¿ flask æœåŠ¡å™¨å¼€å§‹è¿è¡Œ<br></code></pre></td></tr></table></figure><p>è¿™é‡Œä¸»è¦å®šä¹‰äº†ä¸€ä¸ªè·¯ç”±â€œ&#x2F;â€ å’Œ è°ƒç”¨æ–¹æ³•çš„å…³ç³»ã€‚å¯åŠ¨æœåŠ¡å™¨åå¯¹å¯¹åº”çš„è·¯å¾„è¿›è¡Œè®¿é—®</p><p>é€šè¿‡æŒ‡å®š â€”host&#x3D;0.0.0.0 å…è®¸æ“ä½œç³»ç»Ÿç›‘å¬æ‰€æœ‰å…¬å¼€IPçš„è¯·æ±‚</p><h2 id="è·¯ç”±ä¸­çš„å˜é‡å®šä¹‰"><a href="#è·¯ç”±ä¸­çš„å˜é‡å®šä¹‰" class="headerlink" title="è·¯ç”±ä¸­çš„å˜é‡å®šä¹‰"></a>è·¯ç”±ä¸­çš„å˜é‡å®šä¹‰</h2><table><thead><tr><th><code>string</code></th><th>ï¼ˆç¼ºçœå€¼ï¼‰ æ¥å—ä»»ä½•ä¸åŒ…å«æ–œæ çš„æ–‡æœ¬</th></tr></thead><tbody><tr><td><code>int</code></td><td>æ¥å—æ­£æ•´æ•°</td></tr><tr><td><code>float</code></td><td>æ¥å—æ­£æµ®ç‚¹æ•°</td></tr><tr><td><code>path</code></td><td>ç±»ä¼¼Â <code>string</code>Â ï¼Œä½†å¯ä»¥åŒ…å«æ–œæ </td></tr><tr><td><code>uuid</code></td><td>æ¥å— UUID å­—ç¬¦ä¸²</td></tr></tbody></table><h2 id="url-for"><a href="#url-for" class="headerlink" title="url_for()"></a>url_for()</h2><p>url_for å¯ä»¥é€šè¿‡å…·ä½“çš„å‡½æ•°åè¿”å›å…¶æ‰€å¯¹åº”çš„èµ„æºè·¯å¾„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/user/&lt;username&gt;&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">profile</span>(<span class="hljs-params">username</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#123;&#125;\&#x27;s profile&#x27;</span>.<span class="hljs-built_in">format</span>(escape(username))<br><span class="hljs-keyword">with</span> app.test_request_context():<br><span class="hljs-built_in">print</span>(url_for(<span class="hljs-string">&#x27;profile&#x27;</span>,username=<span class="hljs-string">&#x27;Codfish&#x27;</span>))  <span class="hljs-comment"># è¾“å‡º/user/codfish</span><br></code></pre></td></tr></table></figure><h2 id="å®šä¹‰httpè¯·æ±‚æ–¹æ³•å¯¹åº”çš„å¤„ç†"><a href="#å®šä¹‰httpè¯·æ±‚æ–¹æ³•å¯¹åº”çš„å¤„ç†" class="headerlink" title="å®šä¹‰httpè¯·æ±‚æ–¹æ³•å¯¹åº”çš„å¤„ç†"></a>å®šä¹‰httpè¯·æ±‚æ–¹æ³•å¯¹åº”çš„å¤„ç†</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> request<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/login&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        <span class="hljs-keyword">return</span> do_the_login()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> show_the_login_form()<br></code></pre></td></tr></table></figure><h2 id="é™æ€æ–‡ä»¶"><a href="#é™æ€æ–‡ä»¶" class="headerlink" title="é™æ€æ–‡ä»¶"></a>é™æ€æ–‡ä»¶</h2><p><strong><code>url_for(&#39;static&#39;, filename=&#39;style.css&#39;)</code></strong></p><p>é™æ€æ–‡ä»¶å’Œè·¯å¾„çš„æ˜ å°„</p><h2 id="æ¸²æŸ“æ¨¡æ¿"><a href="#æ¸²æŸ“æ¨¡æ¿" class="headerlink" title="æ¸²æŸ“æ¨¡æ¿"></a>æ¸²æŸ“æ¨¡æ¿</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> render_template<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/hello/&#x27;</span></span>)</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/hello/name&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hello</span>(<span class="hljs-params">name=<span class="hljs-literal">None</span></span>)<br><span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;hello.html&#x27;</span>,name=name)<br><br></code></pre></td></tr></table></figure><p>æ¨¡æ¿å¯ä»¥ç”¨æ¥ç›´æ¥å‘å…¶ä¸­å¡«å……è°ƒç”¨æ–¹æ³•ä¸­çš„å˜é‡ä¿¡æ¯ï¼Œæ¨¡æ¿ä¼šå¸®åŠ©è¿›è¡ŒåæœŸçš„æ›¿æ¢</p><h2 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flaskimport request<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/upload&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">upload_file</span>():<br><span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>f = request.files[<span class="hljs-string">&#x27;the_file&#x27;</span>]<br>f.save(<span class="hljs-string">&#x27;/var/www/uploads/uploaded_file.txt&#x27;</span>)<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¯´çš„æ˜¯æ¥æ”¶æ–‡ä»¶ä¸Šä¼ è¯·æ±‚å°†æ–‡ä»¶ä¿å­˜åˆ°æœåŠ¡å™¨ã€‚<br>f &#x3D; request.files[â€˜the_fileâ€™]  ä»è¯·æ±‚ä¸­è·å–æ–‡ä»¶ä¿¡æ¯</p><p>f.save(â€˜&#x2F;var&#x2F;www&#x2F;uploads&#x2F;uploaded_file.txtâ€™)  å°†æ–‡ä»¶ä¿å­˜åˆ°ç›®æ ‡è·¯å¾„</p><h2 id="è·å–Cookies"><a href="#è·å–Cookies" class="headerlink" title="è·å–Cookies"></a>è·å–Cookies</h2><p>requestä¸­å­˜åœ¨ä¸€ä¸ªå¯¹è±¡ç”¨æ¥å­˜å‚¨æ‰€æœ‰çš„cookies </p><p>è¿™é‡Œæ˜¯ è·å–åä¸ºusernameçš„cookiesä¿¡æ¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> request<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    username = request.cookies.get(<span class="hljs-string">&#x27;username&#x27;</span>)<br>    <span class="hljs-comment"># use cookies.get(key) instead of cookies[key] to not get a</span><br>    <span class="hljs-comment"># KeyError if the cookie is missing.</span><br></code></pre></td></tr></table></figure><p>å¯¹åº”çš„å‘å®¢æˆ·ç«¯è®¾ç½®cookie</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> make_response<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    resp = make_response(render_template(...))<br>    resp.set_cookie(<span class="hljs-string">&#x27;username&#x27;</span>, <span class="hljs-string">&#x27;the username&#x27;</span>)<br>    <span class="hljs-keyword">return</span> resp<br></code></pre></td></tr></table></figure><h2 id="ä½¿ç”¨é‡å®šå‘-ï¼Œè½¬ç§»åˆ°å¦ä¸€ä¸ªè·¯å¾„"><a href="#ä½¿ç”¨é‡å®šå‘-ï¼Œè½¬ç§»åˆ°å¦ä¸€ä¸ªè·¯å¾„" class="headerlink" title="ä½¿ç”¨é‡å®šå‘ ï¼Œè½¬ç§»åˆ°å¦ä¸€ä¸ªè·¯å¾„"></a>ä½¿ç”¨é‡å®šå‘ ï¼Œè½¬ç§»åˆ°å¦ä¸€ä¸ªè·¯å¾„</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> abort, redirect, url_for<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;login&#x27;</span>))<br></code></pre></td></tr></table></figure><h2 id="å°†ç”¨æˆ·è·³è½¬åˆ°é”™è¯¯é¡µé¢"><a href="#å°†ç”¨æˆ·è·³è½¬åˆ°é”™è¯¯é¡µé¢" class="headerlink" title="å°†ç”¨æˆ·è·³è½¬åˆ°é”™è¯¯é¡µé¢"></a>å°†ç”¨æˆ·è·³è½¬åˆ°é”™è¯¯é¡µé¢</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">abort(<span class="hljs-number">401</span>) <span class="hljs-comment"># è¿”å› 401 é”™è¯¯é¡µé¢</span><br><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> render_template<br><br><span class="hljs-meta">@app.errorhandler(<span class="hljs-params"><span class="hljs-number">404</span></span>) </span><span class="hljs-comment"># å®šåˆ¶å‡ºé”™é¡µé¢</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">page_not_found</span>(<span class="hljs-params">error</span>):<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;page_not_found.html&#x27;</span>), <span class="hljs-number">404</span>   <span class="hljs-comment"># æœ€åè¿”å›çš„æ˜¯çŠ¶æ€ç </span><br></code></pre></td></tr></table></figure><h2 id="è¿”å›"><a href="#è¿”å›" class="headerlink" title="è¿”å›"></a>è¿”å›</h2><p>æ”¯æŒå¤šç§è¿”å›ç±»å‹è‡ªåŠ¨è½¬æ¢</p><p>å“åº”å¯¹è±¡   â†’  ç›´æ¥è¿”å›</p><p>å­—ç¬¦ä¸² â†’ åŒ…è£…å­—ç¬¦ä¸²å’Œç¼ºçœå‚æ•° è¿”å›</p><p>å­—å…¸  â†’ ä½¿ç”¨jsonfyåˆ›å»ºä¸€ä¸ªè¿”å›å¯¹è±¡</p><p>å…ƒç»„ â†’ æ¥æ”¶ç±»å‹ä¸ºï¼ˆresponseï¼Œstatusï¼‰ (response,headers) ä»¥åŠï¼ˆresponse,status,headersï¼‰ç±»å‹çš„é¡¹ç›® ä¼šå°†ä¿¡æ¯ç»„è£…æˆæ–°çš„å“åº”</p><p>æˆ–è€…ä½¿ç”¨make_response() æ„å»ºå“åº”è¿”å›</p><p>æˆ–è€…  ç›´æ¥ è¿”å›json å­—æ®µ</p><h2 id="ä¼šè¯"><a href="#ä¼šè¯" class="headerlink" title="ä¼šè¯"></a>ä¼šè¯</h2><p>session å¯¹è±¡ç”¨äºå‚¨å­˜åŒç”¨æˆ·çš„å¤šä¸ªè¯·æ±‚çš„ä¿¡æ¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, session, redirect, url_for, escape, request<br><br>app = Flask(__name__)<br><br><span class="hljs-comment"># Set the secret key to some random bytes. Keep this really secret!</span><br>app.secret_key = <span class="hljs-string">b&#x27;_5#y2L&quot;F4Q8z\n\xec]/&#x27;</span>          <span class="hljs-comment">#ä½¿ç”¨å‰éœ€è¦è®¾ç½®å¯†é’¥</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;username&#x27;</span> <span class="hljs-keyword">in</span> session:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Logged in as %s&#x27;</span> % escape(session[<span class="hljs-string">&#x27;username&#x27;</span>])<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;You are not logged in&#x27;</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/login&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        session[<span class="hljs-string">&#x27;username&#x27;</span>] = request.form[<span class="hljs-string">&#x27;username&#x27;</span>]<br>        <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;index&#x27;</span>))<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">        &lt;form method=&quot;post&quot;&gt;</span><br><span class="hljs-string">            &lt;p&gt;&lt;input type=text name=username&gt;</span><br><span class="hljs-string">            &lt;p&gt;&lt;input type=submit value=Login&gt;</span><br><span class="hljs-string">        &lt;/form&gt;</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/logout&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">logout</span>():<br>    <span class="hljs-comment"># remove the username from the session if it&#x27;s there</span><br>    session.pop(<span class="hljs-string">&#x27;username&#x27;</span>, <span class="hljs-literal">None</span>)<br>    <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;index&#x27;</span>))<br></code></pre></td></tr></table></figure><h2 id="æ—¥å¿—æ‰“å°"><a href="#æ—¥å¿—æ‰“å°" class="headerlink" title="æ—¥å¿—æ‰“å°"></a>æ—¥å¿—æ‰“å°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">app.logger.debug(<span class="hljs-string">&#x27;A value for debugging&#x27;</span>)<br>app.logger.warning(<span class="hljs-string">&#x27;A warning occurred (%d apples)&#x27;</span>, <span class="hljs-number">42</span>)<br>app.logger.error(<span class="hljs-string">&#x27;An error occurred&#x27;</span>)<br></code></pre></td></tr></table></figure><p>Webåç«¯æ¡†æ¶çš„æ ¸å¿ƒåŠŸèƒ½åœ¨äº</p><p>HTTPè¯·æ±‚å¤„ç† - å°†è¯·æ±‚æ–‡æœ¬å¤„ç†ä¸ºè¯·æ±‚å¯¹è±¡</p><p>è·¯ç”±èµ„æº - åœ¨æ¡†æ¶ä¸­å®šä¹‰è·¯ç”±èµ„æºæ·»åŠ çš„æ–¹æ³•ï¼Œä»¥åŠå¦‚ä½•æ ¹æ®è¯·æ±‚æŸ¥æ‰¾åˆ°å¯¹åº”çš„è·¯å¾„</p><p>å“åº”æ„å»º - è¯·æ±‚ç»“æŸåçš„å“åº”æ˜¯å¦‚ä½•ç»„è£…çš„ï¼Œä»¥ä»€ä¹ˆå½¢å¼è¿”å›å“åº”</p><p>æ‰©å±•åŠŸèƒ½ - ä¸€äº›ååŠ©æ„å»ºæ•´ä¸ªæœåŠ¡çš„æ‰©å±•åŠŸèƒ½ï¼Œæ¯”å¦‚æ¨¡æ¿æ¸²æŸ“ï¼ŒåŠ¨æ€èµ„æºè·¯å¾„</p><h1 id="WSGI-ï¼ˆWeb-Server-Gateway-Interfaceï¼‰"><a href="#WSGI-ï¼ˆWeb-Server-Gateway-Interfaceï¼‰" class="headerlink" title="WSGI ï¼ˆWeb Server Gateway Interfaceï¼‰"></a>WSGI ï¼ˆWeb Server Gateway Interfaceï¼‰</h1><p>wsgi æ˜¯å®šä¹‰ web serverï¼ˆå¯ä»¥ç†è§£ä¸ºç«¯å£ç›‘å¬ï¼Œçº¿ç¨‹ç®¡ç†ï¼Œä»¥åŠsocketçš„éƒ¨åˆ†ï¼‰ å¦‚ä½•ä¸å®é™…åº”ç”¨ï¼ˆhttpè¯·æ±‚å¤„ç†ï¼ŒæŠ¥æ–‡å¤´åˆ†æç­‰å…·ä½“çš„å‡½æ•°å¤„ç†éƒ¨åˆ†ï¼‰äº¤äº’çš„æ¥å£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">application</span>(<span class="hljs-params">environ, start_response</span>):<br><span class="hljs-comment"># environ æ˜¯è¯·æ±‚çš„æ•°æ®ä¿¡æ¯, start_reponse æ˜¯webserver çš„å›è°ƒå‡½æ•°</span><br>...<br><span class="hljs-comment"># æ¥æ”¶åˆ°è¯·æ±‚ä½“åçš„åŠŸèƒ½å¤„ç†éƒ¨åˆ†</span><br><br>    <span class="hljs-comment"># è°ƒç”¨å›è°ƒå‡½æ•°ï¼Œå‘Šè¯‰æœåŠ¡å™¨å“åº”çš„çŠ¶æ€ç å’Œå¤´éƒ¨</span><br>    start_response(<span class="hljs-string">&quot;200 OK&quot;</span>, [(<span class="hljs-string">&quot;Content-Type&quot;</span>, <span class="hljs-string">&quot;text/plain&quot;</span>)])<br>    <br>    <span class="hljs-comment"># è¿”å›å“åº”ä½“ï¼ˆæ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼‰</span><br>    <span class="hljs-keyword">return</span> [<span class="hljs-string">b&quot;Hello, WSGI World!&quot;</span>]<br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œå®šä¹‰äº† web server éœ€è¦å°†è¯·æ±‚å†…å®¹ä»¥åŠä¸€ä¸ªç”¨äºå‘å…¶å†™å…¥çŠ¶æ€ç ä¿¡æ¯å’Œå“åº”å¤´çš„å›è°ƒå‡½æ•°ä¼ å…¥ã€‚åœ¨æ¥å£å†…éƒ¨éœ€è¦è¿›è¡Œè¯·æ±‚å¤„ç†ï¼Œå¤„ç†å®Œæ¯•åï¼Œè°ƒç”¨å›è°ƒå‡½æ•°å†™å…¥çŠ¶æ€ç å’Œå“åº”å¤´</p><p>æœ€ç»ˆå°†å“åº”ä½“é€šè¿‡return è¿”å›ã€‚</p><h2 id="Flask-çš„wsgiå®ç°"><a href="#Flask-çš„wsgiå®ç°" class="headerlink" title="Flask çš„wsgiå®ç°"></a>Flask çš„wsgiå®ç°</h2><p>flask å¯¹äºwsgiçš„å®ç°ä¸»è¦æœ‰3éƒ¨åˆ†</p><ol><li>å®šä¹‰äº†ä¸€ä¸ªè¯·æ±‚å¯¹è±¡<code>RequestContext</code>ï¼Œå°†è¯·æ±‚ä½“ä¸­çš„å†…å®¹å°è£…åˆ°å¯¹è±¡ä¸­ã€‚</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestContext</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, app, environ</span>):<br>        <span class="hljs-variable language_">self</span>.request = app.request_class(environ)   <span class="hljs-comment"># æ„é€  Request å¯¹è±¡</span><br>        <span class="hljs-variable language_">self</span>.session = app.open_session(<span class="hljs-variable language_">self</span>.request)<br>        <span class="hljs-variable language_">self</span>.app = app<br>        ...<br></code></pre></td></tr></table></figure><ol><li><p>å®šä¹‰äº†ä¸€ä¸ªä¸Šä¸‹æ–‡æ ˆï¼Œå°†è¯·æ±‚å¯¹è±¡å‹å…¥æ ˆä¸­</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> werkzeug.local <span class="hljs-keyword">import</span> LocalStack<br><br>_request_ctx_stack = LocalStack()<br><br></code></pre></td></tr></table></figure></li><li><p>å®šä¹‰äº†ä¸€ä¸ªä»£ç†å¯¹è±¡requestï¼Œä½¿flaskä¸å¿…çœŸæ­£çš„å°†RequestContext å¯¹è±¡ä¼ å…¥å‡½æ•°ï¼Œè€Œæ˜¯é€šè¿‡ä»£ç†è·å–å¤–éƒ¨çš„ä½œç”¨åŸŸæ¥æŸ¥è¯¢RequestContextä¸­çš„å±æ€§</p></li><li><p>æ„å»ºäº†app è¿™æ ·ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡æ¥å®ç°wsgiæ¥å£ï¼Œåº•å±‚æ˜¯é€šè¿‡wsgi_app å‡½æ•°æ¥å®Œæˆæ•´ä¸ªè¿‡ç¨‹çš„æ‰§è¡Œï¼Œappå¯¹è±¡æœ¬èº«æ˜¯ä¸ºäº†å­˜å‚¨ä¸€äº›ä¸­é—´çŠ¶æ€</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Flask</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">self, environ, start_response</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.wsgi_app(environ, start_response)<br></code></pre></td></tr></table></figure><h2 id="å®ç°ä¸€ä¸ªè½»é‡æ¡†æ¶"><a href="#å®ç°ä¸€ä¸ªè½»é‡æ¡†æ¶" class="headerlink" title="å®ç°ä¸€ä¸ªè½»é‡æ¡†æ¶"></a>å®ç°ä¸€ä¸ªè½»é‡æ¡†æ¶</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">from</span> wsgiref.simple_server <span class="hljs-keyword">import</span> make_server<br><span class="hljs-keyword">from</span> werkzeug.local <span class="hljs-keyword">import</span> LocalStack, LocalProxy<br><br><span class="hljs-comment"># === ä¸Šä¸‹æ–‡æ ˆ ===</span><br>_request_ctx_stack = LocalStack()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_lookup_request</span>():<br>    top = _request_ctx_stack.top<br>    <span class="hljs-keyword">if</span> top <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">raise</span> RuntimeError(<span class="hljs-string">&quot;No request context&quot;</span>)<br>    <span class="hljs-keyword">return</span> top[<span class="hljs-string">&#x27;request&#x27;</span>]<br><br><span class="hljs-comment"># å…¨å±€ä»£ç†å˜é‡</span><br>request = LocalProxy(_lookup_request)<br><br><span class="hljs-comment"># === Request å’Œ Response å°è£… ===</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Request</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, environ</span>):<br>        <span class="hljs-variable language_">self</span>.method = environ[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>]<br>        <span class="hljs-variable language_">self</span>.path = environ[<span class="hljs-string">&#x27;PATH_INFO&#x27;</span>]<br>        <span class="hljs-variable language_">self</span>.environ = environ<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Response</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, body, status=<span class="hljs-string">&quot;200 OK&quot;</span>, headers=<span class="hljs-literal">None</span></span>):<br>        <span class="hljs-variable language_">self</span>.body = [body.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)]<br>        <span class="hljs-variable language_">self</span>.status = status<br>        <span class="hljs-variable language_">self</span>.headers = headers <span class="hljs-keyword">or</span> [(<span class="hljs-string">&quot;Content-Type&quot;</span>, <span class="hljs-string">&quot;text/html&quot;</span>)]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">self, environ, start_response</span>):<br>        start_response(<span class="hljs-variable language_">self</span>.status, <span class="hljs-variable language_">self</span>.headers)<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.body<br><br><span class="hljs-comment"># === Flask Mini æ¡†æ¶æ ¸å¿ƒ ===</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MiniFlask</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.routes = &#123;&#125;<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">route</span>(<span class="hljs-params">self, path</span>):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">decorator</span>(<span class="hljs-params">f</span>):<br>            <span class="hljs-variable language_">self</span>.routes[path] = f<br>            <span class="hljs-keyword">return</span> f<br>        <span class="hljs-keyword">return</span> decorator<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wsgi_app</span>(<span class="hljs-params">self, environ, start_response</span>):<br>        <span class="hljs-comment"># æ„é€  request ä¸Šä¸‹æ–‡å¹¶å‹å…¥æ ˆ</span><br>        req = Request(environ)<br>        _request_ctx_stack.push(&#123;<span class="hljs-string">&#x27;request&#x27;</span>: req&#125;)<br>        <span class="hljs-keyword">try</span>:<br>            handler = <span class="hljs-variable language_">self</span>.routes.get(req.path)<br>            <span class="hljs-keyword">if</span> handler <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>                <span class="hljs-keyword">return</span> Response(<span class="hljs-string">&quot;404 Not Found&quot;</span>, <span class="hljs-string">&quot;404 NOT FOUND&quot;</span>)(<br>                    environ, start_response<br>                )<br>            result = handler()<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(result, Response):<br>                <span class="hljs-keyword">return</span> result(environ, start_response)<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">return</span> Response(<span class="hljs-built_in">str</span>(result))(environ, start_response)<br>        <span class="hljs-keyword">finally</span>:<br>            _request_ctx_stack.pop()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">self, environ, start_response</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.wsgi_app(environ, start_response)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, host=<span class="hljs-string">&quot;127.0.0.1&quot;</span>, port=<span class="hljs-number">5000</span></span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Running on http://<span class="hljs-subst">&#123;host&#125;</span>:<span class="hljs-subst">&#123;port&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">with</span> make_server(host, port, <span class="hljs-variable language_">self</span>) <span class="hljs-keyword">as</span> httpd:<br>            httpd.serve_forever()<br><br><span class="hljs-comment"># === ç¤ºä¾‹ä½¿ç”¨ ===</span><br>app = MiniFlask()<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;Hello, your method is <span class="hljs-subst">&#123;request.method&#125;</span>&quot;</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/hi&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hi</span>():<br>    <span class="hljs-keyword">return</span> Response(<span class="hljs-string">&quot;&lt;h1&gt;Hi there!&lt;/h1&gt;&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run()<br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œé¢å®ç°äº†æˆ‘ä»¬ä¸Šè¿°çš„å‡ ä¸ªå…³é”®ç‚¹</p><ol><li>å®šä¹‰äº† å¯¹httpè¯·æ±‚çš„å°è£…</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Request</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, environ</span>):<br>        <span class="hljs-variable language_">self</span>.method = environ[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>]<br>        <span class="hljs-variable language_">self</span>.path = environ[<span class="hljs-string">&#x27;PATH_INFO&#x27;</span>]<br>        <span class="hljs-variable language_">self</span>.environ = environ<br></code></pre></td></tr></table></figure><ol><li>å®šä¹‰äº†ä¸€ä¸ªä¸Šä¸‹æ–‡æ ˆï¼Œåœ¨æ¶ˆæ¯åˆ°è¾¾æ—¶ï¼Œå°†è¯·æ±‚å­˜å‚¨ä¸Šä¸‹æ–‡æ ˆï¼Œå“åº”åå°†è¯·æ±‚å¼¹å‡º</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">_request_ctx_stack = LocalStack()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_lookup_request</span>():<br>    top = _request_ctx_stack.top<br>    <span class="hljs-keyword">if</span> top <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">raise</span> RuntimeError(<span class="hljs-string">&quot;No request context&quot;</span>)<br>    <span class="hljs-keyword">return</span> top[<span class="hljs-string">&#x27;request&#x27;</span>]<br><br></code></pre></td></tr></table></figure><ol><li>ä¸€ä¸ªå¯¹äºä¸Šä¸‹æ–‡æ ˆä¸­è¯·æ±‚çš„ä»£ç†</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">request = LocalProxy(_lookup_request)<br></code></pre></td></tr></table></figure><ol><li>å®ç° wsgiæ¥å£ï¼Œæ¥æ”¶è¯·æ±‚ç¯å¢ƒä¿¡æ¯å’Œå›è°ƒå‡½æ•°ï¼Œè¿”å›æœ€ç»ˆçš„å“åº”ä½“</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">wsgi_app</span>(<span class="hljs-params">self, environ, start_response</span>):<br>    <span class="hljs-comment"># æ„é€  request ä¸Šä¸‹æ–‡å¹¶å‹å…¥æ ˆ</span><br>    req = Request(environ)<br>    _request_ctx_stack.push(&#123;<span class="hljs-string">&#x27;request&#x27;</span>: req&#125;)<br>    <span class="hljs-keyword">try</span>:<br>        handler = <span class="hljs-variable language_">self</span>.routes.get(req.path)<br>        <span class="hljs-keyword">if</span> handler <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">return</span> Response(<span class="hljs-string">&quot;404 Not Found&quot;</span>, <span class="hljs-string">&quot;404 NOT FOUND&quot;</span>)(<br>                environ, start_response<br>            )<br>        result = handler()<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(result, Response):<br>            <span class="hljs-keyword">return</span> result(environ, start_response)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> Response(<span class="hljs-built_in">str</span>(result))(environ, start_response)<br>    <span class="hljs-keyword">finally</span>:<br>        _request_ctx_stack.pop()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonç¼–ç¨‹ VIII HTTPæœåŠ¡</title>
    <link href="/2025/04/17/Python%E7%BC%96%E7%A8%8B-VIII-HTTP%E6%9C%8D%E5%8A%A1/"/>
    <url>/2025/04/17/Python%E7%BC%96%E7%A8%8B-VIII-HTTP%E6%9C%8D%E5%8A%A1/</url>
    
    <content type="html"><![CDATA[<h1 id="ç½‘ç»œä¸åº”ç”¨å±‚"><a href="#ç½‘ç»œä¸åº”ç”¨å±‚" class="headerlink" title="ç½‘ç»œä¸åº”ç”¨å±‚"></a>ç½‘ç»œä¸åº”ç”¨å±‚</h1><p>ä»æœåŠ¡å¤„ç†çš„è§’åº¦æ¥çœ‹ï¼Œç½‘ç»œçš„æ ¸å¿ƒç›®çš„åœ¨äº<strong>é€šè¿‡åè®®æ§åˆ¶ï¼Œå®ç°è¯·æ±‚ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´æ•°æ®çš„å®Œæ•´äº¤äº’</strong>ã€‚</p><p>å¯¹è¯·æ±‚ç«¯å’ŒæœåŠ¡ç«¯è€Œè¨€ï¼Œä¸­é—´å±‚çš„æŠ¥æ–‡å°è£…ã€è½¬å‘ã€è·¯ç”±ç­‰è¡Œä¸ºæ˜¯ä¸å¯æ„ŸçŸ¥çš„ã€‚<strong>ç½‘ç»œå±‚å’Œä¼ è¾“å±‚å…±åŒæ„å»ºäº†ä¸€ä¸ªæŠ½è±¡çš„â€œä¸€è‡´äº¤äº’ç¯å¢ƒâ€</strong>ï¼Œä½¿å¾—è¿œç«¯ä¼ è¾“çš„æ•°æ®èƒ½å¤Ÿè¢«â€œåŸå°ä¸åŠ¨åœ°â€æ¥æ”¶å¹¶å­˜å‚¨åˆ°æœ¬åœ°ç¼“å­˜ï¼Œä¾›åº”ç”¨é€»è¾‘å¤„ç†ã€‚</p><p>æ­£å› ä¸ºä¸­é—´ç½‘ç»œçš„ä¸å¯è§æ€§ä¸â€œç©¿é€æ€§â€ï¼Œç½‘ç»œå±‚ä¸ä¼ è¾“å±‚çš„åè®®è®¾è®¡æ›´å¼ºè°ƒ<strong>é€šç”¨æ€§ä¸å¯é æ€§</strong>ã€‚å®ƒä»¬çš„å…³æ³¨ç‚¹åœ¨äºæ•°æ®çš„å¯é ä¼ é€’ä¸é¡ºåºæ§åˆ¶ï¼Œè€Œä¸æ˜¯æ•°æ®çš„å…·ä½“å†…å®¹ï¼Œå› æ­¤åè®®ç»“æ„é€šå¸¸å…·æœ‰<strong>ä¸¥æ ¼çš„å¤´éƒ¨æ ¼å¼ä¸å­—æ®µå®šä¹‰</strong>ï¼Œä»¥ä¿è¯è®¾å¤‡é—´çš„äº’é€šä¸åè®®çš„ä¸€è‡´æ€§ã€‚</p><p>ç›¸è¾ƒä¹‹ä¸‹ï¼Œ<strong>åº”ç”¨å±‚åè®®æ›´å…³æ³¨çš„æ˜¯â€œå¦‚ä½•å¤„ç†æ•°æ®â€</strong>ã€‚å®ƒæ‰€éœ€è€ƒè™‘çš„ï¼Œæ˜¯æœåŠ¡éœ€è¦å“ªäº›è¾“å…¥å­—æ®µã€è¾“å‡ºä»¥ä½•ç§æ ¼å¼è¡¨è¾¾ã€‚å› è€Œï¼Œåº”ç”¨å±‚åè®®å…·å¤‡æ›´å¼ºçš„<strong>çµæ´»æ€§ä¸è¯­ä¹‰æ‰©å±•æ€§</strong>ï¼Œæ ¸å¿ƒæ˜¯å›´ç»•å­—æ®µçš„<strong>å®šä¹‰ã€è§£æä¸ä¸šåŠ¡æ˜ å°„</strong>ï¼Œå®ŒæˆæœåŠ¡ç«¯ä¸è¯·æ±‚ç«¯çš„è¯­ä¹‰ååŒã€‚</p><p>ç½‘ç»œå±‚å’Œä¼ è¾“å±‚åè®®é€šå¸¸å¼ºè°ƒ<strong>å­—æ®µçš„æ§åˆ¶æ„ä¹‰å’ŒçŠ¶æ€ç®¡ç†åŠŸèƒ½</strong>ï¼Œä¾‹å¦‚é€šè¿‡è®¾ç½®ç‰¹å®šä½ï¼ˆå¦‚ TCP çš„ SYNã€ACKã€FINï¼‰æ¥æ ‡è¯†è¿æ¥çŠ¶æ€æˆ–æ•°æ®ä¼ è¾“çš„é˜¶æ®µï¼Œä»¥åŠé€šè¿‡ IP å±‚çš„ TTLã€æ ‡å¿—ä½ç­‰æ§åˆ¶æŠ¥æ–‡çš„è½¬å‘è¡Œä¸ºã€‚</p><p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œåº”ç”¨å±‚åè®®æ›´å¼ºè°ƒ<strong>å­—æ®µçš„è¯­ä¹‰æè¿°æ€§</strong>ï¼Œå³å­—æ®µç”¨äºè¡¨è¾¾è¯·æ±‚çš„æ“ä½œç±»å‹ã€å‚æ•°å†…å®¹æˆ–æ ¼å¼è¦æ±‚ï¼Œå…·ä½“çš„çŠ¶æ€ï¼ˆå¦‚ä¼šè¯æ˜¯å¦æœ‰æ•ˆã€ç™»å½•æ˜¯å¦æˆåŠŸï¼‰é€šå¸¸ç”±å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯é€šè¿‡å„è‡ªçš„é€»è¾‘æ¥ç»´æŠ¤ã€‚åº”ç”¨å±‚å­—æ®µæœ¬èº«é€šå¸¸<strong>ä¸ç»´æŠ¤ä¼ è¾“çŠ¶æ€</strong>ï¼Œè€Œæ˜¯ä½œä¸ºè§¦å‘çŠ¶æ€å˜åŒ–æˆ–çŠ¶æ€æ ¡éªŒçš„ä¾æ®ã€‚</p><h1 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h1><h2 id="HTTPåè®®æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#HTTPåè®®æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="HTTPåè®®æ˜¯ä»€ä¹ˆï¼Ÿ"></a>HTTPåè®®æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>HTTP æ˜¯ä¸€ç§åŸºäºè¯·æ±‚-å“åº”æ¨¡å¼çš„åº”ç”¨å±‚åè®®ï¼Œå®¢æˆ·ç«¯é€šè¿‡æ„å»ºç»“æ„åŒ–çš„è¯·æ±‚æŠ¥æ–‡ï¼ˆåŒ…æ‹¬è¯·æ±‚æ–¹æ³•ã€èµ„æºè·¯å¾„ã€è¯·æ±‚å¤´å’Œå¯é€‰çš„è¯·æ±‚ä½“ï¼‰æ¥æè¿°å…¶è®¿é—®æ„å›¾ï¼ŒæœåŠ¡ç«¯æ ¹æ®è¿™äº›ä¿¡æ¯è¿›è¡Œè§£æã€è·¯ç”±ã€å¤„ç†ï¼Œå¹¶ç”Ÿæˆç»“æ„åŒ–çš„å“åº”è¿”å›ã€‚</p><h2 id="è¯·æ±‚"><a href="#è¯·æ±‚" class="headerlink" title="è¯·æ±‚"></a>è¯·æ±‚</h2><p>HTTPè¯·æ±‚åŒ…å«ä¸‰éƒ¨åˆ†</p><p>1.è¯·æ±‚è¡Œï¼šè¯´æ˜è¯·æ±‚ç±»å‹ï¼ˆGETã€POST ç­‰ï¼‰ã€èµ„æºè·¯å¾„å’Œåè®®ç‰ˆæœ¬ã€‚</p><p>è¯·æ±‚è¡Œæè¿°äº† è¯·æ±‚çš„èµ„æºå¯¹è±¡ï¼Œä»¥åŠè¯·æ±‚çš„æ–¹æ³•ã€‚</p><p>2.è¯·æ±‚å¤´ï¼šæºå¸¦å®¢æˆ·ç«¯ç¯å¢ƒã€è¯·æ±‚æ„å›¾ã€èº«ä»½éªŒè¯ã€ç¼“å­˜è§„åˆ™ç­‰å…ƒæ•°æ®ã€‚</p><p>è¯·æ±‚å¤´æè¿°äº†ä¸€äº›äº¤äº’çš„æ§åˆ¶ä¿¡æ¯ï¼Œ</p><p>3.è¯·æ±‚ä½“ï¼ˆå¯é€‰ï¼‰ï¼šä¾‹å¦‚ POST è¯·æ±‚ä¸­å‘é€çš„æ•°æ®ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html">è¯·æ±‚ç¤ºä¾‹<br><br>GET /index.html HTTP/1.1<br>Host: [www.example.com](http://www.example.com/)<br>User-Agent: MyBrowser/2.0<br>Connection: keep-alive<br>Accept: text/html<br></code></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html">å“åº”ç¤ºä¾‹ <br><br>HTTP/1.1 200 OK<br>Content-Type: text/html<br>Content-Length: 75<br>Cache-Control: max-age=3600<br>Connection: keep-alive<br><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello, HTTP/1.1!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>Pythonçš„HTTPå®ç°ç¤ºä¾‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> socket<br><br>HOST = <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>   <span class="hljs-comment"># ç›‘å¬æ‰€æœ‰åœ°å€</span><br>PORT = <span class="hljs-number">4623</span>       <span class="hljs-comment"># ç›‘å¬ç«¯å£</span><br>PATH_ROUTE = &#123;&#125;<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">path_add</span>(<span class="hljs-params">path_name</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wapper</span>(<span class="hljs-params">func</span>) :<br>        PATH_ROUTE[path_name] = func<br>    <span class="hljs-keyword">return</span> wapper<br><br><span class="hljs-meta">@path_add(<span class="hljs-params"><span class="hljs-string">&quot;/home&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_home_method</span>(<span class="hljs-params">conn</span>):<br>    response_body = <span class="hljs-string">&quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello, World! Here is home page&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span><br>    response = (<br>        <span class="hljs-string">&quot;HTTP/1.1 200 OK\r\n&quot;</span><br>        <span class="hljs-string">f&quot;Content-Length: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(response_body.encode())&#125;</span>\r\n&quot;</span><br>        <span class="hljs-string">&quot;Content-Type: text/html\r\n&quot;</span><br>        <span class="hljs-string">&quot;Connection: close\r\n&quot;</span><br>        <span class="hljs-string">&quot;\r\n&quot;</span><br>        <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;response_body&#125;</span>&quot;</span><br>    )<br><br>    conn.sendall(response.encode())<br>    conn.close()<br><br><span class="hljs-meta">@path_add(<span class="hljs-params"><span class="hljs-string">&quot;/index&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_index_method</span>(<span class="hljs-params">conn</span>):<br>    response_body = <span class="hljs-string">&quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello, World! Here is index page&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span><br>    response = (<br>        <span class="hljs-string">&quot;HTTP/1.1 200 OK\r\n&quot;</span><br>        <span class="hljs-string">f&quot;Content-Length: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(response_body.encode())&#125;</span>\r\n&quot;</span><br>        <span class="hljs-string">&quot;Content-Type: text/html\r\n&quot;</span><br>        <span class="hljs-string">&quot;Connection: close\r\n&quot;</span><br>        <span class="hljs-string">&quot;\r\n&quot;</span><br>        <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;response_body&#125;</span>&quot;</span><br>    )<br><br>    conn.sendall(response.encode())<br>    conn.close()<br><br><span class="hljs-comment"># åˆ›å»º socket</span><br>server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>server_socket.bind((HOST, PORT))<br>server_socket.listen(<span class="hljs-number">5</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;HTTP Server running at http://<span class="hljs-subst">&#123;HOST&#125;</span>:<span class="hljs-subst">&#123;PORT&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    client_conn, client_addr = server_socket.accept()<br>    request = client_conn.recv(<span class="hljs-number">1024</span>).decode()<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n----- Received request from <span class="hljs-subst">&#123;client_addr&#125;</span> -----&quot;</span>)<br>    <span class="hljs-built_in">print</span>(request.strip())<br>    <br>    content = request.splitlines()<br>    method,path,protocol = content[<span class="hljs-number">0</span>].split(<span class="hljs-string">&quot; &quot;</span>)<br>    rout_name = path.split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">if</span> rout_name <span class="hljs-keyword">in</span> PATH_ROUTE :<br>        PATH_ROUTE[rout_name]()<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">else</span> :<br><br>        <span class="hljs-comment"># æ„é€  HTTP å“åº”å†…å®¹</span><br>        response_body = <span class="hljs-string">&quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello, World!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span><br>        response = (<br>            <span class="hljs-string">&quot;HTTP/1.1 200 OK\r\n&quot;</span><br>            <span class="hljs-string">f&quot;Content-Length: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(response_body.encode())&#125;</span>\r\n&quot;</span><br>            <span class="hljs-string">&quot;Content-Type: text/html\r\n&quot;</span><br>            <span class="hljs-string">&quot;Connection: close\r\n&quot;</span><br>            <span class="hljs-string">&quot;\r\n&quot;</span><br>            <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;response_body&#125;</span>&quot;</span><br>        )<br><br>        client_conn.sendall(response.encode())<br>        client_conn.close()<br><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° å…¶å·¥ä½œæµç¨‹ï¼š</p><ol><li>åˆ›å»ºTCP æœåŠ¡å™¨ï¼Œç»‘å®šç½‘å¡åœ°å€å’Œç«¯å£åœ°å€</li></ol><p>2.å¼€å§‹ç›‘å¬å¤–éƒ¨è¯·æ±‚</p><p>3.å®šä¹‰å¾ªç¯æ¥å¤„ç†æ¥æ”¶åˆ°çš„æ¶ˆæ¯</p><p>4.æ¥æ”¶åˆ°çš„httpè¯·æ±‚è¢«å¤„ç†æˆå­—ç¬¦ä¸² è¯·æ±‚å¤´ä¸€èˆ¬åŒ…å« æ–¹æ³•ï¼Œè·¯å¾„ï¼Œåè®®ç‰ˆæœ¬ å’Œä¸€äº›å¤´æ§åˆ¶ä¿¡æ¯</p><ol start="5"><li>å¯ä»¥é€šè¿‡è¯·æ±‚å¤´è§£æå‡ºå¯¹åº”çš„è·¯å¾„ï¼Œè¿™é‡Œè®¾è®¡äº†ä¸€ä¸ªè£…é¥°å™¨ï¼Œå°†è¢«è£…é¥°çš„å‡½æ•°æ·»åŠ åˆ°æ•´ä½“çš„è·¯ç”±å­—å…¸ä¸­ï¼Œå½“è¯·æ±‚å¤´ä¸­çš„å­—æ®µå­˜åœ¨äºå­—å…¸ä¸­æ—¶æ‰§è¡Œå¯¹åº”çš„å‡½æ•°ï¼Œå¦åˆ™æ‰§è¡Œé»˜è®¤å‡½æ•°ã€‚é»˜è®¤å‡½æ•°ä¼šå°†é»˜è®¤çš„å“åº”å¤´å’ŒHTMLå­—æ®µï¼Œå¯¹httpè¯·æ±‚åšå‡ºå“åº”ã€‚</li></ol><p>æ•´ä½“ä¸ŠHTTPçš„å·¥ä½œæµç¨‹æ˜¯ ï¼š</p><p>æœåŠ¡å™¨ç›‘å¬â†’ æœåŠ¡ç«¯å‘èµ·è¯·æ±‚â†’ æœåŠ¡ç«¯åˆ†ææ–‡æœ¬ä¿¡æ¯ï¼Œè·¯ç”±åˆ°è¯·æ±‚çš„ç›®æ ‡èµ„æºï¼Œæ‰§è¡Œå¯¹åº”çš„å‡½æ•°ï¼Œå°†æ•°æ®è¿”å›ç»™è¯·æ±‚ç«¯ï¼Œå…³é—­socketã€‚</p><h1 id=""><a href="#" class="headerlink" title=""></a></h1>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonç¼–ç¨‹ VII ç½‘ç»œç¼–ç¨‹</title>
    <link href="/2025/04/17/Python%E7%BC%96%E7%A8%8B-VII-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/"/>
    <url>/2025/04/17/Python%E7%BC%96%E7%A8%8B-VII-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯ç½‘ç»œï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ç½‘ç»œï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ç½‘ç»œï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ç½‘ç»œï¼Ÿ</h1><p>æ˜¯OSIçš„7å±‚æ¨¡å‹ï¼Ÿ è¿˜æ˜¯TCP&#x2F;IP åè®®ç°‡ï¼Ÿwifi&#x2F;ç§»åŠ¨é€šä¿¡çš„ç©ºå£äº’è”ï¼Ÿ åˆæˆ–è€…æ˜¯å†…æ ¸è¿›ç¨‹çš„è™šæ‹Ÿæ•°æ®è½¬å‘ï¼Ÿ</p><ul><li>ç½‘ç»œçš„æœ¬è´¨åŸºäºé¢„å®šä¹‰çš„é€šä¿¡åè®®é€šè¿‡ç‰©ç†ä»‹è´¨ï¼ˆæˆ–è™šæ‹Ÿç‰©ç†ä»‹è´¨å¦‚è™šæ‹Ÿç«¯å£ï¼Œè™šæ‹Ÿmacåœ°å€ï¼‰åœ¨è®¾å¤‡é—´è¿›è¡Œæ•°æ®ä¼ è¾“çš„ä¸€ç§ç»„ç»‡ç»“æ„ã€‚<ul><li>ç½‘ç»œæ˜¯â€œæœ‰å±‚æ¬¡â€çš„ï¼Œæ— è®ºæ˜¯å›ºç½‘é€šä¿¡è¿˜æ˜¯ç©ºå£é€šä¿¡ã€‚æ•°æ®åŒ…çš„ä¼ è¾“éƒ½åœ¨è¿›è¡Œä¸€ä¸ªâ€œå°è£…-è§£å°è£…â€çš„è¿‡ç¨‹</li><li>ç½‘ç»œæ˜¯â€œåŠ¨æ€â€çš„ï¼Œç«¯åˆ°ç«¯çš„ç½‘ç»œé€šä¿¡ï¼Œéœ€è¦ç½‘å¡æŒç»­ç›‘å¬å¤–éƒ¨ç½‘ç»œæ¥æ”¶åˆ°çš„æ•°æ®åŒ…ï¼Œå¹¶é€šè¿‡ä¸­æ–­è§¦å‘å†…æ ¸æ¥å¯¹æ•°æ®åŒ…è¿›è¡Œå¤„ç†</li></ul></li></ul><h1 id="TCP-IPåè®®æ ˆ"><a href="#TCP-IPåè®®æ ˆ" class="headerlink" title="TCP&#x2F;IPåè®®æ ˆ"></a>TCP&#x2F;IPåè®®æ ˆ</h1><p>åœ¨å…¶ä»–çš„ç½‘ç»œå†…å®¹ä¼šå…·ä½“ä»‹ç»ç½‘ç»œçš„è½¬å‘å’Œä¼ è¾“ã€‚è¿™é‡Œåªæ˜¯ç®€å•è®²è§£ä¸‹TCP&#x2F;IP åè®®</p><p>ç½‘ç»œæ˜¯ä¸€ç§åŸºäºå¤šå±‚é€šä¿¡çš„æ•°æ®ä¼ è¾“æ¨¡å¼</p><p>ç½‘ç»œæ¨¡å‹ä¸€å¼€å§‹ç”±OSI é¢„å…ˆå®šä¹‰ å³7å±‚ç½‘ç»œç»“æ„ ï¼š</p><p>ç‰©ç†å±‚ï¼š                                                   æ¯”ç‰¹æµçš„ä¼ è¾“ã€ç”µæ°”ç‰¹æ€§ã€æœºæ¢°ç‰¹æ€§</p><p>æ•°æ®é“¾è·¯å±‚ï¼š                                          å°†æ¯”ç‰¹ç‡è½¬æ¢ä¸ºç‰©ç†ä¿¡å·ã€‚å¹¶è¿›è¡ŒåŸºç¡€çš„ç½‘ç»œè®¾å¤‡æ§åˆ¶</p><p>ç½‘ç»œå±‚ï¼š                                                   æä¾›æ•°æ®çš„è½¬å‘ï¼Œå¯»å€ã€‚ä»¥åŠåŸºç¡€çš„ç½‘ç»œè´¨é‡æ£€æµ‹</p><p>ä¼ è¾“å±‚ï¼š                                                   å°è£…ï¼Œæ‰¿è½½æ•°æ®ã€‚ä¸å¯¹ç«¯è®¾å¤‡å»ºç«‹è¿æ¥é€šé“ã€‚è¿›è¡Œæ•°æ®ä¼ è¾“</p><p>ä¼šè¯å±‚ï¼š                                                   ç®¡ç†ä¼šè¯è¿æ¥çš„å»ºç«‹ã€ç»´æŠ¤å’Œç»ˆæ­¢</p><p>è¡¨ç¤ºå±‚ï¼š                                                   å¤„ç†æ•°æ®æ ¼å¼è½¬æ¢ã€åŠ å¯†è§£å¯†ã€å‹ç¼©è§£å‹ç¼©</p><p>åº”ç”¨å±‚ï¼š                                                   è®¾è®¡åº”ç”¨æ•°æ®ç»“æ„å¦‚ä½•åœ¨è®¾å¤‡é—´è¿›è¡Œè¿æ¥ï¼Œå¤„ç†ï¼Œè§£æ                                                </p><p>åœ¨å®ç°å±‚é¢ä¸Šåº”ç”¨è¾ƒå¤šçš„æ˜¯TCP&#x2F;IPåè®®æ ˆï¼Œè®¾è®¡äº†4å±‚ç½‘ç»œç»“æ„ ï¼š</p><p>é“¾è·¯å±‚ï¼š                                                   æ•°æ®åˆ°ä»‹è´¨çš„è½¬æ¢ï¼Œé€šå¸¸ç”±ç½‘å¡ç­‰ç¡¬ä»¶è¿›è¡Œã€‚</p><p>ç½‘ç»œå±‚ï¼š                                                   è¿›è¡Œæ•°æ®çš„è½¬å‘ï¼Œå¯»å€ã€‚ä»¥åŠåŸºç¡€çš„ç½‘ç»œè´¨é‡æ£€æµ‹</p><p>ä¼ è¾“å±‚ï¼š                                                   å°è£…ï¼Œæ‰¿è½½æ•°æ®ã€‚ä¸å¯¹ç«¯å»ºç«‹è¿æ¥ã€‚è¿›è¡Œæ•°æ®ä¼ è¾“</p><p>åº”ç”¨å±‚ï¼š                                                   è®¾è®¡åº”ç”¨æ•°æ®ç»“æ„å¦‚ä½•åœ¨è®¾å¤‡é—´è¿›è¡Œè¿æ¥ï¼Œå¤„ç†ï¼Œè§£æ </p><p>åœ¨æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€å±‚éƒ½å…·å¤‡å¯¹åº”çš„å¤´éƒ¨ï¼Œæ¥æ›´å¥½çš„æ§åˆ¶æ•°æ®çš„è½¬å‘å’Œå¯¹åº”åè®®çš„è¯†åˆ«ã€‚</p><p>é€šè¿‡è¿™ç§è®¾è®¡ï¼Œå…è®¸å°†ä¸€ç«¯çš„ä¿¡æ¯&#x2F;ä»£ç &#x2F;æ•°æ®ä¼ è¾“åˆ°å¦å¤–ä¸€ç«¯ï¼Œå¹¶è¢«è§£ææ‰§è¡Œã€‚</p><h1 id="socket"><a href="#socket" class="headerlink" title="socket"></a>socket</h1><p>socket èµ·æºäºlinuxæ¦‚å¿µï¼Œå›½å†…ä¸€èˆ¬ç§°ä¸ºå¥—æ¥å­—ã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ç§linuxå†…æ ¸ç½‘ç»œåè®®æ ˆä¸Šçš„æè¿°ç¬¦èµ„æºã€‚ä¹Ÿå¯ä»¥ç†è§£ä¸ºä¸€ç§ç½‘ç»œåè®®æ¥å£ï¼Œé€šè¿‡socket,æˆ‘ä»¬å¯ä»¥åˆ›å»ºå¤šç§ä¸åŒçš„ç½‘ç»œåè®®ï¼Œå¹¶å°†æ•°æ®ä½¿ç”¨å„ç§ç½‘ç»œåè®®ä¼ è¾“åˆ°å¯¹ç«¯ï¼Œè€Œä¸éœ€è¦å»è€ƒè™‘æ¯ç§åè®®çš„å…·ä½“å®ç°ã€‚</p><h1 id="socket-åº•å±‚å®ç°çš„ç®€å•æè¿°"><a href="#socket-åº•å±‚å®ç°çš„ç®€å•æè¿°" class="headerlink" title="socket åº•å±‚å®ç°çš„ç®€å•æè¿°"></a>socket åº•å±‚å®ç°çš„ç®€å•æè¿°</h1><p>ä¸Šé¢æˆ‘ä»¬å·²ç»è¯´æ˜äº†socketæ˜¯ä¸€ç§ç½‘ç»œåè®®æ¥å£ï¼Œå®ƒå¯¹ä¸Šæä¾›äº†æ•°æ®å±‚ï¼Œç½‘ç»œå±‚æ•°æ®ä¼ è¾“çš„åŠŸèƒ½ã€‚å¯¹ä¸‹æä¾›äº†å‘é€æ•°æ®åŒ…æ‰€å¿…é¡»çš„IPï¼Œç«¯å£ï¼Œåè®®å¤´è®¾è®¡ã€‚</p><p>åœ¨å®ç°ä¸Šã€‚ç½‘ç»œåè®®æ ˆä¸­ï¼Œåœ¨è¿™ä¸€å±‚å®šä¹‰äº†sockæ¥å£ã€‚ç„¶åå®šä¹‰äº†é€šç”¨çš„Cå‡½æ•°æŒ‡é’ˆï¼Œå†åœ¨ä¸åŒçš„ä¼ è¾“å±‚åè®®ä¸Šæ ¹æ®ä¸åŒçš„åè®®æè¿°è¿›è¡Œä¸åŒçš„å®ç°ã€‚åœ¨æ”¶å‘åŒ…æ—¶ï¼Œåœ¨sockå±‚æ‹†å°ç½‘ç»œå±‚åè®®å¤´ï¼Œè¯†åˆ«ç½‘ç»œå±‚ä¸­çš„åè®®å·ï¼Œå°†æ•°æ®åŒ…è½¬å‘ç»™å¯¹åº”çš„ç»“æ„å»å¤„ç†ã€‚è½¬å‘åˆ°å¯¹åº”ç»“æ„åï¼Œé€šè¿‡å¼ºåˆ¶è½¬æ¢ï¼Œè½¬æ¢ä¸ºå¯¹åº”çš„åè®®æ•°æ®åŒ…æ¥è¿›è¡Œè¿›ä¸€æ­¥çš„æ•°æ®è§£æ</p><h2 id="ä¼ è¾“å±‚åè®®"><a href="#ä¼ è¾“å±‚åè®®" class="headerlink" title="ä¼ è¾“å±‚åè®®"></a>ä¼ è¾“å±‚åè®®</h2><p>é€šå¸¸ä½¿ç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯UDPåè®®å’ŒTCPåè®®</p><h3 id="UDPï¼ˆåè®®å·17ï¼‰"><a href="#UDPï¼ˆåè®®å·17ï¼‰" class="headerlink" title="UDPï¼ˆåè®®å·17ï¼‰"></a>UDPï¼ˆåè®®å·17ï¼‰</h3><p>UDPåè®®ï¼Œé€šå¸¸è¢«è®¤ä¸ºæ˜¯æ— è¿æ¥çš„ï¼Œå› ä¸ºåè®®æœ¬èº«åªå®šä¹‰äº†åŸï¼Œç›®ç«¯å£å·ä¿¡æ¯ã€‚å°†åº”ç”¨å±‚æ•°æ®å†™å…¥UDPæ•°æ®åŒ…ä¸­ï¼Œä¼ è¾“åˆ°å¯¹ç«¯çš„è®¾å¤‡çš„ç›®çš„ç«¯å£ï¼Œä¸å­˜åœ¨è¿æ¥è¿‡ç¨‹å’Œä¿æ´»ï¼Œé‡ä¼ ç­‰ç”¨æ¥ä¿è¯æ•°æ®å®Œæ•´æ€§çš„è®¾è®¡ã€‚ä½†æ˜¯å¯ä»¥åœ¨å…¶ä¸Šå±‚è¿›è¡Œè¿™äº›å¯é æ€§è®¾è®¡ã€‚æ‰€ä»¥UDPä¼˜ç‚¹æ˜¯ä¼ è¾“æ•ˆç‡é«˜ï¼Œæ— è®ºæ˜¯æ•°æ®å‘é€å±‚é¢è¿˜æ˜¯åŒ…ä¿¡æ¯åˆ©ç”¨ç‡ä¸Šã€‚è€Œç¼ºç‚¹æ˜¯æ— è¿æ¥ï¼Œå½“å‘é€æ‰åŒ…æ—¶ï¼Œä¼šå¯¼è‡´æ•´ä¸ªæ•°æ®ä¸å®Œæ•´ï¼Œéœ€è¦åœ¨åº”ç”¨å±‚å†è¿›è¡Œå®Œæ•´æ€§ç¡®è®¤ã€‚</p><h3 id="TCPï¼ˆåè®®å·6ï¼‰"><a href="#TCPï¼ˆåè®®å·6ï¼‰" class="headerlink" title="TCPï¼ˆåè®®å·6ï¼‰"></a>TCPï¼ˆåè®®å·6ï¼‰</h3><p>TCPåè®®ï¼Œä¸UDPä¸åŒï¼ŒTCPä¸­å®šä¹‰äº†å¤æ‚çš„æ§åˆ¶å­—æ®µï¼Œå¹¶è®¾è®¡äº†çŠ¶æ€æœºæ¥æ ‡è¯†TCPä¼ è¾“è¿‡ç¨‹ä¸­çš„æ¯ä¸€ä¸ªé˜¶æ®µï¼Œå®ƒæä¾›äº†è¿æ¥è¿‡ç¨‹ï¼Œé‡ä¼ ï¼Œä¿æ´»ç­‰æœºåˆ¶æ¥åœ¨ä¼ è¾“å±‚ä¿æŠ¤æ•°æ®çš„å®Œæ•´æ€§ã€‚åœ¨TCPä¸­ï¼Œæ•°æ®æ˜¯æµå¼ä¼ è¾“çš„ã€‚å®ƒå¹¶éUDPé‚£æ ·è¿›è¡Œç”¨æˆ·çš„å†™å…¥-æ‰“åŒ…-å‘é€ã€‚è€Œæ˜¯å­˜åœ¨ä¸¤ä¸ª æ¥æ”¶&#x2F;å‘é€çš„ç¼“å­˜é˜Ÿåˆ—ï¼Œæ¯æ¬¡ä»å…¶ä¸­è·å–ä¸€å®šé‡çš„å­—ç¬¦å‘é€åˆ°å¯¹ç«¯ã€‚</p><h1 id="Pythonä¸­çš„socket"><a href="#Pythonä¸­çš„socket" class="headerlink" title="Pythonä¸­çš„socket"></a>Pythonä¸­çš„socket</h1><p>pythonä¸­åŒæ ·æä¾›äº†socketçš„æ ‡å‡†åº“ç”¨äºè¿›è¡Œç½‘ç»œç¼–ç¨‹</p><p>ä¸€ä¸ªæœ€ç®€å•çš„UDP echo server å®ç° ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">sock = socket.socket(socket.AF_INET,socket.SOCK_DGRAM)                 <br><span class="hljs-comment">#åˆ›å»ºsocketå¯¹è±¡ï¼ŒAF_INET æŒ‡å®šäº†ä½¿ç”¨IPåè®®ï¼ŒSOCK_DGRAMæŒ‡å®šæ˜¯UDP</span><br>sock.bind((<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">5560</span>))<br><span class="hljs-comment">#ç»‘å®šIPåœ°å€å’Œç«¯å£å· æœ¬åœ°ä¸»æœºä½¿ç”¨127.0.0.1</span><br>buffer = <span class="hljs-number">10240</span><br><span class="hljs-comment">#è®¾ç½®æ¥æ”¶ç¼“å­˜å—çš„å¤§å°ï¼Œæ¥æ”¶åˆ°çš„æ•°æ®åŒ…ä¼šè¢«å­˜æ”¾åœ¨ç¼“å­˜ä¸­</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;server start&quot;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span> : <span class="hljs-comment">#è®¾ç½®æ¥æ”¶/å‘é€å¾ªç¯</span><br>    message,addr = sock.recvfrom(buffer)      <span class="hljs-comment">#ä»socketä¸­æ¥æ”¶æ•°æ®ï¼Œè¿”å›å€¼ä¸ºä¸€ä¸ªæ¥æ”¶åˆ°çš„ä¿¡æ¯å’Œipåœ°å€å’Œç«¯å£çš„å…ƒç»„</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;recevie message <span class="hljs-subst">&#123;message.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)&#125;</span> from <span class="hljs-subst">&#123;addr&#125;</span>&quot;</span>)      <span class="hljs-comment">#ä»æ•°æ®åŒ…è§£ç å­—ç¬¦ä¸²å¹¶æ‰“å°</span><br>    send_message = <span class="hljs-string">f&quot;recevie message <span class="hljs-subst">&#123;message.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)&#125;</span> from <span class="hljs-subst">&#123;addr&#125;</span>&quot;</span>.encode()<br>    sock.sendto(send_message,addr)      <span class="hljs-comment">#å°†æ”¶åˆ°çš„ä¿¡æ¯å‘é€å›åŸåœ°å€</span><br><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å®¢æˆ·ç«¯</span><br><span class="hljs-keyword">import</span> socket <br>buff = <span class="hljs-number">10240</span><br>sock = socket.socket(socket.AF_INET,socket.SOCK_DGRAM)<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span> :<br>    message = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;è¾“å…¥æ¶ˆæ¯:&quot;</span>)<br>    sock.sendto(message.encode(),(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">5560</span>))<br>    message,addr = sock.recvfrom(buff)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;receive message <span class="hljs-subst">&#123;message&#125;</span> from <span class="hljs-subst">&#123;addr&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>è¿™å…¶ä¸­æœ‰å‡ ä¸ªä¸»è¦è¿‡ç¨‹ ï¼š </p><p>1.è°ƒç”¨socketå‡½æ•°ï¼Œä¼ å…¥åè®®æ—ï¼Œæ•°æ®ç±»å‹ï¼Œè¿”å› socketç»“æ„ä½“ã€‚å®ƒæœ¬èº«æ˜¯ä¸€ç§å¤šæ€å®ç°ï¼Œå¸®åŠ©æˆ‘ä»¬å±è”½äº†UDPï¼ŒTCPç”šè‡³ç½‘ç»œå±‚åè®®çš„å·®å¼‚æ€§ï¼Œæ ¹æ®æˆ‘ä»¬ä¼ é€’çš„å‚æ•°åˆ›å»ºå¯¹åº”çš„UDPæˆ–è€…TCPå¥—æ¥å­—å®ä¾‹</p><p>2.å½“æˆ‘ä»¬ä¼ å…¥çš„æ˜¯AF_INETï¼ŒSOCK_DGRAMæ—¶ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªUDP å¥—æ¥å­—å¯¹è±¡ã€‚</p><p>3.å°†å¥—æ¥å­—å¯¹è±¡ä¸å¯¹åº”çš„ç½‘å¡è¿›è¡Œç»‘å®šï¼Œï¼ˆç«¯å£å·æ˜¯å†…æ ¸ç”¨äºè½¬å‘æ•°æ®æŠ¥çš„é€»è¾‘æ ‡è¯†ã€‚å½“æœåŠ¡å™¨æ”¶åˆ°ç›®çš„åœ°å€ä¸º127.0.0.1 ç«¯å£å·ä¸º5560çš„ UDPåŒ…æ—¶ï¼Œä¼šå°†æ•°æ®åŒ…è½¬å‘ç»™å¯¹åº”çš„ä¸Šå±‚åº”ç”¨ç¨‹åºå¤„ç†ï¼Œå®é™…ä¸Šå°±æ˜¯å°†æ‹†é™¤åè®®å¤´çš„æ•°æ®æŠ¥æ–‡å†™å…¥ socket æ¥æ”¶ç¼“å†²åŒºä¸­ï¼‰</p><p>4.è®¾ç½®äº†æ¥æ”¶æ•°æ®æ‰€ä½¿ç”¨çš„ç¼“å­˜å¤§å°</p><p>5.è®¾ç½®while å¾ªç¯ ä½¿ç”¨ recvfrom è·å–æ•°æ®ï¼Œæ¥æ”¶åˆ°çš„æ˜¯å¯¹ç«¯ä¼ æ¥çš„å­—èŠ‚æ•°æ®å’Œå¯¹ç«¯çš„åœ°å€ç«¯å£ä¿¡æ¯</p><ol start="6"><li>ä½¿ç”¨sendto å‘ç›®æ ‡åœ°å€å‘é€æ•°æ®ã€‚</li></ol><p>socket è¿‡ç¨‹å¸¸ç”¨å‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">server = socket.socket()  <span class="hljs-comment"># å®šä¹‰åè®®æ—å’Œåè®®ä¿¡æ¯ï¼Œè¿”å›å¯¹åº”çš„åè®®å¥—æ¥å­—å®ä¾‹</span><br>server.bind((ip,port))  <span class="hljs-comment"># å°†å¥—æ¥å­—ä¸ç½‘å¡è¿›è¡Œç»‘å®š</span><br>server.recvfrom(buffer_size) <span class="hljs-comment">#æ¥æ”¶ç»è¿‡buffer_sizeé™åˆ¶å¤§å°çš„æ•°æ®ï¼Œè¿”å›å­—èŠ‚æ¶ˆæ¯å’Œè¿œç«¯çš„IP ç«¯å£ä¿¡æ¯</span><br>server.sendto(message,addr) <span class="hljs-comment">#å‘ç›®æ ‡ç½‘ç»œå‘é€æ•°æ®ï¼Œä¼ å…¥å¾…å‘é€çš„å­—ç¬¦å’Œè¿œç«¯çš„IP ç«¯å£ä¿¡æ¯</span><br>server.listen() <span class="hljs-comment">#ç”¨äºTCP,æ‰§è¡Œåæ‰“å¼€å¯¹åº”çš„ç½‘ç»œç«¯å£ç›‘å¬</span><br>server.accept() <span class="hljs-comment">#å½“åˆ›å»ºçš„TCPæ¥æ”¶åˆ°è¿æ¥è¯·æ±‚åï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªsocketçš„å­é“¾æ¥å…¬ç”¨åº•å±‚çš„ç«¯å£å’ŒIPä¿¡æ¯</span><br>sock.recv()     <span class="hljs-comment">#å› ä¸ºTCP æ˜¯æœ‰è¿æ¥çš„ï¼Œç¡®è®¤ç»‘å®šå…³ç³»åï¼Œä¸éœ€è¦å†æŒ‡å®šIPå’Œç«¯å£ä¿¡æ¯</span><br>sock.send()     <span class="hljs-comment">#åŒä¸Š</span><br>client.connect((ip,port)) <span class="hljs-comment">#TCPå®¢æˆ·ç«¯çš„è°ƒç”¨ï¼ŒæŒ‡å®šå¯¹ç«¯åœ°å€å’Œç«¯å£è¿›è¡ŒTCPè¿æ¥</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonç¼–ç¨‹ VI å¤šä»»åŠ¡å¤„ç†</title>
    <link href="/2025/04/16/Python%E7%BC%96%E7%A8%8B-VI-%E5%A4%9A%E4%BB%BB%E5%8A%A1%E5%A4%84%E7%90%86/"/>
    <url>/2025/04/16/Python%E7%BC%96%E7%A8%8B-VI-%E5%A4%9A%E4%BB%BB%E5%8A%A1%E5%A4%84%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1 id="æ“ä½œç³»ç»Ÿè§†è§’ä¸‹çš„ä»»åŠ¡æ‰§è¡Œ"><a href="#æ“ä½œç³»ç»Ÿè§†è§’ä¸‹çš„ä»»åŠ¡æ‰§è¡Œ" class="headerlink" title="æ“ä½œç³»ç»Ÿè§†è§’ä¸‹çš„ä»»åŠ¡æ‰§è¡Œ"></a>æ“ä½œç³»ç»Ÿè§†è§’ä¸‹çš„ä»»åŠ¡æ‰§è¡Œ</h1><p>åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œæ‰€æœ‰çš„ç¨‹åºéƒ½æ˜¯ä»¥<strong>è¿›ç¨‹æˆ–çº¿ç¨‹çš„å½¢å¼</strong>è¢«è°ƒåº¦æ‰§è¡Œçš„ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ</h3><p>è¿›ç¨‹æ˜¯ç¨‹åºè¢«åŠ è½½åˆ°å†…å­˜åçš„è¿è¡Œæ—¶å®ä¾‹ï¼Œæ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚</p><p>è¿›ç¨‹è´Ÿè´£ç®¡ç†å…¶æ‰€éœ€çš„å„ç§èµ„æºï¼ŒåŒ…æ‹¬ä½†ä¸é™äºç”¨æˆ·ç©ºé—´ä¸­çš„ä»£ç æ®µã€å †ã€æ ˆã€åŠ¨æ€é“¾æ¥åº“ï¼Œä»¥åŠé€šè¿‡å†…æ ¸ä¸­çš„ <code>task_struct</code> ç»“æ„ä½“å…³è”çš„ç³»ç»Ÿèµ„æºï¼Œä¾‹å¦‚å‘½åç©ºé—´ã€æ–‡ä»¶æŒ‚è½½ç‚¹ã€ç½‘ç»œæ¥å£ã€ç”¨æˆ·æƒé™ã€ä¿¡å·å¤„ç†ã€å…±äº«å†…å­˜å’Œä¿¡å·é‡ç­‰ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ</h3><p>çº¿ç¨‹æ˜¯è¿›ç¨‹å†…çš„ä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼Œæ˜¯æ“ä½œç³»ç»Ÿè°ƒåº¦çš„æœ€å°å•ä½ã€‚</p><p>çº¿ç¨‹ä¸è¿›ç¨‹çš„åŒºåˆ«åœ¨äºèµ„æºçš„å…±äº«æ–¹å¼ï¼š</p><p>å¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«åŒä¸€ä¸ªè¿›ç¨‹çš„ç”¨æˆ·ç©ºé—´èµ„æºï¼ˆå¦‚å†…å­˜ã€æ–‡ä»¶æè¿°ç¬¦ã€ä¿¡å·å¤„ç†å™¨ç­‰ï¼‰ï¼Œä½†æ¯ä¸ªçº¿ç¨‹ä¾ç„¶ä¼šæ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„ <code>task_struct</code>ã€å†…æ ¸æ ˆå’Œè°ƒåº¦ä¸Šä¸‹æ–‡ã€‚</p><p>åœ¨çº¿ç¨‹åˆ›å»ºæ—¶ï¼Œå¯ä»¥é€šè¿‡ <code>clone()</code> ç³»ç»Ÿè°ƒç”¨æŒ‡å®šå…±äº«å“ªäº›èµ„æºï¼Œä»è€Œå®ç°ä¸åŒç²’åº¦çš„èµ„æºéš”ç¦»æˆ–å…±äº«ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯ä»»åŠ¡è°ƒåº¦ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ä»»åŠ¡è°ƒåº¦ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ä»»åŠ¡è°ƒåº¦ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ä»»åŠ¡è°ƒåº¦ï¼Ÿ</h3><p>æ“ä½œç³»ç»Ÿé€šè¿‡ <code>task_struct</code> ç»“æ„ä½“æ¥æè¿°æ¯ä¸€ä¸ªå¯è°ƒåº¦å®ä½“ï¼ˆæ— è®ºæ˜¯è¿›ç¨‹è¿˜æ˜¯çº¿ç¨‹ï¼‰ã€‚</p><p>å½“ä¸€ä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹è¢«åˆ›å»ºæ—¶ï¼Œå†…æ ¸ä¼šä¸ºå…¶åˆ†é…ä¸€ä¸ª <code>task_struct</code>ï¼Œå¹¶å°†å…¶åŠ å…¥è°ƒåº¦å™¨çš„å°±ç»ªé˜Ÿåˆ—ä¸­ï¼Œç­‰å¾… CPU åˆ†é…æ—¶é—´ç‰‡è¿›è¡Œæ‰§è¡Œã€‚</p><h3 id="å¤šçº¿ç¨‹å¯¹è°ƒåº¦çš„å½±å“"><a href="#å¤šçº¿ç¨‹å¯¹è°ƒåº¦çš„å½±å“" class="headerlink" title="å¤šçº¿ç¨‹å¯¹è°ƒåº¦çš„å½±å“"></a>å¤šçº¿ç¨‹å¯¹è°ƒåº¦çš„å½±å“</h3><p>ç”±äºæ¯ä¸ªçº¿ç¨‹éƒ½å¯¹åº”ä¸€ä¸ªç‹¬ç«‹çš„ <code>task_struct</code>ï¼Œå› æ­¤æ“ä½œç³»ç»Ÿä¼šå°†å®ƒä»¬ä½œä¸º<strong>ç‹¬ç«‹çš„è°ƒåº¦å®ä½“</strong>è¿›è¡Œè°ƒåº¦ã€‚</p><p>ä¾‹å¦‚ï¼š</p><p>å‡è®¾ç³»ç»Ÿä¸­å…±æœ‰ 10 ä¸ªä»»åŠ¡ï¼ˆè°ƒåº¦å®ä½“ï¼‰åœ¨ç­‰å¾… CPUï¼Œè€ŒæŸè¿›ç¨‹åªåŒ…å«ä¸€ä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆå®ƒè·å¾— CPU çš„æ¦‚ç‡çº¦ä¸º 1&#x2F;10ã€‚</p><p>å½“è¯¥è¿›ç¨‹åˆ›å»ºäº†ä¸€ä¸ªæ–°çº¿ç¨‹åï¼Œå®ƒå°±æ‹¥æœ‰äº†ä¸¤ä¸ª <code>task_struct</code>ï¼Œè°ƒåº¦æ¦‚ç‡æå‡è‡³çº¦ 2&#x2F;11ï¼Œä»è€Œæé«˜äº†è¯¥è¿›ç¨‹æ•´ä½“çš„æ‰§è¡Œé¢‘ç‡å’Œå¹¶å‘èƒ½åŠ›ã€‚</p><p>è¿™ç§æ–¹å¼å°¤å…¶é€‚ç”¨äºå¤šæ ¸å¤„ç†å™¨æ¶æ„ï¼Œèƒ½å¤Ÿå®ç°å¤šä¸ªçº¿ç¨‹åœ¨ä¸åŒ CPU æ ¸å¿ƒä¸ŠåŒæ—¶è¿è¡Œï¼Œæå‡æ•´ä½“æ€§èƒ½å’Œå“åº”é€Ÿåº¦ã€‚</p><h1 id="Pythonä¸­çš„å¤šä»»åŠ¡å¤„ç†"><a href="#Pythonä¸­çš„å¤šä»»åŠ¡å¤„ç†" class="headerlink" title="Pythonä¸­çš„å¤šä»»åŠ¡å¤„ç†"></a>Pythonä¸­çš„å¤šä»»åŠ¡å¤„ç†</h1><h2 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" class="headerlink" title="å¤šçº¿ç¨‹"></a>å¤šçº¿ç¨‹</h2><p>å¦‚ä¸Šé¢æ‰€è®²ï¼Œå¤šçº¿ç¨‹å°±æ˜¯é€šè¿‡åœ¨ç³»ç»Ÿå±‚é¢ä½¿ç”¨cloneæŒ‡å®šå…±äº«èµ„æºåŒºåœ¨å†…æ ¸åˆ›å»ºæ–°çš„task_struct å¢åŠ è¢«ç³»ç»Ÿè°ƒåº¦çš„å¯èƒ½æ€§ï¼Œåœ¨pythonä¸­ï¼Œä½¿ç”¨threadingæ¨¡å—æ¥æ„å»ºpythonçš„å¤šçº¿ç¨‹åº”ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#ç¤ºä¾‹1 åˆ›å»ºå‡½æ•°ï¼Œå°†å‡½æ•°æ·»åŠ åˆ°å¤šçº¿ç¨‹å¯¹è±¡ä¸­å¯åŠ¨å¤šçº¿ç¨‹</span><br><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">count</span>():<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,<span class="hljs-number">100</span>):                                       <br>        <span class="hljs-built_in">print</span>(i)<br><br>session1 = threading.Thread(target=count,name=<span class="hljs-string">&quot;thread1&quot;</span>)          <span class="hljs-comment">#åˆ›å»ºçº¿ç¨‹1,æŒ‡å®šçº¿ç¨‹1æ‰§è¡Œçš„æ–¹æ³•</span><br>session2 = threading.Thread(target=count,name=<span class="hljs-string">&quot;thread2&quot;</span>)          <span class="hljs-comment">#åˆ›å»ºçº¿ç¨‹2,æŒ‡å®šçº¿ç¨‹2æ‰§è¡Œçš„æ–¹æ³•</span><br>session1.start()                                                  <span class="hljs-comment">#åˆ›å»ºcå±‚é¢çš„çº¿ç¨‹ç»“æ„</span><br>session2.start()                                                  <span class="hljs-comment">#åˆ›å»ºcå±‚é¢çš„çº¿ç¨‹ç»“æ„</span><br>session1.join()                                                   <span class="hljs-comment">#æ‰§è¡Œçº¿ç¨‹1</span><br>session2.join()                                                   <span class="hljs-comment">#æ‰§è¡Œçº¿ç¨‹2</span><br><span class="hljs-comment"># session1å’Œsession2 åˆ†åˆ«æ­£å¸¸è¾“å‡º</span><br></code></pre></td></tr></table></figure><p>è¿™æ—¶ï¼Œsession1å’Œsession2 åˆ†åˆ«æ­£å¸¸è¾“å‡ºï¼Œå› ä¸ºå‡½æ•°ä¸­æ‰€ä½¿ç”¨çš„å˜é‡éƒ½æ˜¯åœ¨æ ˆä¸­åˆ›å»ºçš„ï¼Œè€Œä¸åŒçº¿ç¨‹çš„æ ˆç©ºé—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥ä¸å­˜åœ¨å½±å“ã€‚</p><p>è°ƒç”¨åŒä¸€ä¸ªå¯¹è±¡è¯»å†™æ—¶ è¿™æ—¶å°±ä¼šå‡ºç°è¾“å‡ºä¸ç›®æ ‡è¾“å‡ºä¸ä¸€è‡´çš„æƒ…å†µã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#ç¤ºä¾‹2 åˆ›å»ºä¸€ä¸ªç±»ï¼Œé€šè¿‡æ“ä½œç±»ä¸­çš„å±æ€§ï¼Œæ¥æŸ¥çœ‹å¤šçº¿ç¨‹æ“ä½œæ—¶å¯èƒ½å‡ºç°çš„é—®é¢˜</span><br><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> time <br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">count1</span> :<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,num</span>):<br>        <span class="hljs-variable language_">self</span>.num = num<br>a = count1(<span class="hljs-number">0</span>)<br>test_max = <span class="hljs-number">10000</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">count</span>(<span class="hljs-params">count_t, <span class="hljs-built_in">max</span></span>):<br>    <span class="hljs-keyword">while</span> count_t.num &lt; <span class="hljs-built_in">max</span>:                <br>        time.sleep(<span class="hljs-number">0.001</span>)               <span class="hljs-comment">#å¢åŠ æ‰§è¡Œæ—¶é—´ï¼Œå¢åŠ çº¿ç¨‹åˆ‡æ¢çš„å¯èƒ½æ€§</span><br>        count_t.num += <span class="hljs-number">1</span><br><br>session1 = threading.Thread(target=count,name=<span class="hljs-string">&quot;thread1&quot;</span>,args=(a,test_max))<br>session2 = threading.Thread(target=count,name=<span class="hljs-string">&quot;thread2&quot;</span>,args=(a,test_max))<br>session3 = threading.Thread(target=count,name=<span class="hljs-string">&quot;thread3&quot;</span>,args=(a,test_max))<br>session4 = threading.Thread(target=count,name=<span class="hljs-string">&quot;thread4&quot;</span>,args=(a,test_max))<br>session5 = threading.Thread(target=count,name=<span class="hljs-string">&quot;thread5&quot;</span>,args=(a,test_max))<br><br>session1.start()<br>session2.start()<br>session3.start()<br>session4.start()<br>session5.start()<br><br>session1.join()<br>session2.join()<br>session3.join()<br>session4.join()<br>session5.join()<br><br><span class="hljs-comment"># è¾“å‡º 10005ï¼ˆä¸å›ºå®šï¼‰</span><br></code></pre></td></tr></table></figure><p>åŸºäºç±»ç»§æ‰¿å®ç°å¤šçº¿ç¨‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ç¤ºä¾‹3 åŸºäºç±»ç»§æ‰¿å®ç°å¤šçº¿ç¨‹</span><br><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">anum</span> :<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,num</span>):<br>        <span class="hljs-variable language_">self</span>.num = num<br>    <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">count1</span>(threading.Thread):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,num,<span class="hljs-built_in">max</span></span>):<br>        <span class="hljs-built_in">super</span>().__init__()<br>        <span class="hljs-variable language_">self</span>.num = num<br>        <span class="hljs-variable language_">self</span>.<span class="hljs-built_in">max</span> = <span class="hljs-built_in">max</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-variable language_">self</span>.num.num&lt;<span class="hljs-variable language_">self</span>.<span class="hljs-built_in">max</span>:<br>            time.sleep(<span class="hljs-number">0.001</span>) <br>            <span class="hljs-variable language_">self</span>.num.num += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span><br>num1 = anum(<span class="hljs-number">0</span>)<br>session1 = count1(num1,<span class="hljs-number">1000</span>)<br>session2 = count1(num1,<span class="hljs-number">1000</span>)<br>session3 = count1(num1,<span class="hljs-number">1000</span>)<br>session4 = count1(num1,<span class="hljs-number">1000</span>)<br>session5 = count1(num1,<span class="hljs-number">1000</span>)<br>session1.start()<br>session2.start()<br>session3.start()<br>session4.start()<br>session5.start()<br>session1.join()<br>session2.join()<br>session3.join()<br>session4.join()<br>session5.join()<br><span class="hljs-built_in">print</span>(num1.num)<br><span class="hljs-comment"># æœ€ç»ˆç»“æœåŒæ ·å­˜åœ¨é—®é¢˜</span><br></code></pre></td></tr></table></figure><h2 id="å¤šè¿›ç¨‹"><a href="#å¤šè¿›ç¨‹" class="headerlink" title="å¤šè¿›ç¨‹"></a>å¤šè¿›ç¨‹</h2><p>åœ¨Pythonä¸­ï¼Œæ”¯æŒä¸¤ç§å¤šè¿›ç¨‹çš„åˆ›å»ºæ–¹å¼ ï¼š</p><ol><li>é€šè¿‡fork åˆ›å»ºè¿›ç¨‹  å³å¤åˆ¶å½“å‰è¿›ç¨‹åˆ›å»ºä¸€ä¸ªè¿›ç¨‹</li><li>spawn ï¼Œ é‡æ–°åŠ è½½è§£é‡Šå™¨åˆ›å»ºè¿›ç¨‹</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> multiprocessing<br>multiprocessing.set_start_method(<span class="hljs-string">&quot;spawn&quot;</span>)  <span class="hljs-comment"># è®¾ç½®è§£é‡Šå™¨åˆ›å»ºè¿›ç¨‹  </span><br>multiprocessing.set_start_method(<span class="hljs-string">&quot;fork&quot;</span>)  <span class="hljs-comment"># è®¾ç½®forkåˆ›å»ºè¿›ç¨‹</span><br></code></pre></td></tr></table></figure><p>è¿›ç¨‹çš„åˆ›å»º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ä½¿ç”¨Process ä¼ å…¥workerå‡½æ•°åœ¨æ–°è¿›ç¨‹ä¸­æ‰§è¡Œ</span><br><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Process<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">worker</span>(<span class="hljs-params">name</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;name&#125;</span> running in PID: <span class="hljs-subst">&#123;os.getpid()&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    processes = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        p = Process(target=worker, args=(<span class="hljs-string">f&#x27;Process-<span class="hljs-subst">&#123;i&#125;</span>&#x27;</span>,))<br>        processes.append(p)<br>        p.start()<br><br>    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> processes:<br>        p.join()<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ç»§æ‰¿Processç±» ï¼Œ é‡å†™runæ–¹æ³•åˆ›å»ºè¿›ç¨‹</span><br><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Process<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyProcess</span>(<span class="hljs-title class_ inherited__">Process</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name</span>):<br>        <span class="hljs-built_in">super</span>().__init__()<br>        <span class="hljs-variable language_">self</span>.name = name<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.name&#125;</span> running in PID: <span class="hljs-subst">&#123;os.getpid()&#125;</span>&quot;</span>)<br><br>p = MyProcess(<span class="hljs-string">&quot;CustomProcess&quot;</span>)<br>p.start()<br>p.join()<br></code></pre></td></tr></table></figure><h2 id="å†æ¬¡ç†è§£å¤šè¿›ç¨‹-å¤šçº¿ç¨‹"><a href="#å†æ¬¡ç†è§£å¤šè¿›ç¨‹-å¤šçº¿ç¨‹" class="headerlink" title="å†æ¬¡ç†è§£å¤šè¿›ç¨‹&#x2F;å¤šçº¿ç¨‹"></a>å†æ¬¡ç†è§£å¤šè¿›ç¨‹&#x2F;å¤šçº¿ç¨‹</h2><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¤šè¿›ç¨‹æˆ–è€…å¤šçº¿ç¨‹åœ¨pythonä¸­çš„å®ç°éƒ½æ˜¯é€šè¿‡ ä¼ å…¥å‡½æ•°-å¯åŠ¨çº¿ç¨‹&#x2F;è¿›ç¨‹å¯¹è±¡ï¼Œæˆ–è€…ç»§æ‰¿threadæˆ–processç±»ï¼Œé‡å†™runæ–¹æ³•æ¥å®ç°çš„ã€‚è¿™æœ¬è´¨ä¸Šå¯¹åº”ç€â€˜é€šè¿‡è½½å…¥å‡½æ•°&#x2F;å¯¹è±¡å®šä¹‰åˆ›å»ºå¯è°ƒåº¦ä½“â€™è¿™ä¸€è¿‡ç¨‹</p><p>åŒæ—¶è¦æ³¨æ„çš„æ˜¯ï¼ŒPythonæ–‡ä»¶ä¸­å®šä¹‰çš„çº¿ç¨‹&#x2F;è¿›ç¨‹åˆ›å»ºè¿‡ç¨‹å¹¶ä¸èƒ½ä¸æ‰§è¡Œåçš„è¡Œä¸ºç›´æ¥å…³è”ã€‚å¯¹äºçº¿ç¨‹æ¥è¯´ï¼Œåˆ›å»ºè¿‡ç¨‹æ˜¯ åŠ è½½Pythonæ–‡ä»¶åˆ°å†…å­˜ä¸­ï¼Œåˆ›å»ºçº¿ç¨‹ï¼Œåˆ›å»ºåçš„æ‰€æœ‰çº¿ç¨‹ä»ç„¶å¯ä»¥ä½¿ç”¨æ–‡ä»¶ä¸­å®šä¹‰çš„å¯¹è±¡ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚è€Œå¯¹äºè¿›ç¨‹æ¥è¯´ï¼Œå½“è¿›ç¨‹è¢«åˆ›å»ºåï¼Œåœ¨ç³»ç»Ÿå±‚é¢ä¸Šæ˜¯åˆ›å»ºäº†ä¸€ä¸ªåŸè§£é‡Šå™¨çš„å‰¯æœ¬(fork) æˆ–è€… ä¸€ä¸ªæ–°çš„pythonè§£é‡Šå™¨è¿›ç¨‹ï¼ˆspawnï¼‰ã€‚è¿™æ—¶æ–°è¿›ç¨‹å·²ç»å’ŒåŸè¿›ç¨‹çš„å†…å­˜ç©ºé—´è¿›è¡Œäº†éš”ç¦»ã€‚ç›¸å½“äºå°† Pythonæ–‡ä»¶çš„å‰¯æœ¬åŠ è½½åˆ°äº†ä¸¤ä¸ªè¿›ç¨‹ä¸­ï¼Œå„è‡ªçš„åç»­ä¿®æ”¹å’Œä½¿ç”¨å·²ç»å®Œå…¨éš”ç¦»ï¼Œå¦‚æœéœ€è¦è¿›ç¨‹äº¤äº’ï¼Œåˆ™éœ€è¦è¿›è¡Œä¸€äº›è¿›ç¨‹é—´é€šä¿¡çš„è®¾è®¡ã€‚</p><h2 id="åç¨‹"><a href="#åç¨‹" class="headerlink" title="åç¨‹"></a>åç¨‹</h2><p>åç¨‹æ˜¯ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è®¾è®¡ï¼Œé¦–å…ˆå®ƒå°†å®šä¹‰å¥½çš„ä»»åŠ¡é¡ºåºæ‰§è¡Œåˆ°ç­‰å¾…ç‚¹ï¼Œå¦‚ä½•å°†ä»»åŠ¡æ³¨å†Œåˆ°ä»»åŠ¡ç­‰å¾…é˜Ÿåˆ—ä¸­å½“æ¡ä»¶è¾¾æˆåï¼Œå”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ç»§ç»­æ‰§è¡Œã€‚åç¨‹ä¸ä¾èµ–ç³»ç»Ÿæ—¶é—´ç‰‡è°ƒåº¦ï¼Œè€Œé‡‡ç”¨åä½œå¼è°ƒåº¦æ¨¡å¼ï¼ˆcooperative schedulingï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> asyncio<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">task</span>(<span class="hljs-params">name, delay</span>):                                       <span class="hljs-comment">#å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•°</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;name&#125;</span> å¼€å§‹æ‰§è¡Œ&quot;</span>)                                       <span class="hljs-comment">#å‰åŠéƒ¨åˆ†æ‰§è¡Œ</span><br>    <span class="hljs-keyword">await</span> asyncio.sleep(delay)                                       <span class="hljs-comment">#awaitå°†æ ˆå¸§æŒ‚èµ·</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;name&#125;</span> æ‰§è¡Œç»“æŸï¼ˆç­‰å¾…äº† <span class="hljs-subst">&#123;delay&#125;</span> ç§’ï¼‰&quot;</span>)                     <span class="hljs-comment">#ç­‰å¾…è¿‡åç»§ç»­æ‰§è¡Œ</span><br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># å¹¶å‘è¿è¡Œå¤šä¸ªåç¨‹</span><br>    <span class="hljs-keyword">await</span> asyncio.gather(                           <br>        task(<span class="hljs-string">&quot;ä»»åŠ¡A&quot;</span>, <span class="hljs-number">2</span>),                                      <br>        task(<span class="hljs-string">&quot;ä»»åŠ¡B&quot;</span>, <span class="hljs-number">1</span>),<br>        task(<span class="hljs-string">&quot;ä»»åŠ¡C&quot;</span>, <span class="hljs-number">3</span>)<br>    )<br><br>asyncio.run(main())<br><span class="hljs-comment"># å®šä¹‰äº†å¤šä¸ªåç¨‹æ‰§è¡Œã€‚</span><br><span class="hljs-comment"># å…¶æ‰§è¡Œè¿‡ç¨‹ä¸º taskA , taskB, taskC è¢«pythonè§£é‡Šå™¨è§£é‡Š,æŒ‰æ¬¡åºæ‰§è¡Œ,æ‰§è¡Œåˆ°awaitåè¢«æŒ‚èµ·,æ³¨å†Œåˆ°äº‹ä»¶å¾ªç¯çš„â€œæŒ‚èµ·ä»»åŠ¡é˜Ÿåˆ—â€ä¸­</span><br></code></pre></td></tr></table></figure><h1 id="å¤šä»»åŠ¡å¤„ç†çš„å±€é™æ€§"><a href="#å¤šä»»åŠ¡å¤„ç†çš„å±€é™æ€§" class="headerlink" title="å¤šä»»åŠ¡å¤„ç†çš„å±€é™æ€§"></a>å¤šä»»åŠ¡å¤„ç†çš„å±€é™æ€§</h1><h2 id="å¤šçº¿ç¨‹çš„é—®é¢˜-çº¿ç¨‹å®‰å…¨é—®é¢˜"><a href="#å¤šçº¿ç¨‹çš„é—®é¢˜-çº¿ç¨‹å®‰å…¨é—®é¢˜" class="headerlink" title="å¤šçº¿ç¨‹çš„é—®é¢˜- çº¿ç¨‹å®‰å…¨é—®é¢˜"></a>å¤šçº¿ç¨‹çš„é—®é¢˜- çº¿ç¨‹å®‰å…¨é—®é¢˜</h2><p>å¤šçº¿ç¨‹å¯ä»¥æé«˜ç¨‹åºè¢«æ‰§è¡Œçš„æ•ˆç‡ï¼Œä½†æ˜¯åœ¨ç»è¿‡CPUæ‰§è¡Œåå›å†™çš„è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºçº¿ç¨‹æ˜¯å…±äº«å†…å­˜èµ„æºçš„ï¼Œæ‰€ä»¥ä¼šå­˜åœ¨èµ„æºçš„å†™å…¥é—®é¢˜ã€‚</p><p>ç¨‹åºçš„å®é™…è¿è¡Œè¿‡ç¨‹å¹¶éç®€å•çš„æ‰§è¡Œ-å†™å…¥ã€‚è€Œæ˜¯åˆ†æ­¥éª¤ï¼š</p><ul><li>åŠ è½½å†…å­˜å™¨ä¸­çš„å€¼åˆ°å¯„å­˜å™¨</li><li>å¯„å­˜å™¨æ‰§è¡Œè¿ç®—ï¼Œè¿”å›è¿ç®—ç»“æœ</li><li>å°†è¿ç®—ç»“æœå†™å›å†…å­˜</li></ul><p>è€Œåœ¨å¤šä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œå¦‚æœéƒ½å¯¹åŒä¸€å—å†…å­˜è¿›è¡Œå¤„ç†ï¼Œè¿™ä¸ªç»“æœæ˜¯ä¸å¯é¢„çŸ¥çš„ï¼Œä¼šå‡ºç°ï¼š</p><ul><li>åŠ è½½å†…å­˜å™¨ä¸­çš„å€¼åˆ°å¯„å­˜å™¨ï¼ˆçº¿ç¨‹1ï¼‰</li><li>å¯„å­˜å™¨æ‰§è¡Œè¿ç®—ï¼Œè¿”å›è¿ç®—ç»“æœï¼ˆçº¿ç¨‹1ï¼‰</li><li>CPUèµ„æºè¢«æŠ¢å ï¼Œå‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œåˆ‡æ¢è‡³çº¿ç¨‹2æ‰§è¡Œ</li><li>åŠ è½½å†…å­˜å™¨ä¸­çš„å€¼åˆ°å¯„å­˜å™¨ï¼ˆçº¿ç¨‹2ï¼‰</li><li>å¯„å­˜å™¨æ‰§è¡Œè¿ç®—ï¼Œè¿”å›è¿ç®—ç»“æœï¼ˆçº¿ç¨‹2ï¼‰</li><li>å°†è¿ç®—ç»“æœå†™å›å†…å­˜ï¼Œçº¿ç¨‹2é€€å‡ºï¼Œåˆ‡æ¢è‡³çº¿ç¨‹1æ‰§è¡Œ</li><li>å°†è¿ç®—ç»“æœå†™å›å†…å­˜ï¼ˆçº¿ç¨‹1ï¼‰</li></ul><p>è¿™å¯èƒ½å¯¼è‡´æ•°æ®è¢«è¦†ç›–ï¼Œé€ æˆæ“ä½œä¸¢å¤±ï¼ˆå³â€˜å†™å†²çªâ€™ï¼‰</p><h2 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h2><h3 id="é”"><a href="#é”" class="headerlink" title="é”"></a>é”</h3><p>é”æ˜¯ä¸€ç§ç”±æ“ä½œç³»ç»Ÿå®šä¹‰çš„åŒæ­¥åŸè¯­ã€‚ä¿æŠ¤äº†ä¸€ä¸ªçº¿ç¨‹åœ¨è®¿é—®å†…å­˜æ—¶ï¼Œå°†å…¶ä»–å°è¯•è·å–è¯¥èµ„æºçš„çº¿ç¨‹é˜»å¡ï¼Œç›´åˆ°å¤„ç†èµ„æºçš„çº¿ç¨‹é‡Šæ”¾å®ƒã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> time <br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">count1</span> :<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,num</span>):<br>        <span class="hljs-variable language_">self</span>.lock = threading.Lock()<br>        <span class="hljs-variable language_">self</span>.num = num<br>a = count1(<span class="hljs-number">0</span>)<br>test_max = <span class="hljs-number">10000</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">count</span>(<span class="hljs-params">count_t, <span class="hljs-built_in">max</span></span>):<br>    <span class="hljs-keyword">while</span> count_t.num &lt; <span class="hljs-built_in">max</span>:                <br>        time.sleep(<span class="hljs-number">0.001</span>)<br>        count_t.lock.acquire()<br>        <span class="hljs-keyword">if</span> count_t.num &gt;= <span class="hljs-built_in">max</span> :<br>            count_t.lock.release()<br>            <span class="hljs-keyword">break</span><br>        count_t.num += <span class="hljs-number">1</span><br>        count_t.lock.release()<br>session1 = threading.Thread(target=count,name=<span class="hljs-string">&quot;thread1&quot;</span>,args=(a,test_max))<br>session2 = threading.Thread(target=count,name=<span class="hljs-string">&quot;thread2&quot;</span>,args=(a,test_max))<br>session3 = threading.Thread(target=count,name=<span class="hljs-string">&quot;thread3&quot;</span>,args=(a,test_max))<br>session4 = threading.Thread(target=count,name=<span class="hljs-string">&quot;thread4&quot;</span>,args=(a,test_max))<br>session5 = threading.Thread(target=count,name=<span class="hljs-string">&quot;thread5&quot;</span>,args=(a,test_max))<br><br>session1.start()<br>session2.start()<br>session3.start()<br>session4.start()<br>session5.start()<br><br>session1.join()<br>session2.join()<br>session3.join()<br>session4.join()<br>session5.join()<br></code></pre></td></tr></table></figure><p>è¿˜æœ‰å¦‚ä¿¡å·é‡ï¼Œå…è®¸è®¾ç½®å½“å‰æœ€å¤šå¯ä»¥æ‰§è¡Œçš„çº¿ç¨‹æ•°é‡</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">sem_t</span> = threading.<span class="hljs-built_in">Semaphore</span>(<span class="hljs-number">1</span>)<br><span class="hljs-type">sem_t</span>.<span class="hljs-built_in">acquire</span>()  # è¯·æ±‚ä¿¡å·é‡<br><span class="hljs-type">sem_t</span>.<span class="hljs-built_in">release</span>()  # é‡Šæ”¾ä¿¡å·é‡<br><br></code></pre></td></tr></table></figure><p>ä»¥åŠä¸€äº›å…¶ä»–çš„ç”¨æ¥ä¿è¯çº¿ç¨‹å®‰å…¨çš„è®¾è®¡</p><h1 id="å¤šçº¿ç¨‹é—®é¢˜-æ•°æ®é€šä¿¡"><a href="#å¤šçº¿ç¨‹é—®é¢˜-æ•°æ®é€šä¿¡" class="headerlink" title="å¤šçº¿ç¨‹é—®é¢˜ - æ•°æ®é€šä¿¡"></a>å¤šçº¿ç¨‹é—®é¢˜ - æ•°æ®é€šä¿¡</h1><p>å¯¹äºå¤šä¸ªè¿›ç¨‹æ¥è¯´ï¼Œå› ä¸ºæ¯ä¸ªè¿›ç¨‹çš„ç®¡ç†çš„èµ„æºæ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥å°±ä¸å­˜åœ¨æ‰§è¡Œç»“æœè¢«å…¶ä»–è¿›ç¨‹è¦†ç›–çš„å¯èƒ½æ€§ã€‚ä½†æ˜¯åˆä¼šå‡ºç°å¦ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºå³ä½¿å¤šä¸ªè¿›ç¨‹ä¹‹é—´çš„æ“ä½œæ˜¯äº’ç›¸ç‹¬ç«‹çš„ï¼Œä¸åŒè¿›ç¨‹é—´éœ€è¦é€šè¿‡ä¸€äº›æ–¹æ³•è¿›è¡Œæ•°æ®ä¼ é€’ï¼Œæ‰èƒ½å®Œæˆé€šä¿¡ã€‚</p><h3 id="é˜Ÿåˆ—"><a href="#é˜Ÿåˆ—" class="headerlink" title="é˜Ÿåˆ—"></a>é˜Ÿåˆ—</h3><p>é˜Ÿåˆ—æ˜¯é€šè¿‡å®šä¹‰äº†ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œåœ¨ä¸¤ä¸ªè¿›ç¨‹é—´å®Œæˆæ”¶å‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Process, Queue<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">producer</span>(<span class="hljs-params">q</span>):<br>    q.put(<span class="hljs-string">&quot;ä½ å¥½&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">consumer</span>(<span class="hljs-params">q</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ”¶åˆ°ï¼š&quot;</span>, q.get())<br><br>q = Queue()<br>Process(target=producer, args=(q,)).start()<br>Process(target=consumer, args=(q,)).start()<br><br></code></pre></td></tr></table></figure><h3 id="ç®¡é“"><a href="#ç®¡é“" class="headerlink" title="ç®¡é“"></a>ç®¡é“</h3><p>ç®¡é“å®šä¹‰äº†ç‚¹å¯¹ç‚¹çš„ è¿›ç¨‹é—´é€šä¿¡æ–¹å¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Process, Pipe<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">worker</span>(<span class="hljs-params">conn</span>):<br>    conn.send(<span class="hljs-string">&quot;hello&quot;</span>)<br>    conn.close()<br><br>parent_conn, child_conn = Pipe()<br>Process(target=worker, args=(child_conn,)).start()<br><span class="hljs-built_in">print</span>(parent_conn.recv())<br><br></code></pre></td></tr></table></figure><h3 id="ä¸€äº›å…±äº«å†…å­˜é¡µ-æ˜ å°„è¡¨-æ¯”å¦‚Value-Arrayæˆ–è€…SharedMemory"><a href="#ä¸€äº›å…±äº«å†…å­˜é¡µ-æ˜ å°„è¡¨-æ¯”å¦‚Value-Arrayæˆ–è€…SharedMemory" class="headerlink" title="ä¸€äº›å…±äº«å†…å­˜é¡µ&#x2F;æ˜ å°„è¡¨ æ¯”å¦‚Value,Arrayæˆ–è€…SharedMemory"></a>ä¸€äº›å…±äº«å†…å­˜é¡µ&#x2F;æ˜ å°„è¡¨ æ¯”å¦‚Value,Arrayæˆ–è€…SharedMemory</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Value, Process<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">v</span>):<br>    v.value += <span class="hljs-number">1</span><br><br>v = Value(<span class="hljs-string">&#x27;i&#x27;</span>, <span class="hljs-number">0</span>)  <span class="hljs-comment"># &#x27;i&#x27; = int           # å®é™…ä¸Šæ˜¯ç›´æ¥ä½¿ç”¨äº†å†…æ ¸ä¸­çš„å†…å­˜å­˜å‚¨äº†è¿™ä¸ªå˜é‡</span><br>p = Process(target=add, args=(v,))<br>p.start()<br>p.join()<br><span class="hljs-built_in">print</span>(v.value)<br><br></code></pre></td></tr></table></figure><h3 id="åŸºäºç³»ç»Ÿçš„æ–‡ä»¶æè¿°ç¬¦-ç¼“å†²ç»“æ„"><a href="#åŸºäºç³»ç»Ÿçš„æ–‡ä»¶æè¿°ç¬¦-ç¼“å†²ç»“æ„" class="headerlink" title="åŸºäºç³»ç»Ÿçš„æ–‡ä»¶æè¿°ç¬¦&#x2F;ç¼“å†²ç»“æ„"></a>åŸºäºç³»ç»Ÿçš„æ–‡ä»¶æè¿°ç¬¦&#x2F;ç¼“å†²ç»“æ„</h3><p>æ–‡ä»¶ï¼š ä¸€ä¸ªè¿›ç¨‹å‘ç³»ç»Ÿå†™å…¥æ–‡ä»¶ï¼Œå¦ä¸€ä¸ªè¿›ç¨‹æ¥æ”¶æ–‡ä»¶å¹¶è¯»å–</p><p>Socketï¼š å¥—æ¥å­—ï¼Œé€šè¿‡ç½‘ç»œåè®®æ ˆè½¬å‘</p><p>ä¸è¿‡å®ç°åŸç†éƒ½æ˜¯åŸºäºæ“ä½œç³»ç»Ÿä¸­çš„ä¸€äº›å†…å­˜æ˜ å°„æœºåˆ¶ï¼Œæˆ–è€…å®ç°åœ¨å†…æ ¸å†…çš„ç¼“å­˜æœºåˆ¶æ¥å®Œæˆçš„ã€‚ä»»åŠ¡å¤„ç†è®¾è®¡æ•´ä½“çš„ä½¿ç”¨åœºæ™¯è¾ƒä¸ºå¤æ‚ï¼Œä¸”å¾ˆå¤šéƒ½ä¾èµ–äºå®é™…åœºæ™¯çš„è®¾è®¡å®ç°ï¼ŒåæœŸå†è¿›ä¸€æ­¥æ‰©å……è¿™ä¸€éƒ¨åˆ†å†…å®¹ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonç¼–ç¨‹ V æ¨¡å—ä¸åº“</title>
    <link href="/2025/04/16/Python%E7%BC%96%E7%A8%8B-V-%E6%A8%A1%E5%9D%97%E4%B8%8E%E5%BA%93/"/>
    <url>/2025/04/16/Python%E7%BC%96%E7%A8%8B-V-%E6%A8%A1%E5%9D%97%E4%B8%8E%E5%BA%93/</url>
    
    <content type="html"><![CDATA[<h1 id="æ¨¡å—"><a href="#æ¨¡å—" class="headerlink" title="æ¨¡å—"></a>æ¨¡å—</h1><p>åœ¨Pythonä¸­ï¼Œæ˜¯ä»¥æ¨¡å—è¿›è¡Œä»£ç ç»„ç»‡çš„ã€‚å•ç‹¬çš„pythonæ–‡ä»¶ï¼Œç”±å¤šä¸ªpythonæ–‡ä»¶ç»„æˆçš„æ–‡ä»¶å¤¹ã€‚éƒ½å¯ä»¥ä½œä¸ºæ¨¡å—å¯¼å…¥å…¶ä»–æ–‡ä»¶ä¸­ï¼Œè¿™æ ·åœ¨å…¶ä»–æ–‡ä»¶ä¸­å®šä¹‰çš„å‡½æ•°æˆ–è€…ç±»å°±å¯ä»¥åœ¨å½“å‰æ–‡ä»¶ä¸­è¿›è¡Œä½¿ç”¨ï¼Œæ–¹ä¾¿ç¨‹åºè®¾è®¡äººå‘˜æ›´å¥½çš„ç»„ç»‡æ•´ä¸ªå·¥ç¨‹çš„ç»“æ„ã€‚</p><p>ä¸€äº›å¯¼å…¥æ¨¡å—çš„æ–¹å¼ ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Person <span class="hljs-keyword">import</span> Person                    <span class="hljs-comment">#ä»Person.pyæ¨¡å—ä¸­å¯¼å…¥Personç±»</span><br><span class="hljs-keyword">from</span> Anmial <span class="hljs-keyword">import</span> Dog                       <span class="hljs-comment">#ä»Anmialæ–‡ä»¶å¤¹ä¸­å¯¼å…¥Dogæ¨¡å—</span><br><span class="hljs-keyword">from</span> Anmial.Dog <span class="hljs-keyword">import</span> dog                   <span class="hljs-comment">#ä»Anmialæ–‡ä»¶å¤¹çš„Dogæ¨¡å—ä¸­å¯¼å…¥dogç±»</span><br><span class="hljs-keyword">from</span> Anmial.Cat <span class="hljs-keyword">import</span> cat <span class="hljs-keyword">as</span> mimi           <span class="hljs-comment">#ä»Anmialæ–‡ä»¶å¤¹çš„catæ¨¡å—ä¸­å¯¼å…¥catç±»,å¹¶è®¾è®¡åˆ«å mimi</span><br></code></pre></td></tr></table></figure><h1 id="åº“"><a href="#åº“" class="headerlink" title="åº“"></a>åº“</h1><p>ä¸€äº›è¢«è®¾è®¡å¥½çš„Pythonæ–‡ä»¶æ¨¡å—è¢«ç§°ä¸ºåº“ï¼Œå³ä¸€ä¸ªæä¾›ç‰¹å®šåŠŸèƒ½çš„python å‡½æ•°&#x2F;ç±»ä»“åº“</p><p>åº“é€šå¸¸åˆ†ä¸ºä¸¤ç§:</p><p>éšPythonä¸€èµ·å®‰è£…çš„ï¼Œæä¾›äº†ä¸€äº›æ ¸å¿ƒåŠŸèƒ½çš„åº“ è¢«ç§°ä¸ºå®˜æ–¹åº“ï¼Œé€šå¸¸å­˜å‚¨åœ¨</p><p>Python\Python313\Lib</p><p>ä¸€äº›ä¼˜ç§€çš„ï¼Œå¯ä»¥æä¾›æ‰©å±•åŠŸèƒ½çš„ è¢«ç§°ä¸ºç¬¬ä¸‰æ–¹åº“ï¼Œé€šå¸¸å­˜å‚¨åœ¨</p><p>Python\Python313\Lib\site-packages</p><h2 id="ç¬¬ä¸‰æ–¹åº“å¯ä»¥é€šè¿‡pip-çš„pythonåº“ç®¡ç†å·¥å…·æ¥å®‰è£…"><a href="#ç¬¬ä¸‰æ–¹åº“å¯ä»¥é€šè¿‡pip-çš„pythonåº“ç®¡ç†å·¥å…·æ¥å®‰è£…" class="headerlink" title="ç¬¬ä¸‰æ–¹åº“å¯ä»¥é€šè¿‡pip çš„pythonåº“ç®¡ç†å·¥å…·æ¥å®‰è£…"></a>ç¬¬ä¸‰æ–¹åº“å¯ä»¥é€šè¿‡pip çš„pythonåº“ç®¡ç†å·¥å…·æ¥å®‰è£…</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">pip install requests                      <span class="hljs-comment"># å®‰è£…requestsåº“</span><br>pip uninstall requests                    <span class="hljs-comment"># å¸è½½requestsåº“</span><br>pip <span class="hljs-built_in">list</span>                                  <span class="hljs-comment"># æŸ¥è¯¢å·²å®‰è£…çš„pythonç¬¬ä¸‰æ–¹åº“</span><br></code></pre></td></tr></table></figure><h1 id="å®˜æ–¹åº“"><a href="#å®˜æ–¹åº“" class="headerlink" title="å®˜æ–¹åº“"></a>å®˜æ–¹åº“</h1><p>ä»‹ç»ä¸€äº›æ¯”è¾ƒå¸¸ç”¨çš„å®˜æ–¹åº“</p><h2 id="time"><a href="#time" class="headerlink" title="time"></a>time</h2><p>timeåº“ä¸»è¦ç”¨æ¥è·å–unixæ—¶é—´ï¼Œä»¥åŠæ‰§è¡Œæš‚åœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br>time.time()                               <span class="hljs-comment"># è·å–å½“å‰çš„unixæ—¶é—´</span><br>time.strftime(<span class="hljs-string">&quot;%Y %m %d -%H:%M:%S&quot;</span>)  <span class="hljs-comment"># æŒ‰ç…§ç»™å®šçš„å­—ç¬¦ä¸²æ ¼å¼è¾“å‡ºæ—¶é—´ï¼Œé»˜è®¤å°†å½“å‰unixæ—¶é—´æŒ‰æ ¼å¼è¾“å‡º</span><br>time.strptime(<span class="hljs-string">&quot;2017-12-08:5-32-11&quot;</span>,<span class="hljs-string">&quot;%Y-%m-%d:%H-%M-%S&quot;</span>)) <span class="hljs-comment"># å°†æ¥æ”¶åˆ°çš„æ—¶é—´å­—ç¬¦æ‹†åˆ†ä½å…ƒç»„</span><br>time.sleep(<span class="hljs-number">1</span>)                         <span class="hljs-comment"># ä¼‘çœ æ—¶é—´ ä¼ å…¥ç§’</span><br></code></pre></td></tr></table></figure><h2 id="os"><a href="#os" class="headerlink" title="os"></a>os</h2><p>osåº“æä¾›äº†ä¸€äº›åŸºäºå½“å‰æ“ä½œç³»ç»Ÿçš„æ“ä½œï¼Œä¹Ÿæä¾›äº†å¤šç§å‘ç³»ç»Ÿç»ˆç«¯æ‰§è¡Œå‘½ä»¤çš„æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>os.mkdir()               <span class="hljs-comment">#åˆ›å»ºæ–‡ä»¶å¤¹</span><br>os.chdir()               <span class="hljs-comment">#ä¿®æ”¹å½“å‰è·¯å¾„</span><br>os.getcwd()              <span class="hljs-comment">#è·å–å½“å‰çš„è·¯å¾„</span><br>os.system(<span class="hljs-string">&quot;dir&quot;</span>)         <span class="hljs-comment">#å‘ç³»ç»Ÿå‘é€å‘½ä»¤</span><br></code></pre></td></tr></table></figure><h2 id="Json"><a href="#Json" class="headerlink" title="Json"></a>Json</h2><p>json åº“æ˜¯ç”¨äºjsonæ–‡ä»¶çš„å¤„ç†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;hello.json&quot;</span>,<span class="hljs-string">&#x27;r&#x27;</span>,encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> f :<br>    content1 = json.load(f)<br><span class="hljs-comment"># ç›´æ¥åŠ è½½æ–‡ä»¶åˆ°python</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;hello.json&quot;</span>,<span class="hljs-string">&#x27;r&#x27;</span>,encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> f :<br>    content2 = f.read()<br>    content2 = json.loads(content2)<br><span class="hljs-comment"># å°†å­—ç¬¦ä¸²è§£æä¸ºdict </span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;goodbye.json&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>,encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> f :<br>    json.dump(content1, f)<br><span class="hljs-comment"># å°†å­—ç¬¦ä¸²è§£æä¸ºjsonå†™å…¥æ–‡ä»¶</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;goodby2e.json&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>,encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> f :<br>    json.dump(content2,f,indent=<span class="hljs-number">4</span>)<br> <span class="hljs-comment"># ç›´æ¥å‘æ–‡ä»¶å¯¹è±¡ä¸­å†™å…¥</span><br></code></pre></td></tr></table></figure><h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><p>reæ˜¯ç”¨äºå¯¹æ–‡æœ¬è¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</p><p>æ­£åˆ™è¡¨è¾¾å¼æ˜¯ä¸€ç§å­—ç¬¦åŒ¹é…è§„åˆ™ï¼Œé€šè¿‡ä¸€äº›é€šé…ç¬¦çš„ç»„åˆæ¥è¾¾æˆç­›é€‰ç¬¦åˆç»“æ„è§„åˆ™çš„æ•°æ®</p><p>ä¸€äº›å¸¸ç”¨çš„é€šé…è§„åˆ™</p><p>[0-9] [\d]  åŒ¹é…æ‰€æœ‰0-9çš„æ•´æ•°å­—ç¬¦</p><p>. åŒ¹é…ä»»æ„å­—ç¬¦</p><p>.*åŒ¹é…ä¸€ä¸ªåˆ°å¤šä¸ªä»»æ„å­—ç¬¦</p><p>[a-z] åŒ¹é…å°å†™å­—ç¬¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br>a = <span class="hljs-string">&quot;456jaoijgeio123feqagvbjm&quot;</span><br><br><span class="hljs-built_in">print</span>(re.<span class="hljs-keyword">match</span>(<span class="hljs-string">&quot;[1-9]&#123;3&#125;&quot;</span>,a ).group(<span class="hljs-number">0</span>))  <span class="hljs-comment"># é€šè¿‡.group è·å–åŒ¹é…åˆ°çš„æ–‡æœ¬</span><br>d = re.finditer(<span class="hljs-string">&quot;[1-9]&#123;3&#125;&quot;</span>,a )           <span class="hljs-comment"># ä½¿ç”¨finditerä¼šä¼šçš„ä¸€ä¸ªåŒ¹é…å¯¹è±¡çš„å¯è¿­ä»£å¯¹è±¡</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d :<br>    <span class="hljs-built_in">print</span>(i.group())                     <span class="hljs-comment"># è®¿é—®å¯è¿­ä»£å¯¹è±¡</span><br></code></pre></td></tr></table></figure><h2 id="argparse"><a href="#argparse" class="headerlink" title="argparse"></a>argparse</h2><p>argpare åº“ å…è®¸è‡ªå®šä¹‰å‚æ•°ï¼Œå¹¶å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œè§£æ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> argparse<br><br><span class="hljs-comment"># åˆ›å»º ArgumentParser å¯¹è±¡</span><br>parser = argparse.ArgumentParser(description=<span class="hljs-string">&quot;Simple calculator&quot;</span>)<br><br><span class="hljs-comment"># æ·»åŠ å‚æ•°</span><br>parser.add_argument(<span class="hljs-string">&quot;--x&quot;</span>, <span class="hljs-built_in">type</span>=<span class="hljs-built_in">int</span>, required=<span class="hljs-literal">True</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;First integer&quot;</span>)<br>parser.add_argument(<span class="hljs-string">&quot;--y&quot;</span>, <span class="hljs-built_in">type</span>=<span class="hljs-built_in">int</span>, required=<span class="hljs-literal">True</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Second integer&quot;</span>)<br>parser.add_argument(<span class="hljs-string">&quot;--op&quot;</span>, <span class="hljs-built_in">type</span>=<span class="hljs-built_in">str</span>, default=<span class="hljs-string">&quot;add&quot;</span>, choices=[<span class="hljs-string">&quot;add&quot;</span>, <span class="hljs-string">&quot;sub&quot;</span>, <span class="hljs-string">&quot;mul&quot;</span>, <span class="hljs-string">&quot;div&quot;</span>], <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Operation&quot;</span>)<br><br><span class="hljs-comment"># è§£æå‚æ•°</span><br>args = parser.parse_args()<br><br><span class="hljs-comment"># æ‰§è¡Œè¿ç®—</span><br><span class="hljs-keyword">if</span> args.op == <span class="hljs-string">&quot;add&quot;</span>:<br>    result = args.x + args.y<br><span class="hljs-keyword">elif</span> args.op == <span class="hljs-string">&quot;sub&quot;</span>:<br>    result = args.x - args.y<br><span class="hljs-keyword">elif</span> args.op == <span class="hljs-string">&quot;mul&quot;</span>:<br>    result = args.x * args.y<br><span class="hljs-keyword">elif</span> args.op == <span class="hljs-string">&quot;div&quot;</span>:<br>    result = args.x / args.y<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Result: <span class="hljs-subst">&#123;result&#125;</span>&quot;</span>)<br><br><span class="hljs-comment">#ç¤ºä¾‹</span><br><br>python calc.py --x <span class="hljs-number">3</span> --y <span class="hljs-number">5</span> --op add <br><span class="hljs-comment"># æ‰§è¡Œ3+5 ï¼Œå¹¶è¿”å›ç»“æœ</span><br></code></pre></td></tr></table></figure><h2 id="configparser"><a href="#configparser" class="headerlink" title="configparser"></a>configparser</h2><p>configparseråº“ç”¨äºå¯¹ é…ç½®æ–‡ä»¶ï¼ˆ.iniï¼‰è¿›è¡Œè¯»å†™</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python">ä¾‹å¦‚ ï¼š<br>[database]<br>host = localhost<br>port = <span class="hljs-number">3306</span><br>user = root<br>password = <span class="hljs-number">123456</span><br><br>[logging]<br>level = DEBUG<br>logfile = app.log<br><br><span class="hljs-keyword">import</span> configparser<br><br><span class="hljs-comment"># åˆ›å»ºé…ç½®è§£æå™¨</span><br>config = configparser.ConfigParser()<br><br><span class="hljs-comment"># è¯»å–é…ç½®æ–‡ä»¶</span><br>config.read(<span class="hljs-string">&quot;config.ini&quot;</span>)<br><br><span class="hljs-comment"># è·å–å…·ä½“å€¼</span><br>host = config.get(<span class="hljs-string">&quot;database&quot;</span>, <span class="hljs-string">&quot;host&quot;</span>)<br>port = config.getint(<span class="hljs-string">&quot;database&quot;</span>, <span class="hljs-string">&quot;port&quot;</span>)<br>log_level = config.get(<span class="hljs-string">&quot;logging&quot;</span>, <span class="hljs-string">&quot;level&quot;</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Database host: <span class="hljs-subst">&#123;host&#125;</span>&quot;</span>)       <span class="hljs-comment"># localhost</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Database port: <span class="hljs-subst">&#123;port&#125;</span>&quot;</span>)       <span class="hljs-comment"># 3306</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Log level: <span class="hljs-subst">&#123;log_level&#125;</span>&quot;</span>)      <span class="hljs-comment"># DEBUG</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonç¼–ç¨‹ IV æ•°æ®ä¸å‡½æ•°æ‰©å±•</title>
    <link href="/2025/04/15/Python%E7%BC%96%E7%A8%8B-IV-%E6%95%B0%E6%8D%AE%E4%B8%8E%E5%87%BD%E6%95%B0%E6%89%A9%E5%B1%95/"/>
    <url>/2025/04/15/Python%E7%BC%96%E7%A8%8B-IV-%E6%95%B0%E6%8D%AE%E4%B8%8E%E5%87%BD%E6%95%B0%E6%89%A9%E5%B1%95/</url>
    
    <content type="html"><![CDATA[<p><em>pythonä¸­ï¼Œå®šä¹‰äº†ä¸€äº›æœ‰ç”¨çš„ç‰¹æ€§å¸®åŠ©ç¼–ç¨‹äººå‘˜ä¸°å¯ŒåŠŸèƒ½çš„å¤„ç†è¿‡ç¨‹</em></p><h1 id="è£…é¥°å™¨"><a href="#è£…é¥°å™¨" class="headerlink" title="è£…é¥°å™¨"></a>è£…é¥°å™¨</h1><p>åœ¨ ç±»è®¾è®¡æ€æƒ³ä¸­ æœ‰ä¸€æ¡å¼€é—­åŸåˆ™ â€œå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­â€ã€‚ åœ¨å‰é¢çš„å†…å®¹ä¸­ï¼Œæˆ‘ä»¬å·²ç»è®¨è®ºè¿‡ä¸€äº› pythonå¯¹äºå°è£…ç‰¹æ€§çš„å¤„ç†ã€‚ è¿™é‡Œçš„è£…é¥°å™¨å°±æ˜¯ç”¨äºå¯¹å·²å®šä¹‰ç±»è¿›è¡ŒåŠŸèƒ½æ‰©å±•çš„ä¸€ç§æ–¹æ³•ã€‚</p><p>å¦‚property é€šè¿‡ä¸ºæ–¹æ³•è£…é¥°property,å¯ä»¥å°†æ–¹æ³•ä¼ªè£…æˆå±æ€§è°ƒç”¨ï¼Œè€Œä¸æ˜¯ç›´æ¥å¯¹ç±»ä¸­çš„å±æ€§è¿›è¡Œæ“ä½œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">person</span> :<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name</span>):<br>        <span class="hljs-variable language_">self</span>.__name = name<br><br><span class="hljs-meta">    @property</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">name</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.__name<br><span class="hljs-meta">    @name.setter</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">name</span>(<span class="hljs-params">self,name</span>):<br>        <span class="hljs-variable language_">self</span>.__name = name<br>        <br>        <br>preson1 = person(<span class="hljs-string">&quot;wang&quot;</span>)<br><span class="hljs-built_in">print</span>(preson1.name)<br><span class="hljs-comment"># output wang</span><br>preson1.name = <span class="hljs-string">&quot;zhao&quot;</span><br><span class="hljs-built_in">print</span>(preson1.name)<br><span class="hljs-comment"># output zhao</span><br></code></pre></td></tr></table></figure><p>ç”±è¿™ä¸ªä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œé€šè¿‡@property ï¼Œå¹¶æœªå¯¹åŸå§‹ç±»è¿›è¡Œä¿®æ”¹ï¼Œä½†æ˜¯å¯¹å®ƒæœ€ç»ˆè¡Œä¸ºäº§ç”Ÿäº†å½±å“</p><h2 id="å¦‚ä½•å®šä¹‰ä¸€ä¸ªè£…é¥°å™¨"><a href="#å¦‚ä½•å®šä¹‰ä¸€ä¸ªè£…é¥°å™¨" class="headerlink" title="å¦‚ä½•å®šä¹‰ä¸€ä¸ªè£…é¥°å™¨"></a>å¦‚ä½•å®šä¹‰ä¸€ä¸ªè£…é¥°å™¨</h2><p>è£…é¥°å™¨çš„æœ¬è´¨æ˜¯å®šä¹‰ä¸€ä¸ªå‡½æ•° æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œ å¹¶åœ¨å‡½æ•°å†…éƒ¨å†å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå°†æ¥æ”¶è¿›æ¥çš„å‚æ•°åœ¨è¯¥å‡½æ•°å†…æ‰§è¡Œï¼Œæœ€ç»ˆè¿”å›è¯¥å‡½æ•°</p><p>å› ä¸ºä¹‹å‰è®¨è®ºè¿‡ â€œ__call__â€ æ–¹æ³•åœ¨æ¥æ”¶å‚æ•°è¿™æ–¹é¢å’Œå‡½æ•°ä¸€è‡´ï¼Œæ‰€ä»¥æœ‰ä¸¤ç§å®šä¹‰æ–¹æ³•</p><p>è£…é¥°å™¨çš„åŸºç¡€å®šä¹‰ ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_hello</span>(<span class="hljs-params">func</span>):                              <span class="hljs-comment"># å®šä¹‰è£…é¥°å‡½æ•°</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wapper</span>(<span class="hljs-params">*args ,**kwargs</span>) :                 <span class="hljs-comment"># å®šä¹‰å†…éƒ¨å‡½æ•°, åœ¨è¿™ä¸€å±‚æ¥æ”¶åŸå‡½æ•°çš„å‚æ•°</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hello user&quot;</span>)                   <span class="hljs-comment"># æ‰§è¡Œå‡½æ•°å‰çš„é¢„å¤„ç†</span><br>            func(*args ,**kwargs)                 <span class="hljs-comment"># å‡½æ•°æ‰§è¡Œ </span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;goodbye user&quot;</span>)                 <span class="hljs-comment"># å‡½æ•°ç»“æŸ</span><br>    <span class="hljs-keyword">return</span> wapper                                 <span class="hljs-comment"># å°†æ„å»ºçš„å‡½æ•°ä½œä¸ºè¿”å›å€¼</span><br><br><span class="hljs-meta">@add_hello                                        </span><span class="hljs-comment"># å°†è£…é¥°å™¨æ·»åŠ åœ¨å‡½æ•°å®šä¹‰ä¸Š</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">base_function</span>(<span class="hljs-params">parameter</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;this is a parmeter <span class="hljs-subst">&#123;parameter&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;this is a base function&quot;</span>) <br><br><br>base_function(<span class="hljs-string">&quot;hello&quot;</span>)<br><br><span class="hljs-comment"># æ‰§è¡Œ </span><br><span class="hljs-comment"># hello user                                      # é¢„å¤„ç†</span><br><span class="hljs-comment"># this is a parmeter hello                        # å‡½æ•°ä»£ç å—æ‰§è¡Œ</span><br><span class="hljs-comment"># this is a base function                         # å‡½æ•°ä»£ç å—æ‰§è¡Œ</span><br><span class="hljs-comment"># goodbye user                                    # ç»“æŸ</span><br><br></code></pre></td></tr></table></figure><p>æ‰©å±•1 : è£…é¥°å™¨æœ¬èº«ä¹Ÿå¯ä»¥æ¥æ”¶å‚æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">*outter_args,**outter_kwargs</span>):            <span class="hljs-comment"># å®šä¹‰è£…é¥°å‡½æ•°ï¼Œè¿™ä¸€å±‚æ¥æ”¶è£…é¥°å™¨å‚æ•°</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_hello</span>(<span class="hljs-params">func</span>):                          <span class="hljs-comment"># å®šä¹‰å†…éƒ¨å‡½æ•°, è¿™ä¸€å±‚æ¥æ”¶å‡½æ•°</span><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">wapper</span>(<span class="hljs-params">*args ,**kwargs</span>) :             <span class="hljs-comment"># å®šä¹‰å®é™…çš„è£…é¥°å™¨å‡½æ•°, æ¥æ”¶å‡½æ•°çš„å˜é‡</span><br>                <span class="hljs-built_in">print</span>(outter_args[<span class="hljs-number">0</span>])             <span class="hljs-comment"># æ‰“å°æ¥æ”¶åˆ°çš„è£…é¥°å™¨å‚æ•°</span><br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hello user&quot;</span>)               <span class="hljs-comment"># é¢„å¤„ç†</span><br>                func(*args ,**kwargs)             <span class="hljs-comment"># å‡½æ•°æ‰§è¡Œ</span><br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;goodbye user&quot;</span>)             <span class="hljs-comment"># ç»“æŸ</span><br>        <span class="hljs-keyword">return</span> wapper                             <span class="hljs-comment"># è¿”å›è£…é¥°å™¨å‡½æ•°</span><br>    <span class="hljs-keyword">return</span> add_hello                              <span class="hljs-comment"># è¿”å›å¤–å±‚å‡½æ•°</span><br><br><span class="hljs-meta">@add(<span class="hljs-params"><span class="hljs-string">&quot;hi&quot;</span></span>)                                        </span><span class="hljs-comment"># æ·»åŠ å¸¦å‚è£…é¥°å™¨</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">base_function</span>(<span class="hljs-params">parameter</span>):                     <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;this is a parmeter <span class="hljs-subst">&#123;parameter&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;this is a base function&quot;</span>) <br><br><br>base_function(<span class="hljs-string">&quot;hello&quot;</span>)                    <br><br><span class="hljs-comment"># è¾“å‡º                                             </span><br><span class="hljs-comment"># hi                                              # æ¥æ”¶åˆ°çš„è£…é¥°å™¨å‚æ•°</span><br><span class="hljs-comment"># hello user                                      # é¢„å¤„ç†</span><br><span class="hljs-comment"># this is a parmeter hello                        # å‡½æ•°ä»£ç æ‰§è¡Œ</span><br><span class="hljs-comment"># this is a base function                         # å‡½æ•°ä»£ç æ‰§è¡Œ</span><br><span class="hljs-comment"># goodbye user                                    # ç»“æŸ</span><br></code></pre></td></tr></table></figure><p>æ‰©å±•2ï¼šè£…é¥°å™¨è£…é¥°åœ¨ç±»ä¸Š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">*outter_args,**outter_kwargs</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_hello</span>(<span class="hljs-params">func</span>):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">wapper</span>(<span class="hljs-params">*args ,**kwargs</span>) :<br>                <span class="hljs-built_in">print</span>(outter_args[<span class="hljs-number">0</span>])<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hello user&quot;</span>)<br>                m = func(*args ,**kwargs)         <span class="hljs-comment"># ä¸»è¦è¦å°†å®ä¾‹åˆ›å»ºçš„å¯¹è±¡è¿”å›ï¼Œè¿™é‡Œæ‰§è¡Œçš„å®é™…ä¸Šæ˜¯å¯¹è±¡çš„åˆå§‹åŒ–</span><br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;goodbye user&quot;</span>)<br>                <span class="hljs-keyword">return</span> m <br>        <span class="hljs-keyword">return</span> wapper<br>    <span class="hljs-keyword">return</span> add_hello<br><br><span class="hljs-meta">@add(<span class="hljs-params"><span class="hljs-string">&quot;hi&quot;</span></span>)</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">person</span> :<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;class person is on initing&quot;</span>)<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">self,message</span>):<br>        <span class="hljs-built_in">print</span>(message)<br><br>p = person()<br>p(<span class="hljs-string">&quot;hello&quot;</span>)<br><br><span class="hljs-comment"># è¾“å‡º                                             </span><br><span class="hljs-comment"># hi                                              # æ‰“å°æ¥æ”¶åˆ°çš„è£…é¥°å™¨å‚æ•°</span><br><span class="hljs-comment"># hello user                                      # é¢„å¤„ç†</span><br><span class="hljs-comment"># class person is on initing                      # ç±»è°ƒç”¨</span><br><span class="hljs-comment"># goodbye user                                    # ç»“æŸ</span><br><span class="hljs-comment"># hello                                           # å®ä¾‹çš„è°ƒç”¨</span><br></code></pre></td></tr></table></figure><p>è£…é¥°å™¨æ˜¯ä¸€ç§è¯­æ³•ç³–ï¼Œå…¶æœ¬è´¨æ˜¯é€šè¿‡å¤šå±‚åµŒå¥—å‡½æ•°å®ç°çš„è¿è¡Œæ—¶å‡½æ•°å¢å¼ºæœºåˆ¶ã€‚</p><p>é¡ºåºæ˜¯ å®šä¹‰å‡½æ•°ä¼ å…¥è£…é¥°å™¨å‚æ•°-å®šä¹‰å‡½æ•°ä¼ å…¥å‡½æ•°-å®šä¹‰å‡½æ•°ä¼ å…¥åŸå‡½æ•°å‚æ•°-å®šä¹‰å‡½æ•°ä¼ å…¥åŸå‡½æ•°ã€‚ç„¶åå†é€å±‚è¿”å›ï¼Œå¦å¤–å°±æ˜¯ç”¨åˆ°äº†pythonçš„ä½œç”¨åŸŸæœºåˆ¶ï¼Œå³å®šä¹‰çš„å†…éƒ¨å‡½æ•°å¯¹å¤–éƒ¨çš„å±€éƒ¨å˜é‡æ˜¯å¯ä»¥è®¿é—®çš„</p><p>æ‰©å±•3 ï¼šä½¿ç”¨ç±»å®šä¹‰è£…é¥°å™¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">add</span> :<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name</span>):                      <span class="hljs-comment"># æ¥æ”¶çš„è£…é¥°å™¨ å‚æ•° ç›¸å½“äºæ‰§è¡Œäº†åˆå§‹åŒ–</span><br>        <span class="hljs-variable language_">self</span>.name = name<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">self,func</span>):                      <span class="hljs-comment"># æ¥æ”¶å‡½æ•°</span><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">wapper</span>(<span class="hljs-params">*args,**kwargs</span>):               <span class="hljs-comment"># æ¥æ”¶å‡½æ•°çš„å‚æ•°</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-variable language_">self</span>.name)                      <span class="hljs-comment"># è·å–åˆ°çš„å®ä¾‹å±æ€§</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hello user&quot;</span>)                   <span class="hljs-comment"># é¢„å¤„ç†</span><br>            func(*args)                           <span class="hljs-comment"># æ‰§è¡Œå‡½æ•°</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;goodby user&quot;</span>)                  <span class="hljs-comment"># ç»“æŸ</span><br>        <span class="hljs-keyword">return</span> wapper                             <span class="hljs-comment"># è¿”å›å‡½æ•°</span><br><br><span class="hljs-meta">@add(<span class="hljs-params"><span class="hljs-string">&quot;codfish&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">base_function</span>(<span class="hljs-params">parameter</span>):                     <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;this is a parmeter <span class="hljs-subst">&#123;parameter&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;this is a base function&quot;</span>) <br><br>base_function(<span class="hljs-string">&quot;base_parameter&quot;</span>)<br><br><span class="hljs-comment"># è¾“å‡º</span><br><span class="hljs-comment"># codfish                                         # æ¥æ”¶åˆ°çš„è£…é¥°å™¨å‚æ•°</span><br><span class="hljs-comment"># hello user                                      # é¢„å¤„ç†</span><br><span class="hljs-comment"># this is a parmeter base_parameter               # å‡½æ•°æ‰§è¡Œ</span><br><span class="hljs-comment"># this is a base function                         # å‡½æ•°æ‰§è¡Œ</span><br><span class="hljs-comment"># goodby user                                     # ç»“æŸ</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä»¥ç±»ä½œä¸ºè£…é¥°å™¨çš„å¤§ä½“é€»è¾‘æ˜¯ä¸€è‡´çš„ æ— éå°±æ˜¯ å‡½æ•°å’Œå‚æ•°ä¼ å…¥ä½ç½®å‘ç”Ÿäº†å˜åŒ–</p><h1 id="è¿­ä»£å™¨"><a href="#è¿­ä»£å™¨" class="headerlink" title="è¿­ä»£å™¨"></a>è¿­ä»£å™¨</h1><p>è¿­ä»£å™¨æ˜¯ä¸€ç§è®©åˆ›å»ºçš„å®ä¾‹è·å¾—å¦‚åˆ—è¡¨æˆ–è€…å…ƒç»„ç­‰ç»“æ„ä¸€æ ·ï¼Œå…è®¸ä½¿ç”¨for å¾ªç¯éå†æ•´ä¸ªæ•°æ®ç»“æ„ä¸­çš„å…ƒç´ çš„ç‰¹æ€§ã€‚å…¶æœ¬è´¨æ˜¯é€šè¿‡å®ç°ä¸¤ä¸ªé­”æœ¯æ–¹æ³•å®ç°çš„ â€œ__iter__â€ å’Œ â€œ__next__â€</p><p>â€œ__iter__â€ ä¼šè¿”å›ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡</p><p>â€œ__next__â€ åˆ™æ˜¯ä¼šè·å–å¯è¿­ä»£å¯¹è±¡ä¸­çš„ä¸‹ä¸€ä¸ªå€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">num_group</span> :<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.num = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__iter__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span><br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__next__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.num+=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.num &gt; <span class="hljs-number">10</span> :<br>            <span class="hljs-keyword">raise</span> StopIteration<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.num<br>    <br><br>a = num_group()<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">next</span>(a))                                   <span class="hljs-comment"># æ—¢å¯ä»¥é€šè¿‡next(a) è·å–è¿­ä»£å¯¹è±¡ä¸­çš„ä¸‹ä¸€ä¸ªè¿”å›</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:                                      <span class="hljs-comment"># ä¹Ÿå¯ä»¥é€šè¿‡éå†æ¥å®Œæˆè¿­ä»£å¯¹è±¡çš„å€¼éå†</span><br>    <span class="hljs-built_in">print</span>(i)<br></code></pre></td></tr></table></figure><h1 id="ç”Ÿæˆå™¨"><a href="#ç”Ÿæˆå™¨" class="headerlink" title="ç”Ÿæˆå™¨"></a>ç”Ÿæˆå™¨</h1><p>ä¸ é€šè¿‡åˆ—è¡¨ä¸­æŸ¥è¯¢æ•°æ®ä¸åŒï¼ŒPython è¿˜æä¾›äº†ä¸€ä¸ªç»„ä»¶ yieldæ¥ç”Ÿæˆæ•°æ®ã€‚</p><p>åœ¨ä¸€ä¸ªå‡½æ•°ä¸­å®šä¹‰äº†yieldå…³é”®å­—åï¼Œè¯¥å‡½æ•°è¢«ç§°ä¸ºç”Ÿæˆå™¨ã€‚</p><p>å½“æ‰§è¡Œåˆ°è¯¥å‡½æ•°æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ã€‚è¿™ä¸ªç”Ÿæˆå™¨å¯¹è±¡ä¼šä¿ç•™å…¶æ‰§è¡Œæ‰€ä½¿ç”¨çš„æ ˆå¸§ç»“æ„ã€‚</p><p>å½“è¿è¡Œåˆ°yieldå…³é”®å­—æ—¶ï¼Œä¼šå°†å€¼è¿”å›ï¼Œç”Ÿæˆå™¨å¯¹è±¡æš‚åœï¼Œå¹¶å®Œæ•´ä¿ç•™å½“å‰çš„æ‰§è¡ŒçŠ¶æ€ã€‚å½“ç”Ÿæˆå™¨å¯¹è±¡çš„ä»£ç æ‰§è¡Œå®Œæ¯•åï¼Œç”Ÿæˆå™¨å¯¹è±¡ä¼šé€€å‡ºç­‰å¾…GCå›æ”¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">count</span>(<span class="hljs-params">num=<span class="hljs-number">0</span></span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span> :<br>        <span class="hljs-keyword">yield</span> num                                 <span class="hljs-comment"># å£°æ˜äº†yield,python ä¼šå°†è¿™ä¸ªå‡½æ•°ä½œä¸ºç”Ÿæˆå™¨å¤„ç†</span><br>        <span class="hljs-keyword">if</span> num &gt; <span class="hljs-number">10</span> :<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">100</span><br>        num+=<span class="hljs-number">1</span><br>        <br>b = count()                                       <span class="hljs-comment"># æ‰§è¡Œå‡½æ•°è¿”å›ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> b :<br>    <span class="hljs-built_in">print</span>(i)                                      <span class="hljs-comment"># for å¾ªç¯ä¼šæŒç»­è°ƒç”¨ç”Ÿæˆå™¨çš„ __next__() æ–¹æ³•ï¼Œç›´åˆ°æ•è·åˆ° StopIteration å¼‚å¸¸ï¼Œè¡¨ç¤ºè¿­ä»£ç»“æŸã€‚</span><br></code></pre></td></tr></table></figure><h1 id="å†…å»ºçš„ä½œç”¨åŸŸè®¾ç½®å‡½æ•°-setattr-getattr-delattr"><a href="#å†…å»ºçš„ä½œç”¨åŸŸè®¾ç½®å‡½æ•°-setattr-getattr-delattr" class="headerlink" title="å†…å»ºçš„ä½œç”¨åŸŸè®¾ç½®å‡½æ•° setattr,getattr,delattr"></a>å†…å»ºçš„ä½œç”¨åŸŸè®¾ç½®å‡½æ•° setattr,getattr,delattr</h1><p>åœ¨pythonä¸­å‘½åç©ºé—´å†³å®šäº†ä¸€ä¸ªå¯¹è±¡éƒ½å¯ä»¥è®¿é—®å“ªäº›å¯¹è±¡ï¼Œè€Œé€šè¿‡setattr,getattrå’Œdelattr å¯ä»¥ç›´æ¥å¯¹å¯¹è±¡çš„å‘½åç©ºé—´è¿›è¡Œæ“ä½œï¼Œæ¥ä¿®æ”¹å¯¹è±¡çš„è®¿é—®æƒé™</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">person</span>:                                     <span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªç±»</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name</span>):                      <span class="hljs-comment"># é‡å†™æ„é€ å‡½æ•°</span><br>        <span class="hljs-variable language_">self</span>.name = name <br><br><span class="hljs-built_in">delattr</span>(person,<span class="hljs-string">&quot;__init__&quot;</span>)                        <span class="hljs-comment"># åˆ é™¤personç±»ä¸­çš„æ„é€ å‡½æ•°å®šä¹‰</span><br>someone = person()                                <span class="hljs-comment"># å¯¹è±¡æ­£å¸¸åˆ›å»º</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">person</span>:                                     <span class="hljs-comment"># å®šä¹‰ç©ºç´¯ person</span><br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name</span>):                          <span class="hljs-comment"># å®šä¹‰å…¨å±€æ–¹æ³• __init__</span><br>    <span class="hljs-variable language_">self</span>.name = name <br><span class="hljs-built_in">setattr</span>(person,<span class="hljs-string">&quot;__init__&quot;</span>,__init__)               <span class="hljs-comment"># å°†æ–¹æ³•è®¾ç½®åˆ°personçš„å‘½åç©ºé—´</span><br>c = person(<span class="hljs-string">&quot;wang&quot;</span>)                                <span class="hljs-comment"># æ­£å¸¸å®ä¾‹åŒ–</span><br><span class="hljs-built_in">print</span>(c.name)                                     <span class="hljs-comment"># è¾“å‡º â€œwangâ€</span><br></code></pre></td></tr></table></figure><p>ä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹å‡º pythonä¸­çš„ç±»å’Œæ–¹æ³•çš„å…³ç³»æ˜¯æ¾æ•£ç»‘å®šçš„ã€‚</p><p>å¹¶ä¸”è¿˜æ˜¯å®æ—¶çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">person</span>:<br>    <span class="hljs-keyword">pass</span><br>person1 = person(<span class="hljs-string">&quot;wang&quot;</span>)                          <span class="hljs-comment"># person1åˆ›å»ºå¤±è´¥</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name</span>):<br>    <span class="hljs-variable language_">self</span>.name = name <br><span class="hljs-built_in">setattr</span>(person,<span class="hljs-string">&quot;__init__&quot;</span>,__init__)<br>person2 = person(<span class="hljs-string">&quot;wang&quot;</span>)                          <span class="hljs-comment"># person2åˆ›å»ºæˆåŠŸ</span><br><span class="hljs-built_in">print</span>(c.name)<br></code></pre></td></tr></table></figure><p>ç”±æ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºpython åœ¨æ‰§è¡Œé˜¶æ®µæ˜¯é€è¡Œè§£é‡Šçš„</p><p>åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå¯ä»¥å¯¹pythonçš„ä»£ç è¿›è¡Œæµç¨‹æ§åˆ¶ç­‰æ“ä½œ</p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonç¼–ç¨‹ III é­”æœ¯æ–¹æ³•</title>
    <link href="/2025/04/15/Python-%E7%BC%96%E7%A8%8B-III-%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95/"/>
    <url>/2025/04/15/Python-%E7%BC%96%E7%A8%8B-III-%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<p><em>Pythonä¸­ç”¨äºå¯¹å¯¹è±¡è¿›è¡Œçš„ä¸€äº›æ§åˆ¶å’Œé€šç”¨å¤„ç† æ˜¯é€šè¿‡é­”æœ¯æ–¹æ³•æ¥å®ç°</em></p><h1 id="ä»€ä¹ˆæ˜¯é­”æœ¯æ–¹æ³•"><a href="#ä»€ä¹ˆæ˜¯é­”æœ¯æ–¹æ³•" class="headerlink" title="ä»€ä¹ˆæ˜¯é­”æœ¯æ–¹æ³•"></a>ä»€ä¹ˆæ˜¯é­”æœ¯æ–¹æ³•</h1><p>é€šè¿‡__function_name__ æ¥å®šä¹‰é­”æœ¯æ–¹æ³•ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„é€šå¸¸çš„é­”æœ¯æ–¹æ³•æ˜¯pythoné¢„ç½®çš„ï¼Œæ‰€ä»¥function_nameé€šå¸¸æ˜¯pythonä¸­å®šä¹‰è¿‡çš„é­”æœ¯æ–¹æ³•åã€‚</p><p>Pythonçš„é­”æœ¯æ–¹æ³•å¦‚æœæ²¡æœ‰åœ¨ç±»ä¸­è¿›è¡Œå®šä¹‰ï¼Œåˆ™æ˜¯è¢«éšå¼å®šä¹‰çš„ï¼ˆæˆ–è€…è¯´ç”±åŸºç±»ç»§æ‰¿è€Œæ¥ï¼‰</p><p>å¦‚æœ€å¸¸è§çš„__init__ ä¹Ÿæ˜¯ä¸€ä¸ªé­”æœ¯æ–¹æ³•ã€‚å®ƒå‘ç”Ÿåœ¨Pythonå®ä¾‹çš„æ„å»ºé˜¶æ®µï¼Œé€šè¿‡__init__ æ¥å®Œæˆå¯¹ç±»å®šä¹‰å±æ€§çš„åˆå§‹èµ‹å€¼ :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#å®šä¹‰ä¸€ä¸ª ç±»çš„åˆå§‹åŒ–æ–¹æ³•</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">person</span> :<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name</span>) :<br> <span class="hljs-variable language_">self</span>.name = name<br></code></pre></td></tr></table></figure><p>è¿™æ · nameå°±ä»ä¸€ä¸ªå±€éƒ¨å˜é‡æˆä¸ºä¸€ä¸ªpersonå®ä¾‹çš„å®ä¾‹å±æ€§</p><h1 id="â€œ-new-â€"><a href="#â€œ-new-â€" class="headerlink" title="â€œ__new__â€"></a>â€œ__new__â€</h1><p>ä¸å¤ªå¸¸ç”¨ï¼Œä½†åœ¨è¿›è¡Œç±»è®¾è®¡è¿‡ç¨‹ä¸­ç”¨åˆ°çš„__new__ ä¹Ÿæ˜¯ä¸€ä¸ªé­”æœ¯æ–¹æ³•ï¼Œå®ƒå‘ç”Ÿåœ¨åˆå§‹åŒ–ä¹‹å‰ï¼Œç”¨äºå‘å †ä¸­ç”³è¯·å†…å­˜ï¼Œä»¥åŠå¯¹å®ä¾‹çš„åˆ›å»ºè¿‡ç¨‹è¿›è¡Œæ§åˆ¶ï¼Œè¿”å›çš„æ˜¯ç±»çš„å®ä¾‹ï¼ˆå°†åˆ›å»ºçš„å†…å­˜ç©ºé—´è¿”å›ï¼‰ï¼Œæœ€å¸¸è§çš„æ˜¯å•ä¾‹æ¨¡å¼çš„å®šä¹‰ ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">knife</span> :<br>    _instance = <span class="hljs-literal">None</span>  <span class="hljs-comment"># ç±»å˜é‡ï¼Œä¿å­˜å•ä¾‹å®ä¾‹</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">cls, *args, **kwargs</span>):<br>      <span class="hljs-keyword">if</span> cls._instance <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>          <span class="hljs-comment"># åˆ›å»ºå”¯ä¸€å®ä¾‹</span><br>          cls._instance = <span class="hljs-built_in">super</span>(knife, cls).__new__(cls)<br>      <span class="hljs-keyword">return</span> cls._instance<br></code></pre></td></tr></table></figure><h1 id="â€œ-str-â€"><a href="#â€œ-str-â€" class="headerlink" title="â€œ__str__â€"></a>â€œ__str__â€</h1><p>â€œ__str__â€  ç”¨äºé‡å†™å¯¹è±¡çš„å­—ç¬¦ä¸²æ‰“å°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">person</span> :<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name</span>):<br>        <span class="hljs-variable language_">self</span>.name = name <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__str__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.name        <span class="hljs-comment"># å°†æ‰“å°å­—ç¬¦å®šä¹‰ä¸ºself.nameï¼Œä¸ç„¶åˆ™è¿”å›personå¯¹è±¡çš„å†…å­˜åœ°å€</span><br><br><span class="hljs-built_in">print</span>(person(<span class="hljs-string">&quot;wang&quot;</span>))<br></code></pre></td></tr></table></figure><h1 id="â€œ-eq-â€"><a href="#â€œ-eq-â€" class="headerlink" title="â€œ__eq__â€"></a>â€œ__eq__â€</h1><p>â€œ__eq__â€ç­‰ä¸€äº›é­”æœ¯æ–¹æ³•ï¼Œç”¨äºé‡æ–°å®šä¹‰è¿ç®—å¤„ç†çš„é€»è¾‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">person</span> :<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name,age</span>):<br>        <span class="hljs-variable language_">self</span>.name = name <br>        <span class="hljs-variable language_">self</span>.age = age<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__eq__</span>(<span class="hljs-params">self, value</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.age==value.age<br><br>c = person(<span class="hljs-string">&quot;wang&quot;</span>,<span class="hljs-number">26</span>)<br>d = person(<span class="hljs-string">&quot;zhao&quot;</span>,<span class="hljs-number">26</span>)<br><span class="hljs-built_in">print</span>(c == d )<br></code></pre></td></tr></table></figure><h1 id="â€œ-len-â€"><a href="#â€œ-len-â€" class="headerlink" title="â€œ__len__â€"></a>â€œ__len__â€</h1><p>è¿˜æœ‰ä¸€äº›é­”æœ¯æ–¹æ³•ç”¨äºå¤„ç†ä¸€äº›å†…ç½®å‡½æ•°çš„è°ƒç”¨,å½“æŸäº›å†…ç½®å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå®é™…è°ƒç”¨çš„è¿™äº›é­”æœ¯æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">person</span> :<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name,age</span>):<br>        <span class="hljs-variable language_">self</span>.name = name <br>        <span class="hljs-variable language_">self</span>.age = age<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__len__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>np = person(<span class="hljs-string">&quot;zhao&quot;</span>,<span class="hljs-string">&quot;27&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(np))    <span class="hljs-comment">#é‡æ–°å®šä¹‰äº†__len__ ,ä¼šæ ¹æ®æ–¹æ³•çš„è¿”å›å€¼è¿”å›ï¼Œè¿™é‡Œæ‰“å°0</span><br><br></code></pre></td></tr></table></figure><h1 id="â€œenter-â€œ-â€œ-exit-â€"><a href="#â€œenter-â€œ-â€œ-exit-â€" class="headerlink" title="â€œenter â€œ &#x2F; â€œ __exit__â€"></a>â€œ<strong>enter</strong> â€œ &#x2F; â€œ __exit__â€</h1><p>â€œ<strong>enter</strong> â€&#x2F; â€œ__exit__â€ ä¸»è¦åœ¨ä½¿ç”¨withè¯­å¥ æ—¶çš„ä¼šè§¦å‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyResource</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__enter__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ‰“å¼€èµ„æº&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__exit__</span>(<span class="hljs-params">self, exc_type, exc_val, exc_tb</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;é‡Šæ”¾èµ„æº&quot;</span>)<br><br><span class="hljs-keyword">with</span> MyResource() <span class="hljs-keyword">as</span> r:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å¤„ç†ä¸­...&quot;</span>)<br>  <br><span class="hljs-comment"># è¾“å‡ºç»“æœ</span><br><span class="hljs-comment"># æ‰“å¼€èµ„æº</span><br><span class="hljs-comment"># å¤„ç†ä¸­...</span><br><span class="hljs-comment"># é‡Šæ”¾èµ„æº</span><br></code></pre></td></tr></table></figure><h1 id="â€œ-call-â€"><a href="#â€œ-call-â€" class="headerlink" title="â€œ__call__â€"></a>â€œ__call__â€</h1><p>â€œ<strong>call__â€ æ–¹æ³•å…è®¸å¯¹è±¡åˆ›å»ºçš„å®ä¾‹å˜ä¸ºå¯è°ƒç”¨çš„ï¼Œå³å…è®¸å‘å®ä¾‹ä¼ å…¥å‚æ•°ï¼Œä½¿å®ä¾‹ä¹Ÿå¯ä»¥è¿›è¡Œä¸€äº›åŠŸèƒ½çš„å¤„ç†ã€‚__call</strong> å’Œ å‡½æ•°åœ¨ä¼ å…¥å‚æ•°æ‰§è¡Œçš„è¡Œä¸ºä¸Šæ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯åœ¨è°ƒç”¨å’ŒæŸ¥è¯¢æ–¹é¢çš„å…·ä½“å®ç°ä¸åŒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">button</span> :<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,status=<span class="hljs-literal">False</span></span>):<br>        <span class="hljs-variable language_">self</span>.status = status<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.status :<br>            <span class="hljs-variable language_">self</span>.status = <span class="hljs-literal">False</span> <br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;the light is closed&quot;</span>)<br>        <span class="hljs-keyword">else</span> : <br>            <span class="hljs-variable language_">self</span>.status =<span class="hljs-literal">True</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;the light is on&quot;</span>)<br><br>light_button =button()        <span class="hljs-comment"># åˆ›å»ºbutton å®ä¾‹</span><br>light_button()                <span class="hljs-comment"># æ‰§è¡Œå®ä¾‹ status : False -&gt; True</span><br>light_button()                <span class="hljs-comment"># æ‰§è¡Œå®ä¾‹ status : True -&gt; False</span><br><span class="hljs-comment"># è¾“å‡º</span><br><span class="hljs-comment"># the light is on</span><br><span class="hljs-comment"># the light is closed</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonç¼–ç¨‹ II é¢å‘å¯¹è±¡</title>
    <link href="/2025/04/15/Python%E7%BC%96%E7%A8%8B-II-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"/>
    <url>/2025/04/15/Python%E7%BC%96%E7%A8%8B-II-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/</url>
    
    <content type="html"><![CDATA[<p><em>Python æ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œä½†æ˜¯æˆ‘ä»¬ä»éœ€è¦è®¨è®ºçš„æ˜¯ ä»€ä¹ˆæ˜¯<strong>é¢å‘å¯¹è±¡</strong>ï¼Ÿ</em></p><h1 id="ä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ</h1><p>åœ¨è®¸å¤šç¼–ç¨‹ä¹¦ç±å’ŒæŠ€æœ¯åšå®¢ä¸­ï¼Œå¯¹è±¡å¸¸è¢«å®šä¹‰ä¸ºâ€œä¸€ä¸ªçœŸå®å­˜åœ¨çš„å®ä½“â€æˆ–â€œæ–¹æ³•å’Œå±æ€§çš„é›†åˆâ€ã€‚</p><p>ç„¶è€Œï¼Œè¿™äº›å®šä¹‰å¾€å¾€åªåœç•™åœ¨è¡¨å±‚ï¼Œå¹¶æœªçœŸæ­£è§£é‡Šâ€œ<strong>ä»€ä¹ˆæ˜¯å¯¹è±¡</strong>â€è¿™ä¸€æ ¸å¿ƒé—®é¢˜ã€‚æ¯”å¦‚ï¼Œâ€œå®ä½“â€æœ¬èº«æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿä¸ºä»€ä¹ˆå±æ€§å’Œæ–¹æ³•çš„ç»„åˆå¯ä»¥ç§°ä¸ºä¸€ä¸ªâ€˜å¯¹è±¡â€™ï¼Ÿå¸¦ç€è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä»è®¾è®¡å±‚é¢é‡æ–°æ€è€ƒå¯¹è±¡çš„æœ¬è´¨ã€‚</p><h2 id="è®¾è®¡å±‚é¢ï¼šå¯¹è±¡æ˜¯é¢å‘ç›®çš„çš„å®ä½“ç‰¹å¾ä¸è¡Œä¸ºçš„æŠ½è±¡"><a href="#è®¾è®¡å±‚é¢ï¼šå¯¹è±¡æ˜¯é¢å‘ç›®çš„çš„å®ä½“ç‰¹å¾ä¸è¡Œä¸ºçš„æŠ½è±¡" class="headerlink" title="è®¾è®¡å±‚é¢ï¼šå¯¹è±¡æ˜¯é¢å‘ç›®çš„çš„å®ä½“ç‰¹å¾ä¸è¡Œä¸ºçš„æŠ½è±¡"></a>è®¾è®¡å±‚é¢ï¼šå¯¹è±¡æ˜¯é¢å‘ç›®çš„çš„å®ä½“ç‰¹å¾ä¸è¡Œä¸ºçš„æŠ½è±¡</h2><h3 id="ä»€ä¹ˆæ˜¯å®ä½“ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å®ä½“ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å®ä½“ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å®ä½“ï¼Ÿ</h3><p>åŠ¨ç‰©æ˜¯ä¸æ˜¯ä¸€ç§å®ä½“ï¼Ÿæˆ¿å±‹æ˜¯ä¸æ˜¯ä¸€ç§å®ä½“ï¼Ÿæˆ¿å±‹ï¼Ÿæ¯”ç‰¹å¸å‘¢ï¼Ÿç¬›å¡å°”çš„â€œæˆ‘æ€æ•…æˆ‘åœ¨â€å‘¢ï¼Ÿ</p><p>å®ä½“å¹¶ä¸ä¸€å®šæ˜¯ä»¥â€œçœŸå®å­˜åœ¨â€ä½œä¸ºå¿…è¦æ¡ä»¶çš„ï¼Œå®ä½“çš„é‡è¦ç‰¹å¾æ˜¯â€œä¸€ç§å¯æè¿°çš„æ¦‚å¿µâ€ã€‚æ¯”å¦‚â€œç‹¬è§’å…½â€æ˜¯ä¸€åªé•¿æœ‰çŠ„è§’å’Œç¿…è†€çš„é©¬ï¼Œæ¯”å¦‚â€œè¥¿æ–¹çš„æ¶é¾™è¦†ç›–æœ‰åšåšçš„é³ç‰‡èƒ½å¤Ÿå–·åç«ç„°â€ã€‚è¿™äº›æ¦‚å¿µçš„é‡ç‚¹ä¸æ˜¯â€œçœŸå®å­˜åœ¨â€ï¼Œè€Œæ˜¯â€œå¯æè¿°â€ã€‚æ¨è€Œå¹¿ä¹‹ï¼Œä¸€äº›æŠ½è±¡æ¦‚å¿µä¹Ÿå¯ä»¥ä½œä¸ºâ€œå®ä½“â€ï¼Œæ¯”å¦‚ FIFOçš„é˜Ÿåˆ—ï¼Œä»£ç†æ¨¡å¼ä¸­çš„ä»£ç†æ¦‚å¿µã€‚</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å®ä½“çš„å®šä¹‰ â€œä¸€ç§å¯æè¿°çš„æ¦‚å¿µâ€ï¼ˆæ— è®ºå®ƒæ˜¯å¦çœŸçš„å­˜åœ¨ï¼‰</p><h3 id="é‚£ä¹ˆä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ"><a href="#é‚£ä¹ˆä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ" class="headerlink" title="é‚£ä¹ˆä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ"></a>é‚£ä¹ˆä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿ</h3><p>æˆ‘ä»¬æ°¸è¿œæ²¡åŠæ³•å°†ä¸€ä¸ªå®ä½“å®Œæ•´åœ°ç”¨è®¡ç®—æœºè¯­è¨€å»æè¿°ã€‚ä½†å¯ä»¥å°†ç‰¹å¾å’Œè¡Œä¸ºæŠ½è±¡å‡ºæ¥ï¼Œä½œä¸ºæˆ‘ä»¬ç”¨è®¡ç®—æœºå»æ¨¡æ‹Ÿè¿™ä¸ªç‰©ä½“çš„æ–¹æ³•ã€‚è¿™æš—å«ç€å¯¹è±¡è®¾è®¡æ˜¯é¢å‘åŠŸèƒ½çš„ï¼Œæœ‰å–èˆçš„ã€‚å› ä¸ºæˆ‘ä»¬å®é™…å…³æ³¨çš„ä¸æ˜¯å®ä½“åˆ°åº•æ˜¯æ€ä¹ˆæ ·çš„ï¼Œè€Œæ˜¯å…³æ³¨å®ä½“é€šè¿‡å“ªäº›ç‰¹å¾å’Œè¡Œä¸ºè¾¾æˆäº†æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚å½“æˆ‘ä»¬è€ƒè™‘ä¸€å¤´ç‰›çš„æ—¶å€™ï¼Œåœ¨è™šæ‹Ÿä¸–ç•Œé‡Œï¼Œæˆ‘ä»¬ä¸ä¼šå»è€ƒè™‘ç‰›ä½åœ¨å“ªé‡Œï¼Œä½•æ—¶ä¼‘æ¯ã€‚è€ƒè™‘çš„æ˜¯æˆ‘ä»¬ä¸ºäº†è¾¾æˆç›®çš„ï¼Œéœ€è¦â€ä¾›åº”â€œä»€ä¹ˆï¼Œâ€œäº§å‡ºâ€ä»€ä¹ˆã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨è®¾è®¡æ—¶çœŸæ­£æ„å»ºçš„å¯¹è±¡æ˜¯ä»¥ç›®çš„ä¸ºæ ¸å¿ƒï¼Œå¯¹å®ä½“ç‰¹å¾å’Œè¡Œä¸ºçš„æŠ½è±¡ã€‚ç›®çš„æ˜¯æˆ‘ä»¬çš„æœ€ç»ˆç»“æœï¼Œè€Œå®ä½“çš„ç‰¹å¾å’Œè¡Œä¸ºæ˜¯ä¸ºäº†è¾¾æˆç›®çš„æ‰€å¿…é¡»çš„ç»„ä»¶</p><h2 id="å®ç°å±‚é¢ï¼šå¯¹è±¡æ˜¯ç»è¿‡ç»“æ„åŒ–ç»„ç»‡çš„å†…å­˜"><a href="#å®ç°å±‚é¢ï¼šå¯¹è±¡æ˜¯ç»è¿‡ç»“æ„åŒ–ç»„ç»‡çš„å†…å­˜" class="headerlink" title="å®ç°å±‚é¢ï¼šå¯¹è±¡æ˜¯ç»è¿‡ç»“æ„åŒ–ç»„ç»‡çš„å†…å­˜"></a>å®ç°å±‚é¢ï¼šå¯¹è±¡æ˜¯ç»è¿‡ç»“æ„åŒ–ç»„ç»‡çš„å†…å­˜</h2><h3 id="å†…å­˜ä¸å¯¹è±¡"><a href="#å†…å­˜ä¸å¯¹è±¡" class="headerlink" title="å†…å­˜ä¸å¯¹è±¡"></a>å†…å­˜ä¸å¯¹è±¡</h3><p>ç¨‹åºå‘˜å¯¹å†…å­˜å’Œç¨‹åºç»“æ„æ‹¥æœ‰è¿‘ä¹å®Œå…¨çš„æ§åˆ¶æƒã€‚ä»–ä»¬å¯ä»¥è‡ªç”±åœ°å†³å®šæ¯ä¸€ä¸ªå†…å­˜åœ°å€çš„ç”¨é€”ï¼Œè¿™åœ¨ç©ºé—´å—é™çš„åœºæ™¯ä¸­æ˜¾å¾—å°¤ä¸ºé«˜æ•ˆï¼Œå¯ä»¥æœ€å¤§é™åº¦åœ°å‹æ¦¨å‡ºæ¯ä¸€å­—èŠ‚çš„æ½œåŠ›ã€‚ä½†ä¹Ÿå¯¼è‡´äº†ä¸€äº›é—®é¢˜ï¼š</p><ol><li>åœ¨åŠŸèƒ½è®¾è®¡çš„åˆæœŸå°±éœ€è¦å‘¨å…¨çš„è€ƒè™‘å¯¹è±¡ï¼ˆç»“æ„ä½“ï¼‰çš„è®¾è®¡ï¼Œä¸ç„¶ä¼šåŠ å¤§åæœŸçš„ç»´æŠ¤ï¼Œé‡æ„ï¼Œæ–°å¢åŠŸèƒ½çš„å¤æ‚åº¦ã€‚</li><li>ç¼–ç¨‹äººå‘˜å¯¹ç¨‹åºæœ‰ç»å¯¹çš„æƒé™ï¼Œæ„å‘³ç€ç›¸åŒçš„åŠŸèƒ½å¯èƒ½ä¼šè®¾è®¡ä¸åŒçš„ç³»ç»Ÿæ¥å¤„ç†ç›¸åŒçš„æµç¨‹ï¼Œå¦‚å†…å­˜åˆ†é…&#x2F;å›æ”¶ã€‚æ¶ˆæ¯å¤„ç†ã€‚å¯¹äºå¤šäººå¼€å‘çš„å¤§å‹ç³»ç»Ÿä¼šå¢åŠ ç³»ç»Ÿçš„å¤æ‚åº¦ã€‚</li></ol><p>åœ¨è¿™ä¸€å±‚é¢ä¸Šï¼Œä¸€äº›æ›´ç°ä»£çš„ç¼–ç¨‹è¯­è¨€é€‰æ‹©æ”¾å¼ƒäº†Cè¯­è¨€çš„â€œè‡ªç”±â€œï¼Œç°ä»£ç³»ç»Ÿçš„è®¾è®¡éƒ½æ˜¯å±‚æ¬¡åŒ–çš„ï¼Œå½“æˆ‘è¿›è¡Œä¸Šå±‚æ•°æ®çš„å¤„ç†æ—¶ï¼Œä»ç„¶è¦å»å…³å¿ƒæœ€åº•å±‚çš„å†…å­˜æ˜¯å¦‚ä½•æ’å¸ƒçš„æ˜¾ç„¶æ˜¯ä¸€ä¸ªä¸å¤Ÿé«˜æ•ˆçš„åšæ³•ã€‚å› æ­¤å®ƒä»¬å¼€å§‹å»é¢„å®šä¹‰ä¸€äº›ç»“æ„åŒ–çš„å†…å­˜ï¼Œä»â€å†…å­˜äº¤ç»™ä½ ï¼Œä½ æ¥ä»0å¼€å§‹å®Œæˆç³»ç»Ÿâ€œï¼Œåˆ°â€œç”±æˆ‘æä¾›ä¸€äº›åŸºç¡€ç»„ä»¶ï¼Œä½ åœ¨è¿™ä¸ªåŸºç¡€ä¹‹ä¸Šç»„ç»‡ç³»ç»Ÿâ€ã€‚é€šè¿‡å¯¹å†…å­˜å—çš„ç»“æ„åŒ–è®¾è®¡ï¼Œå°†â€œè®¾è®¡-å®ç°â€çš„é—®é¢˜ï¼Œå˜æˆäº†â€œç»„ç»‡-å®ç°â€ã€‚</p><p>å¦ä¸€æ–¹é¢å› ä¸ºæ‰€æœ‰åŸºç¡€æ¨¡å—æ˜¯ç¼–ç¨‹è¯­è¨€é¢„å…ˆå®šä¹‰çš„ï¼Œæ‰€ä»¥åœ¨åæœŸä½¿ç”¨æ—¶ï¼Œä½œä¸ºå†…å­˜-ç³»ç»Ÿçš„ä¸­é—´å±‚ï¼ˆå¦‚ä¸€äº›è™šæ‹Ÿæœºç¨‹åºï¼‰ï¼Œå¯ä»¥å¯¹ç³»ç»Ÿä¸­çš„å†…å­˜ä½¿ç”¨è¿›è¡Œæ›´å¥½çš„æ§åˆ¶ï¼Œè¿™æ ·æ—¢å¯ä»¥é€šè¿‡ç³»ç»Ÿçš„ç®¡ç†ï¼Œå°†å·²åŠ è½½çš„åŠŸèƒ½æ¨¡å—çµæ´»å¤ç”¨ï¼Œä¹Ÿå¯ä»¥æ›´å¥½çš„æä¾›ç³»ç»Ÿçº§çš„ç›‘æ§ç®¡ç†ï¼Œåƒåƒåœ¾å›æ”¶ï¼Œå¯¹è±¡çš„åŠ¨æ€åŠ è½½åˆ›å»ºç­‰ï¼Œå¯¹äºæ›´ä¸Šå±‚çš„ç¼–ç¨‹äººå‘˜æ¥è¯´ï¼Œè¿›è¡Œç±»è®¾è®¡ï¼Œå¯¹è±¡è®¾è®¡ã€‚åè€Œæ˜¯ä¸€äº›é¡ºä¾¿å¸¦æ¥çš„å¥½å¤„ã€‚</p><h3 id="é‚£ä¹ˆä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ï¼Ÿ"><a href="#é‚£ä¹ˆä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ï¼Ÿ" class="headerlink" title="é‚£ä¹ˆä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ï¼Ÿ"></a>é‚£ä¹ˆä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ï¼Ÿ</h3><p>å½“æˆ‘ä»¬æ˜ç™½äº†å¯¹è±¡æ˜¯ä¸€ç§å¯æè¿°çš„æ¦‚å¿µï¼Œå¹¶ä¸”å¯¹è±¡è®¾è®¡çš„æ ¸å¿ƒæ˜¯é¢å‘åŠŸèƒ½çš„ï¼Œä»¥åŠä¸ºä»€ä¹ˆä½¿ç”¨å¯¹è±¡è€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨å†…å­˜æ¥è®¾è®¡æˆ‘ä»¬çš„ç³»ç»Ÿã€‚é‚£ä¹ˆé¢å‘å¯¹è±¡å°±æ˜¯åœ¨è®¾è®¡ç³»ç»Ÿæ—¶ï¼Œé¦–å…ˆå®Œæˆå¯¹ç³»ç»ŸåŠŸèƒ½çš„æŠ½è±¡ï¼Œå°†ç³»ç»Ÿçš„å®ç°å˜ä¸ºå¤šä¸ªæ ¸å¿ƒå¯¹è±¡ä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡å’Œæ–¹æ³•è°ƒç”¨ã€‚å¦‚ï¼š</p><ul><li>å¯¹æ•°æ®è¿›è¡Œå­˜å‚¨å’Œç»´æŠ¤è€Œè®¾è®¡çš„ç±»ï¼Œå¦‚ç”¨æˆ·ç±»ï¼Œä»“åº“ç±»</li><li>å¯¹æ•°æ®ç»„ç»‡ç»“æ„è¿›è¡ŒæŠ½è±¡çš„ç±»ï¼Œå¦‚æ•°æ®åŒ…ç±»ï¼Œå·¥å‚ç±»</li><li>ä»¥æŸç§æ“ä½œæµç¨‹ä¸ºæ ¸å¿ƒå»ºæ¨¡çš„è®¾è®¡çš„ç±»ï¼Œé˜Ÿåˆ—ã€æ ˆ</li></ul><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬ä¸ä»…æ„å»ºäº†æ›´å…·ç»“æ„åŒ–çš„ç³»ç»Ÿï¼ŒåŒæ—¶ä¹Ÿæå‡äº†ç³»ç»Ÿçš„å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ä¸å¯æ‰©å±•æ€§ â€”â€” è¿™æ­£æ˜¯é¢å‘å¯¹è±¡è®¾è®¡çš„æ ¸å¿ƒä»·å€¼æ‰€åœ¨ã€‚</p><h1 id="è°ˆè°ˆPython"><a href="#è°ˆè°ˆPython" class="headerlink" title="è°ˆè°ˆPython"></a>è°ˆè°ˆPython</h1><p>å½“æˆ‘ä»¬å®Œå…¨çš„ç†è§£äº†ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ä¹‹åï¼Œè¿™æ—¶æˆ‘ä»¬åˆè¦å†å›è¿‡å¤´æ¥ï¼Œè°ˆè°ˆä¸ºä»€ä¹ˆPythonæ˜¯é¢å‘å¯¹è±¡çš„ã€‚</p><h2 id="Pythonçš„å¯¹è±¡"><a href="#Pythonçš„å¯¹è±¡" class="headerlink" title="Pythonçš„å¯¹è±¡"></a>Pythonçš„å¯¹è±¡</h2><p>åœ¨æˆ‘çœ‹æ¥ï¼ŒPythonçš„å¯¹è±¡è®¾è®¡å¯ä»¥ç”¨å˜æ€æ¥å½¢å®¹ã€‚åœ¨å®ƒçš„ç¨‹åºä¸­çš„ä»»ä½•å˜é‡&#x2F;å¯¹è±¡&#x2F;å®ä¾‹éƒ½æ˜¯è¢«ä½œä¸ºç»“æ„åŒ–çš„å†…å­˜å­˜å‚¨åœ¨ç³»ç»Ÿå½“ä¸­çš„ï¼Œå¹¶ä¸”å¯ä»¥ä¾¿æ·çš„è®¿é—®ã€‚å®ƒæä¾›äº†ä¸€ç§æ€ªå¼‚çš„è‡ªç”±åº¦ï¼Œåƒä¸€å®¶æ‚è´§åº—ï¼Œä»¿ä½›åœ¨å‘Šè¯‰ä½ ï¼Œåªè¦ä½ æƒ³æ‰¾ä»»ä½•å•†å“ï¼ˆå¯¹è±¡ï¼‰ã€‚éƒ½å¯ä»¥ä¾¿æ·çš„å¸®ä½ æ‰¾åˆ°ï¼Œåªæä¾›å¯¹è±¡çš„äº¤ä»˜ï¼Œç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œå‰©ä¸‹çš„ä»»ä½•å†…å®¹éƒ½äº¤ç”±ä½ å¤„ç†ã€‚</p><h2 id="ä½œä¸ºâ€œç»„ç»‡è€…â€çš„æˆ‘ä»¬"><a href="#ä½œä¸ºâ€œç»„ç»‡è€…â€çš„æˆ‘ä»¬" class="headerlink" title="ä½œä¸ºâ€œç»„ç»‡è€…â€çš„æˆ‘ä»¬"></a>ä½œä¸ºâ€œç»„ç»‡è€…â€çš„æˆ‘ä»¬</h2><p>äºæ˜¯ï¼Œä½œä¸ºä½¿ç”¨ Python çš„å¼€å‘è€…ï¼Œæˆ‘ä»¬ä¸å†æ˜¯å•çº¯çš„â€œç¼–å†™è€…â€ï¼Œè€Œæ›´åƒæ˜¯<strong>ç³»ç»Ÿçš„ç»„ç»‡è€…ä¸è¡Œä¸ºçš„ç­–åˆ’è€…</strong>ã€‚</p><p>æˆ‘ä»¬é¢å¯¹çš„ä¸æ˜¯ä¸€å—ç©ºç™½çš„å†…å­˜ï¼Œè€Œæ˜¯ä¸€å¼ åºæ‚å´çµæ´»çš„å·¥å…·æ¸…å•â€”â€”ç±»ã€å‡½æ•°ã€è£…é¥°å™¨ã€ç”Ÿæˆå™¨ã€é­”æœ¯æ–¹æ³•ã€å…ƒç±»â€¦â€¦Python æŠŠæ„å»ºç³»ç»Ÿæ‰€éœ€çš„ç –ç“¦éƒ½æå‰æ‘†å¥½ï¼Œè€Œæˆ‘ä»¬éœ€è¦åšçš„ï¼Œæ˜¯ä»¥<strong>å¯¹è±¡ä¸ºåŸºçŸ³ï¼Œä»¥åŠŸèƒ½ä¸ºç›®æ ‡</strong>ï¼Œç»„ç»‡å®ƒä»¬æ„å»ºå‡ºä¸€ä¸ªå¯è¿è¡Œã€å¯ç»´æŠ¤ã€å¯ç†è§£çš„ç³»ç»Ÿã€‚</p><p>å¦å¤–è™½ç„¶é¢å‘å¯¹è±¡æä¾›äº†ç»“æ„åŒ–çš„è®¾è®¡æ–¹å¼ï¼Œä½†åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œç®€å•çš„å‡½æ•°æˆ–æ¨¡å—åŒ–è®¾è®¡å¯èƒ½æ›´é«˜æ•ˆï¼ŒPythonçš„çµæ´»æ€§å…è®¸å¼€å‘è€…è‡ªç”±é€‰æ‹©ã€‚</p><h2 id="å°è£…ï¼Œç»§æ‰¿å’Œå¤šæ€"><a href="#å°è£…ï¼Œç»§æ‰¿å’Œå¤šæ€" class="headerlink" title="å°è£…ï¼Œç»§æ‰¿å’Œå¤šæ€"></a>å°è£…ï¼Œç»§æ‰¿å’Œå¤šæ€</h2><h3 id="å°è£…"><a href="#å°è£…" class="headerlink" title="å°è£…"></a>å°è£…</h3><p>å°è£…æŒ‡çš„æ˜¯ ï¼Œå½“å¯¹è±¡å·²ç»è¢«è®¾è®¡ä¸ºä¸€ä¸ªå®Œæ•´çš„æ•´ä½“æ—¶ï¼Œå†…éƒ¨çš„ä¸€äº›å±æ€§æˆ–æ–¹æ³•ä¸å†èƒ½ä½œä¸ºå…¬å…±åŠŸèƒ½æä¾›ç»™å¤–ç•Œè°ƒç”¨ã€‚åœ¨Pythonä¸­è¡¨ç°ä¸ºå¯¹æ–¹æ³•ï¼Œç±»çš„ä¼ªç§æœ‰åŒ–ï¼Œå±æ€§çš„å°è£…å’Œå†…éƒ¨å‡½æ•°çš„é—­åŒ…è®¾è®¡</p><ul><li><strong>æ–¹æ³•å’Œç±»çš„ä¼ªç§æœ‰åŒ–</strong></li></ul><p>å½“å°†æ–¹æ³•è®¾ç½®ä¸º__function_nameåï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šå°†æ–¹æ³•åæ›¿æ¢ä¸º_ClassName__name,é¿å…æ–¹æ³•è¢«ç›´æ¥è°ƒç”¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.public_var = <span class="hljs-string">&quot;æˆ‘æ˜¯å…¬å¼€çš„&quot;</span><br>        <span class="hljs-variable language_">self</span>.__private_var = <span class="hljs-string">&quot;æˆ‘æ˜¯&#x27;ç§æœ‰&#x27;çš„&quot;</span><br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__private_method</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;è¿™æ˜¯&#x27;ç§æœ‰&#x27;æ–¹æ³•&quot;</span><br></code></pre></td></tr></table></figure><ul><li><strong>å±æ€§çš„å°è£…</strong></li></ul><p>å°†å±æ€§è®¾ç½®ä¸ºç§æœ‰å±æ€§,é€šè¿‡æ–¹æ³•è°ƒç”¨æ¥å®Œæˆå±æ€§çš„è®¾ç½®ã€‚é¿å…äº†å±æ€§ç›´æ¥é€šè¿‡â€.â€è·å–åˆ°è¢«ç¯¡æ”¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, score</span>):<br>        <span class="hljs-variable language_">self</span>._name = name    <span class="hljs-comment"># ä½¿ç”¨å•ä¸‹åˆ’çº¿è¡¨ç¤ºä¸åº”ç›´æ¥è®¿é—®</span><br>        <span class="hljs-variable language_">self</span>._score = score  <span class="hljs-comment"># ä½¿ç”¨å•ä¸‹åˆ’çº¿è¡¨ç¤ºä¸åº”ç›´æ¥è®¿é—®</span><br>    <br><span class="hljs-meta">    @property  </span><span class="hljs-comment"># è¯»å–å™¨</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">name</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._name<br>    <br><span class="hljs-meta">    @property  </span><span class="hljs-comment"># è¯»å–å™¨</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">score</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._score<br>    <br><span class="hljs-meta">    @score.setter  </span><span class="hljs-comment"># è®¾ç½®å™¨</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">score</span>(<span class="hljs-params">self, value</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(value, <span class="hljs-built_in">int</span>):<br>            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;æˆç»©å¿…é¡»æ˜¯æ•´æ•°&quot;</span>)<br>        <span class="hljs-keyword">if</span> value &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> value &gt; <span class="hljs-number">100</span>:<br>            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;æˆç»©å¿…é¡»åœ¨0åˆ°100ä¹‹é—´&quot;</span>)<br>        <span class="hljs-variable language_">self</span>._score = value<br></code></pre></td></tr></table></figure><ul><li>é—­åŒ…</li></ul><p>é—­åŒ…æä¾›äº†ä¸€ä¸ªéšè—å‡½æ•°å†…éƒ¨å®ç°ï¼Œå°†æ•°æ®åœ¨å†…éƒ¨å¤„ç†çš„æ–¹æ³•ï¼Œåªåœ¨å¤–éƒ¨å®šä¹‰è¿”å›çš„å˜é‡ï¼Œè€Œå°†å…·ä½“çš„è¿‡ç¨‹æ”¾åœ¨å†…éƒ¨è¿›è¡Œå¤„ç†ï¼Œè®©å¤–éƒ¨æ— éç›´æ¥è®¿é—®å†…éƒ¨çš„æ‰§è¡Œé€»è¾‘ã€‚pythonä¸­çš„é—­åŒ…ä¸æ˜¯å…¸å‹çš„ OOP å°è£…ï¼Œä½†å®ƒæä¾›äº†ç±»ä¼¼â€˜æ•°æ®ç§æœ‰æ€§â€™çš„èƒ½åŠ›ï¼Œå› æ­¤å¯ä»¥ç†è§£ä¸ºä¸€ç§è¿‡ç¨‹å¼å°è£…å½¢å¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">counter_factory</span>(<span class="hljs-params">start=<span class="hljs-number">0</span>, step=<span class="hljs-number">1</span></span>):<br>    <span class="hljs-comment"># åœ¨å¤–éƒ¨å‡½æ•°ä¸­å®šä¹‰çš„å˜é‡</span><br>    count = start<br>    <br>    <span class="hljs-comment"># å†…éƒ¨å‡½æ•°ï¼Œå½¢æˆé—­åŒ…</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">counter</span>():<br>        <span class="hljs-comment"># ä½¿ç”¨nonlocalå…³é”®å­—ï¼Œè¡¨æ˜æˆ‘ä»¬è¦ä¿®æ”¹å¤–éƒ¨å‡½æ•°çš„å˜é‡</span><br>        <span class="hljs-keyword">nonlocal</span> count<br>        <span class="hljs-comment"># ä¿å­˜å½“å‰å€¼</span><br>        current = count<br>        <span class="hljs-comment"># æ›´æ–°è®¡æ•°</span><br>        count += step<br>        <span class="hljs-comment"># è¿”å›è®¡æ•°å€¼</span><br>        <span class="hljs-keyword">return</span> current<br>    <br>    <span class="hljs-comment"># è¿”å›å†…éƒ¨å‡½æ•°ï¼Œä¸æ‰§è¡Œå®ƒ</span><br>    <span class="hljs-keyword">return</span> counter<br></code></pre></td></tr></table></figure><h3 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h3><p>ç»§æ‰¿æŒ‡çš„æ˜¯ï¼Œå½“ä¸€ä¸ªå­ç±»å¯¹çˆ¶ç±»è¿›è¡Œç»§æ‰¿ä¹‹åï¼Œå­ç±»æ‹¥æœ‰äº†å¯¹çˆ¶ç±»çš„æ‰€æœ‰æ–¹æ³•å’Œå±æ€§çš„è®¿é—®æƒé™ã€‚(å¯¹ç»è¿‡ç§æœ‰å£°æ˜çš„å±æ€§å’Œæ–¹æ³•å¯ä»¥ä»¥ç‰¹æ®Šå½¢å¼è®¿é—®åˆ°)ã€‚è¿™å°±å®Œæˆäº†is-a çš„å…³ç³»ï¼Œç»§æ‰¿é€šå¸¸ç”¨äºåœ¨åŒä¸€ç±»åˆ«ä¸‹å­ç±»çš„å¿«é€Ÿåˆ›å»ºï¼Œä»¥åŠä¸ºå¤šæ€çš„å®ç°æä¾›å¯èƒ½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, age</span>):<br>        <span class="hljs-variable language_">self</span>.name = name<br>        <span class="hljs-variable language_">self</span>.age = age    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">make_sound</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;å‘å‡ºå£°éŸ³&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ä¸€äº›å£°éŸ³&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">info</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;æ˜¾ç¤ºåŠ¨ç‰©ä¿¡æ¯&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;åç§°ï¼š<span class="hljs-subst">&#123;self.name&#125;</span>, å¹´é¾„ï¼š<span class="hljs-subst">&#123;self.age&#125;</span>å²&quot;</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-title class_ inherited__">Animal</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;ç‹—ç±»ï¼Œç»§æ‰¿è‡ªåŠ¨ç‰©ç±»&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, age, breed</span>):<br>        <span class="hljs-comment"># è°ƒç”¨çˆ¶ç±»çš„__init__æ–¹æ³•</span><br>        <span class="hljs-built_in">super</span>().__init__(name, age)<br>        <span class="hljs-variable language_">self</span>.breed = breed  <span class="hljs-comment"># ç‹—çš„å“ç§</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">make_sound</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;é‡å†™çˆ¶ç±»çš„æ–¹æ³•&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æ±ªæ±ªæ±ªï¼&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">info</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;æ‰©å±•çˆ¶ç±»çš„æ–¹æ³•&quot;&quot;&quot;</span><br>        basic_info = <span class="hljs-built_in">super</span>().info()<br>        <span class="hljs-comment"># æ·»åŠ å­ç±»ç‰¹æœ‰çš„ä¿¡æ¯</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;basic_info&#125;</span>, å“ç§ï¼š<span class="hljs-subst">&#123;self.breed&#125;</span>&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wag_tail</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;å­ç±»ç‰¹æœ‰çš„æ–¹æ³•&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.name&#125;</span>æ‘‡äº†æ‘‡å°¾å·´&quot;</span><br><span class="hljs-comment"># åˆ›å»ºå®ä¾‹å¹¶æµ‹è¯•</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªAnimalå®ä¾‹</span><br>    generic_animal = Animal(<span class="hljs-string">&quot;å°åŠ¨ç‰©&quot;</span>, <span class="hljs-number">3</span>)<br>    <span class="hljs-built_in">print</span>(generic_animal.info())<br>    <span class="hljs-built_in">print</span>(generic_animal.make_sound())<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">30</span>)<br>    <span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªDogå®ä¾‹</span><br>    my_dog = Dog(<span class="hljs-string">&quot;æ—ºè´¢&quot;</span>, <span class="hljs-number">5</span>, <span class="hljs-string">&quot;é‡‘æ¯›&quot;</span>)<br>    <span class="hljs-comment"># æµ‹è¯•ç»§æ‰¿çš„å±æ€§å’Œæ–¹æ³•</span><br>    <span class="hljs-built_in">print</span>(my_dog.info())  <span class="hljs-comment"># ä½¿ç”¨é‡å†™çš„æ–¹æ³•</span><br>    <span class="hljs-built_in">print</span>(my_dog.make_sound())  <span class="hljs-comment"># ä½¿ç”¨é‡å†™çš„æ–¹æ³•</span><br>    <span class="hljs-built_in">print</span>(my_dog.wag_tail())  <span class="hljs-comment"># ä½¿ç”¨å­ç±»ç‰¹æœ‰çš„æ–¹æ³•</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><h3 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h3><p>å¤šæ€æŒ‡çš„æ˜¯ï¼Œå½“ä¸€ä¸ªå‡½æ•°æ¥æ”¶çˆ¶ç±»å‹ä½œä¸ºå‚æ•°æ—¶ï¼Œé€šè¿‡ä¼ å…¥ç»§æ‰¿è‡ªçˆ¶ç±»çš„å­ç±»ã€‚è°ƒç”¨åŒä¸€ä¸ªæ–¹æ³•ä¼šå¾—åˆ°ä¸åŒçš„è¡Œä¸ºï¼Œåœ¨pythonä¸­ï¼Œå› ä¸ºå¼±ç±»å‹çš„å®ç°ï¼Œä¸å¤ªå¥½å…³æ³¨åˆ°å¤šæ€çš„æ˜æ˜¾ç‰¹å¾ã€‚å› ä¸ºåœ¨å‡½æ•°è°ƒç”¨æ—¶ï¼Œpythonå¹¶ä¸æ˜¯ä»¥ä¼ å…¥çš„å¯¹è±¡æ˜¯å¦ç»§æ‰¿è‡ªæŸä¸ªçˆ¶ç±»ï¼Œè€Œæ˜¯ä»¥ä¼ å…¥çš„å¯¹è±¡æ˜¯å¦å…·å¤‡æŸç§æ–¹æ³•æ¥è¿›è¡Œæ‰§è¡Œã€‚æ‰€ä»¥å¦‚æœæƒ³å®ç°æ›´æ ‡å‡†çš„å¤šæ€ï¼Œéœ€è¦å¯¹ä¼ å…¥çš„å¯¹è±¡è¿›è¡Œç±»å‹ä¸Šçš„åˆ¤æ–­ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">speak</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span>  <span class="hljs-comment"># åŸºç±»ä¸­çš„æ–¹æ³•æ˜¯æŠ½è±¡çš„</span><br><br><span class="hljs-comment"># å®šä¹‰å­ç±»ï¼Œç»§æ‰¿è‡ªAnimal</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-title class_ inherited__">Animal</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">speak</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æ±ªæ±ª!&quot;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-title class_ inherited__">Animal</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">speak</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;å–µå–µ!&quot;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Duck</span>(<span class="hljs-title class_ inherited__">Animal</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">speak</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;å˜å˜!&quot;</span><br><br><span class="hljs-comment"># å¤šæ€å‡½æ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">animal_sound</span>(<span class="hljs-params">animal</span>):<br>    <span class="hljs-comment"># åŒä¸€ä¸ªå‡½æ•°è°ƒç”¨ä¼šæ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹äº§ç”Ÿä¸åŒçš„ç»“æœ</span><br>    <span class="hljs-comment"># è¿™å°±æ˜¯å¤šæ€çš„ä½“ç°</span><br>    <span class="hljs-keyword">return</span> animal.speak()<br><br><span class="hljs-comment"># åˆ›å»ºä¸åŒåŠ¨ç‰©çš„å®ä¾‹</span><br>dog = Dog()<br>cat = Cat()<br>duck = Duck()<br><br><span class="hljs-comment"># ä½¿ç”¨ç›¸åŒçš„å‡½æ•°è°ƒç”¨ä¸åŒç±»å‹çš„å¯¹è±¡</span><br><span class="hljs-built_in">print</span>(animal_sound(dog))  <span class="hljs-comment"># è¾“å‡º: æ±ªæ±ª!</span><br><span class="hljs-built_in">print</span>(animal_sound(cat))  <span class="hljs-comment"># è¾“å‡º: å–µå–µ!</span><br><span class="hljs-built_in">print</span>(animal_sound(duck))  <span class="hljs-comment"># è¾“å‡º: å˜å˜!</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Devops</title>
    <link href="/2025/04/15/Devops/"/>
    <url>/2025/04/15/Devops/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>Devops</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Devops</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æµ‹è¯•æŠ€æœ¯</title>
    <link href="/2025/04/15/%E6%B5%8B%E8%AF%95%E6%8A%80%E6%9C%AF/"/>
    <url>/2025/04/15/%E6%B5%8B%E8%AF%95%E6%8A%80%E6%9C%AF/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>æµ‹è¯•æŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æµ‹è¯•æŠ€æœ¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ“ä½œç³»ç»Ÿ</title>
    <link href="/2025/04/15/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    <url>/2025/04/15/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>æ“ä½œç³»ç»Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ“ä½œç³»ç»Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®ç»“æ„</title>
    <link href="/2025/04/15/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    <url>/2025/04/15/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•°æ®ç»“æ„</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>tcp/ip</title>
    <link href="/2025/04/15/tcp-ip/"/>
    <url>/2025/04/15/tcp-ip/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>TCP/IP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>TCP/IP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonç¼–ç¨‹ I åŸºç¡€</title>
    <link href="/2025/04/14/Python%E7%BC%96%E7%A8%8B-I/"/>
    <url>/2025/04/14/Python%E7%BC%96%E7%A8%8B-I/</url>
    
    <content type="html"><![CDATA[<h1 id="Pythonç¼–ç¨‹-I"><a href="#Pythonç¼–ç¨‹-I" class="headerlink" title="Pythonç¼–ç¨‹ I"></a>Pythonç¼–ç¨‹ I</h1><h1 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hello world&quot;</span>)<br><span class="hljs-comment"># å‡½æ•°(&quot;ä¼ å…¥å‚æ•°&quot;)</span><br></code></pre></td></tr></table></figure><h3 id="å˜é‡çš„å‘½å"><a href="#å˜é‡çš„å‘½å" class="headerlink" title="å˜é‡çš„å‘½å"></a>å˜é‡çš„å‘½å</h3><p>æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªå˜é‡åå†å°†å…¶æ‰“å° ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">message = <span class="hljs-string">&quot;hello world&quot;</span><br><span class="hljs-built_in">print</span>(message)<br></code></pre></td></tr></table></figure><h3 id="å‘½åè¦æ±‚å’Œé£æ ¼"><a href="#å‘½åè¦æ±‚å’Œé£æ ¼" class="headerlink" title="å‘½åè¦æ±‚å’Œé£æ ¼"></a>å‘½åè¦æ±‚å’Œé£æ ¼</h3><p>å˜é‡åæ¥å—çš„å­—ç¬¦ ï¼š å¤§å°å†™å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ã€‚æ•°å­—ä¸èƒ½åœ¨é¦–ä½å‡ºç°</p><p>é£æ ¼ï¼š</p><p>å¤§é©¼å³°å¼(å¸¸ç”¨äºç±»å®šä¹‰ï¼Œå‡½æ•°å®šä¹‰) ï¼š  ThisIsAVariableDefine</p><p>å°é©¼å³°å¼(å¸¸ç”¨äºç±»å®šä¹‰ï¼Œå‡½æ•°å®šä¹‰) ï¼š  thisIsAVariableDefin</p><p>ä¸‹åˆ’çº¿é£æ ¼(å¸¸ç”¨äºå˜é‡å£°æ˜)  :  my_variable</p><p>å˜é‡åå°½å¯èƒ½èµ·å¾—å®¹æ˜“ç†è§£ã€‚</p><h3 id="å˜é‡æ˜¯ä»€ä¹ˆ"><a href="#å˜é‡æ˜¯ä»€ä¹ˆ" class="headerlink" title="å˜é‡æ˜¯ä»€ä¹ˆ"></a>å˜é‡æ˜¯ä»€ä¹ˆ</h3><p>åœ¨æˆ‘ä»¬çš„æœ€åˆè®¨è®ºä¸­ï¼Œå˜é‡æ˜¯ä¸€ä¸ªé€šè¿‡æ˜ å°„ä¸å®é™…å¯¹è±¡å»ºç«‹å…³ç³»çš„æ ‡è¯†ç¬¦ã€‚</p><p>å½“ç„¶ç›®å‰å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ ‡ç­¾ç”¨æ¥å¯»æ‰¾æˆ‘ä»¬çœŸæ­£æƒ³å¤„ç†çš„å†…å®¹</p><h3 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h3><p>å­—ç¬¦ä¸²æ˜¯ä¸€ç§pythonçš„<strong>æ•°æ®ç±»å‹</strong></p><p>ç›´æ¥å°±å¯ä»¥å®šä¹‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">str1 = <span class="hljs-string">&quot;string&quot;</span><br>str1.upper()  <span class="hljs-comment"># å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå…¨éƒ¨å¤§å†™ï¼Œè¾“å‡º ï¼š STRING</span><br>str1.lower()  <span class="hljs-comment"># å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå…¨éƒ¨å°å†™ï¼Œè¾“å‡º ï¼š string</span><br>str1.title()  <span class="hljs-comment"># å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºé¦–å­—æ¯å¤§å†™ï¼Œè¾“å‡º ï¼šString</span><br></code></pre></td></tr></table></figure><h3 id="æ ¼å¼åŒ–è¾“å‡º"><a href="#æ ¼å¼åŒ–è¾“å‡º" class="headerlink" title="æ ¼å¼åŒ–è¾“å‡º"></a>æ ¼å¼åŒ–è¾“å‡º</h3><p>python æä¾›å¤šç§å­—ç¬¦ä¸²çš„è¾“å‡ºæ–¹å¼</p><p>åŒæ—¶å¯ä»¥ä½¿ç”¨â€™\charâ€™ æ¥åœ¨å­—ç¬¦ä¸²ä¸­æ·»åŠ è½¬ä¹‰å­—ç¬¦</p><p>\t åˆ¶è¡¨ç¬¦</p><p>\n æ¢è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">StringA = <span class="hljs-string">&quot;a&quot;</span><br>StringB = <span class="hljs-string">&quot;b&quot;</span><br>StringC = <span class="hljs-string">&quot;c&quot;</span><br>StringD = <span class="hljs-string">&quot;d&quot;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hello %s&quot;</span> % StringA)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hello &quot;</span>+StringB)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;hello <span class="hljs-subst">&#123;StringC&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hello &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(StringD))<br><span class="hljs-comment"># è¾“å‡º ï¼š</span><br><span class="hljs-comment"># hello a</span><br><span class="hljs-comment"># hello b</span><br><span class="hljs-comment"># hello c</span><br><span class="hljs-comment"># hello d</span><br></code></pre></td></tr></table></figure><h3 id="æ•°å€¼"><a href="#æ•°å€¼" class="headerlink" title="æ•°å€¼"></a>æ•°å€¼</h3><p>æ•´æ•°</p><p>pythonæ”¯æŒæ•°å­¦è¿ç®—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">a,b,c,d = <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span> <br><span class="hljs-built_in">print</span>(a+b)      <span class="hljs-comment"># åŠ æ³• è¾“å‡º 3</span><br><span class="hljs-built_in">print</span>(a-b)      <span class="hljs-comment"># å‡æ³• è¾“å‡º -1</span><br><span class="hljs-built_in">print</span>(b*c)      <span class="hljs-comment"># ä¹˜æ³• è¾“å‡º 6</span><br><span class="hljs-built_in">print</span>(c/d)      <span class="hljs-comment"># é™¤æ³• è¾“å‡º3/4</span><br><span class="hljs-built_in">print</span>(d//<span class="hljs-number">4</span>)     <span class="hljs-comment"># æ•´é™¤  è¾“å‡º1</span><br><span class="hljs-built_in">print</span>(d%c)      <span class="hljs-comment"># å–ä½™æ•° è¾“å‡º1</span><br><span class="hljs-built_in">print</span>(d**b)     <span class="hljs-comment"># è®¡ç®—å¹³æ–¹ è¾“å‡º 16</span><br></code></pre></td></tr></table></figure><p>æµ®ç‚¹æ•°</p><p>åŒæ ·æ”¯æŒæ•°å­¦è¿ç®—ï¼Œåœ¨æœ‰æµ®ç‚¹æ•°å‚ä¸çš„è®¡ç®—ç§ä¼šè¢«è‡ªåŠ¨è½¬åŒ–ä¸ºæµ®ç‚¹æ•°</p><p>å¸¸é‡</p><p>Python ä¸­é€šå¸¸ç”¨å¤§å†™æ¥æ ‡è®°ä¸€ä¸ªé‡ä¸ºå¸¸é‡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">MAX_VALUE = <span class="hljs-number">5000</span><br></code></pre></td></tr></table></figure><h3 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h3><p>python ä½¿ç”¨ä¸¤ç§é£æ ¼çš„æ³¨é‡Š  å•è¡Œæ³¨é‡Š #  å’Œ  å¤šè¡Œæ³¨é‡Š â€œâ€â€ â€¦ â€œâ€â€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å•è¡Œæ³¨é‡Š</span><br><span class="hljs-string">&quot;&quot;&quot; å¤šè¡Œ</span><br><span class="hljs-string">æ³¨é‡Š &quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h1 id="åˆ—è¡¨"><a href="#åˆ—è¡¨" class="headerlink" title="åˆ—è¡¨"></a>åˆ—è¡¨</h1><p>åˆ—è¡¨æ˜¯ä¸€ç§èƒ½å¤Ÿå®¹çº³å¤šä¸ªå…ƒç´ çš„æ•°æ®ç»“æ„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">lst1 = <span class="hljs-built_in">list</span>()  <span class="hljs-comment">#æ˜¾å¼åˆ›å»ºç©ºåˆ—è¡¨</span><br>lst2 = []      <span class="hljs-comment">#éšå¼åˆ›å»ºç©ºåˆ—è¡¨</span><br></code></pre></td></tr></table></figure><p>pythonä¸­çš„åˆ—è¡¨ä¸ä¼šé™åˆ¶åˆ—è¡¨ä¸­å…ƒç´ çš„ç±»å‹ï¼Œä¹Ÿä¸ä¼šé™åˆ¶æ•´ä¸ªåˆ—è¡¨çš„é•¿åº¦</p><p>ä¸€äº›é€šç”¨å‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">lst1 = <span class="hljs-built_in">list</span>()<br>lst2 = [<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">7</span>,<span class="hljs-number">6</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">9</span>]<br> <br>lst1.append(<span class="hljs-number">1</span>)                 <span class="hljs-comment"># å‘åˆ—è¡¨ä¸­æ·»åŠ å…ƒç´               [1]</span><br>lst1.append(<span class="hljs-string">&quot;hi&quot;</span>)              <span class="hljs-comment"># æ·»åŠ å…¶ä»–ç±»å‹çš„å…ƒç´             [1, &#x27;hi&#x27;]</span><br>lst1.remove(<span class="hljs-number">1</span>)                 <span class="hljs-comment"># åˆ é™¤åˆ—è¡¨ä¸­çš„å…ƒç´               [&#x27;hi&#x27;]</span><br>lst1.extend(lst2)              <span class="hljs-comment"># å°†lst2ä¸­çš„å…ƒç´ æ·»åŠ åˆ°lst1      [&#x27;hi&#x27;, 2, 5, 8, 9, 7, 6, 2, 3, 9]</span><br>lst1.reverse()                 <span class="hljs-comment"># åè½¬åˆ—è¡¨                      [9, 3, 2, 6, 7, 9, 8, 5, 2, &#x27;hi&#x27;]</span><br>lst1.pop()                     <span class="hljs-comment"># å¼¹å‡ºæœ«å°¾å…ƒç´ èµ‹å€¼ç»™å˜é‡         [9, 3, 2, 6, 7, 9, 8, 5, 2]</span><br></code></pre></td></tr></table></figure><h1 id="åˆ—è¡¨æ“ä½œ"><a href="#åˆ—è¡¨æ“ä½œ" class="headerlink" title="åˆ—è¡¨æ“ä½œ"></a>åˆ—è¡¨æ“ä½œ</h1><h2 id="éå†"><a href="#éå†" class="headerlink" title="éå†"></a>éå†</h2><p>å¯¹äºæƒ³è¯»å–åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨for in æ¥è¿›è¡Œè¯»å–ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lst2 :       <span class="hljs-comment"># iä½œä¸ºä¸´æ—¶å˜é‡ä½¿ç”¨ç”¨æ¥è·å–lst2ä¸­çš„å…ƒç´ </span><br>    <span class="hljs-built_in">print</span>(i,end=<span class="hljs-string">&quot;,&quot;</span>)      <span class="hljs-comment"># end=  è®¾ç½®è¾“å‡ºçš„ç»“æŸç¬¦</span><br><span class="hljs-comment"># è¾“å‡º 2,5,8,9,7,6,2,3,9,</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(lst2)):  <span class="hljs-comment"># ä¹Ÿå¯ä»¥ä½¿ç”¨rangeæ¥å®Œæˆå¾ªç¯ï¼Œæ¯æ¬¡æ‰§è¡Œä¼šå°†iå¢åŠ 1</span><br>    <span class="hljs-built_in">print</span>(lst2[i],end=<span class="hljs-string">&quot;,&quot;</span>)<br><span class="hljs-comment"># è¾“å‡º 2,5,8,9,7,6,2,3,9,</span><br><span class="hljs-comment"># rangeçš„èŒƒå›´æ˜¯å‰é—­åå¼€</span><br><span class="hljs-built_in">range</span> è¿˜å¯ä»¥æŒ‰æ­¥é•¿è¾“å‡º<br></code></pre></td></tr></table></figure><h2 id="åˆ—è¡¨ç”Ÿæˆå¼"><a href="#åˆ—è¡¨ç”Ÿæˆå¼" class="headerlink" title="åˆ—è¡¨ç”Ÿæˆå¼"></a>åˆ—è¡¨ç”Ÿæˆå¼</h2><p>å½“éœ€è¦åˆ›å»ºç±»ä¼¼ [1,2,3,4,5,6,7,8,9]çš„åˆ—è¡¨æ—¶ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡forå¾ªç¯åˆ›å»º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">lst3 = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,<span class="hljs-number">10</span>)] <br><span class="hljs-comment"># åˆ›å»ºåˆ—è¡¨ [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span><br></code></pre></td></tr></table></figure><h2 id="åˆ‡ç‰‡"><a href="#åˆ‡ç‰‡" class="headerlink" title="åˆ‡ç‰‡"></a>åˆ‡ç‰‡</h2><p>å¦‚æœæƒ³è·å–åˆ—è¡¨ä¸­çš„éƒ¨åˆ†å…ƒç´ å¯ä»¥é€šè¿‡ä¸‹æ ‡å¯¹æŸä½ç½®çš„å…ƒç´ è¿›è¡Œè·å– </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">lst3[<span class="hljs-number">0</span>]    <span class="hljs-comment"># è·å–ç¬¬ä¸€ä¸ªå…ƒç´  å³0</span><br>lst3[<span class="hljs-number">2</span>:<span class="hljs-number">5</span>]  <span class="hljs-comment"># è·å–ç¬¬3-5ä¸ªå…ƒç´ çš„å­åˆ—è¡¨</span><br>lst3[::-<span class="hljs-number">1</span>] <span class="hljs-comment"># è·å–åè½¬åˆ—è¡¨</span><br></code></pre></td></tr></table></figure><h2 id="å¤åˆ¶åˆ—è¡¨"><a href="#å¤åˆ¶åˆ—è¡¨" class="headerlink" title="å¤åˆ¶åˆ—è¡¨"></a>å¤åˆ¶åˆ—è¡¨</h2><p>æœ‰äº›æƒ…å†µä¸‹éœ€è¦å¯¹åˆ—è¡¨è¿›è¡Œå¤åˆ¶æ“ä½œï¼Œè¿™æ—¶éœ€è¦è€ƒè™‘æ˜¯å¦ä¼šå¯¹æºåˆ—è¡¨æœ‰å½±å“</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">lst0 = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]                   <span class="hljs-comment">#å®šä¹‰äº†ä¸€ä¸ªåˆ—è¡¨çš„æ•°æ®ç»“æ„</span><br>lst4 = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,lst0]      <span class="hljs-comment">#æ·»åŠ åˆ°å¦ä¸€ä¸ªåˆ—è¡¨ä¸­</span><br>lst5 = lst4[::]                  <span class="hljs-comment">#å¤åˆ¶åˆ—è¡¨lst4åˆ°lst5</span><br>lst5[-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">2</span>                  <span class="hljs-comment">#ä¿®æ”¹5ä¸­çš„lst0</span><br><span class="hljs-built_in">print</span>(lst0)                      <span class="hljs-comment"># è¾“å‡º[2,2,3] å‘ç°lst0ä¹Ÿè¢«æ”¹åŠ¨äº†ã€‚</span><br></code></pre></td></tr></table></figure><p>è¿™æ˜¯å› ä¸ºpythonä¸­ å¤åˆ¶åˆ—è¡¨æ—¶ï¼Œä¼ é€’è¿‡å»çš„éƒ½æ˜¯å˜é‡çš„å€¼ï¼Œä½†æ˜¯å¯¹äºå¼•ç”¨å˜é‡ï¼ˆå¯ä»¥ç†è§£ä¸ºåŒ…å«å¤šä¸ªå…ƒç´ çš„å˜é‡ï¼Œå¦‚åˆ—è¡¨ï¼‰ï¼Œè¿”å›çš„æ˜¯è¯¥å˜é‡çš„å­˜å‚¨ä½ç½®ã€‚æ‰€ä»¥å½“ä¿®æ”¹è¯¥å˜é‡ä¸­çš„å€¼çš„æ—¶å€™ï¼Œè¿˜æ˜¯å¯¹åŸå¯¹è±¡è¿›è¡Œäº†ä¿®æ”¹ã€‚æ‰€ä»¥åœ¨å¤åˆ¶åˆ—è¡¨ç­‰å¼•ç”¨æ•°æ®ç±»å‹çš„æ—¶å€™éœ€è¦:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">lst0 = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]<br>lst4 = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,lst0]<br>lst6 = copy.deepcopy(lst4)        <span class="hljs-comment">#éå†å…ƒç´ ï¼Œåˆ¤æ–­å­˜åœ¨å¼•ç”¨ç±»å‹çš„å…ƒç´ ï¼Œåˆ›å»ºæ–°å¼•ç”¨å…ƒç´ åŠ å…¥åˆ—è¡¨</span><br>lst6[-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]=<span class="hljs-number">2</span><br><span class="hljs-built_in">print</span>(lst0)<br></code></pre></td></tr></table></figure><h1 id="å…ƒç»„"><a href="#å…ƒç»„" class="headerlink" title="å…ƒç»„"></a>å…ƒç»„</h1><p>åœ¨pythonä¸­ï¼Œå…ƒç»„æ˜¯å¯¹äºä¸€ç»„ä¸å¯å˜æ•°æ®çš„ç±»å‹ç§°å‘¼ï¼Œè¢«å®šä¹‰çš„å…ƒç»„åœ¨åç»­çš„ä½¿ç”¨ä¸­ä¸å¯ä»¥è¢«ä¿®æ”¹</p><p>è¿™ç§è®¾è®¡æ˜¯å¯¹åº”ä¸€äº›æ•°æ®çš„åªè¯»å±æ€§ï¼Œé˜²æ­¢åæœŸè¢«ç¯¡æ”¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">tuple1 = ï¼ˆ<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>ï¼‰           <span class="hljs-comment">#ä½¿ç”¨åœ†æ‹¬å·å®šä¹‰å…ƒç»„</span><br>tuple2 = <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>               <span class="hljs-comment">#éšå¼å®šä¹‰å…ƒç»„</span><br>tuple3 = <span class="hljs-number">1</span>,                  <span class="hljs-comment">#æˆ–è€…ä½¿ç”¨,å®šä¹‰åªæœ‰ä¸€ä¸ªå…ƒç´ çš„å…ƒç»„</span><br></code></pre></td></tr></table></figure><p>å…ƒç»„ä¹Ÿæ”¯æŒå‰è¿°ä¸­åˆ—è¡¨çš„éå†ï¼Œåˆ‡ç‰‡æ“ä½œã€‚åªæ˜¯ä¸èƒ½ä¿®æ”¹å…¶ä¸­çš„æ•°æ®ï¼Œè¿™æ˜¯ç”±è§£é‡Šå™¨æ§åˆ¶çš„</p><h1 id="åˆ¤æ–­è¡¨è¾¾å¼"><a href="#åˆ¤æ–­è¡¨è¾¾å¼" class="headerlink" title="åˆ¤æ–­è¡¨è¾¾å¼"></a>åˆ¤æ–­è¡¨è¾¾å¼</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">a =<span class="hljs-string">&#x27;c&#x27;</span><br><span class="hljs-keyword">if</span> a == <span class="hljs-string">&#x27;a&#x27;</span> :                            <span class="hljs-comment"># åˆ¤æ–­æ¡ä»¶1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s is here&quot;</span> % a)<br><span class="hljs-keyword">elif</span> a == <span class="hljs-string">&#x27;b&#x27;</span>  :                      <span class="hljs-comment"># åˆ¤æ–­æ¡ä»¶2 å¯ä»¥è·Ÿå¤šä¸ªelse if + åˆ¤æ–­æ¡ä»¶</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;a&#125;</span> is here&quot;</span>)<br><span class="hljs-keyword">else</span> :                                   <span class="hljs-comment"># å…¶ä»–æƒ…å†µ</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125; is here&quot;</span>.<span class="hljs-built_in">format</span>(a))<br></code></pre></td></tr></table></figure><h2 id="åˆ¤æ–­æ¡ä»¶"><a href="#åˆ¤æ–­æ¡ä»¶" class="headerlink" title="åˆ¤æ–­æ¡ä»¶"></a>åˆ¤æ–­æ¡ä»¶</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">!= ä¸ç­‰äº<br>== ç­‰äº<br><span class="hljs-keyword">is</span> ç”¨äºå¼•ç”¨å˜é‡åˆ¤æ–­æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡<br><span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> ç”¨äºå¼•ç”¨å˜é‡åˆ¤æ–­æ˜¯å¦éåŒä¸€ä¸ªå¯¹è±¡<br><span class="hljs-keyword">in</span> åˆ¤æ–­æŸå…ƒç´ æ˜¯å¦ä¸­æ˜¯å¦åŒ…å«è¯¥å…ƒç´ <br><span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> åˆ¤æ–­æŸå…ƒç´ æ˜¯å¦ä¸å«æœ‰æŸå…ƒç´ <br><span class="hljs-literal">True</span>  å€¼ä¸ºçœŸ<br><span class="hljs-literal">False</span> å€¼ä¸ºå‡<br><br></code></pre></td></tr></table></figure><h2 id="å¤šæ¡ä»¶å¤„ç†"><a href="#å¤šæ¡ä»¶å¤„ç†" class="headerlink" title="å¤šæ¡ä»¶å¤„ç†"></a>å¤šæ¡ä»¶å¤„ç†</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">and</span>  <span class="hljs-string">&quot;ä¸”&quot;</span> æ‹¼æ¥å¤šä¸ªæ¡ä»¶åˆ¤æ–­<br><span class="hljs-keyword">or</span>   <span class="hljs-string">&quot;æˆ–&quot;</span> æ‹¼æ¥å¤šä¸ªæ¡ä»¶åˆ¤æ–­<br><br></code></pre></td></tr></table></figure><h1 id="å­—å…¸"><a href="#å­—å…¸" class="headerlink" title="å­—å…¸"></a>å­—å…¸</h1><p>å­—å…¸æ˜¯ä¸€ç§é”®å€¼å¯¹çš„ç»“æ„ é€šè¿‡å¯¹åº”çš„é”®å¯ä»¥è¿›è¡Œå€¼çš„è®¿é—®ã€‚</p><p>å­—å…¸å¯ä»¥æ¥æ”¶ä»»æ„çš„å…ƒç´ ä½œä¸ºé”®å’Œå€¼ï¼Œä½†æ˜¯è¦ä¿è¯é”®çš„å”¯ä¸€æ€§</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">dict1 = <span class="hljs-built_in">dict</span>()                        <span class="hljs-comment">#æ˜¾å¼åˆ›å»º</span><br>dict2 = &#123;<span class="hljs-string">&quot;sex&quot;</span>:<span class="hljs-string">&quot;male&quot;</span>&#125;                <span class="hljs-comment">#éšå¼åˆ›å»º</span><br>dict3 = &#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;codfish&quot;</span>,<span class="hljs-string">&quot;age&quot;</span>:<span class="hljs-string">&quot;28&quot;</span>&#125;<br>dict3.update(dict2)                   <span class="hljs-comment">#å°†dict2ä¸­çš„é”®å€¼å¯¹æ›´æ–°åˆ°dict3ä¸­</span><br>dict3[<span class="hljs-string">&quot;name&quot;</span>]                         <span class="hljs-comment">#è·å–é”®nameå¯¹åº”çš„å€¼</span><br>dict3[<span class="hljs-string">&quot;name&quot;</span>] = <span class="hljs-string">&quot;someone&quot;</span>             <span class="hljs-comment">#è®¾ç½®ä¿®æ”¹nameé”®å¯¹åº”çš„å€¼</span><br>dict3.get(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;default value&quot;</span>)     <span class="hljs-comment">#è·å–ä¸€ä¸ªé”®çš„å€¼,ä¸å­˜åœ¨å¯¹åº”é”®çš„æ—¶å€™è¿”å›é»˜è®¤å€¼</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dict3.keys():                <span class="hljs-comment">#éå†æ‰“å°æ‰€æœ‰çš„é”®</span><br>    <span class="hljs-built_in">print</span>(i)<br><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> dict3.values():              <span class="hljs-comment">#éå†æ‰“å°æ‰€æœ‰çš„å€¼</span><br>    <span class="hljs-built_in">print</span>(j)<br><br><span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> dict3.items() :            <span class="hljs-comment">#é€šè¿‡.items è·å–é”®å’Œå€¼</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;your <span class="hljs-subst">&#123;k&#125;</span> is <span class="hljs-subst">&#123;v&#125;</span>&quot;</span>)<br> <br></code></pre></td></tr></table></figure><h1 id="æ¥æ”¶è¾“å…¥"><a href="#æ¥æ”¶è¾“å…¥" class="headerlink" title="æ¥æ”¶è¾“å…¥"></a>æ¥æ”¶è¾“å…¥</h1><p>pythonä¸­ä½¿ç”¨â€œinputâ€ æ¥æ”¶æ•°æ®ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">age = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;input your age&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(age))   <span class="hljs-comment"># typeè¿”å›å˜é‡çš„ç±»å‹ï¼Œ è¾“å‡ºä¸º&lt;class &#x27;str&#x27;&gt;</span><br></code></pre></td></tr></table></figure><h1 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h1><p>é™¤äº†ä½¿ç”¨for ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨whileè¿›è¡Œå¾ªç¯æ§åˆ¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">counter = <span class="hljs-number">10</span><br><span class="hljs-keyword">while</span> counter &gt; <span class="hljs-number">3</span> :<br><span class="hljs-keyword">if</span> counter == <span class="hljs-number">6</span> :<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;current is %d &quot;</span> % counter)          <br><span class="hljs-keyword">elif</span> counter == <span class="hljs-number">7</span> :<br>  <span class="hljs-keyword">continue</span>                          <span class="hljs-comment">#è·³è¿‡æœ¬æ¬¡å¾ªç¯,å¾ªç¯ç»§ç»­</span><br><span class="hljs-keyword">elif</span> counter == <span class="hljs-number">4</span> :<br><span class="hljs-keyword">break</span>                             <span class="hljs-comment">#è·³å‡ºwhileå¾ªç¯æ‰§è¡Œåç»­å·¥ä½œæµ</span><br><span class="hljs-keyword">else</span> :<br>  <span class="hljs-built_in">print</span>(counter) <br>  <br>è¾“å‡º:<br>PS D:\Software&gt; python .\anmial.py<br><span class="hljs-number">10</span><br><span class="hljs-number">9</span><br><span class="hljs-number">8</span><br>current <span class="hljs-keyword">is</span> <span class="hljs-number">6</span> <br><span class="hljs-number">5</span><br></code></pre></td></tr></table></figure><h1 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h1><p>å‡½æ•°æ˜¯ä¸€æ®µæ‰§è¡Œç‰¹å®šåŠŸèƒ½çš„ä»£ç å—ï¼Œå½“æŸäº›åŠŸèƒ½åœ¨å¤šä¸ªä½ç½®é‡å¤ä½¿ç”¨æ—¶ï¼Œä½¿ç”¨å‡½æ•°å¯ä»¥æé«˜ä»£ç å¤ç”¨ï¼Œæå‡ç¼–ç¨‹æ•ˆç‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#python ä¸­çš„å‡½æ•°å®šä¹‰</span><br><span class="hljs-keyword">def</span>              <span class="hljs-title function_">say_hello</span>(<span class="hljs-params">name</span>):<br><span class="hljs-comment">#å‡½æ•°å£°æ˜ä¿ç•™å­—  å‡½æ•°å   å‚æ•°ä¿¡æ¯</span><br> <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;hello <span class="hljs-subst">&#123;name&#125;</span>&quot;</span>)<br> <br>say_hello(<span class="hljs-string">&quot;codfish&quot;</span>)  <span class="hljs-comment">#è°ƒç”¨å‡½æ•° è¾“å‡º hello codfish</span><br></code></pre></td></tr></table></figure><h2 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h2><p>pythonçš„ å‚æ•°æ”¯æŒçµæ´»çš„å®šä¹‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">say_hello</span>()    <span class="hljs-comment"># æ— å‚æƒ…å†µ</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">say_hello</span>(<span class="hljs-params">name</span>)  <span class="hljs-comment"># ä¼ å…¥ä¸€ä¸ªå‚æ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">say_hello</span>(<span class="hljs-params">name,time=<span class="hljs-string">&quot;evening&quot;</span></span>) <span class="hljs-comment"># ä¼ å…¥å¤šä¸ªå‚æ•°ï¼Œä¸”æœ‰é»˜è®¤å€¼çš„å‚æ•°ï¼Œæœ‰é»˜è®¤å€¼çš„å‚æ•°éœ€è¦ä½äºæœ€åã€‚</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">say_hello</span>(<span class="hljs-params">name,*args</span>)  <span class="hljs-comment"># æ¥æ”¶name å’Œå¤šä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå…ƒç»„argç»™å‡½æ•°å¤„ç†</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">say_hello</span>(<span class="hljs-params">name,**kwargs</span>)  <span class="hljs-comment"># å°†ä¼ å…¥çš„æŒ‡å®šå˜é‡åçš„å‚æ•°ä½œä¸ºä¸€ä¸ªå­—å…¸å˜é‡kwargs ä¼ å…¥å‡½æ•°å¤„ç†</span><br>  <br></code></pre></td></tr></table></figure><h2 id="å½¢å‚ä¸å®å‚"><a href="#å½¢å‚ä¸å®å‚" class="headerlink" title="å½¢å‚ä¸å®å‚"></a>å½¢å‚ä¸å®å‚</h2><p>å½¢å¼å‚æ•° æ˜¯ç”¨æ¥è¯´æ˜å‡½æ•°åŠŸèƒ½ï¼Œä½œä¸ºæ›¿ä»£ç¬¦ï¼Œä½¿å¾—å‡½æ•°åŠŸèƒ½çš„å®šä¹‰å®Œæ•´</p><p>å®é™…å‚æ•° æ˜¯çœŸæ­£éœ€è¦è¢«å¤„ç†çš„å‚æ•°ã€‚</p><p>åœ¨è¿™é‡Œ  å®å‚åŒæ ·è¦æ³¨æ„ å€¼å’Œå¼•ç”¨çš„é—®é¢˜ï¼Œå½“ä¼ å…¥å¼•ç”¨å¯¹è±¡çš„æ—¶å€™ï¼Œå‡½æ•° æ“ä½œçš„ä»ç„¶æ˜¯ä½ çš„å®é™…å¯¹è±¡ã€‚</p><h2 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h2><p>python å¯ä»¥æ¥æ”¶ä»»æ„ç±»å‹çš„å€¼ä½œä¸ºè¿”å›å€¼è¿”å›ç»™æ¥æ”¶å®ƒçš„å˜é‡ï¼Œä¹Ÿå¯ä»¥è¿”å›å¤šä¸ªå€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">return_test</span>():                 <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>              <span class="hljs-comment">#ä¹Ÿå¯ä»¥æ¥æ”¶å¤šä¸ªå€¼çš„è¿”å›ï¼Œæœ¬è´¨æ˜¯å…ƒç»„çš„æ˜ å°„</span><br>a,b,c,d,e = return_test()<br><span class="hljs-built_in">print</span>(a)<br></code></pre></td></tr></table></figure><h1 id="ç±»"><a href="#ç±»" class="headerlink" title="ç±»"></a>ç±»</h1><p>åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œç±»æ˜¯ç”¨æ¥æè¿°ä¸€ç±»å…·æœ‰ç›¸åŒåŠŸèƒ½æˆ–ç»„ä»¶çš„äº‹ç‰©çš„æŠ½è±¡æ¨¡æ¿ï¼Œé€šè¿‡åœ¨ç±»ä¸­å®šä¹‰å±æ€§å’Œæ–¹æ³•ï¼ˆç±»ä¸­çš„å‡½æ•°ï¼‰ï¼Œæ¥å®Œæˆå¯¹äº‹ç‰©åŠŸèƒ½çš„æŠ½è±¡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span>          <span class="hljs-comment"># å®šä¹‰ç±» Dog</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name,age</span>):        <span class="hljs-comment"># __init__ ç”¨äºä¸ºåç»­åˆ›å»ºçš„ç‹—çš„å®ä¾‹èµ‹å€¼</span><br><span class="hljs-variable language_">self</span>.name = name         <br><span class="hljs-variable language_">self</span>.age = age<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bark</span>(<span class="hljs-params">self</span>):<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.name&#125;</span> is barking&quot;</span>)  <span class="hljs-comment"># å°ç‹—å…·å¤‡çš„åŠŸèƒ½</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">walk</span>(<span class="hljs-params">self</span>):<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.name&#125;</span> is walking&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><p>ç±»ä½œä¸ºæŠ½è±¡äº‹åŠ¡çš„æ¨¡æ¿ï¼Œé‚£ä¹ˆç”±ç±»åˆ›é€ çš„å®ä¾‹å°±æ˜¯å¯¹å…·ä½“äº‹åŠ¡åœ¨è®¡ç®—æœºä¸Šçš„æŠ½è±¡ï¼Œé€šè¿‡å¯¹ç±»çš„è°ƒç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¯¥ç±»çš„å®ä¾‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">dog =  Dog(<span class="hljs-string">&quot;æ—ºæŸ´&quot;</span>,<span class="hljs-string">&quot;3&quot;</span>)   <span class="hljs-comment"># åˆ›å»ºäº†ä¸€åªåå«æ—ºæŸ´çš„3å²çš„ç‹—</span><br><span class="hljs-built_in">print</span>(dog.name)          <span class="hljs-comment"># æ‰“å°ç‹—çš„åå­—</span><br>dog.bark()               <span class="hljs-comment"># æ‰§è¡Œç‹—å«çš„æ–¹æ³•</span><br></code></pre></td></tr></table></figure><h1 id="æ–‡ä»¶æ“ä½œ"><a href="#æ–‡ä»¶æ“ä½œ" class="headerlink" title="æ–‡ä»¶æ“ä½œ"></a>æ–‡ä»¶æ“ä½œ</h1><p>åœ¨pythonä¸­ï¼Œä½¿ç”¨open&#x2F;closeå…³é”®å­—æ¥è¿›è¡Œ æ–‡ä»¶çš„æ“ä½œå¼€é—­æ“ä½œ</p><p>é€šè¿‡encoding æŒ‡å®šæ–‡ä»¶çš„å­—ç¬¦é›†</p><p>é€šè¿‡ â€˜rwaâ€™ æŒ‡å®šæ–‡ä»¶çš„è¯»å†™æ¨¡å¼ r åªè¯» wåªå†™ aè¿½åŠ  rä»¥å­—èŠ‚åºè¯»å–æ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;test.txt&quot;</span>,encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> content :       <span class="hljs-comment">#æ‰“å¼€æ–‡ä»¶,ä½¿ç”¨withæ—¶ ä¸éœ€è¦ä½¿ç”¨closeå…³é—­è¿™ä¸ªä½œç”¨åŸŸç»“æŸåä¼šè‡ªåŠ¨å…³é—­æ–‡ä»¶</span><br>    a = content.read()                                    <span class="hljs-comment">#è¯»å–æ–‡ä»¶å†…å®¹</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(a))                                        <span class="hljs-comment">#æ–‡ä»¶å†…å®¹é»˜è®¤ä»¥å­—ç¬¦ä¸²ç±»å‹è¢«è¯»å–</span><br></code></pre></td></tr></table></figure><h1 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h1><p>åœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ¥æ”¶åˆ°äº†ä¸ç¬¦åˆé¢„æœŸçš„å‚æ•°ç­‰ä¸€äº›æƒ…å†µä¼šä½¿å¾—ç¨‹åºäº§ç”Ÿå¼‚å¸¸ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡</p><p>try-except-finally æ¥å®Œæˆå¼‚å¸¸çš„æ•æ‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">try</span> :<br>    <span class="hljs-number">8</span>/<span class="hljs-number">0</span>                                     <span class="hljs-comment"># è§¦å‘é™¤æ•°å¼‚å¸¸</span><br><span class="hljs-keyword">except</span> ZeroDivisionError <span class="hljs-keyword">as</span> e  :            <span class="hljs-comment"># å°†å¼‚å¸¸æ¥æ”¶ä¸ºä¸€ä¸ªå¼‚å¸¸å¯¹è±¡ï¼Œå¯ä»¥è¿›è¡Œæ‰“å°æˆ–è€…è¿”å›</span><br><span class="hljs-built_in">print</span>(e)<br><span class="hljs-keyword">finally</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;it&#x27;s done&quot;</span>)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonçš„åŠ è½½è¿‡ç¨‹ä¸å†…å­˜æ¨¡å‹</title>
    <link href="/2025/04/14/Python%E7%9A%84%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/"/>
    <url>/2025/04/14/Python%E7%9A%84%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="Pythonçš„åŠ è½½è¿‡ç¨‹ä¸å†…å­˜æ¨¡å‹-CPythonå®ç°"><a href="#Pythonçš„åŠ è½½è¿‡ç¨‹ä¸å†…å­˜æ¨¡å‹-CPythonå®ç°" class="headerlink" title="Pythonçš„åŠ è½½è¿‡ç¨‹ä¸å†…å­˜æ¨¡å‹(CPythonå®ç°)"></a>Pythonçš„åŠ è½½è¿‡ç¨‹ä¸å†…å­˜æ¨¡å‹(CPythonå®ç°)</h1><h1 id="Pythonçš„åŠ è½½è¿‡ç¨‹"><a href="#Pythonçš„åŠ è½½è¿‡ç¨‹" class="headerlink" title="Pythonçš„åŠ è½½è¿‡ç¨‹"></a>Pythonçš„åŠ è½½è¿‡ç¨‹</h1><p><img src="https://i.111666.best/image/vJcRKHO4PyR94YrSC7j0IS.png" alt="image"></p><h2 id="ç¼–è¯‘æ—¶"><a href="#ç¼–è¯‘æ—¶" class="headerlink" title="ç¼–è¯‘æ—¶"></a>ç¼–è¯‘æ—¶</h2><p>Python ä¸å…¶ä»–è¯­è¨€ä¸€æ ·ä¹Ÿå…·æœ‰ç¼–è¯‘è¿‡ç¨‹ ï¼Œå°†Pythonæ–‡ä»¶è½¬æ¢ä¸ºå­—èŠ‚ç æ–‡ä»¶ä¾›è§£é‡Šå™¨è¿›è¡Œä¸‹ä¸€æ­¥çš„å¤„ç†ã€‚è¿›è¡Œè¯­ä¹‰åˆ†æï¼Œè¯­æ³•åˆ†æï¼Œå…·è±¡ç”Ÿæˆæ ‘ï¼ŒæŠ½è±¡ç”Ÿæˆæ ‘ï¼Œæœ€ç»ˆå°†æ–‡ä»¶è½¬æ¢ä¸ºå­—èŠ‚ç ã€‚</p><p>å¯¹å¯¹è±¡çš„é¢„å¤„ç†:</p><p>å¯¹äºå·¦å€¼ï¼ˆå˜é‡åï¼‰ä¼šåœ¨ç¼–è¯‘æœŸè¢«åŠ å…¥åç§°è¡¨ï¼ˆ<code>co_names</code>ï¼‰ï¼Œå¹¶åŠ å…¥åˆ° ä¸€ä¸ªåç§°è¡¨å…ƒç»„ä¸­ã€‚</p><p>å¯¹äºå³ä¾§åˆ›å»ºçš„å˜é‡ï¼Œæ ¹æ®ç±»å‹çš„ä¸åŒï¼ŒåŠ å…¥åˆ°å¸¸é‡è¡¨ä¸­ã€‚</p><p>å°†å…¨å±€å˜é‡æ›¿æ¢ä¸ºåç§°è¡¨ä¸­çš„ç´¢å¼•ï¼Œè€Œç´¢å¼•æ˜ å°„äº†å¯¹åº”çš„å¸¸é‡å¯¹è±¡æŒ‡é’ˆ</p><p>åœ¨pythonæ–‡ä»¶ä¸­çš„å˜é‡å£°æ˜â€a &#x3D; 3â€  å˜æˆäº† â€œåå­—è¡¨ä¸­â€˜aâ€™çš„å†…å­˜åœ°å€  æŒ‡å‘äº†å¸¸é‡è¡¨ä¸­â€˜3â€™çš„å†…å­˜åœ°å€â€</p><p>ä¸ºäº†æ“ä½œæ›´åŠ æ–¹ä¾¿çµæ´»ï¼Œç±»å®šä¹‰ä¸­çš„ç±»å˜é‡åˆ™ç›´æ¥è¢«è£…è½½åˆ°ç±»çš„å‘½åç©ºé—´è¿›è¡Œç®¡ç†ã€‚</p><p>å°†å±€éƒ¨å˜é‡æ›¿æ¢ä¸ºå±€éƒ¨å˜é‡è¡¨+æ’æ§½</p><h2 id="è¿è¡Œæ—¶"><a href="#è¿è¡Œæ—¶" class="headerlink" title="è¿è¡Œæ—¶"></a>è¿è¡Œæ—¶</h2><p>å°†pythonå­—èŠ‚ç æ–‡ä»¶åŠ è½½åˆ°è™šæ‹Ÿæœºã€‚ä¸åŒçš„pythonç»„ä»¶ä¼šæ‰§è¡Œä¸åŒçš„è£…è½½è¡Œä¸ºã€‚æœ€ç»ˆå°†å¯¹è±¡åŠ è½½åˆ°å‘½åç©ºé—´ï¼Œè¿›è¡Œæ‰§è¡Œã€‚</p><h1 id="ç»„ä»¶åŠ è½½è¿‡ç¨‹"><a href="#ç»„ä»¶åŠ è½½è¿‡ç¨‹" class="headerlink" title="ç»„ä»¶åŠ è½½è¿‡ç¨‹"></a>ç»„ä»¶åŠ è½½è¿‡ç¨‹</h1><p>Pythonçš„åŠ è½½é€»è¾‘æ˜¯å°†æ–‡ä»¶ä¸­å®šä¹‰çš„å†…å®¹ è½¬æ¢ä¸º å„ä¸ªå±‚çº§ç»´æŠ¤çš„å‘½åç©ºé—´ä¸­çš„æ˜ å°„å…³ç³»ã€‚è¿›è¡Œè°ƒç”¨æ—¶ é€šè¿‡æŸ¥è¯¢å‘½åç©ºé—´ï¼Œæ‰¾åˆ°å¯¹åº”çš„å¾…æ‰§è¡Œå†…å®¹(ç±»ï¼Œæ–¹æ³•ï¼Œå˜é‡)ï¼Œæ‰§è¡Œã€‚</p><h2 id="ç»„ä»¶å’Œç±»çš„åŠ è½½"><a href="#ç»„ä»¶å’Œç±»çš„åŠ è½½" class="headerlink" title="ç»„ä»¶å’Œç±»çš„åŠ è½½:"></a>ç»„ä»¶å’Œç±»çš„åŠ è½½:</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>:<br>    x = <span class="hljs-number">10</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, val</span>):<br>        <span class="hljs-variable language_">self</span>.val = val<br></code></pre></td></tr></table></figure><p>ç­‰ä»·äº ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">namespace = &#123;&#125;<br><span class="hljs-built_in">exec</span>(code_object_for_class_A, <span class="hljs-built_in">globals</span>(), namespace)<br>A = <span class="hljs-built_in">type</span>(<span class="hljs-string">&quot;A&quot;</span>, (<span class="hljs-built_in">object</span>,), namespace)<br></code></pre></td></tr></table></figure><p>ç»„ä»¶å’Œç±»çš„åŠ è½½è¿‡ç¨‹ï¼š</p><p>å®šä¹‰ä¸€ä¸ªäº†å‘½åç©ºé—´ï¼ˆå†…å­˜ç”³è¯·ï¼‰</p><p>ä½¿ç”¨code_object åŠ è½½ç±»Aä¸­çš„å…ƒç´ å®šä¹‰åˆ°å‘½åç©ºé—´</p><p>å†åœ¨å¤–å±‚å°†ç±»ä¸è¯¥å‘½åç©ºé—´ç»‘å®šï¼ˆå®é™…ä¸Šä¹Ÿå°†Aæ·»åŠ åˆ°å¤–éƒ¨çš„å‘½åç©ºé—´ï¼‰</p><p>cpython ä½¿ç”¨code_objectè¿™ä¸ªå¯¹è±¡å®ç°äº†å‘ç±»ä¸­æ·»åŠ å…¶æ‰€å±å…ƒç´ çš„åŠ è½½è¿‡ç¨‹</p><h2 id="å‡½æ•°-æ–¹æ³•"><a href="#å‡½æ•°-æ–¹æ³•" class="headerlink" title="å‡½æ•°&#x2F;æ–¹æ³•"></a>å‡½æ•°&#x2F;æ–¹æ³•</h2><p>æ–¹æ³•ä¸­åŒæ ·ä¼šåˆ›å»ºä¸€ä¸ªcode object å¯¹è±¡ï¼Œä½†æ˜¯ä¸ä¼šå°†å˜é‡-å¼•ç”¨è½¬æ¢æˆk-væ¨¡å¼åŠ å…¥åˆ°å‡½æ•°çš„å‘½åç©ºé—´ï¼Œè€Œæ˜¯ä½œä¸ºå­—èŠ‚ç å­˜å‚¨åœ¨å‘½åç©ºé—´ä¸­ï¼Œå½“æ–¹æ³•è¢«æ‰§è¡Œæ—¶ï¼Œå‡½æ•°ä¼šè°ƒç”¨å­—èŠ‚ç æ–‡ä»¶æ‰§è¡Œï¼Œåˆ›å»ºä¸€ç³»åˆ—çš„å‚æ•°å…ƒç»„ï¼Œç„¶åé€šè¿‡ç´¢å¼•â†’keyâ†’value çš„è°ƒç”¨æ–¹å¼æŸ¥è¯¢å¾…å¤„ç†çš„å¯¹è±¡</p><h2 id="å®ä¾‹çš„åˆ›å»º"><a href="#å®ä¾‹çš„åˆ›å»º" class="headerlink" title="å®ä¾‹çš„åˆ›å»º"></a>å®ä¾‹çš„åˆ›å»º</h2><p>åœ¨pythonä¸­åˆ›å»ºä¸€ä¸ªå®ä¾‹ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">person</span> :<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name</span>):<br><span class="hljs-variable language_">self</span>.name = name <br><br>nobody = person(<span class="hljs-string">&quot;nobody&quot;</span>)<br><span class="hljs-comment"># 1. éšå¼è°ƒç”¨äº†__new__ æ–¹æ³• person.__new__(person,name), </span><br><span class="hljs-comment"># æŸ¥è¯¢ç±»å‘½åç©ºé—´ä¸­çš„__new__new æ–¹æ³•å¹¶æ‰§è¡Œ,æ¥æ”¶å‚æ•°ä¼ å…¥ï¼Œæ˜¯å› ä¸ºåœ¨å®ä¾‹æ„é€ æœŸé—´ï¼Œä¼ å…¥çš„å‚æ•°å¹¶ä¸ä¸€å®šåªæ˜¯è¿›è¡Œå­—æ®µçš„åˆå§‹åŒ–ï¼Œ</span><br><span class="hljs-comment"># ä¹Ÿå¯èƒ½å‚ä¸å®ä¾‹çš„æ„é€ è¿‡ç¨‹</span><br><span class="hljs-comment"># 2. è°ƒç”¨__init__ æ–¹æ³•ï¼Œ person.__init__(self,name),</span><br><span class="hljs-comment"># æŸ¥è¯¢å®šä¹‰çš„__init__æ–¹æ³•ï¼Œæ¥æ”¶ä¼ å…¥å‚æ•°å¹¶å¯¹å¯¹è±¡ä¸­çš„å­—æ®µè¿›è¡Œåˆå§‹åŒ–ã€‚</span><br></code></pre></td></tr></table></figure><h2 id="å‡½æ•°çš„æ‰§è¡Œ"><a href="#å‡½æ•°çš„æ‰§è¡Œ" class="headerlink" title="å‡½æ•°çš„æ‰§è¡Œ"></a>å‡½æ•°çš„æ‰§è¡Œ</h2><p>åœ¨pythonä¸­è°ƒç”¨ä¸€ä¸ªæ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">say_hello</span>(<span class="hljs-params">name</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">locals</span>())<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hello &quot;</span>, name)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">locals</span>())<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;variable in func say_hello &quot;</span>+say_hello.__code__.co_varnames[<span class="hljs-number">0</span>])<br>    say_hello(<span class="hljs-string">&quot;codfish&quot;</span>)<br><br><span class="hljs-comment"># è¾“å‡º</span><br><span class="hljs-comment">#&#123;&#x27;__name__&#x27;: &#x27;__main__&#x27;, &#x27;__doc__&#x27;: None, &#x27;__package__&#x27;: None, &#x27;__loader__&#x27;: &lt;_frozen_importlib_external.SourceFileLoader object at 0x0000016CCC307850&gt;, &#x27;__spec__&#x27;: None, &#x27;__annotations__&#x27;: &#123;&#125;, &#x27;__builtins__&#x27;: &lt;module &#x27;builtins&#x27; (built-in)&gt;, &#x27;__file__&#x27;: &#x27;d:\\Software\\age.py&#x27;, &#x27;__cached__&#x27;: None, &#x27;say_hello&#x27;: &lt;function say_hello at 0x0000016CCC2DFB00&gt;&#125;</span><br><span class="hljs-comment"># å¯¹åº” å¤–éƒ¨çš„locals()</span><br><span class="hljs-comment"># variable in func say_hello name</span><br><span class="hljs-comment"># å¯¹åº” print(&quot;variable in func say_hello &quot;+say_hello.__code__.co_varnames[0]) æ‰“å°say_hello</span><br><span class="hljs-comment"># å‡½æ•°ä¸­çš„å¸¸é‡æ± ä¿¡æ¯0</span><br><span class="hljs-comment">#&#123;&#x27;name&#x27;: &#x27;codfish&#x27;&#125;</span><br><span class="hljs-comment"># å‡½æ•°å†…éƒ¨çš„locals()</span><br><span class="hljs-comment"># hello  codfish</span><br><span class="hljs-comment"># å‡½æ•°çš„æœ€ç»ˆæ‰“å°</span><br><span class="hljs-comment"># å› ä¸ºpython å‡½æ•°ä¸­çš„å¯¹è±¡è¡¨æ˜¯ä¼šå¤šæ¬¡åˆ›å»ºçš„ï¼Œæ‰€ä»¥å‡½æ•°ä¸­ä¿ç•™çš„æ˜¯code_object å­—èŠ‚ç ï¼Œæ¯æ¬¡éƒ½</span><br><span class="hljs-comment"># ä¼šæ‰§è¡Œåˆ›å»ºå¯¹è±¡è¡¨çš„è¿‡ç¨‹ã€‚</span><br><span class="hljs-comment"># 1. æ‰“å°æœ¬åœ°çš„å‘½åç©ºé—´</span><br><span class="hljs-comment"># 2. æŸ¥è¯¢å‡½æ•°ä¸­çš„å‚æ•°ä¿¡æ¯-&gt;name</span><br><span class="hljs-comment"># 3. æ‰§è¡Œsay_helloï¼Œå¯ä»¥ä»å‘½åç©ºé—´ä¸­æŸ¥è¯¢åˆ°say_helloå¹¶æ‰§è¡Œ</span><br><span class="hljs-comment"># 4. æ‰“å°å†…éƒ¨çš„å‘½åç©ºé—´ï¼Œå¯ä»¥çœ‹åˆ°nameä¸codfish è¿›è¡Œäº†ç»‘å®š</span><br><span class="hljs-comment"># 5. æ‰§è¡Œprintæ‰“å°nameï¼Œå†…éƒ¨æ˜¯ç”¨ç´¢å¼•å»æŸ¥è¯¢nameå¯¹åº”çš„å®å‚ï¼Œä½†ä»ç„¶ç»´æŠ¤äº†ä¸€ä¸ªå‘½åç©ºé—´</span><br></code></pre></td></tr></table></figure><h2 id="æ–¹æ³•çš„æ‰§è¡Œ"><a href="#æ–¹æ³•çš„æ‰§è¡Œ" class="headerlink" title="æ–¹æ³•çš„æ‰§è¡Œ"></a>æ–¹æ³•çš„æ‰§è¡Œ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">someone</span> :<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">locals</span>())<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name</span>):<br>        <span class="hljs-variable language_">self</span>.name=name<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">locals</span>())<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">say_hello</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-variable language_">self</span>.__dict__)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">locals</span>())<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hello &quot;</span>, <span class="hljs-variable language_">self</span>.name)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">locals</span>())            <br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">locals</span>())<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;variable in func say_hello &quot;</span>+someone.say_hello.__code__.co_varnames[<span class="hljs-number">0</span>])<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;someone&#x27;s namespace:&quot;</span>,someone.__dict__)<br>    someone(<span class="hljs-string">&#x27;codfish&#x27;</span>).say_hello()<br> <span class="hljs-comment"># è¾“å‡º</span><br> <span class="hljs-comment"># &#123;&#x27;__module__&#x27;: &#x27;__main__&#x27;, &#x27;__qualname__&#x27;: &#x27;someone&#x27;, &#x27;__firstlineno__&#x27;: 1&#125;</span><br> <span class="hljs-comment"># Python çš„ç±»å®šä¹‰å’Œå‡½æ•°å®šä¹‰éƒ½æ˜¯â€œæ‰§è¡Œè¿‡ç¨‹â€ï¼Œä¸æ˜¯å£°æ˜è¯­æ³•ã€‚</span><br> <span class="hljs-comment"># å½“è§£é‡Šå™¨é‡åˆ° class MyClass:ï¼Œå®ƒå°±ç«‹å³æ‰§è¡Œæ•´ä¸ªç±»ä½“ä¸­çš„ä»£ç ï¼Œä»ä¸Šåˆ°ä¸‹é¡ºåºæ‰§è¡Œã€‚</span><br> <span class="hljs-comment"># def ä»£è¡¨æ‰§è¡ŒåŠ è½½è¿™ä¸ªå‡½æ•°å®šä¹‰åˆ°å‘½åç©ºé—´ä¸­</span><br> <span class="hljs-comment"># &#123;&#x27;__module__&#x27;: &#x27;__main__&#x27;, &#x27;__qualname__&#x27;: &#x27;someone&#x27;, &#x27;__firstlineno__&#x27;: 1, &#x27;__init__&#x27;: &lt;function someone.__init__ at 0x000001C90E681440&gt;, &#x27;say_hello&#x27;: &lt;function someone.say_hello at 0x000001C90E6E4720&gt;&#125;</span><br> <span class="hljs-comment"># æ‰§è¡Œè¿‡ç¨‹ åªä¼šæ‰§è¡Œç±»å£°æ˜æ¬¡ä¸€çº§çš„ä»£ç ï¼Œå‡½æ•°å®šä¹‰çš„ä»£ç å—ä¼šä½œä¸ºå­—èŠ‚ç è¢«å­˜å‚¨åˆ°__code__ä¸­</span><br> <span class="hljs-comment"># &#123;&#x27;__name__&#x27;: &#x27;__main__&#x27;, &#x27;__doc__&#x27;: None, &#x27;__package__&#x27;: None, &#x27;__loader__&#x27;: &lt;_frozen_importlib_external.SourceFileLoader object at 0x000001C90E6F7850&gt;, &#x27;__spec__&#x27;: None, &#x27;__annotations__&#x27;: &#123;&#125;, &#x27;__builtins__&#x27;: &lt;module &#x27;builtins&#x27; (built-in)&gt;, &#x27;__file__&#x27;: &#x27;d:\\Software\\age.py&#x27;, &#x27;__cached__&#x27;: None, &#x27;someone&#x27;: &lt;class &#x27;__main__.someone&#x27;&gt;&#125;</span><br> <span class="hljs-comment"># å…¨å±€å‘½åç©ºé—´</span><br> <span class="hljs-comment"># variable in func say_hello self</span><br> <span class="hljs-comment"># æŸ¥è¯¢åˆ°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¯¹äºæ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºself.</span><br> <span class="hljs-comment"># someone&#x27;s namespace: &#123;&#x27;__module__&#x27;: &#x27;__main__&#x27;, &#x27;__firstlineno__&#x27;: 1, &#x27;__init__&#x27;: &lt;function someone.__init__ at 0x000001C90E681440&gt;, &#x27;say_hello&#x27;: &lt;function someone.say_hello at 0x000001C90E6E4720&gt;, &#x27;__static_attributes__&#x27;: (&#x27;name&#x27;,), &#x27;__dict__&#x27;: &lt;attribute &#x27;__dict__&#x27; of &#x27;someone&#x27; objects&gt;, &#x27;__weakref__&#x27;: &lt;attribute &#x27;__weakref__&#x27; of &#x27;someone&#x27; objects&gt;, &#x27;__doc__&#x27;: None&#125;</span><br> <span class="hljs-comment"># è£…è½½åçš„ç±»å‘½åç©ºé—´</span><br> <span class="hljs-comment"># &#123;&#x27;self&#x27;: &lt;__main__.someone object at 0x000001C90E5E70E0&gt;, &#x27;name&#x27;: &#x27;codfish&#x27;&#125;</span><br> <span class="hljs-comment"># åˆå§‹åŒ–æ–¹æ³•__init__çš„å‘½åç©ºé—´</span><br> <span class="hljs-comment"># &#123;&#x27;name&#x27;: &#x27;codfish&#x27;&#125;</span><br> <span class="hljs-comment"># å®ä¾‹çš„å‘½åç©ºé—´</span><br> <span class="hljs-comment"># &#123;&#x27;self&#x27;: &lt;__main__.someone object at 0x000001C90E5E70E0&gt;&#125;</span><br> <span class="hljs-comment"># ç”±å‡½æ•°ç»´æŠ¤çš„å‘½åç©ºé—´</span><br> <span class="hljs-comment"># hello  codfish</span><br> <span class="hljs-comment"># æœ€ç»ˆæ‰“å°</span><br></code></pre></td></tr></table></figure><h2 id="å‘½åç©ºé—´çš„æŸ¥è¯¢"><a href="#å‘½åç©ºé—´çš„æŸ¥è¯¢" class="headerlink" title="å‘½åç©ºé—´çš„æŸ¥è¯¢"></a>å‘½åç©ºé—´çš„æŸ¥è¯¢</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">locals</span>() <span class="hljs-comment"># å½“å‰ä½œç”¨åŸŸï¼ˆåŠ¨æ€ï¼‰å½“å‰æ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡å­—å…¸æŸ¥çœ‹å½“å‰å‡½æ•°ã€ç±»ä½“ã€æ¨¡å—çš„å±€éƒ¨å˜é‡</span><br><span class="hljs-built_in">globals</span>() <span class="hljs-comment"># å½“å‰æ¨¡å—çº§ä½œç”¨åŸŸå½“å‰æ¨¡å—çš„å…¨å±€å˜é‡å­—å…¸æŸ¥çœ‹æ¨¡å—çš„å…¨å±€å˜é‡ã€å‡½æ•°ã€ç±»ç­‰</span><br>__dict__ <span class="hljs-comment"># å¯¹è±¡è‡ªèº«çš„å±æ€§å­—å…¸æ˜¾å¼å®šä¹‰çš„å˜é‡ï¼ˆä¸å«ç»§æ‰¿/å†…å»ºå±æ€§ï¼‰æŸ¥çœ‹å¯¹è±¡è‡ªå·±çš„å±æ€§</span><br><span class="hljs-built_in">dir</span>()     <span class="hljs-comment"># å¯¹è±¡+ç»§æ‰¿é“¾æ‰€æœ‰å¯è®¿é—®å±æ€§åçš„åˆ—è¡¨ï¼ˆå­—ç¬¦ä¸²ï¼‰è¡¥å…¨ã€IDE è‡ªåŠ¨æç¤ºã€è°ƒè¯•</span><br></code></pre></td></tr></table></figure><h2 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h2><p>pythonæ˜¯é€šè¿‡å‘½åç©ºé—´æ¥ç®¡ç†æ¯ä¸ªå¯¹è±¡çš„è®¿é—®æƒé™çš„ã€‚</p><p>æ‰€ä»¥è°ƒç”¨éƒ½éµå¾ªç€ å½“è°ƒç”¨å‡½æ•°ï¼Œç±»æ—¶ï¼ŒæŸ¥è¯¢å½“å‰å±‚çš„å‘½åç©ºé—´ï¼Œæ£€ç´¢å¯¹åº”çš„å‡½æ•°åï¼Œç±»åä¿¡æ¯ã€‚æ‰¾åˆ°å¯¹åº”çš„å‡½æ•°ï¼Œç±»çš„ä½ç½®ï¼Œè¿›è¡Œæ‰§è¡Œã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çœ‹çœ‹pythonæ˜¯å¦‚ä½•å®ç°å¤šæ€çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">anmial</span> :<br><span class="hljs-comment"># åˆ›å»ºåŸºç±»ï¼Œå®šä¹‰eatæ–¹æ³•</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name</span>):<br>        <span class="hljs-variable language_">self</span>.name = name <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">eat</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-variable language_">self</span>.name + <span class="hljs-string">&quot; eat nothing, still hungry&quot;</span>)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">duck</span>(<span class="hljs-title class_ inherited__">anmial</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name=<span class="hljs-string">&quot;duck&quot;</span></span>):<br>        <span class="hljs-variable language_">self</span>.name = name<br><span class="hljs-comment">#        super().__init__(name)</span><br><span class="hljs-comment"># å®šä¹‰å­ç±»ç»§æ‰¿åŸºç±»ï¼Œä¼ é€’name å­ç±»çš„self.name å’Œ ä½¿ç”¨super().__init__(name)å¯¹çˆ¶ç±»çš„self</span><br><span class="hljs-comment"># è¿›è¡Œåˆå§‹åŒ–æ•ˆæœç›¸åŒï¼Œè¯´æ˜selfä»ç„¶æ˜¯åŒä¸€ä¸ªå®ä¾‹ï¼ˆå†…å­˜å¯¹è±¡ï¼‰ã€‚</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">cat</span>(<span class="hljs-title class_ inherited__">anmial</span>) :<br><span class="hljs-comment"># å®šä¹‰å­ç±»çŒ«ï¼Œé‡å†™eatæ–¹æ³•</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name=<span class="hljs-string">&quot;cat&quot;</span></span>):<br>        <span class="hljs-variable language_">self</span>.name = name <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">eat</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-variable language_">self</span>.name + <span class="hljs-string">&quot; eat some fish&quot;</span>)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">dog</span>(<span class="hljs-title class_ inherited__">anmial</span>):<br><span class="hljs-comment"># å®šä¹‰å­ç±»ç‹—ï¼Œé‡æ–°eatæ–¹æ³•</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name=<span class="hljs-string">&quot;dog&quot;</span></span>):<br>        <span class="hljs-variable language_">self</span>.name = name <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">eat</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-variable language_">self</span>.name + <span class="hljs-string">&quot; eat some bones&quot;</span>)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ghost</span> :<br><span class="hljs-comment"># å®šä¹‰æ™®é€šç±»é¬¼ï¼Œå…·æœ‰ç›¸åŒçš„æ–¹æ³•</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name=<span class="hljs-string">&quot;ghost&quot;</span></span>) :<br>        <span class="hljs-variable language_">self</span>.name = name<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">eat</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-variable language_">self</span>.name+ <span class="hljs-string">&quot; eat some blood&quot;</span>)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">person</span> :<br><span class="hljs-comment"># å®šä¹‰æ™®é€šç±»äººï¼Œä¸å…·å¤‡eatæ–¹æ³•</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,name=<span class="hljs-string">&quot;person&quot;</span></span>) :<br>        <span class="hljs-variable language_">self</span>.name = name<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">want_eat</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-variable language_">self</span>.name+ <span class="hljs-string">&quot; eat some noodls&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">toldAnmialToEat</span>(<span class="hljs-params">anmial</span>):<br><span class="hljs-comment"># å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°æ¥æ”¶ä¼ å…¥çš„åŸºç±»ï¼Œè°ƒç”¨eatæ–¹æ³•</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">locals</span>())<br>    anmial.eat()<br><br>toldAnmialToEat(duck())<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">dir</span>(duck))<br>toldAnmialToEat(cat())<br>toldAnmialToEat(dog())<br>toldAnmialToEat(ghost())<br>toldAnmialToEat(person())<br><span class="hljs-comment"># æ‰§è¡Œ</span><br><span class="hljs-comment"># &#123;&#x27;anmial&#x27;: &lt;__main__.duck object at 0x000002A92EFA6F90&gt;&#125;</span><br><span class="hljs-comment"># duck eat nothing, still hungry</span><br><span class="hljs-comment"># duck æœªå®ç°è‡ªå·±çš„æ–¹æ³•æ‰€ä»¥ä½¿ç”¨äº†çˆ¶ç±»çš„æ–¹æ³•</span><br><span class="hljs-comment"># [&#x27;__class__&#x27;, &#x27;__delattr__&#x27;, &#x27;__dict__&#x27;, &#x27;__dir__&#x27;, &#x27;__doc__&#x27;, &#x27;__eq__&#x27;, &#x27;__firstlineno__&#x27;, &#x27;__format__&#x27;, &#x27;__ge__&#x27;, &#x27;__getattribute__&#x27;, &#x27;__getstate__&#x27;, &#x27;__gt__&#x27;, &#x27;__hash__&#x27;, &#x27;__init__&#x27;, &#x27;__init_subclass__&#x27;, &#x27;__le__&#x27;, &#x27;__lt__&#x27;, &#x27;__module__&#x27;, &#x27;__ne__&#x27;, &#x27;__new__&#x27;, &#x27;__reduce__&#x27;, &#x27;__reduce_ex__&#x27;, &#x27;__repr__&#x27;, &#x27;__setattr__&#x27;, &#x27;__sizeof__&#x27;, &#x27;__static_attributes__&#x27;, &#x27;__str__&#x27;, &#x27;__subclasshook__&#x27;, &#x27;__weakref__&#x27;, &#x27;eat&#x27;]</span><br><span class="hljs-comment"># duck ç”±çˆ¶ç±»ç»§æ‰¿äº†eat æ–¹æ³•</span><br><span class="hljs-comment"># &#123;&#x27;anmial&#x27;: &lt;__main__.cat object at 0x000002A92EFA6F90&gt;&#125;</span><br><span class="hljs-comment"># cat eat some fish</span><br><span class="hljs-comment"># è°ƒç”¨äº†catçš„æ–¹æ³•</span><br><span class="hljs-comment"># &#123;&#x27;anmial&#x27;: &lt;__main__.dog object at 0x000002A92EFA6F90&gt;&#125;</span><br><span class="hljs-comment"># dog eat some bones</span><br><span class="hljs-comment"># è°ƒç”¨äº†dogçš„æ–¹æ³•</span><br><span class="hljs-comment"># &#123;&#x27;anmial&#x27;: &lt;__main__.ghost object at 0x000002A92EFA6F90&gt;&#125;</span><br><span class="hljs-comment"># ghost eat some blood</span><br><span class="hljs-comment"># è°ƒç”¨äº†ghostçš„æ–¹æ³•</span><br><span class="hljs-comment"># &#123;&#x27;anmial&#x27;: &lt;__main__.person object at 0x000002A92EFA6F90&gt;&#125;</span><br><span class="hljs-comment"># Traceback (most recent call last):</span><br><span class="hljs-comment"># person ä¸å…·å¤‡æ­¤æ–¹æ³•ï¼ŒæŠ¥é”™</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡º </p><p>1.å­ç±»ä¼šä»çˆ¶ç±»é‚£é‡Œç»§æ‰¿å®ƒæ²¡æœ‰é‡æ–°çš„æ–¹æ³•ã€‚</p><p>2.å½“å­ç±»é‡å†™äº†æ–¹æ³•åï¼Œä¼šæ‰§è¡Œå­ç±»çš„æ–¹æ³•</p><ol start="3"><li><p>éå­ç±»ä½†å…·æœ‰ç›¸åŒæ–¹æ³•çš„ç±»ä¹Ÿå¯ä»¥æ­£ç¡®æ‰§è¡Œï¼Œè¯´æ˜å‡½æ•°çš„å®šä¹‰åªæ˜¯å£°æ˜å¼çº¦æŸï¼Œä¸ä¼šè¿›è¡Œç±»çš„æ£€æŸ¥</p></li><li><p>å½“ä¼ å…¥çš„ç±»ä¸å…·å¤‡æ–¹æ³•æ—¶ï¼Œä¼šæŠ¥é”™ã€‚ç”±3ï¼Œ4è¯´æ˜è¿˜æ˜¯æ ¹æ®å‘½åç©ºé—´ä¸­çš„åŠŸèƒ½åˆ—è¡¨æ¥è¿›è¡Œçš„å‡½æ•°æ‰§è¡Œ</p></li></ol><h1 id="å˜é‡ï¼Œå¼•ç”¨ï¼Œç±»å‹å’Œå¯¹è±¡"><a href="#å˜é‡ï¼Œå¼•ç”¨ï¼Œç±»å‹å’Œå¯¹è±¡" class="headerlink" title="å˜é‡ï¼Œå¼•ç”¨ï¼Œç±»å‹å’Œå¯¹è±¡"></a>å˜é‡ï¼Œå¼•ç”¨ï¼Œç±»å‹å’Œå¯¹è±¡</h1><p>é€šè¿‡åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°Pythonä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ç”±å‘½åç©ºé—´æ¥ç»„ç»‡å’Œç»´æŠ¤çš„ã€‚</p><p><strong>å˜é‡</strong> ï¼š pythonä¸­çš„å˜é‡ååœ¨å­—èŠ‚ç ä¸­æ˜¯ä»¥åç§°ç´¢å¼•çš„å½¢å¼å‡ºç°ï¼Œå¹¶å­˜äºåç§°è¡¨ä¸­ã€‚</p><p><strong>å¼•ç”¨</strong> ï¼š å¼•ç”¨åœ¨pythonä¸­è¡¨ç°ä¸ºä¸€ç§â€œé—´æ¥â€çš„å¼•ç”¨ï¼Œå®ƒä¸æ˜¯é€šè¿‡æ ‡è¯†ç¬¦â†’å®é™…å¯¹è±¡çš„åœ°å€æŒ‡é’ˆâ†’è·å–å®é™…çš„å¯¹è±¡ã€‚è€Œæ˜¯é€šè¿‡åˆ›å»ºäº†æ ‡è¯†ç¬¦å¯¹è±¡â†’æ ‡è¯†ç¬¦åŠ å…¥nameè¡¨â†’å®é™…å¯¹è±¡åŠ å…¥å¸¸é‡è¡¨â†’é€šè¿‡å‘½åç©ºé—´å®Œæˆæ˜ å°„ç»‘å®šã€‚å†é€šè¿‡å‘½åç©ºé—´ä¸­çš„k-vå…³ç³»æŸ¥è¯¢åˆ°å®é™…è¢«è°ƒç”¨çš„å¯¹è±¡ã€‚</p><p><strong>ç±»å‹</strong> ï¼š Pythonæ˜¯å¼±ç±»å‹è¯­è¨€çš„æ­£æ˜¯åŸºäºè¿™ç§å¼•ç”¨çš„å®ç°æ¥æ„å»ºçš„ã€‚è™½ç„¶åœ¨åº•å±‚Pythonçš„å¯¹è±¡ä¾ç„¶æ˜¯å­˜åœ¨ç±»å‹çš„ï¼Œä½†é”®ä¸å€¼ä¹‹é—´çš„å…³ç³»æ˜¯åŸºäºæ˜ å°„å…³ç³»ï¼Œè€Œä¸æ˜¯æŒ‡é’ˆã€‚ç”±äºé”®å€¼æ˜ å°„çš„åŠ¨æ€æ€§ï¼Œç±»å‹æ£€æŸ¥åœ¨è¿è¡Œæ—¶è¿›è¡Œï¼Œåç§°æœ¬èº«ä¸æºå¸¦ç±»å‹ä¿¡æ¯</p><p><strong>å¯¹è±¡</strong> ï¼šåŒæ ·æ˜¯å› ä¸ºè¿™ç§å¼•ç”¨çš„æ„å»ºï¼ŒPythonä¸­çš„ä¸€åˆ‡çš†å¯¹è±¡å®æ–½çš„æ›´åŠ å½»åº•â€”â€”- å˜é‡åä¹Ÿæ˜¯ä½œä¸ºå¯¹è±¡å­˜å‚¨çš„ã€‚è¿™æ ·çš„è®¾è®¡è®©æˆ‘ä»¬ä¸å¿…æ·±å…¥åº•å±‚æ‰èƒ½è·å–åˆ°ç±»ï¼Œå‡½æ•°çš„åˆ›å»ºä¿¡æ¯ï¼Œåªéœ€è¦æ‰¾åˆ°å…¶ä¸­çš„æ˜ å°„å…³ç³»ï¼Œå°±èƒ½å¯¹ç±»æˆ–è€…å‡½æ•°ä¸­çš„å±æ€§è¿›è¡Œæ“ä½œä¿®æ”¹ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaçš„åŠ è½½è¿‡ç¨‹ä¸å†…å­˜æ¨¡å‹</title>
    <link href="/2025/04/12/Java%E7%9A%84%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/"/>
    <url>/2025/04/12/Java%E7%9A%84%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="Javaçš„åŠ è½½è¿‡ç¨‹ä¸å†…å­˜æ¨¡å‹"><a href="#Javaçš„åŠ è½½è¿‡ç¨‹ä¸å†…å­˜æ¨¡å‹" class="headerlink" title="Javaçš„åŠ è½½è¿‡ç¨‹ä¸å†…å­˜æ¨¡å‹"></a>Javaçš„åŠ è½½è¿‡ç¨‹ä¸å†…å­˜æ¨¡å‹</h1><h1 id="JavaåŠ è½½ç»„ä»¶"><a href="#JavaåŠ è½½ç»„ä»¶" class="headerlink" title="JavaåŠ è½½ç»„ä»¶"></a>JavaåŠ è½½ç»„ä»¶</h1><p><img src="https://i.111666.best/image/ZCNHcuLH23gTkkNwTwgjfA.png" alt="image"></p><h2 id="ç¼–è¯‘æ—¶"><a href="#ç¼–è¯‘æ—¶" class="headerlink" title="ç¼–è¯‘æ—¶"></a>ç¼–è¯‘æ—¶</h2><p>è¿›è¡Œjavaæ–‡ä»¶çš„ç¼–è¯‘ï¼Œæœ€ç»ˆè½¬æ¢ä¸ºå­—èŠ‚ç æ–‡ä»¶</p><h2 id="ç±»åŠ è½½æ—¶"><a href="#ç±»åŠ è½½æ—¶" class="headerlink" title="ç±»åŠ è½½æ—¶"></a>ç±»åŠ è½½æ—¶</h2><ul><li>ç±»åŠ è½½å™¨(ClassLoader)ï¼šè´Ÿè´£åŠ è½½ç±»æ–‡ä»¶</li><li>åŠ è½½(Loading)ï¼šè¯»å–ç±»æ–‡ä»¶å¹¶åˆ›å»ºäºŒè¿›åˆ¶è¡¨ç¤º</li><li>è¿æ¥(Linking)ï¼šåˆ†ä¸ºä¸‰ä¸ªå­æ­¥éª¤<ul><li>éªŒè¯ï¼šç¡®ä¿ç±»æ–‡ä»¶ç»“æ„æ­£ç¡®</li><li>å‡†å¤‡ï¼šä¸ºé™æ€å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®åˆå§‹å€¼</li><li>è§£æï¼šå°†ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨</li></ul></li><li>åˆå§‹åŒ–(Initialization)ï¼šæ‰§è¡Œç±»çš„é™æ€åˆå§‹åŒ–ä»£ç </li><li>ä½¿ç”¨(Using)ï¼šç¨‹åºä¸­ä½¿ç”¨ç±»</li><li>å¸è½½(Unload)ï¼šç±»è¢«JVMå¸è½½</li></ul><h2 id="è¿è¡Œæ—¶"><a href="#è¿è¡Œæ—¶" class="headerlink" title="è¿è¡Œæ—¶"></a>è¿è¡Œæ—¶</h2><ul><li>JVMè¿è¡Œæ—¶å†…å­˜åŒºï¼š<ul><li>å…ƒç©ºé—´(Metaspace)ï¼šå­˜å‚¨ç±»ä¿¡æ¯ã€å¸¸é‡å’Œé™æ€å˜é‡</li><li>å †(Heap)ï¼šå­˜å‚¨å¯¹è±¡å®ä¾‹å’Œæ•°ç»„</li><li>è™šæ‹Ÿæœºæ ˆ(JVM Stack)ï¼šåŒ…å«æ–¹æ³•è°ƒç”¨çš„æ ˆå¸§å’Œå±€éƒ¨å˜é‡è¡¨</li><li>ç¨‹åºè®¡æ•°å™¨(PC Register)ï¼šè®°å½•å½“å‰æ‰§è¡Œçš„æŒ‡ä»¤åœ°å€</li></ul></li><li>æ‰§è¡Œå¼•æ“(Execution Engine)ï¼š<ul><li>è§£é‡Šå™¨(Interpreter)ï¼šé€æ¡è§£é‡Šæ‰§è¡Œå­—èŠ‚ç </li><li>JITç¼–è¯‘å™¨ï¼šå°†çƒ­ç‚¹ä»£ç ç¼–è¯‘ä¸ºæœ¬åœ°æœºå™¨ç ï¼Œæé«˜æ‰§è¡Œæ•ˆç‡</li><li>åƒåœ¾å›æ”¶å™¨(GC)ï¼šè‡ªåŠ¨ç®¡ç†å†…å­˜ï¼Œå›æ”¶ä¸å†ä½¿ç”¨çš„å¯¹è±¡</li><li>æœ¬åœ°æ–¹æ³•æ¥å£(JNI)ï¼šè°ƒç”¨æœ¬åœ°æ–¹æ³•</li><li>æœ¬åœ°æ–¹æ³•åº“ï¼šC&#x2F;C++å®ç°çš„æ–¹æ³•å’Œæ“ä½œç³»ç»ŸAPI</li></ul></li><li>æ‰§è¡Œè¿‡ç¨‹ï¼š<ul><li>åŠ è½½ç±»çš„å­—èŠ‚ç </li><li>è§£æå­—èŠ‚ç </li><li>æ ¹æ®ä»£ç çƒ­åº¦å†³å®šä½¿ç”¨è§£é‡Šæ‰§è¡Œæˆ–JITç¼–è¯‘</li><li>æ‰§è¡Œç”Ÿæˆçš„æœºå™¨ç </li><li>å¿…è¦æ—¶è°ƒç”¨ç³»ç»ŸAPI</li><li>è‡ªåŠ¨è¿›è¡Œå†…å­˜ç®¡ç†å’Œåƒåœ¾å›æ”¶</li></ul></li></ul><h1 id="Javaä»£ç å—çš„å­˜å‚¨ä½ç½®å’ŒåŠ è½½æµç¨‹"><a href="#Javaä»£ç å—çš„å­˜å‚¨ä½ç½®å’ŒåŠ è½½æµç¨‹" class="headerlink" title="Javaä»£ç å—çš„å­˜å‚¨ä½ç½®å’ŒåŠ è½½æµç¨‹"></a>Javaä»£ç å—çš„å­˜å‚¨ä½ç½®å’ŒåŠ è½½æµç¨‹</h1><h2 id="ç±»åŠ è½½æµç¨‹"><a href="#ç±»åŠ è½½æµç¨‹" class="headerlink" title="ç±»åŠ è½½æµç¨‹"></a>ç±»åŠ è½½æµç¨‹</h2><h3 id="ç¼–è¯‘æ—¶-1"><a href="#ç¼–è¯‘æ—¶-1" class="headerlink" title="ç¼–è¯‘æ—¶"></a>ç¼–è¯‘æ—¶</h3><p>å°† Java æºæ–‡ä»¶ç¼–è¯‘ä¸ºå­—èŠ‚ç æ–‡ä»¶ï¼ˆ.classï¼‰ï¼ŒæœŸé—´ç¼–è¯‘å™¨ä¸ºæ¯ä¸ªæ–¹æ³•å»ºç«‹å±€éƒ¨å˜é‡è¡¨ï¼Œ<br>ä½¿ç”¨æ’æ§½ï¼ˆslotï¼‰ç´¢å¼•æ¥ç®¡ç†å˜é‡å¼•ç”¨å’ŒåŸå§‹ç±»å‹çš„å­˜å‚¨ã€‚</p><p>ç¼–è¯‘å™¨æ ¹æ®æ–¹æ³•ç±»å‹ï¼ˆé™æ€&#x2F;æˆå‘˜æ–¹æ³•ï¼‰å’Œå˜é‡æ¥æºï¼ˆthisã€å‚æ•°ã€å±€éƒ¨å˜é‡ï¼‰å†³å®šå˜é‡åœ¨å±€éƒ¨å˜é‡è¡¨ä¸­çš„æ’å¸ƒé¡ºåºã€‚</p><h3 id="ç±»åŠ è½½"><a href="#ç±»åŠ è½½" class="headerlink" title="ç±»åŠ è½½"></a>ç±»åŠ è½½</h3><p>ç±»åŠ è½½å™¨å°† class æ–‡ä»¶åŠ è½½åˆ° JVMï¼Œå¹¶åœ¨å…ƒç©ºé—´ä¸­æ„å»º class å…ƒä¿¡æ¯ï¼ˆå¦‚ instanceKlassï¼‰<br>å°†å­—æ®µã€æ–¹æ³•ã€å¸¸é‡æ± ã€æ¥å£ç­‰ä¿¡æ¯ç»„ç»‡åˆ°å…ƒç©ºé—´ç»“æ„ä¸­ã€‚</p><p>é™æ€æ–¹æ³•ã€final æ–¹æ³•ã€private æ–¹æ³•åœ¨åŠ è½½æ—¶å³å¯ç¡®å®šå…¶è°ƒç”¨ç›®æ ‡ï¼Œæ— éœ€åœ¨è¿è¡Œæ—¶é€šè¿‡è™šæ–¹æ³•è¡¨è¿›è¡Œåˆ†æ´¾ã€‚</p><p>JVM æ„å»ºå­—æ®µå¸ƒå±€ä¿¡æ¯ï¼ˆfield layoutï¼‰ï¼Œæ ¹æ®å­—æ®µæè¿°ç¬¦è®¡ç®—å­—æ®µåœ¨ç±»å’Œå¯¹è±¡ä¸­çš„åç§»åœ°å€ã€‚</p><p>åŒæ—¶å°†ç±»å¸¸é‡æ± ä¸­çš„ç¬¦å·å¼•ç”¨è§£æä¸ºç›´æ¥å¼•ç”¨ï¼ˆç¬¦å·å¼•ç”¨ â†’ å…·ä½“ç±»ã€å­—æ®µæˆ–æ–¹æ³•çš„å†…å­˜åœ°å€ï¼‰ã€‚</p><h3 id="è¿è¡Œæ—¶-1"><a href="#è¿è¡Œæ—¶-1" class="headerlink" title="è¿è¡Œæ—¶"></a>è¿è¡Œæ—¶</h3><p>å½“ç±»é¦–æ¬¡è¢«ä¸»åŠ¨ä½¿ç”¨ï¼ˆå¦‚ new æ“ä½œï¼‰æ—¶ï¼Œå¦‚æœå°šæœªåˆå§‹åŒ–ï¼Œåˆ™è§¦å‘ <code>&lt;clinit&gt;</code> é™æ€åˆå§‹åŒ–æµç¨‹ã€‚</p><p>JVM æ‰§è¡Œé™æ€å˜é‡åˆå§‹åŒ–å’Œé™æ€ä»£ç å—ï¼Œåˆå§‹åŒ–ç±»çš„å…ƒæ•°æ®ã€‚</p><p>å®ä¾‹åŒ–æ—¶ï¼ŒJVM æŸ¥è¯¢è¯¥ç±»å®ä¾‹æ‰€éœ€çš„å†…å­˜å¸ƒå±€ï¼Œå¹¶å‘å †å†…å­˜ç”³è¯·å¯¹åº”å¤§å°ç©ºé—´ã€‚</p><p>JVM åœ¨æ‰§è¡Œæ„é€ å‡½æ•°å‰ï¼Œä¼šå…ˆæ‰§è¡Œæˆå‘˜å˜é‡çš„åˆå§‹åŒ–è¡¨è¾¾å¼å’Œå®ä¾‹åˆå§‹åŒ–å—ã€‚</p><p>è¿™äº›åˆå§‹åŒ–ä»£ç ç”±ç¼–è¯‘å™¨ç¼–è¯‘æ—¶æ’å…¥åˆ° <code>&lt;init&gt;</code> æ„é€ æ–¹æ³•çš„å¼€å¤´ã€‚</p><p>æ„é€ å‡½æ•°æ‰§è¡Œæ—¶ï¼ŒæŒ‰å±€éƒ¨å˜é‡è¡¨åŠ è½½ this å¼•ç”¨å’Œæ–¹æ³•å‚æ•°ï¼Œè¿›å…¥å¯¹è±¡åˆå§‹åŒ–æµç¨‹ã€‚</p><p>JVM  æ ¹æ®å­—æ®µæè¿°ç¬¦æ•°ç»„çš„åç§»é‡ä»¥åŠç»§æ‰¿ç»“æ„ï¼Œä¸ºæ¯ä¸ªæˆå‘˜å˜é‡åˆ†é…åç§»åœ°å€ï¼ŒæŒ‰åç§»å°†æ•°æ®å†™å…¥å †ä¸­å¯¹è±¡å®ä¾‹ã€‚</p><p>æ„é€ å‡½æ•°æ‰§è¡Œå®Œæˆåï¼Œå°†å¯¹è±¡çš„å¼•ç”¨ï¼ˆoop æŒ‡é’ˆï¼‰è¿”å›ç»™è°ƒç”¨è€…ï¼Œé€šå¸¸å‹å…¥æ“ä½œæ•°æ ˆä»¥ä¾›åç»­ä½¿ç”¨ã€‚</p><p>è°ƒç”¨å®ä¾‹æ–¹æ³•æ—¶ï¼ŒJVM é€šè¿‡å¯¹è±¡ä¸­çš„ç±»å…ƒæ•°æ®æŒ‡é’ˆè®¿é—®è™šæ–¹æ³•è¡¨ï¼ˆvtableï¼‰ï¼Œ<br>æŒ‰æ–¹æ³•ç­¾åæ‰¾åˆ°å¯¹åº”æ–¹æ³•çš„åç§»å¹¶æ‰§è¡Œã€‚</p><p>static,final,privateæ–¹æ³• åœ¨å‰æœŸè¿›è¡Œäº†é™æ€ç»‘å®šï¼Œä¸éœ€è¦æŸ¥è¯¢è™šæ–¹æ³•è¡¨ï¼Œé€šè¿‡é™æ€ç»‘å®šï¼ˆç¡®å®šæ–¹æ³•åœ°å€ï¼‰æ‰§è¡Œ</p><h2 id="Javaæˆå‘˜ç»„ä»¶çš„å­˜å‚¨ä½ç½®å’Œæ‰§è¡Œæ—¶é—´ç‚¹"><a href="#Javaæˆå‘˜ç»„ä»¶çš„å­˜å‚¨ä½ç½®å’Œæ‰§è¡Œæ—¶é—´ç‚¹" class="headerlink" title="Javaæˆå‘˜ç»„ä»¶çš„å­˜å‚¨ä½ç½®å’Œæ‰§è¡Œæ—¶é—´ç‚¹"></a>Javaæˆå‘˜ç»„ä»¶çš„å­˜å‚¨ä½ç½®å’Œæ‰§è¡Œæ—¶é—´ç‚¹</h2><table><thead><tr><th>ç±»å‹</th><th>å®šä¹‰æ–¹å¼</th><th>æ‰§è¡Œæ—¶é—´ç‚¹</th><th>å­˜å‚¨ä½ç½®</th><th>æè¿°</th></tr></thead><tbody><tr><td>é™æ€å¸¸é‡</td><td><code>static final</code> ä¿®é¥°å­—æ®µ</td><td>ç¼–è¯‘æœŸå†…è” æˆ– ç±»åŠ è½½æ—¶</td><td>å­—èŠ‚ç ä¸­ä¸ºå¸¸é‡æ± å¼•ç”¨ï¼›å¯èƒ½å†…è”è¿›è°ƒç”¨ç±»</td><td>ç¼–è¯‘å™¨å¸¸å°†å…¶å†…è”ä¼˜åŒ–ï¼Œè‹¥ä¸ºç¼–è¯‘æœŸå¸¸é‡ï¼Œä¸ä¾èµ–ç±»åˆå§‹åŒ–</td></tr><tr><td>é™æ€å˜é‡</td><td><code>static</code> ä¿®é¥°çš„å­—æ®µ</td><td>ç±»åŠ è½½æ—¶ï¼Œåˆå§‹åŒ–é˜¶æ®µ</td><td>å­˜å‚¨åœ¨å…ƒç©ºé—´</td><td>æ‰€æœ‰å¯¹è±¡å…±äº«ï¼›å­˜åœ¨äºå…ƒç©ºé—´ä¸­</td></tr><tr><td>é™æ€åˆå§‹åŒ–å—</td><td><code>static &#123; ... &#125;</code></td><td>ç±»åŠ è½½æ—¶ï¼Œé™æ€å˜é‡ä¹‹å</td><td>å­˜å‚¨åœ¨å…ƒç©ºé—´</td><td>é€šå¸¸ç”¨äºå¤æ‚çš„é™æ€åˆå§‹åŒ–é€»è¾‘</td></tr><tr><td>å®ä¾‹å˜é‡</td><td>æ™®é€šå­—æ®µï¼ˆæ—  <code>static</code>ï¼‰</td><td>å¯¹è±¡åˆ›å»ºæ—¶ï¼Œæ„é€ å™¨ä¹‹å‰</td><td>å­˜å‚¨åœ¨å †ä¸Š</td><td>æ¯ä¸ªå¯¹è±¡ç‹¬ç«‹æ‹¥æœ‰</td></tr><tr><td>åˆå§‹åŒ–å—</td><td><code>&#123; ... &#125;</code> ï¼ˆé staticï¼‰</td><td>å¯¹è±¡åˆ›å»ºæ—¶ï¼Œå®ä¾‹å˜é‡ä¹‹åã€æ„é€ å™¨ä¹‹å‰</td><td>å­˜å‚¨åœ¨å †ä¸Š</td><td>ä¸»è¦ç”¨äºå¤šä¸ªæ„é€ å™¨å…±äº«çš„åˆå§‹åŒ–ä»£ç </td></tr><tr><td>æ„é€ å™¨</td><td><code>ClassName(...) &#123; ... &#125;</code></td><td>å¯¹è±¡åˆ›å»ºæ—¶ï¼Œåˆå§‹åŒ–å—ä¹‹å</td><td>å­˜å‚¨åœ¨å…ƒç©ºé—´</td><td>å®ä¾‹æ„é€ å‡½æ•°ï¼Œç”¨äºå®Œæˆå¯¹è±¡çš„æœ€ç»ˆåˆå§‹åŒ–</td></tr><tr><td>æ–¹æ³•ï¼ˆæˆå‘˜æ–¹æ³•ï¼‰</td><td><code>public void method() &#123; ... &#125;</code></td><td>è¢«è°ƒç”¨æ—¶æ‰§è¡Œ</td><td>å­˜å‚¨åœ¨å…ƒç©ºé—´</td><td>æ™®é€šæˆå‘˜å‡½æ•°</td></tr><tr><td>é™æ€æ–¹æ³•</td><td><code>public static void method() &#123;&#125;</code></td><td>è¢«è°ƒç”¨æ—¶æ‰§è¡Œ</td><td>å­˜å‚¨åœ¨å…ƒç©ºé—´</td><td>ä¸ä¾èµ–å¯¹è±¡å³å¯è°ƒç”¨çš„æ–¹æ³•</td></tr></tbody></table><h1 id="ç±»æ¨¡æ¿åœ¨å†…å­˜ä¸­çš„å¸ƒå±€"><a href="#ç±»æ¨¡æ¿åœ¨å†…å­˜ä¸­çš„å¸ƒå±€" class="headerlink" title="ç±»æ¨¡æ¿åœ¨å†…å­˜ä¸­çš„å¸ƒå±€"></a>ç±»æ¨¡æ¿åœ¨å†…å­˜ä¸­çš„å¸ƒå±€</h1><p><img src="https://i.111666.best/image/eYQb80Ibcp8dKCKG71JnVA.png" alt="image"></p><h2 id="å˜é‡ï¼Œå¼•ç”¨ï¼Œç±»å‹å’Œå¯¹è±¡"><a href="#å˜é‡ï¼Œå¼•ç”¨ï¼Œç±»å‹å’Œå¯¹è±¡" class="headerlink" title="å˜é‡ï¼Œå¼•ç”¨ï¼Œç±»å‹å’Œå¯¹è±¡"></a>å˜é‡ï¼Œå¼•ç”¨ï¼Œç±»å‹å’Œå¯¹è±¡</h2><p>é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡º ï¼š</p><p>Java æ–‡ä»¶ä¸­å£°æ˜çš„å˜é‡åï¼Œæœ¬è´¨ä¸Šæ˜¯å¯¹å¯¹è±¡çš„å¼•ç”¨æ ‡è¯†ã€‚åœ¨ç¼–è¯‘å’ŒåŠ è½½è¿‡ç¨‹ä¸­ï¼Œå®ƒä»¬ä¼šè¢«è½¬åŒ–ä¸ºå¯¹å…·ä½“å†…å­˜ä½ç½®çš„é—´æ¥è®¿é—®æ–¹å¼ï¼š<br>é™æ€å˜é‡ä¼šåœ¨ç±»åŠ è½½åæ˜ å°„ä¸ºå…ƒç©ºé—´ä¸­çš„å­—æ®µå¼•ç”¨ï¼›<br>å±€éƒ¨å˜é‡åˆ™è¢«åˆ†é…åˆ°å±€éƒ¨å˜é‡è¡¨ä¸­çš„ç´¢å¼•ï¼ˆslotï¼‰ï¼Œåœ¨è¿è¡Œæ—¶ä¸å…·ä½“å¯¹è±¡åœ°å€å»ºç«‹å…³è”ã€‚</p><p>è¿™ä½¿æˆ‘ä»¬å¯ä»¥é‡æ–°ç†è§£ Java çš„å¤šæ€å®šä¹‰ï¼šçˆ¶ç±»ç±»å‹çš„å¼•ç”¨å¯ä»¥æŒ‡å‘å­ç±»å¯¹è±¡ã€‚ç¼–è¯‘å™¨ä»…æ ¹æ®å¼•ç”¨çš„é™æ€ç±»å‹è¿›è¡Œæ–¹æ³•åˆæ³•æ€§æ ¡éªŒï¼Œè€Œå¯¹è±¡åœ¨è¿è¡Œæ—¶çš„å®é™…ç±»å‹ä»ç„¶æ˜¯å­ç±»ã€‚å½“è°ƒç”¨å®ä¾‹æ–¹æ³•æ—¶ï¼ŒJVM ä¼šæ ¹æ®å¯¹è±¡å®é™…ç±»å‹æŸ¥æ‰¾å…¶è™šæ–¹æ³•è¡¨ï¼ˆvtableï¼‰ï¼Œä»¥ç¡®å®šæœ€ç»ˆè°ƒç”¨çš„å…·ä½“æ–¹æ³•å®ç°ã€‚çˆ¶ç±»å¼•ç”¨çš„ä½œç”¨ä»…åœ¨äºæä¾›ä¸€ç§ç»Ÿä¸€çš„è¡Œä¸ºæ¥å£ï¼Œè€Œä¸å…³æ³¨è¡Œä¸ºçš„å…·ä½“å®ç°ã€‚</p><p>æ‰€ä»¥ ï¼Œåœ¨javaä¸­ ï¼š </p><p>å˜é‡åï¼ˆå¼•ç”¨ï¼‰ â†’ ç¼–è¯‘ï¼ŒåŠ è½½åè¢«ç¼–è¯‘ä¸ºç›´æ¥å¼•ç”¨æˆ–å±€éƒ¨å˜é‡è¡¨ä¸­çš„ç´¢å¼•</p><p>ç±»å‹ â†’ å˜é‡çš„å£°æ˜ç±»å‹å†³å®šäº†å…¶å¯ç”¨çš„æ“ä½œï¼ˆè¡Œä¸ºæ¥å£ï¼‰ï¼Œè€Œå¯¹è±¡çš„å®é™…ç±»å‹ç”±å³ä¾§çš„å®ä¾‹åŒ–è¿‡ç¨‹å†³å®šï¼Œå¹¶å½±å“è¿è¡Œæ—¶çš„åŠ¨æ€æ–¹æ³•åˆ†æ´¾ã€‚</p><p>å¯¹è±¡ â†’ å¯¹è±¡çš„å­˜å‚¨å’Œè¡Œä¸ºä¾èµ–äºä¿®é¥°è¯å£°æ˜å’Œå¯¹è±¡çš„å…·ä½“åˆ›å»ºè¿‡ç¨‹ï¼Œä¼šåˆ†å¸ƒåœ¨ </p><ul><li>ä»£ç ï¼ˆå¸¸é‡æ•°å€¼ç›´æ¥åµŒå…¥ï¼‰</li><li>å¸¸é‡æ± ï¼ˆstatic final ä¿®é¥°çš„éæ•°å€¼ç±»å‹ï¼‰</li><li>å…ƒç©ºé—´ï¼ˆé™æ€å˜é‡ï¼‰</li><li>å †ï¼ˆnew æˆ–åå°„æ„å»ºçš„å¯¹è±¡ï¼‰</li><li>æ ˆï¼ˆå±€éƒ¨å˜é‡ï¼‰</li></ul>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cçš„åŠ è½½è¿‡ç¨‹ä¸å†…å­˜æ¨¡å‹</title>
    <link href="/2025/04/11/C%E8%AF%AD%E8%A8%80%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/"/>
    <url>/2025/04/11/C%E8%AF%AD%E8%A8%80%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="å¤„ç†è¿‡ç¨‹"><a href="#å¤„ç†è¿‡ç¨‹" class="headerlink" title="å¤„ç†è¿‡ç¨‹"></a>å¤„ç†è¿‡ç¨‹</h1><h3 id="é¢„å¤„ç†â†’ç¼–è¯‘â†’æ±‡ç¼–â†’é“¾æ¥â†’è£…è½½â†’æ‰§è¡Œ"><a href="#é¢„å¤„ç†â†’ç¼–è¯‘â†’æ±‡ç¼–â†’é“¾æ¥â†’è£…è½½â†’æ‰§è¡Œ" class="headerlink" title="é¢„å¤„ç†â†’ç¼–è¯‘â†’æ±‡ç¼–â†’é“¾æ¥â†’è£…è½½â†’æ‰§è¡Œ"></a>é¢„å¤„ç†â†’ç¼–è¯‘â†’æ±‡ç¼–â†’é“¾æ¥â†’è£…è½½â†’æ‰§è¡Œ</h3><h3 id="é¢„å¤„ç†-å¤„ç†ä»¥-å¼€å¤´çš„é¢„å¤„ç†æŒ‡ä»¤ï¼Œä¾‹å¦‚-includeã€-defineã€-ifdef-ç­‰ã€‚"><a href="#é¢„å¤„ç†-å¤„ç†ä»¥-å¼€å¤´çš„é¢„å¤„ç†æŒ‡ä»¤ï¼Œä¾‹å¦‚-includeã€-defineã€-ifdef-ç­‰ã€‚" class="headerlink" title="é¢„å¤„ç† : å¤„ç†ä»¥ # å¼€å¤´çš„é¢„å¤„ç†æŒ‡ä»¤ï¼Œä¾‹å¦‚ #includeã€#defineã€#ifdef ç­‰ã€‚"></a>é¢„å¤„ç† : å¤„ç†ä»¥ <code>#</code> å¼€å¤´çš„é¢„å¤„ç†æŒ‡ä»¤ï¼Œä¾‹å¦‚ <code>#include</code>ã€<code>#define</code>ã€<code>#ifdef</code> ç­‰ã€‚</h3><ul><li>å®å±•å¼€</li><li>æ–‡ä»¶åŒ…å«å±•å¼€</li><li>æ¡ä»¶ç¼–è¯‘åˆ¤æ–­</li></ul><h3 id="ç¼–è¯‘-å°†é¢„å¤„ç†åçš„-C-ä»£ç è½¬æ¢æˆæ±‡ç¼–ä»£ç ã€‚"><a href="#ç¼–è¯‘-å°†é¢„å¤„ç†åçš„-C-ä»£ç è½¬æ¢æˆæ±‡ç¼–ä»£ç ã€‚" class="headerlink" title="ç¼–è¯‘ : å°†é¢„å¤„ç†åçš„ C ä»£ç è½¬æ¢æˆæ±‡ç¼–ä»£ç ã€‚"></a>ç¼–è¯‘ : å°†é¢„å¤„ç†åçš„ C ä»£ç è½¬æ¢æˆæ±‡ç¼–ä»£ç ã€‚</h3><ul><li>è¯­æ³•åˆ†æï¼ˆè§£æè¯­æ³•ç»“æ„ï¼‰</li><li>è¯­ä¹‰åˆ†æï¼ˆå˜é‡ç±»å‹æ£€æŸ¥ï¼‰</li></ul><h3 id="æ±‡ç¼–-å°†æ±‡ç¼–ä»£ç è½¬æ¢ä¸ºç›®æ ‡æ–‡ä»¶ï¼ˆäºŒè¿›åˆ¶æ ¼å¼ï¼‰ï¼Œè¿˜ä¸æ˜¯æœ€ç»ˆçš„å¯æ‰§è¡Œç¨‹åºã€‚"><a href="#æ±‡ç¼–-å°†æ±‡ç¼–ä»£ç è½¬æ¢ä¸ºç›®æ ‡æ–‡ä»¶ï¼ˆäºŒè¿›åˆ¶æ ¼å¼ï¼‰ï¼Œè¿˜ä¸æ˜¯æœ€ç»ˆçš„å¯æ‰§è¡Œç¨‹åºã€‚" class="headerlink" title="æ±‡ç¼– : å°†æ±‡ç¼–ä»£ç è½¬æ¢ä¸ºç›®æ ‡æ–‡ä»¶ï¼ˆäºŒè¿›åˆ¶æ ¼å¼ï¼‰ï¼Œè¿˜ä¸æ˜¯æœ€ç»ˆçš„å¯æ‰§è¡Œç¨‹åºã€‚"></a>æ±‡ç¼– : å°†æ±‡ç¼–ä»£ç è½¬æ¢ä¸ºç›®æ ‡æ–‡ä»¶ï¼ˆäºŒè¿›åˆ¶æ ¼å¼ï¼‰ï¼Œè¿˜ä¸æ˜¯æœ€ç»ˆçš„å¯æ‰§è¡Œç¨‹åºã€‚</h3><h3 id="é“¾æ¥-å°†ä¸€ä¸ªæˆ–å¤šä¸ª-o-æ–‡ä»¶ä¸æ‰€éœ€çš„åº“æ–‡ä»¶ï¼ˆæ¯”å¦‚æ ‡å‡†åº“-libcï¼‰åˆå¹¶ï¼Œè§£å†³å‡½æ•°è°ƒç”¨ã€å˜é‡å¼•ç”¨ç­‰ç¬¦å·åœ°å€ã€‚"><a href="#é“¾æ¥-å°†ä¸€ä¸ªæˆ–å¤šä¸ª-o-æ–‡ä»¶ä¸æ‰€éœ€çš„åº“æ–‡ä»¶ï¼ˆæ¯”å¦‚æ ‡å‡†åº“-libcï¼‰åˆå¹¶ï¼Œè§£å†³å‡½æ•°è°ƒç”¨ã€å˜é‡å¼•ç”¨ç­‰ç¬¦å·åœ°å€ã€‚" class="headerlink" title="é“¾æ¥ : å°†ä¸€ä¸ªæˆ–å¤šä¸ª .o æ–‡ä»¶ä¸æ‰€éœ€çš„åº“æ–‡ä»¶ï¼ˆæ¯”å¦‚æ ‡å‡†åº“ libcï¼‰åˆå¹¶ï¼Œè§£å†³å‡½æ•°è°ƒç”¨ã€å˜é‡å¼•ç”¨ç­‰ç¬¦å·åœ°å€ã€‚"></a>é“¾æ¥ : å°†ä¸€ä¸ªæˆ–å¤šä¸ª <code>.o</code> æ–‡ä»¶ä¸æ‰€éœ€çš„åº“æ–‡ä»¶ï¼ˆæ¯”å¦‚æ ‡å‡†åº“ <code>libc</code>ï¼‰åˆå¹¶ï¼Œè§£å†³å‡½æ•°è°ƒç”¨ã€å˜é‡å¼•ç”¨ç­‰ç¬¦å·åœ°å€ã€‚</h3><h3 id="è£…è½½-å°†é“¾æ¥ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå‡†å¤‡å¥½è¿è¡Œç¯å¢ƒã€‚"><a href="#è£…è½½-å°†é“¾æ¥ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå‡†å¤‡å¥½è¿è¡Œç¯å¢ƒã€‚" class="headerlink" title="è£…è½½ : å°†é“¾æ¥ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå‡†å¤‡å¥½è¿è¡Œç¯å¢ƒã€‚"></a>è£…è½½ : å°†é“¾æ¥ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå‡†å¤‡å¥½è¿è¡Œç¯å¢ƒã€‚</h3><h3 id="æ‰§è¡Œ-ç¨‹åºå…¥å£é€šå¸¸æ˜¯-start-å‡½æ•°ï¼Œç”±é“¾æ¥å™¨æä¾›ï¼Œä¹‹åä¼šè°ƒç”¨-main-ã€‚"><a href="#æ‰§è¡Œ-ç¨‹åºå…¥å£é€šå¸¸æ˜¯-start-å‡½æ•°ï¼Œç”±é“¾æ¥å™¨æä¾›ï¼Œä¹‹åä¼šè°ƒç”¨-main-ã€‚" class="headerlink" title="æ‰§è¡Œ : ç¨‹åºå…¥å£é€šå¸¸æ˜¯ _start å‡½æ•°ï¼Œç”±é“¾æ¥å™¨æä¾›ï¼Œä¹‹åä¼šè°ƒç”¨ main()ã€‚"></a>æ‰§è¡Œ : <strong>ç¨‹åºå…¥å£é€šå¸¸æ˜¯ <code>_start</code> å‡½æ•°</strong>ï¼Œç”±é“¾æ¥å™¨æä¾›ï¼Œä¹‹åä¼šè°ƒç”¨ <code>main()</code>ã€‚</h3><ul><li>ç”¨æˆ·ç¼–å†™çš„ç¨‹åºä» <code>main()</code> å¼€å§‹è¿è¡Œã€‚</li><li>ç¨‹åºæ‰§è¡Œæ—¶ï¼š<ul><li>åˆå§‹åŒ–å…¨å±€å˜é‡</li><li>æ‰§è¡Œ <code>main()</code> å‡½æ•°</li><li>ç¨‹åºè¿”å›æ—¶è°ƒç”¨ <code>exit()</code></li></ul></li></ul><h1 id="åŠ è½½åçš„Cè¯­è¨€å†…å­˜ç»“æ„"><a href="#åŠ è½½åçš„Cè¯­è¨€å†…å­˜ç»“æ„" class="headerlink" title="åŠ è½½åçš„Cè¯­è¨€å†…å­˜ç»“æ„"></a>åŠ è½½åçš„Cè¯­è¨€å†…å­˜ç»“æ„</h1><p>Cè¯­è¨€é€šè¿‡é“¾æ¥å’Œè£…è½½ å°†æ•°æ®åˆ†å¸ƒåˆ°ä¸€äº›å›ºå®šçš„ä½ç½®</p><p>.text ä»£ç æ®µ ç”¨äºæ”¾ç½®åªè¯»çš„å­—èŠ‚ç æŒ‡ä»¤ .rodata æ®µä¹Ÿä¼šæ”¾ç½®åœ¨é™„è¿‘</p><p>.data æ•°æ®æ®µ ç”¨äºå­˜æ”¾å·²ç»åˆå§‹åŒ–å…¨å±€å˜é‡å’Œé™æ€å˜é‡</p><p>.bss æ®µ            ç”¨äºå­˜æ”¾æœªåˆå§‹åŒ–å’Œåˆå§‹åŒ–ä¸º0çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡ã€‚</p><p>å †åŒº               ç”¨äºå­˜æ”¾ç¨‹åºæ‰§è¡ŒååŠ¨æ€åˆ†é…çš„å†…å­˜</p><p><img src="https://i.111666.best/image/QRNWyUFQUutntsad2LJIex.png" alt="image"></p><h1 id="å˜é‡ï¼ŒæŒ‡é’ˆä¸ç±»å‹"><a href="#å˜é‡ï¼ŒæŒ‡é’ˆä¸ç±»å‹" class="headerlink" title="å˜é‡ï¼ŒæŒ‡é’ˆä¸ç±»å‹"></a>å˜é‡ï¼ŒæŒ‡é’ˆä¸ç±»å‹</h1><p>åœ¨ C è¯­è¨€ä¸­ï¼Œå˜é‡çš„å£°æ˜æ„å‘³ç€ï¼šç¼–è¯‘å™¨ä¼šåœ¨å†…å­˜ä¸­ä¸ºè¿™ä¸ªå˜é‡åˆ†é…ä¸€å—ç©ºé—´ï¼Œå¹¶ä¸ºå®ƒåˆ†é…ä¸€ä¸ªå¯ä¾›ç¨‹åºè®¿é—®çš„â€œåç§°â€æˆ–â€œæ ‡ç­¾â€ã€‚è¿™ä¸ªæ ‡ç­¾ï¼ˆå˜é‡åï¼‰æœ¬è´¨ä¸Šæ˜¯å¯¹è¯¥å†…å­˜åœ°å€çš„ä¸€ç§<strong>é™æ€å¼•ç”¨æ–¹å¼</strong>ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> c = <span class="hljs-number">0</span> ; <br><span class="hljs-comment">// ä¸ºå˜é‡ c åˆ†é…äº†ä¸€ä¸ª int ç±»å‹ï¼ˆé€šå¸¸æ˜¯ 4 å­—èŠ‚ï¼‰çš„ç©ºé—´ï¼Œå¹¶åˆå§‹åŒ–ä¸º 0</span><br> <br><span class="hljs-type">char</span> a[] = &#123;<span class="hljs-string">&#x27;h&#x27;</span>,<span class="hljs-string">&#x27;e&#x27;</span>,<span class="hljs-string">&#x27;l&#x27;</span>,<span class="hljs-string">&#x27;l&#x27;</span>,<span class="hljs-string">&#x27;o&#x27;</span>,<span class="hljs-string">&#x27;\0&#x27;</span>&#125;;<br><span class="hljs-comment">// åˆ†é…äº†ä¸€ä¸ªå¤§å°ä¸º sizeof(a) çš„å­—ç¬¦æ•°ç»„ï¼Œå†…å­˜ä¸Šæ˜¯ä¸€å—è¿ç»­ç©ºé—´ï¼Œå­˜å‚¨äº†å…·ä½“çš„å­—ç¬¦æ•°æ®</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">person</span>&#123;</span><br><span class="hljs-type">int</span> age ;<br><span class="hljs-comment">//char name[10]; æ— æ³•èµ‹å€¼</span><br><span class="hljs-type">char</span>* name ;<br>&#125; person;<br><span class="hljs-comment">// ä¸ºç»“æ„ä½“å˜é‡ h åˆ†é…äº†ä¸€å—ç©ºé—´ï¼ŒåŒ…å«äº† intï¼ˆageï¼‰å’ŒæŒ‡é’ˆï¼ˆnameï¼‰ä¸¤ä¸ªæˆå‘˜</span><br>person h;<br>h.name = <span class="hljs-string">&quot;codfish&quot;</span>;<br><span class="hljs-comment">//  æ‰¾åˆ°ç»“æ„ä½“ä¸­çš„charæŒ‡é’ˆç±»å‹ç»“æ„name, å°†è¯¥æŒ‡é’ˆæŒ‡å‘â€œcodfishâ€ çš„åœ°å€</span><br>h.age = <span class="hljs-number">12</span>;<br><span class="hljs-comment">//  æ‰¾åˆ°ç»“æ„ä½“ä¸­çš„intlç±»å‹age, å‘å…¶æ‰€åœ¨çš„å†…å­˜åœ°å€å†™å…¥â€œ12â€</span><br></code></pre></td></tr></table></figure><p>å˜é‡åå¯ä»¥çœ‹ä½œæ˜¯å¯¹è¯¥å†…å­˜ç©ºé—´çš„ä¸€ä¸ª<strong>é™æ€å¼•ç”¨æ ‡ç­¾</strong>ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥å¯¹è¿™å—å†…å­˜è¿›è¡Œè¯»å†™ã€‚</p><p>åœ¨è¿™ä¸ªè§†è§’ä¸‹ï¼Œâ€œ<strong>åœ°å€</strong>â€æœ¬èº«ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§å€¼ï¼Œè€Œ<strong>æŒ‡é’ˆç±»å‹</strong>å°±æ˜¯<strong>ä¸“é—¨ç”¨äºå­˜å‚¨åœ°å€å€¼çš„ç±»å‹</strong>ã€‚æŒ‡é’ˆå˜é‡çš„å€¼æ˜¯ä¸€ä¸ªåœ°å€ï¼Œé€šè¿‡è¿™ä¸ªåœ°å€å¯ä»¥é—´æ¥è®¿é—®å¦ä¸€ä¸ªå˜é‡æˆ–å†…å­˜åŒºåŸŸã€‚å› æ­¤ï¼ŒæŒ‡é’ˆæœ¬è´¨ä¸Šæ˜¯ä¸€ç§<strong>é—´æ¥å¯»å€çš„å˜é‡ç±»å‹</strong>ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> a = <span class="hljs-number">3</span> ;   <span class="hljs-comment">// å¼€è¾Ÿäº†ä¸€å—å†…å­˜ç©ºé—´ï¼Œå­˜å‚¨çš„å€¼ä¸º3</span><br><span class="hljs-type">int</span> * p = &amp;a ;  <span class="hljs-comment">// å¼€è¾Ÿäº†ä¸€å—å†…å­˜ç©ºé—´, å­˜å‚¨çš„å€¼ä¸ºaçš„å­˜å‚¨åœ°å€</span><br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>,*p);  <span class="hljs-comment">//  æ‰“å° p æŒ‡å‘åœ°å€ä¸­å­˜å‚¨çš„å€¼ï¼Œå³ a</span><br></code></pre></td></tr></table></figure><p>åœ¨ C è¯­è¨€ä¸­ï¼Œ<strong>å·¦å€¼ï¼ˆlvalueï¼‰</strong>ä»£è¡¨çš„æ˜¯ä¸€ä¸ªå¯å¯»å€ã€å¯å†™å…¥çš„å†…å­˜ä½ç½®ï¼Œæ˜¯ç¨‹åºè¿è¡Œä¸­é¢‘ç¹æ“ä½œçš„å¯¹è±¡ã€‚è€Œ<strong>å³å€¼ï¼ˆrvalueï¼‰</strong>é€šå¸¸æ˜¯ä¸€ä¸ªä¸´æ—¶å€¼ï¼Œä¸å…·å¤‡å¯å¯»å€æ€§ï¼Œç”¨å®Œå³å¼ƒã€‚</p><p>ä¾‹å¦‚ï¼š</p><ul><li>å˜é‡ <code>a</code> æ˜¯å·¦å€¼ï¼Œä½ å¯ä»¥å–åœ°å€ <code>&amp;a</code>ï¼Œä¹Ÿå¯ä»¥å¯¹å®ƒèµ‹å€¼ã€‚</li><li>è¡¨è¾¾å¼ <code>a + 1</code> æ˜¯å³å€¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªè®¡ç®—ç»“æœï¼Œä¸èƒ½å–åœ°å€ã€‚</li><li>å­—ç¬¦ä¸² <code>&quot;codfish&quot;</code> æ˜¯ä¸€ä¸ªå³å€¼å¸¸é‡ï¼Œå…¶å†…å®¹åœ¨ç¼–è¯‘æœŸå°±å›ºå®šï¼Œé€šå¸¸è¢«ä¿å­˜åœ¨ <strong>åªè¯»æ•°æ®æ®µï¼ˆ.rodataï¼‰</strong> ä¸­ã€‚</li></ul><p>å› æ­¤ï¼š</p><blockquote><p>å·¦å€¼æ˜¯ç¨‹åºè¿è¡Œæ—¶å¯æ“ä½œçš„å†…å­˜å®ä½“ï¼Œè€Œå³å€¼æ›´å¤šåœ°ä½“ç°ä¸ºä¸´æ—¶æ€§å’Œåªè¯»æ€§ã€‚å…¶ä¸­æŸäº›å³å€¼ï¼ˆå¦‚å­—ç¬¦ä¸²å­—é¢é‡ã€å¸¸é‡è¡¨è¾¾å¼ï¼‰ç¡®å®ä¼šä¿å­˜åœ¨ .rodata æ®µä¸­ï¼Œä½†å¤§å¤šæ•°å³å€¼åªæ˜¯ä¸´æ—¶è®¡ç®—ç»“æœï¼Œå¯èƒ½å­˜åœ¨äºå¯„å­˜å™¨ä¸­ï¼Œæˆ–è€…æ ¹æœ¬ä¸ä¼šåœ¨ç‰©ç†å†…å­˜ä¸­é•¿æœŸä¿ç•™ã€‚</p></blockquote><p>æœ€åå›åˆ°ä¸Šæ–‡ï¼Œåœ¨ç»“æ„ä½“ä¸­å¦‚æœå®šä¹‰çš„char name[10]ï¼›åˆ™æ— æ³•ä½¿ç”¨å­—ç¬¦ä¸²ç›´æ¥å®Œæˆåˆå§‹åŒ–ã€‚å› ä¸ºè¿™æ—¶ ç»“æ„ä½“ä¸­å®šä¹‰çš„æ˜¯ä¸€ä¸ª 10ä¸ªå­—èŠ‚é•¿åº¦ char æ•°ç»„ï¼Œè€Œæ¥æ”¶çš„å³å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦æŒ‡é’ˆã€‚ä¸¤è¾¹çš„ç±»å‹å¹¶ä¸èƒ½åŒ¹é…ï¼Œæ‰€ä»¥æ— æ³•å®Œæˆèµ‹å€¼ï¼Œåªèƒ½å¯¹è¯¥æ•°ç»„ä¸­çš„æ¯ä¸€ä½åˆ†åˆ«è¿›è¡Œèµ‹å€¼ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c">human.name[<span class="hljs-number">0</span>] = <span class="hljs-string">&#x27;C&#x27;</span>;<br>human.name[<span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;o&#x27;</span>;<br>human.name[<span class="hljs-number">2</span>] = <span class="hljs-string">&#x27;d&#x27;</span>;<br>human.name[<span class="hljs-number">3</span>] = <span class="hljs-string">&#x27;f&#x27;</span>;<br>human.name[<span class="hljs-number">4</span>] = <span class="hljs-string">&#x27;i&#x27;</span>;<br>human.name[<span class="hljs-number">5</span>] = <span class="hljs-string">&#x27;s&#x27;</span>;<br>human.name[<span class="hljs-number">6</span>] = <span class="hljs-string">&#x27;h&#x27;</span>;<br>human.name[<span class="hljs-number">7</span>] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>  <br><span class="hljs-comment">// è¾“å‡º</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ myc]# ./test<br>hello ,<span class="hljs-number">12</span> years old<span class="hljs-string">&#x27;s  Codfish</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>C</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bash å¿«æ·æŒ‡ä»¤æ¸…å•</title>
    <link href="/2025/04/10/Bash-%E5%BF%AB%E6%8D%B7%E6%8C%87%E4%BB%A4%E6%B8%85%E5%8D%95/"/>
    <url>/2025/04/10/Bash-%E5%BF%AB%E6%8D%B7%E6%8C%87%E4%BB%A4%E6%B8%85%E5%8D%95/</url>
    
    <content type="html"><![CDATA[<h1 id="å…‰æ ‡ç§»åŠ¨ç±»"><a href="#å…‰æ ‡ç§»åŠ¨ç±»" class="headerlink" title="å…‰æ ‡ç§»åŠ¨ç±»"></a>å…‰æ ‡ç§»åŠ¨ç±»</h1><table><thead><tr><th>å¿«æ·é”®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>Ctrl + A</code></td><td>ç§»åŠ¨å…‰æ ‡åˆ°è¡Œé¦–</td></tr><tr><td><code>Ctrl + E</code></td><td>ç§»åŠ¨å…‰æ ‡åˆ°è¡Œå°¾</td></tr><tr><td><code>Alt + B</code></td><td>å‘å·¦ç§»åŠ¨ä¸€ä¸ªå•è¯</td></tr><tr><td><code>Alt + F</code></td><td>å‘å³ç§»åŠ¨ä¸€ä¸ªå•è¯</td></tr><tr><td><code>Ctrl + B</code></td><td>å‘å·¦ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td><code>Ctrl + F</code></td><td>å‘å³ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td><code>Ctrl + XX</code></td><td>åœ¨è¡Œé¦–ä¸å½“å‰ä½ç½®ä¹‹é—´è·³è½¬</td></tr></tbody></table><h1 id="ç¼–è¾‘å‘½ä»¤ç±»"><a href="#ç¼–è¾‘å‘½ä»¤ç±»" class="headerlink" title="ç¼–è¾‘å‘½ä»¤ç±»"></a>ç¼–è¾‘å‘½ä»¤ç±»</h1><table><thead><tr><th>å¿«æ·é”®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>Ctrl + U</code></td><td>åˆ é™¤ä»å…‰æ ‡åˆ°è¡Œé¦–çš„å†…å®¹</td></tr><tr><td><code>Ctrl + K</code></td><td>åˆ é™¤ä»å…‰æ ‡åˆ°è¡Œå°¾çš„å†…å®¹</td></tr><tr><td><code>Ctrl + W</code></td><td>åˆ é™¤å…‰æ ‡å‰ä¸€ä¸ªâ€œè¯â€</td></tr><tr><td><code>Alt + D</code></td><td>åˆ é™¤å…‰æ ‡åçš„ä¸€ä¸ªâ€œè¯â€</td></tr><tr><td><code>Ctrl + D</code></td><td>åˆ é™¤å…‰æ ‡æ‰€åœ¨å­—ç¬¦ï¼ˆæˆ–é€€å‡º shellï¼‰</td></tr><tr><td><code>Ctrl + H</code></td><td>åˆ é™¤å…‰æ ‡å‰ä¸€ä¸ªå­—ç¬¦ï¼ˆé€€æ ¼ï¼‰</td></tr><tr><td><code>Ctrl + T</code></td><td>äº¤æ¢å…‰æ ‡å‰çš„ä¸¤ä¸ªå­—ç¬¦</td></tr><tr><td><code>Alt + T</code></td><td>äº¤æ¢å…‰æ ‡å‰åä¸¤ä¸ªè¯</td></tr></tbody></table><h1 id="å‰ªåˆ‡ä¸ç²˜è´´"><a href="#å‰ªåˆ‡ä¸ç²˜è´´" class="headerlink" title="å‰ªåˆ‡ä¸ç²˜è´´"></a>å‰ªåˆ‡ä¸ç²˜è´´</h1><table><thead><tr><th>å¿«æ·é”®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>Ctrl + U/K/W</code></td><td>å‰ªåˆ‡å†…å®¹ï¼Œä¼šä¿å­˜åœ¨å‰ªè´´æ¿ä¸­</td></tr><tr><td><code>Ctrl + Y</code></td><td>ç²˜è´´ï¼ˆæ’å…¥ï¼‰åˆšæ‰å‰ªåˆ‡çš„å†…å®¹</td></tr><tr><td><code>Alt + Y</code></td><td>ç²˜è´´å†å²ä¸­æ›´æ—©çš„å‰ªåˆ‡å†…å®¹ï¼ˆå¾ªç¯ï¼‰</td></tr></tbody></table><h1 id="å†å²å‘½ä»¤æ“ä½œ"><a href="#å†å²å‘½ä»¤æ“ä½œ" class="headerlink" title="å†å²å‘½ä»¤æ“ä½œ"></a>å†å²å‘½ä»¤æ“ä½œ</h1><table><thead><tr><th>å¿«æ·é”®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>Ctrl + R</code></td><td>åå‘æœç´¢å†å²å‘½ä»¤</td></tr><tr><td><code>Ctrl + S</code></td><td>æ­£å‘æœç´¢å†å²å‘½ä»¤ï¼ˆå¯èƒ½éœ€é…ç½®ï¼‰</td></tr><tr><td><code>Ctrl + P</code></td><td>ä¸Šä¸€æ¡å†å²å‘½ä»¤ï¼ˆç­‰åŒ â†‘ï¼‰</td></tr><tr><td><code>Ctrl + N</code></td><td>ä¸‹ä¸€æ¡å†å²å‘½ä»¤ï¼ˆç­‰åŒ â†“ï¼‰</td></tr><tr><td><code>Alt + .</code></td><td>æ’å…¥ä¸Šä¸€æ¡å‘½ä»¤çš„æœ€åä¸€ä¸ªå‚æ•°</td></tr></tbody></table><h1 id="å‘½ä»¤è¡Œç»„åˆæ“ä½œ"><a href="#å‘½ä»¤è¡Œç»„åˆæ“ä½œ" class="headerlink" title="å‘½ä»¤è¡Œç»„åˆæ“ä½œ"></a>å‘½ä»¤è¡Œç»„åˆæ“ä½œ</h1><table><thead><tr><th>å¿«æ·é”®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>Ctrl + O</code></td><td>æ‰§è¡Œå½“å‰å‘½ä»¤å¹¶åŠ è½½ä¸‹ä¸€æ¡å†å²å‘½ä»¤</td></tr><tr><td><code>Ctrl + L</code></td><td>æ¸…å±ï¼ˆç­‰åŒ <code>clear</code> å‘½ä»¤ï¼‰</td></tr><tr><td><code>Ctrl + G</code></td><td>é€€å‡ºå½“å‰æ“ä½œï¼ˆå¦‚æœç´¢ã€ç²˜è´´ç­‰ï¼‰</td></tr></tbody></table><h1 id="è¡¥å…¨ä¸è‡ªåŠ¨åŒ–"><a href="#è¡¥å…¨ä¸è‡ªåŠ¨åŒ–" class="headerlink" title="è¡¥å…¨ä¸è‡ªåŠ¨åŒ–"></a>è¡¥å…¨ä¸è‡ªåŠ¨åŒ–</h1><table><thead><tr><th>å¿«æ·é”®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>Tab</code></td><td>è¡¥å…¨å‘½ä»¤ã€æ–‡ä»¶æˆ–è·¯å¾„</td></tr><tr><td><code>Alt + ?</code></td><td>æ˜¾ç¤ºæ‰€æœ‰å¯èƒ½çš„è¡¥å…¨é¡¹</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>Shell</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Redis éƒ¨ç½²ä¸æŸ¥è¯¢å‘½ä»¤</title>
    <link href="/2025/04/10/Redis-%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%9F%A5%E8%AF%A2%E5%91%BD%E4%BB%A4/"/>
    <url>/2025/04/10/Redis-%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%9F%A5%E8%AF%A2%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="Redisçš„å®‰è£…éƒ¨ç½²"><a href="#Redisçš„å®‰è£…éƒ¨ç½²" class="headerlink" title="Redisçš„å®‰è£…éƒ¨ç½²"></a>Redisçš„å®‰è£…éƒ¨ç½²</h1><p>ä½¿ç”¨ç³»ç»Ÿçš„åŒ…ç®¡ç†å™¨æ¥å®‰è£…redis ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">dnf install redis <br></code></pre></td></tr></table></figure><p>æˆ–è€…ç›´æ¥é€šè¿‡å®¹å™¨æ‹‰å–rediså®¹å™¨ ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker pull redis<br>docker run -d   --name my-redis   -p 6379:6379   redis:latest<br></code></pre></td></tr></table></figure><h1 id="Redis-æ–‡ä»¶é…ç½®"><a href="#Redis-æ–‡ä»¶é…ç½®" class="headerlink" title="Redis æ–‡ä»¶é…ç½®"></a>Redis æ–‡ä»¶é…ç½®</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ _posts]# whereis redis<br>redis: /usr/lib64/redis /etc/redis.conf<br><br><span class="hljs-comment"># é‡è¦é…ç½®</span><br><span class="hljs-built_in">bind</span> 127.0.0.1 ::1 <br><span class="hljs-comment"># é…ç½®ç¯å›å£ç›‘å¬ï¼Œ å¦‚æœéœ€è¦ä»å¤–éƒ¨è®¿é—®è¦æ”¹ä¸º bind 0.0.0.0</span><br>port 6379  <br><span class="hljs-comment"># ä¼ è¾“ç«¯å£ï¼Œé»˜è®¤6379</span><br>daemonize no  <br><span class="hljs-comment"># æ˜¯å¦ä½œä¸ºåå°è¿›ç¨‹æ‰§è¡Œï¼Œé»˜è®¤æ˜¯no å³å‰å°è¿è¡Œ</span><br>requirepass yourpassword<br><span class="hljs-comment"># é…ç½®æ•°æ®åº“å¯†ç </span><br><span class="hljs-comment"># å¯åŠ¨redis æœåŠ¡å™¨</span><br>redis-server  path/your_redis.conf<br><span class="hljs-comment"># éœ€è¦ä½¿ç”¨è‡ªå®šä¹‰çš„é…ç½®æ–‡ä»¶å¯åŠ¨ï¼Œè‡ªå®šä¹‰é…ç½®æ‰ä¼šç”Ÿæ•ˆ</span><br></code></pre></td></tr></table></figure><h1 id="é…ç½®Redisä½œä¸ºæœåŠ¡åœ¨æœåŠ¡å™¨ä¸Šå¯åŠ¨"><a href="#é…ç½®Redisä½œä¸ºæœåŠ¡åœ¨æœåŠ¡å™¨ä¸Šå¯åŠ¨" class="headerlink" title="é…ç½®Redisä½œä¸ºæœåŠ¡åœ¨æœåŠ¡å™¨ä¸Šå¯åŠ¨"></a>é…ç½®Redisä½œä¸ºæœåŠ¡åœ¨æœåŠ¡å™¨ä¸Šå¯åŠ¨</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># è®¾ç½®.servicesæ–‡ä»¶</span><br>[Unit]<br>Description=Redis In-Memory Data Store<br>After=network.target<br><br>[Service]<br>Type=simple<br>ExecStart=/usr/bin/redis-server /etc/my_redis/redis.conf <span class="hljs-comment"># å®šä¹‰å¯åŠ¨é¡¹</span><br>ExecStop=/usr/bin/redis-cli -a yourpassword shutdown <span class="hljs-comment"># å®šä¹‰ç»“æŸè¿‡ç¨‹</span><br>Restart=always<br>User=redis<br>Group=redis<br><br><span class="hljs-comment"># Optional: Make sure redis has permission to write to the PID/log/data files</span><br>RuntimeDirectory=redis<br>RuntimeDirectoryMode=0755<br><br>[Install]<br>WantedBy=multi-user.target<br><span class="hljs-comment">#éœ€è¦æ³¨æ„é…ç½®ä¸ºlinuxæœåŠ¡æ—¶ï¼Œè¦å°†daemonizeè®¾ç½®ä¸ºno</span><br><span class="hljs-built_in">sudo</span> systemctl daemon-reload<br><span class="hljs-comment">#é‡æ–°åŠ è½½å®ˆæŠ¤è¿›ç¨‹é…ç½®</span><br><span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">enable</span> redis<br><span class="hljs-comment">#é…ç½®rediså¼€æœºå¯åŠ¨</span><br><span class="hljs-built_in">sudo</span> systemctl start redis<br><span class="hljs-comment">#å¯åŠ¨redis</span><br>redis-cli -p your_port -a your_password <br><span class="hljs-comment">#è¿›å…¥redis</span><br></code></pre></td></tr></table></figure><h1 id="Redisæ”¯æŒçš„æ•°æ®ç»“æ„ä¸å¸¸ç”¨æŸ¥è¯¢"><a href="#Redisæ”¯æŒçš„æ•°æ®ç»“æ„ä¸å¸¸ç”¨æŸ¥è¯¢" class="headerlink" title="Redisæ”¯æŒçš„æ•°æ®ç»“æ„ä¸å¸¸ç”¨æŸ¥è¯¢"></a>Redisæ”¯æŒçš„æ•°æ®ç»“æ„ä¸å¸¸ç”¨æŸ¥è¯¢</h1><h2 id="é€šç”¨å‘½ä»¤"><a href="#é€šç”¨å‘½ä»¤" class="headerlink" title="é€šç”¨å‘½ä»¤"></a>é€šç”¨å‘½ä»¤</h2><p>KEYS æŸ¥çœ‹ç¬¦åˆæ¨¡æ¿çš„æ‰€æœ‰key</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># åŒ¹é…ç¬¦å«ä¹‰</span><br><span class="hljs-comment"># *åŒ¹é…ä»»æ„ä¸ªå­—ç¬¦</span><br>127.0.0.1:6380&gt; keys *<br> 1) <span class="hljs-string">&quot;people&quot;</span><br> 2) <span class="hljs-string">&quot;b&quot;</span><br> 3) <span class="hljs-string">&quot;25&quot;</span><br> 4) <span class="hljs-string">&quot;user&quot;</span><br><span class="hljs-comment"># ?åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦</span><br>127.0.0.1:6380&gt; keys ?<br>1) <span class="hljs-string">&quot;b&quot;</span><br><span class="hljs-comment"># [abc]åŒ¹é… a æˆ– b æˆ– c</span><br>127.0.0.1:6380&gt; keys [eb]<br>1) <span class="hljs-string">&quot;b&quot;</span><br>2) <span class="hljs-string">&quot;e&quot;</span><br></code></pre></td></tr></table></figure><p>DEL åˆ é™¤ä¸€ä¸ªæŒ‡å®šçš„key</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; del e<br>(<span class="hljs-built_in">integer</span>) 1<br></code></pre></td></tr></table></figure><p>EXISTS åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; exists b<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6380&gt; exists e<br>(<span class="hljs-built_in">integer</span>) 0<br></code></pre></td></tr></table></figure><p>EXPIRE ç»™ä¸€ä¸ªkeyè®¾ç½®æœ‰æ•ˆæœŸ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">EXPIRE  item  scends<br>TTL <span class="hljs-comment"># æŸ¥è¯¢å‰©ä½™æœ‰æ•ˆæœŸ</span><br>127.0.0.1:6380&gt; <span class="hljs-built_in">set</span> a 5<br>OK<br>127.0.0.1:6380&gt; expire a 10<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6380&gt; ttl a<br>(<span class="hljs-built_in">integer</span>) 8<br>127.0.0.1:6380&gt; ttl a<br>(<span class="hljs-built_in">integer</span>) 3<br>127.0.0.1:6380&gt; ttl a<br>(<span class="hljs-built_in">integer</span>) 0<br>127.0.0.1:6380&gt; ttl a<br>(<span class="hljs-built_in">integer</span>) -2<br>127.0.0.1:6380&gt; get a<br>(nil)<br></code></pre></td></tr></table></figure><h2 id="å­—ç¬¦ä¸²String"><a href="#å­—ç¬¦ä¸²String" class="headerlink" title="å­—ç¬¦ä¸²String"></a>å­—ç¬¦ä¸²String</h2><p>String</p><ul><li>string</li><li>int</li><li>float</li></ul><h2 id="String"><a href="#String" class="headerlink" title="String"></a>String</h2><p>set&#x2F;get è®¾ç½®&#x2F;è·å– k-v é”®å€¼å¯¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> key value<br><span class="hljs-comment"># è®¾ç½® k-v é”®å€¼å¯¹</span><br>get key <br>- value<br><span class="hljs-comment"># è·å–å¯¹åº”keyçš„å€¼</span><br></code></pre></td></tr></table></figure><p>mset&#x2F;mget åŒæ—¶è®¾ç½®&#x2F;è·å–å¤šç»„é”®å€¼å¯¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; mset z 15 y 12 x 18<br>OK<br>127.0.0.1:6380&gt; mget z y x<br>1) <span class="hljs-string">&quot;15&quot;</span><br>2) <span class="hljs-string">&quot;12&quot;</span><br>3) <span class="hljs-string">&quot;18&quot;</span><br><br></code></pre></td></tr></table></figure><p>incr æŒ‡å®šå¯¹åº”é”®çš„å€¼è‡ªå¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; incr z<br>(<span class="hljs-built_in">integer</span>) 16<br></code></pre></td></tr></table></figure><p>incrby è‡ªå¢è‡ªå®šä¹‰æ­¥é•¿</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; incrby z 8<br>(<span class="hljs-built_in">integer</span>) 24<br></code></pre></td></tr></table></figure><p>incrbyfloat å¢åŠ æµ®ç‚¹æ•°æ•°å€¼æ­¥é•¿</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; incrbyfloat z 0.5<br><span class="hljs-string">&quot;24.5&quot;</span><br></code></pre></td></tr></table></figure><p>setnx  è®¾ç½®å€¼ï¼Œå¦‚æœè¯¥keyå·²ç»å­˜åœ¨æ•°å€¼ï¼Œåˆ™ä¸ä¼šä¿®æ”¹åŸå€¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; setnx z 12<br>(<span class="hljs-built_in">integer</span>) 0<br>127.0.0.1:6380&gt; get z<br><span class="hljs-string">&quot;24.5&quot;</span><br></code></pre></td></tr></table></figure><p>setex è®¾ç½®k-v å¹¶è®¾ç½®è¶…æ—¶æ—¶é—´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; setex z 10 18<br>OK<br>127.0.0.1:6380&gt; ttl z<br>(<span class="hljs-built_in">integer</span>) 8<br>127.0.0.1:6380&gt; ttl z<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6380&gt; ttl z<br>(<span class="hljs-built_in">integer</span>) -2<br>127.0.0.1:6380&gt; get z<br>(nil)<br></code></pre></td></tr></table></figure><h2 id="Hash-å“ˆå¸Œè¡¨ï¼ˆæ•£åˆ—è¡¨ï¼‰"><a href="#Hash-å“ˆå¸Œè¡¨ï¼ˆæ•£åˆ—è¡¨ï¼‰" class="headerlink" title="Hash å“ˆå¸Œè¡¨ï¼ˆæ•£åˆ—è¡¨ï¼‰"></a>Hash å“ˆå¸Œè¡¨ï¼ˆæ•£åˆ—è¡¨ï¼‰</h2><p>hset&#x2F;hget  å‘å“ˆå¸Œè¡¨ä¸­è®¾ç½®&#x2F;è¯»å–k-v</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; hset m name luccy<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6380&gt; hget m name<br><span class="hljs-string">&quot;luccy&quot;</span><br></code></pre></td></tr></table></figure><p>hmset&#x2F;hmget å‘å“ˆå¸Œè¡¨ä¸­ä¸€æ¬¡æ€§è®¾ç½®å¤šå¯¹k-v</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; hmset o age 12 name joi<br>OK<br>127.0.0.1:6380&gt; hmget o age name<br>1) <span class="hljs-string">&quot;12&quot;</span><br>2) <span class="hljs-string">&quot;joi&quot;</span><br></code></pre></td></tr></table></figure><p>hgetall è·å–haskä¸­çš„æ‰€æœ‰é”®å€¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; hgetall o<br>1) <span class="hljs-string">&quot;age&quot;</span><br>2) <span class="hljs-string">&quot;12&quot;</span><br>3) <span class="hljs-string">&quot;name&quot;</span><br>4) <span class="hljs-string">&quot;joi&quot;</span><br></code></pre></td></tr></table></figure><p>hkeys&#x2F;hvalsè·å–æ‰€æœ‰é”®&#x2F;å€¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; hkeys o<br>1) <span class="hljs-string">&quot;age&quot;</span><br>2) <span class="hljs-string">&quot;name&quot;</span><br>127.0.0.1:6380&gt; hvals o<br>1) <span class="hljs-string">&quot;12&quot;</span><br>2) <span class="hljs-string">&quot;joi&quot;</span><br></code></pre></td></tr></table></figure><p>HINCRBY å‘hashä¸­çš„æŸä¸ªé”®æŒ‡å®šæ­¥é•¿è‡ªå¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; hincrby o age 3<br>(<span class="hljs-built_in">integer</span>) 15<br></code></pre></td></tr></table></figure><p>HSETNX å‘hashä¸­çš„æŸä¸ªé”®è®¾ç½®å€¼ï¼Œå¦‚æœå·²ç»å­˜åœ¨å€¼ï¼Œåˆ™ä¿ç•™åŸå€¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; hsetnx o age 18<br>(<span class="hljs-built_in">integer</span>) 0<br>127.0.0.1:6380&gt; hget o age<br><span class="hljs-string">&quot;15&quot;</span><br></code></pre></td></tr></table></figure><h2 id="List-åˆ—è¡¨ï¼ˆå®ç°ä¸ºä¸€ä¸ªåŒå‘é“¾è¡¨ï¼‰"><a href="#List-åˆ—è¡¨ï¼ˆå®ç°ä¸ºä¸€ä¸ªåŒå‘é“¾è¡¨ï¼‰" class="headerlink" title="List åˆ—è¡¨ï¼ˆå®ç°ä¸ºä¸€ä¸ªåŒå‘é“¾è¡¨ï¼‰"></a>List åˆ—è¡¨ï¼ˆå®ç°ä¸ºä¸€ä¸ªåŒå‘é“¾è¡¨ï¼‰</h2><p>LPUSH&#x2F;LPOP ä»å·¦ä¾§æ’å…¥&#x2F;å¼¹å‡ºå€¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; lpush q 28 29 30<br>(<span class="hljs-built_in">integer</span>) 3<br>127.0.0.1:6380&gt; lpop q 1<br>1) <span class="hljs-string">&quot;30&quot;</span><br><span class="hljs-comment"># æ’å…¥å¤šä¸ªå€¼æ—¶ï¼Œæ˜¯ä¾æ¬¡ä»å·¦ä¾§æ’å…¥å€¼ï¼Œæ‰€ä»¥30å¤„äºé“¾è¡¨å¤´éƒ¨</span><br></code></pre></td></tr></table></figure><p>RPUSH&#x2F;RPOP ä»å³ä¾§æ’å…¥&#x2F;å¼¹å‡ºå€¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; rpush q 18 19 20<br>(<span class="hljs-built_in">integer</span>) 5<br>127.0.0.1:6380&gt; rpop q 1<br>1) <span class="hljs-string">&quot;20&quot;</span><br><span class="hljs-comment"># å³ä¾§æ’å…¥å¤šä¸ªå€¼æ—¶ï¼Œæ¯ä¸ªæ–°æ’å…¥çš„å€¼æ’å…¥åœ¨å°¾éƒ¨ï¼Œæ‰€ä»¥20å¤„äºå°¾éƒ¨</span><br></code></pre></td></tr></table></figure><p>LRANGE key start end æŸ¥è¯¢ç»™å‡ºèŒƒå›´å†…çš„å€¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; lrange q 0 4<br>1) <span class="hljs-string">&quot;29&quot;</span><br>2) <span class="hljs-string">&quot;28&quot;</span><br>3) <span class="hljs-string">&quot;18&quot;</span><br>4) <span class="hljs-string">&quot;19&quot;</span><br></code></pre></td></tr></table></figure><p>BLPOP  è®¾ç½®é˜»å¡æ—¶é—´çš„å³ä¾§å¼¹å‡º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; blpop q 5<br>(nil)<br>(5.07s)<br><span class="hljs-comment"># æ³¨æ„è¿™é‡Œå¼¹å‡ºè¶…è¿‡listé•¿åº¦çš„å€¼ä¼šå¼¹å‡ºæœ€å³ä¾§çš„å€¼</span><br></code></pre></td></tr></table></figure><h2 id="Set-é›†åˆ"><a href="#Set-é›†åˆ" class="headerlink" title="Set é›†åˆ"></a>Set é›†åˆ</h2><p>SADD å‘setä¸­æ·»åŠ å…ƒç´ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; sadd p 1 2 3 4 5<br>(<span class="hljs-built_in">integer</span>) 5<br></code></pre></td></tr></table></figure><p>SREM  ç§»é™¤setä¸­çš„å…ƒç´ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; srem p 1<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6380&gt; sinter p<br>1) <span class="hljs-string">&quot;2&quot;</span><br>2) <span class="hljs-string">&quot;3&quot;</span><br>3) <span class="hljs-string">&quot;4&quot;</span><br>4) <span class="hljs-string">&quot;5&quot;</span><br></code></pre></td></tr></table></figure><p>SCARD  è¿”å›setä¸­å…ƒç´ çš„ä¸ªæ•°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; scard p<br>(<span class="hljs-built_in">integer</span>) 4<br></code></pre></td></tr></table></figure><p>SISMEMBER key member åˆ¤æ–­æ˜¯å¦å­˜åœ¨äºsetä¸­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; sismember p 5<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6380&gt; sismember p 6<br>(<span class="hljs-built_in">integer</span>) 0<br></code></pre></td></tr></table></figure><p>SMEMBERS è·å–æ‰€æœ‰æˆå‘˜</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; smembers p<br>1) <span class="hljs-string">&quot;2&quot;</span><br>2) <span class="hljs-string">&quot;3&quot;</span><br>3) <span class="hljs-string">&quot;4&quot;</span><br>4) <span class="hljs-string">&quot;5&quot;</span><br></code></pre></td></tr></table></figure><p>SINTER key1 key2  æ±‚key1 ä¸key2çš„äº¤é›†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; smembers p<br>1) <span class="hljs-string">&quot;2&quot;</span><br>2) <span class="hljs-string">&quot;3&quot;</span><br>3) <span class="hljs-string">&quot;4&quot;</span><br>4) <span class="hljs-string">&quot;5&quot;</span><br>127.0.0.1:6380&gt; sadd j 2 5 8 9 12<br>(<span class="hljs-built_in">integer</span>) 5<br>127.0.0.1:6380&gt; sinter p j<br>1) <span class="hljs-string">&quot;2&quot;</span><br>2) <span class="hljs-string">&quot;5&quot;</span><br></code></pre></td></tr></table></figure><p>SDIFF    å·®é›†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; sdiff p j<br>1) <span class="hljs-string">&quot;3&quot;</span><br>2) <span class="hljs-string">&quot;4&quot;</span><br>127.0.0.1:6380&gt; sdiff j p<br>1) <span class="hljs-string">&quot;8&quot;</span><br>2) <span class="hljs-string">&quot;9&quot;</span><br>3) <span class="hljs-string">&quot;12&quot;</span><br><span class="hljs-comment"># å·¦å¹¶è”</span><br></code></pre></td></tr></table></figure><p>SUNION æ±‚key1 key2 çš„å¹¶é›†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; sunion p j<br>1) <span class="hljs-string">&quot;2&quot;</span><br>2) <span class="hljs-string">&quot;3&quot;</span><br>3) <span class="hljs-string">&quot;4&quot;</span><br>4) <span class="hljs-string">&quot;5&quot;</span><br>5) <span class="hljs-string">&quot;8&quot;</span><br>6) <span class="hljs-string">&quot;9&quot;</span><br>7) <span class="hljs-string">&quot;12&quot;</span><br></code></pre></td></tr></table></figure><h2 id="Sortedset-æœ‰åºé›†åˆ"><a href="#Sortedset-æœ‰åºé›†åˆ" class="headerlink" title="Sortedset æœ‰åºé›†åˆ"></a>Sortedset æœ‰åºé›†åˆ</h2><p>ZADD  key score member è®¾ç½®æƒé‡å¹¶æ·»åŠ æˆå‘˜</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; zadd r 24 48<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6380&gt; zadd r 17 56 19 62 4 77<br></code></pre></td></tr></table></figure><p>ZREM key member</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; zrem r 48<br>(<span class="hljs-built_in">integer</span>) 1<br></code></pre></td></tr></table></figure><p>ZSCORE key member  è·å–æˆå‘˜æƒé‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; zscore r 77<br><span class="hljs-string">&quot;4&quot;</span><br></code></pre></td></tr></table></figure><p>ZRANK key member è·å–æˆå‘˜åºå· </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; zrank r 62<br>(<span class="hljs-built_in">integer</span>) 3<br></code></pre></td></tr></table></figure><p>ZCARD key è·å–å…ƒç´ ä¸ªæ•°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; zcard r<br>(<span class="hljs-built_in">integer</span>) 4<br></code></pre></td></tr></table></figure><p>ZCOUNT key min max æ ¹æ®æƒé‡è·å–æ•°æ®çš„ä¸ªæ•°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; zcard r<br>(<span class="hljs-built_in">integer</span>) 4<br></code></pre></td></tr></table></figure><p>ZINCRBY  æ ¹æ®æˆå‘˜ï¼Œå‘å…¶æƒé‡è‡ªå¢ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; zincrby r 2 62<br><span class="hljs-string">&quot;21&quot;</span><br></code></pre></td></tr></table></figure><p>ZRANGE  æ ¹æ®æ’åºç­›é€‰èŒƒå›´å†…çš„å€¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; zrange r 2 90<br>1) <span class="hljs-string">&quot;36&quot;</span><br>2) <span class="hljs-string">&quot;56&quot;</span><br>3) <span class="hljs-string">&quot;62&quot;</span><br><br></code></pre></td></tr></table></figure><p>ZRANGEBYSCOREæ ¹æ®æƒé‡ç­›é€‰èŒƒå›´å†…çš„å€¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; zrangebyscore r 2 90<br>1) <span class="hljs-string">&quot;52&quot;</span><br>2) <span class="hljs-string">&quot;77&quot;</span><br>3) <span class="hljs-string">&quot;36&quot;</span><br>4) <span class="hljs-string">&quot;56&quot;</span><br>5) <span class="hljs-string">&quot;62&quot;</span><br></code></pre></td></tr></table></figure><p>ZDIFF å–å¤šä¸ªæœ‰åºé›†åˆçš„å·®é›†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; zdiff 2 s r<br>1) <span class="hljs-string">&quot;82&quot;</span><br>2) <span class="hljs-string">&quot;63&quot;</span><br>3) <span class="hljs-string">&quot;48&quot;</span><br></code></pre></td></tr></table></figure><p>ZINTER å–å¤šä¸ªæœ‰åºé›†åˆçš„äº¤é›†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; zinter 3 s r t<br>1) <span class="hljs-string">&quot;56&quot;</span><br></code></pre></td></tr></table></figure><p>ZUNION å–å¤šä¸ªæœ‰åºé›†åˆçš„å¹¶é›†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6380&gt; zunion 3 s r t<br>1) <span class="hljs-string">&quot;52&quot;</span><br>2) <span class="hljs-string">&quot;76&quot;</span><br>3) <span class="hljs-string">&quot;77&quot;</span><br>4) <span class="hljs-string">&quot;36&quot;</span><br>5) <span class="hljs-string">&quot;82&quot;</span><br>6) <span class="hljs-string">&quot;62&quot;</span><br>7) <span class="hljs-string">&quot;63&quot;</span><br>8) <span class="hljs-string">&quot;48&quot;</span><br>9) <span class="hljs-string">&quot;56&quot;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
      <tag>ä¸­é—´ä»¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Shell VIII è§‚æµ‹</title>
    <link href="/2025/04/09/Shell-VIII-%E8%A7%82%E6%B5%8B/"/>
    <url>/2025/04/09/Shell-VIII-%E8%A7%82%E6%B5%8B/</url>
    
    <content type="html"><![CDATA[<p>ç•™å‘ perfå’Œebpf</p>]]></content>
    
    
    <categories>
      
      <category>Shell</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Shell VII VIM</title>
    <link href="/2025/04/09/Shell-VII-VIM/"/>
    <url>/2025/04/09/Shell-VII-VIM/</url>
    
    <content type="html"><![CDATA[<h1 id="Shell-VII-VIM-md"><a href="#Shell-VII-VIM-md" class="headerlink" title="Shell-VII-VIM.md"></a>Shell-VII-VIM.md</h1><h1 id="VIM"><a href="#VIM" class="headerlink" title="VIM"></a>VIM</h1><p><strong>Vim</strong> æ˜¯ä¸€ä¸ªé«˜åº¦å¯å®šåˆ¶çš„ <strong>æ–‡æœ¬ç¼–è¾‘å™¨</strong></p><h1 id="å¯åŠ¨ä¸é€€å‡º"><a href="#å¯åŠ¨ä¸é€€å‡º" class="headerlink" title="å¯åŠ¨ä¸é€€å‡º"></a>å¯åŠ¨ä¸é€€å‡º</h1><h2 id="VIMæ”¯æŒä¸‰ç§æ¨¡å¼-ï¼š"><a href="#VIMæ”¯æŒä¸‰ç§æ¨¡å¼-ï¼š" class="headerlink" title="VIMæ”¯æŒä¸‰ç§æ¨¡å¼ ï¼š"></a>VIMæ”¯æŒä¸‰ç§æ¨¡å¼ ï¼š</h2><ul><li>**æ™®é€šæ¨¡å¼ (Normal)**ï¼šé»˜è®¤æ¨¡å¼ï¼Œç”¨äºæµè§ˆå’Œæ“ä½œæ–‡æœ¬ã€‚</li><li>**æ’å…¥æ¨¡å¼ (Insert)**ï¼šè¾“å…¥æ–‡æœ¬ï¼ŒæŒ‰ <code>i</code> è¿›å…¥ã€‚</li><li>**å‘½ä»¤æ¨¡å¼ (Command-line)**ï¼šè¾“å…¥å†’å· <code>:</code> å‘½ä»¤ã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash<br>å¤åˆ¶ç¼–è¾‘<br>vim filename        <span class="hljs-comment"># æ‰“å¼€æ–‡ä»¶</span><br>vim +n filename     <span class="hljs-comment"># æ‰“å¼€æ–‡ä»¶å¹¶è·³è½¬åˆ°ç¬¬nè¡Œ</span><br><br><span class="hljs-comment"># é€€å‡º:</span><br><span class="hljs-comment">#- `:q`ï¼šé€€å‡º</span><br><span class="hljs-comment">#- `:q!`ï¼šå¼ºåˆ¶é€€å‡ºä¸ä¿å­˜</span><br><span class="hljs-comment">#- `:w`ï¼šä¿å­˜</span><br><span class="hljs-comment">#- `:wq` æˆ– `ZZ`ï¼šä¿å­˜å¹¶é€€å‡º</span><br><span class="hljs-comment">#- `:x`ï¼šä¸ `:wq` ç›¸åŒ</span><br><span class="hljs-comment">#- `:e!`ï¼šæ”¾å¼ƒä¿®æ”¹å¹¶é‡æ–°åŠ è½½</span><br></code></pre></td></tr></table></figure><h1 id="ç§»åŠ¨"><a href="#ç§»åŠ¨" class="headerlink" title="ç§»åŠ¨"></a>ç§»åŠ¨</h1><h3 id="1-åŸºæœ¬ç§»åŠ¨"><a href="#1-åŸºæœ¬ç§»åŠ¨" class="headerlink" title="1. åŸºæœ¬ç§»åŠ¨"></a>1. åŸºæœ¬ç§»åŠ¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">`h`ï¼šå·¦ï¼Œ`l`ï¼šå³ï¼Œ`j`ï¼šä¸‹ï¼Œ`k`ï¼šä¸Š<br>`0`ï¼šè¡Œé¦–ï¼Œ`^`ï¼šé¦–ä¸ªéç©ºå­—ç¬¦ï¼Œ`$`ï¼šè¡Œå°¾<br>`w`ï¼šä¸‹ä¸€ä¸ªè¯ï¼Œ`b`ï¼šå‰ä¸€ä¸ªè¯ï¼Œ`e`ï¼šè¯å°¾<br></code></pre></td></tr></table></figure><h3 id="2-é«˜é€Ÿç§»åŠ¨"><a href="#2-é«˜é€Ÿç§»åŠ¨" class="headerlink" title="2. é«˜é€Ÿç§»åŠ¨"></a>2. é«˜é€Ÿç§»åŠ¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">`gg`ï¼šè·³è½¬åˆ°æ–‡ä»¶å¼€å¤´<br>`G`ï¼šè·³è½¬åˆ°æ–‡ä»¶æœ«å°¾<br>`nG`ï¼šè·³åˆ°ç¬¬ n è¡Œ<br>`H`/`M`/`L`ï¼šå±å¹•é¡¶éƒ¨/ä¸­éƒ¨/åº•éƒ¨<br>`Ctrl-d`/`Ctrl-u`ï¼šå‘ä¸‹/å‘ä¸Šæ»šåŠ¨åŠé¡µ<br>`%`ï¼šåŒ¹é…æ‹¬å·è·³è½¬<br></code></pre></td></tr></table></figure><h1 id="æ’å…¥ä¸åˆ é™¤"><a href="#æ’å…¥ä¸åˆ é™¤" class="headerlink" title="æ’å…¥ä¸åˆ é™¤"></a>æ’å…¥ä¸åˆ é™¤</h1><h3 id="æ’å…¥"><a href="#æ’å…¥" class="headerlink" title="æ’å…¥"></a>æ’å…¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">`i`ï¼šå½“å‰å­—ç¬¦å‰<br>`I`ï¼šè¡Œé¦–<br>`a`ï¼šå½“å‰å­—ç¬¦å<br>`A`ï¼šè¡Œå°¾<br>`o`ï¼šå½“å‰è¡Œä¸‹æ–¹æ–°å¼€ä¸€è¡Œ<br>`O`ï¼šå½“å‰è¡Œä¸Šæ–¹æ–°å¼€ä¸€è¡Œ<br></code></pre></td></tr></table></figure><h3 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">`x`ï¼šåˆ é™¤å½“å‰å­—ç¬¦<br>`<span class="hljs-built_in">dd</span>`ï¼šåˆ é™¤å½“å‰è¡Œ<br>`dw`ï¼šåˆ é™¤ä¸€ä¸ªè¯<br>`d$`ï¼šåˆ é™¤è‡³è¡Œå°¾<br>`d0`ï¼šåˆ é™¤è‡³è¡Œé¦–<br></code></pre></td></tr></table></figure><h1 id="å¤åˆ¶ã€ç²˜è´´ã€æ’¤é”€"><a href="#å¤åˆ¶ã€ç²˜è´´ã€æ’¤é”€" class="headerlink" title="å¤åˆ¶ã€ç²˜è´´ã€æ’¤é”€"></a>å¤åˆ¶ã€ç²˜è´´ã€æ’¤é”€</h1><h3 id="å¤åˆ¶ï¼ˆYankï¼‰"><a href="#å¤åˆ¶ï¼ˆYankï¼‰" class="headerlink" title="å¤åˆ¶ï¼ˆYankï¼‰"></a>å¤åˆ¶ï¼ˆYankï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">`yy`ï¼šå¤åˆ¶å½“å‰è¡Œ<br>`yw`ï¼šå¤åˆ¶ä¸€ä¸ªè¯<br>`y$`ï¼šå¤åˆ¶è‡³è¡Œå°¾<br>`v`ï¼šè¿›å…¥å¯è§†æ¨¡å¼ï¼Œé€‰æ‹©å `y`<br></code></pre></td></tr></table></figure><h3 id="ç²˜è´´"><a href="#ç²˜è´´" class="headerlink" title="ç²˜è´´"></a>ç²˜è´´</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">`p` ï¼šç²˜è´´<br></code></pre></td></tr></table></figure><h3 id="æ’¤é”€ä¸é‡åš"><a href="#æ’¤é”€ä¸é‡åš" class="headerlink" title="æ’¤é”€ä¸é‡åš"></a>æ’¤é”€ä¸é‡åš</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">`u`ï¼šæ’¤é”€<br>`Ctrl-r`ï¼šé‡åš<br></code></pre></td></tr></table></figure><h1 id="æŸ¥æ‰¾ä¸æ›¿æ¢"><a href="#æŸ¥æ‰¾ä¸æ›¿æ¢" class="headerlink" title="æŸ¥æ‰¾ä¸æ›¿æ¢"></a>æŸ¥æ‰¾ä¸æ›¿æ¢</h1><h3 id="æŸ¥æ‰¾"><a href="#æŸ¥æ‰¾" class="headerlink" title="æŸ¥æ‰¾"></a>æŸ¥æ‰¾</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">`/pattern`ï¼šå‘ä¸‹æŸ¥æ‰¾<br>`?pattern`ï¼šå‘ä¸ŠæŸ¥æ‰¾<br>`n`/`N`ï¼šä¸‹ä¸€ä¸ª/ä¸Šä¸€ä¸ªåŒ¹é…<br></code></pre></td></tr></table></figure><h3 id="æ›¿æ¢"><a href="#æ›¿æ¢" class="headerlink" title="æ›¿æ¢"></a>æ›¿æ¢</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs elixir">vim<br>å¤åˆ¶ç¼–è¾‘<br><span class="hljs-symbol">:%s/old/new/g</span>        <span class="hljs-comment"># æ›¿æ¢æ•´ç¯‡æ–‡ä»¶ä¸­æ‰€æœ‰åŒ¹é…</span><br><span class="hljs-symbol">:</span><span class="hljs-number">1</span>,<span class="hljs-number">10</span>s/old/new/g     <span class="hljs-comment"># æ›¿æ¢ç¬¬1è‡³10è¡Œ</span><br><span class="hljs-symbol">:%s/old/new/gc</span>       <span class="hljs-comment"># æ›¿æ¢å‰ç¡®è®¤</span><br><br></code></pre></td></tr></table></figure><h1 id="çª—å£ä¸æ ‡ç­¾é¡µ"><a href="#çª—å£ä¸æ ‡ç­¾é¡µ" class="headerlink" title="çª—å£ä¸æ ‡ç­¾é¡µ"></a>çª—å£ä¸æ ‡ç­¾é¡µ</h1><h3 id="åˆ†å±"><a href="#åˆ†å±" class="headerlink" title="åˆ†å±"></a>åˆ†å±</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">`:<span class="hljs-built_in">split</span>` æˆ– `:sp`ï¼šæ°´å¹³åˆ†å±<br>`:vsplit` æˆ– `:vsp`ï¼šå‚ç›´åˆ†å±<br>`Ctrl-w w`ï¼šåœ¨çª—å£é—´åˆ‡æ¢<br>`Ctrl-w h/j/k/l`ï¼šæ–¹å‘åˆ‡æ¢<br>`Ctrl-w q`ï¼šå…³é—­å½“å‰çª—å£<br></code></pre></td></tr></table></figure><h3 id="æ ‡ç­¾é¡µ"><a href="#æ ‡ç­¾é¡µ" class="headerlink" title="æ ‡ç­¾é¡µ"></a>æ ‡ç­¾é¡µ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">`:tabnew filename`ï¼šæ–°å»ºæ ‡ç­¾é¡µ<br>`:tabn` / `:tabp`ï¼šä¸‹ä¸€ä¸ª/ä¸Šä¸€ä¸ªæ ‡ç­¾é¡µ<br>`gt` / `gT`ï¼šæ ‡ç­¾é¡µåˆ‡æ¢<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Shell</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Shell VI Shellç¼–ç¨‹</title>
    <link href="/2025/04/09/Shell-VI-Shell%E7%BC%96%E7%A8%8B/"/>
    <url>/2025/04/09/Shell-VI-Shell%E7%BC%96%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="Shell-VI-Shellç¼–ç¨‹-md"><a href="#Shell-VI-Shellç¼–ç¨‹-md" class="headerlink" title="Shell-VI-Shellç¼–ç¨‹.md"></a>Shell-VI-Shellç¼–ç¨‹.md</h1><h1 id="ä»€ä¹ˆæ˜¯Shellç¼–ç¨‹ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Shellç¼–ç¨‹ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Shellç¼–ç¨‹ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯Shellç¼–ç¨‹ï¼Ÿ</h1><p>Shell ç¼–ç¨‹æ˜¯ä¸€ç§åŸºäº Shell è§£é‡Šå™¨è¯­æ³•è§„åˆ™ï¼Œç»“åˆç¯å¢ƒå˜é‡å’Œå‘½ä»¤è¡Œå‚æ•°ï¼Œé€šè¿‡ç»„ç»‡å’Œæ§åˆ¶ç³»ç»Ÿå‘½ä»¤ä»¥å®ç°è‡ªåŠ¨åŒ–ä»»åŠ¡ä¸è¿›ç¨‹ç®¡ç†çš„è„šæœ¬è¯­è¨€ã€‚</p><h1 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h1><h3 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h3><p>çˆ¶è¿›ç¨‹çš„å˜é‡åœ¨å­è¿›ç¨‹ä¸­ä¸å¯è§ï¼Œéœ€è¦ä½¿ç”¨exportå£°æ˜éœ€è¦çš„å˜é‡æˆ–è€…ä½¿ç”¨ . <a href="http://child.sh/">child.sh</a> æ‰§è¡Œ</p><p>shellä¸­å£°æ˜å˜é‡èµ‹å€¼å˜é‡åå¿…é¡»ä¸¥æ ¼ç´§è´´èµ‹å€¼ç¬¦åˆâ€œ&#x3D;â€</p><h2 id="åŸºç¡€å˜é‡"><a href="#åŸºç¡€å˜é‡" class="headerlink" title="åŸºç¡€å˜é‡"></a>åŸºç¡€å˜é‡</h2><p>Shell(bash)æœ¬èº«æä¾›äº†ä¸€äº›åŸºç¡€å˜é‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">$?                      <span class="hljs-comment">#å‚¨å­˜äº†ä¸Šä¸€æ¬¡çš„æ‰§è¡Œç»“æœï¼Œç”¨äºå¯¹æ­¥éª¤æ‰§è¡Œç»“æœçš„åˆ¤æ–­</span><br><span class="hljs-variable">$1</span>-<span class="hljs-variable">$9</span>                   <span class="hljs-comment">#å‚¨å­˜äº†ä¼ å…¥çš„ä½ç½®å‚æ•°</span><br><span class="hljs-variable">$#</span>                      <span class="hljs-comment">#ä¼ é€’çš„å‚æ•°ä¸ªæ•°</span><br><span class="hljs-variable">$@</span>                      <span class="hljs-comment">#ä¼ é€’çš„æ‰€æœ‰å‚æ•°</span><br>$*                      <span class="hljs-comment">#ä¼ é€’çš„æ‰€æœ‰å‚æ•° ï¼Œä½œä¸ºä¸€ä¸ªæ•´ä½“</span><br>$$                      <span class="hljs-comment">#è¿›ç¨‹çš„pid</span><br>$!                      <span class="hljs-comment">#ä¸Šä¸€ä¸ªåå°å‘½ä»¤çš„pid</span><br><span class="hljs-variable">$_</span>                      <span class="hljs-comment">#ä¸Šä¸€ä¸ªå‘½ä»¤çš„æœ€åä¸€ä¸ªå‚æ•°</span><br><span class="hljs-variable">$IFS</span>                  <span class="hljs-comment">#è¾“å…¥å­—æ®µåˆ†éš”ç¬¦ï¼ˆé»˜è®¤æ˜¯ç©ºæ ¼ã€Tabã€æ¢è¡Œï¼‰</span><br><span class="hljs-variable">$RANDOM</span>                <span class="hljs-comment">#ç”Ÿæˆä¸€ä¸ª0~32767 çš„éšæœºæ•°</span><br><span class="hljs-variable">$LINENO</span>                 <span class="hljs-comment">#å½“å‰è„šæœ¬ä¸­çš„è¡Œå·</span><br><span class="hljs-variable">$UID</span> / <span class="hljs-variable">$EUID</span>          <span class="hljs-comment">#å½“å‰ç”¨æˆ·çš„ UIDï¼ˆçœŸå®/æœ‰æ•ˆï¼‰</span><br><span class="hljs-variable">$PWD</span>                  <span class="hljs-comment">#å½“å‰ç›®å½•</span><br><span class="hljs-variable">$HOME</span>                  <span class="hljs-comment">#å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•</span><br><span class="hljs-variable">$PATH</span>                  <span class="hljs-comment">#ç³»ç»ŸæŸ¥æ‰¾å‘½ä»¤çš„è·¯å¾„åˆ—è¡¨</span><br><span class="hljs-variable">$SHELL</span>                <span class="hljs-comment">#å½“å‰é»˜è®¤çš„ shell è·¯å¾„</span><br></code></pre></td></tr></table></figure><p>é€šè¿‡ä½¿ç”¨ä¸Šè¿°çš„å˜é‡ï¼Œç¼–å†™ç¬¬ä¸€ä¸ªshellè„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#! /bin/bash</span><br><span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;Give me a name: &quot;</span> name<br><span class="hljs-built_in">echo</span> hello <span class="hljs-variable">$name</span><br><span class="hljs-built_in">echo</span> your home path is <span class="hljs-variable">$HOME</span><br><span class="hljs-built_in">echo</span> current <span class="hljs-built_in">dir</span> is <span class="hljs-variable">$PWD</span><br><br>Give me a name: Codfish<br>hello Codfish<br>your home path is /root<br>current <span class="hljs-built_in">dir</span> is /home/codfish/my_bash<br></code></pre></td></tr></table></figure><h2 id="å˜é‡-1"><a href="#å˜é‡-1" class="headerlink" title="å˜é‡"></a>å˜é‡</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">name=<span class="hljs-string">&quot;Alice&quot;</span>              <span class="hljs-comment"># æ™®é€šå˜é‡ï¼ˆé»˜è®¤æ˜¯å­—ç¬¦ä¸²ï¼‰</span><br><span class="hljs-built_in">declare</span> -i age=18         <span class="hljs-comment"># æ•´æ•°å˜é‡</span><br><span class="hljs-built_in">readonly</span> pi=3.14          <span class="hljs-comment"># åªè¯»å˜é‡</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:/new    <span class="hljs-comment"># ç¯å¢ƒå˜é‡</span><br>arr=(apple banana cherry) <span class="hljs-comment"># æ•°ç»„å˜é‡</span><br><span class="hljs-built_in">declare</span> -A user           <span class="hljs-comment"># å…³è”æ•°ç»„ï¼ˆBash 4+ï¼‰</span><br>user[<span class="hljs-built_in">id</span>]=001<br></code></pre></td></tr></table></figure><h1 id="å¼•ç”¨å’Œæ‰§è¡Œ"><a href="#å¼•ç”¨å’Œæ‰§è¡Œ" class="headerlink" title="å¼•ç”¨å’Œæ‰§è¡Œ"></a>å¼•ç”¨å’Œæ‰§è¡Œ</h1><h2 id="â€™â€™ï¼Œâ€â€œï¼Œä»¥åŠ"><a href="#â€™â€™ï¼Œâ€â€œï¼Œä»¥åŠ" class="headerlink" title="&#96;&#96; ,â€™â€™ï¼Œâ€â€œï¼Œä»¥åŠ$(())"></a>&#96;&#96; ,â€™â€™ï¼Œâ€â€œï¼Œä»¥åŠ$(())</h2><p>ä»¥ä¸Šéƒ½å¯ä»¥ä½œä¸ºå­—ç¬¦ä¸²å‘shellè„šæœ¬ä¸­çš„å˜é‡èµ‹å€¼ã€‚</p><p>åå¼•å· <code>  </code>   ï¼š è·å–å‘½ä»¤æ‰§è¡Œåçš„ç»“æœä½œä¸ºå˜é‡çš„å€¼(è¿‡æ—¶)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">hi=<span class="hljs-string">&quot;hello&quot;</span><br>hi1=`<span class="hljs-built_in">echo</span> hello`<br><br>result : hello<br></code></pre></td></tr></table></figure><p>å•å¼•å·â€˜â€™ ï¼š è¾“å‡ºå­—ç¬¦ä¸²ï¼Œå®Œå…¨ä¸è§£æ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>hi2=<span class="hljs-string">&#x27;echo $hi&#x27;</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$hi2</span><br><br>result : <span class="hljs-built_in">echo</span> <span class="hljs-variable">$hi1</span><br></code></pre></td></tr></table></figure><p>åŒå¼•å·â€˜â€™ ï¼š è¾“å‡ºå«å˜é‡ç©ºæ ¼ä¿¡æ¯ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">hi3=<span class="hljs-string">&quot;echo <span class="hljs-variable">$hi</span>&quot;</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$hi3</span><br><br>result : <span class="hljs-built_in">echo</span> hello<br></code></pre></td></tr></table></figure><p>$()â€™ ï¼š è·å–å‘½ä»¤æ‰§è¡Œåçš„ç»“æœä½œä¸ºå˜é‡çš„å€¼,æ”¯æŒåµŒå¥—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">hi4=$(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$hi</span>)<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$hi4</span><br><br>result : hello<br></code></pre></td></tr></table></figure><h1 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h1><p>ç®—æœ¯è¿ç®—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">+   <span class="hljs-comment">#åŠ æ³•</span><br>-   <span class="hljs-comment">#å‡æ³•</span><br>*    <span class="hljs-comment">#ä¹˜æ³•</span><br>/    <span class="hljs-comment">#é™¤æ³•ï¼ˆæ•´æ•°é™¤æ³•ï¼‰</span><br>%   <span class="hljs-comment">#å–ä½™</span><br>++ <span class="hljs-comment">#è‡ªå¢ï¼ˆå‰/åéƒ½æ”¯æŒï¼‰</span><br>-- <span class="hljs-comment">#è‡ªå‡</span><br>** <span class="hljs-comment">#å¹‚è¿ç®—ï¼ˆBash 4.0+ æ”¯æŒï¼‰</span><br></code></pre></td></tr></table></figure><p>æ•´æ•°æ¯”è¾ƒè¿ç®—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">-eq <span class="hljs-comment">#ç­‰äº</span><br>-ne <span class="hljs-comment">#ä¸ç­‰äº</span><br>-gt  <span class="hljs-comment">#å¤§äº</span><br>-lt <span class="hljs-comment">#å°äº</span><br>-ge <span class="hljs-comment">#å¤§äºç­‰äº</span><br>-le <span class="hljs-comment">#å°äºç­‰äº</span><br></code></pre></td></tr></table></figure><p>å­—ç¬¦æ¯”è¾ƒè¿ç®—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">= æˆ– == <span class="hljs-comment">#å­—ç¬¦ä¸²ç›¸ç­‰</span><br>!=     <span class="hljs-comment">#å­—ç¬¦ä¸²ä¸ç­‰</span><br>&lt;       <span class="hljs-comment">#å­—å…¸åºå°äºï¼ˆä»… [[ ]]ï¼‰</span><br>&gt;       <span class="hljs-comment">#å­—å…¸åºå¤§äºï¼ˆä»… [[ ]]ï¼‰</span><br>-z     <span class="hljs-comment">#å­—ç¬¦ä¸²ä¸ºç©º</span><br>-n     <span class="hljs-comment">#å­—ç¬¦ä¸²éç©º</span><br></code></pre></td></tr></table></figure><p>é€»è¾‘è¿ç®—ç¬¦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">ç”¨äº []<br>-a    <span class="hljs-comment">#ANDï¼ˆä¸ï¼‰</span><br>-o    <span class="hljs-comment">#ORï¼ˆæˆ–ï¼‰</span><br>ç”¨äº [[]] æˆ–(())<br>&amp;&amp;    <span class="hljs-comment">#ä¸</span><br>`<br>!      <span class="hljs-comment">#éï¼ˆå–åï¼‰</span><br></code></pre></td></tr></table></figure><p>æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">-e            <span class="hljs-comment">#æ–‡ä»¶å­˜åœ¨</span><br>-f            <span class="hljs-comment">#æ˜¯æ™®é€šæ–‡ä»¶</span><br>-d            <span class="hljs-comment">#æ˜¯ç›®å½•</span><br>-L            <span class="hljs-comment">#æ˜¯ç¬¦å·é“¾æ¥</span><br>-r            <span class="hljs-comment">#æœ‰è¯»æƒé™</span><br>-w            <span class="hljs-comment">#æœ‰å†™æƒé™</span><br>-x            <span class="hljs-comment">#æœ‰æ‰§è¡Œæƒé™</span><br>-s            <span class="hljs-comment">#æ–‡ä»¶éç©º</span><br>file1 -nt file2<span class="hljs-comment">#file1 æ¯” file2 æ–°</span><br>file1 -ot file2<span class="hljs-comment">#file1 æ¯” file2 æ—§</span><br></code></pre></td></tr></table></figure><p>ä½è¿ç®—ç¬¦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">&amp;             <span class="hljs-comment">#æŒ‰ä½ä¸</span><br>^             <span class="hljs-comment">#æŒ‰ä½å¼‚æˆ–</span><br>~             <span class="hljs-comment">#æŒ‰ä½å–å</span><br>&lt;&lt;           <span class="hljs-comment">#å·¦ç§»</span><br>&gt;&gt;           <span class="hljs-comment">#å³ç§»</span><br></code></pre></td></tr></table></figure><p>èµ‹å€¼è¿ç®—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">=             <span class="hljs-comment">#èµ‹å€¼</span><br>+=           <span class="hljs-comment">#åŠ åèµ‹å€¼</span><br>-=           <span class="hljs-comment">#å‡åèµ‹å€¼</span><br>*=           <span class="hljs-comment">#ä¹˜åèµ‹å€¼</span><br>/=           <span class="hljs-comment">#é™¤åèµ‹å€¼</span><br>%=           <span class="hljs-comment">#å–ä½™åèµ‹å€¼</span><br>&lt;&lt;=           <span class="hljs-comment">#å·¦ç§»åèµ‹å€¼</span><br>&gt;&gt;=           <span class="hljs-comment">#å³ç§»åèµ‹å€¼</span><br>&amp;=           <span class="hljs-comment">#ä½ä¸èµ‹å€¼</span><br>^=           <span class="hljs-comment">#ä½å¼‚æˆ–èµ‹å€¼</span><br></code></pre></td></tr></table></figure><table><thead><tr><th><strong>æ•´æ•°åˆ¤æ–­&#x2F;è¿ç®—</strong></th><th><code>(( ))</code></th></tr></thead><tbody><tr><td><strong>å­—ç¬¦ä¸²åˆ¤æ–­</strong></td><td><code>[[ ]]</code> ï¼ˆæˆ– <code>[ ]</code>ï¼‰</td></tr><tr><td><strong>æ–‡ä»¶æµ‹è¯•</strong></td><td><code>[ ]</code></td></tr><tr><td><strong>ç»„åˆæ¡ä»¶ï¼ˆé€»è¾‘ä¸æˆ–ï¼‰</strong></td><td><code>[[ ]]</code></td></tr></tbody></table><h1 id="å¾ªç¯æ§åˆ¶"><a href="#å¾ªç¯æ§åˆ¶" class="headerlink" title="å¾ªç¯æ§åˆ¶"></a>å¾ªç¯æ§åˆ¶</h1><h2 id="tips-1"><a href="#tips-1" class="headerlink" title="tips"></a>tips</h2><p>å˜é‡ä¸èƒ½ç´§è´´åˆ¤æ–­ç¬¦å·[ ]</p><h2 id="åˆ¤æ–­è¯­å¥"><a href="#åˆ¤æ–­è¯­å¥" class="headerlink" title="åˆ¤æ–­è¯­å¥"></a>åˆ¤æ–­è¯­å¥</h2><h3 id="if-è¯­å¥"><a href="#if-è¯­å¥" class="headerlink" title="if è¯­å¥"></a>if è¯­å¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">if</span> [ condition1 ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-comment"># condition1ä¸ºçœŸæ‰§è¡Œ</span><br><span class="hljs-keyword">elif</span> [condition2]; <span class="hljs-keyword">then</span><br><span class="hljs-comment"># condition2ä¸ºçœŸæ‰§è¡Œ</span><br><span class="hljs-keyword">else</span><br><span class="hljs-comment"># æ¡ä»¶å‡ä¸æ»¡è¶³æ—¶æ‰§è¡Œ</span><br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><h3 id="switchè¯­å¥"><a href="#switchè¯­å¥" class="headerlink" title="switchè¯­å¥"></a>switchè¯­å¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">case</span> $å˜é‡ <span class="hljs-keyword">in</span><br>    æ¨¡å¼1)<br>        å‘½ä»¤1<br>        ;;<br>    æ¨¡å¼2)<br>        å‘½ä»¤2<br>        ;;<br>    *)<br>        é»˜è®¤å‘½ä»¤<br>        ;;<br><span class="hljs-keyword">esac</span><br></code></pre></td></tr></table></figure><h2 id="å¾ªç¯è¯­å¥"><a href="#å¾ªç¯è¯­å¥" class="headerlink" title="å¾ªç¯è¯­å¥"></a>å¾ªç¯è¯­å¥</h2><h3 id="forè¯­å¥"><a href="#forè¯­å¥" class="headerlink" title="forè¯­å¥"></a>forè¯­å¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> val1 val2 val3; <span class="hljs-keyword">do</span><br>    <span class="hljs-comment"># å¾ªç¯ä½“</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> ((i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">5</span>; i++)); <span class="hljs-keyword">do</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h3 id="whileè¯­å¥"><a href="#whileè¯­å¥" class="headerlink" title="whileè¯­å¥"></a>whileè¯­å¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">while</span> [ æ¡ä»¶ ]; <span class="hljs-keyword">do</span><br>    <span class="hljs-comment"># å¾ªç¯ä½“</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h3 id="untilè¯­å¥"><a href="#untilè¯­å¥" class="headerlink" title="untilè¯­å¥"></a>untilè¯­å¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">until</span> [ æ¡ä»¶ ]; <span class="hljs-keyword">do</span><br>    <span class="hljs-comment"># å¾ªç¯ä½“</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h3 id="break-ä¸­æ–­å¹¶è·³å‡ºå½“å‰å¾ªç¯"><a href="#break-ä¸­æ–­å¹¶è·³å‡ºå½“å‰å¾ªç¯" class="headerlink" title="break ä¸­æ–­å¹¶è·³å‡ºå½“å‰å¾ªç¯"></a>break ä¸­æ–­å¹¶è·³å‡ºå½“å‰å¾ªç¯</h3><h3 id="continue-è·³è¿‡æœ¬æ¬¡å¾ªç¯æ‰§è¡Œä¸‹ä¸€æ¬¡å¾ªç¯"><a href="#continue-è·³è¿‡æœ¬æ¬¡å¾ªç¯æ‰§è¡Œä¸‹ä¸€æ¬¡å¾ªç¯" class="headerlink" title="continue è·³è¿‡æœ¬æ¬¡å¾ªç¯æ‰§è¡Œä¸‹ä¸€æ¬¡å¾ªç¯"></a>continue è·³è¿‡æœ¬æ¬¡å¾ªç¯æ‰§è¡Œä¸‹ä¸€æ¬¡å¾ªç¯</h3><h1 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h1><h3 id="å‡½æ•°å£°æ˜"><a href="#å‡½æ•°å£°æ˜" class="headerlink" title="å‡½æ•°å£°æ˜"></a>å‡½æ•°å£°æ˜</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">function</span> myfunc &#123;<br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Hello from myfunc&quot;</span><br>&#125;<br><br></code></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-function"><span class="hljs-title">myfunc</span></span>() &#123;<br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Hello from myfunc&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å‚æ•°ä¼ å…¥"><a href="#å‚æ•°ä¼ å…¥" class="headerlink" title="å‚æ•°ä¼ å…¥"></a>å‚æ•°ä¼ å…¥</h3><blockquote><p>Shell å‡½æ•°ä¸éœ€è¦äº‹å…ˆå£°æ˜ç±»å‹ï¼Œè°ƒç”¨æ—¶ç›´æ¥ä»¥ç©ºæ ¼åˆ†éš”ä¼ é€’å‚æ•°ï¼Œå‡½æ•°å†…éƒ¨ç”¨ $1ã€$2 ç­‰æ–¹å¼è®¿é—®ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-function"><span class="hljs-title">greet</span></span>() &#123;<br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Hello, <span class="hljs-variable">$1</span>!&quot;</span><br>&#125;<br><br>greet <span class="hljs-string">&quot;Alice&quot;</span>  <span class="hljs-comment"># è¾“å‡ºï¼šHello, Alice!</span><br><br></code></pre></td></tr></table></figure><h3 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h3><p><code>return</code> ç”¨äºè¿”å›çŠ¶æ€ç ï¼ˆ0~255ï¼‰ï¼Œè€Œ <code>echo</code> ç”¨äºå°†å€¼è¾“å‡ºç»™å‘½ä»¤æ›¿æ¢ï¼ˆ<code>$(...)</code>ï¼‰æ¥æ¥æ”¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-function"><span class="hljs-title">check_even</span></span>() &#123;<br>    <span class="hljs-keyword">if</span> [ $(( <span class="hljs-variable">$1</span> % <span class="hljs-number">2</span> )) -eq 0 ]; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">return</span> 0<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">return</span> 1<br>    <span class="hljs-keyword">fi</span><br>&#125;<br><br>check_even 4<br><span class="hljs-built_in">echo</span> $?<br><span class="hljs-comment"># æˆ–è€… æ¥æ”¶echoçš„è¾“å‡º</span><br><span class="hljs-function"><span class="hljs-title">check_even2</span></span>() &#123;<br>    <span class="hljs-keyword">if</span> [ $(( <span class="hljs-variable">$1</span> % <span class="hljs-number">2</span> )) -eq 0 ]; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;even&quot;</span><br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;odd&quot;</span><br>    <span class="hljs-keyword">fi</span><br>&#125;<br><br>res=$(check_even2 5)<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$res</span><br><br></code></pre></td></tr></table></figure><h3 id="å±€éƒ¨å˜é‡"><a href="#å±€éƒ¨å˜é‡" class="headerlink" title="å±€éƒ¨å˜é‡"></a>å±€éƒ¨å˜é‡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å…è®¸å®šä¹‰å±€éƒ¨å˜é‡</span><br><span class="hljs-function"><span class="hljs-title">myfunc</span></span>() &#123;<br>    <span class="hljs-built_in">local</span> var=<span class="hljs-string">&quot;secret&quot;</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Inside: <span class="hljs-variable">$var</span>&quot;</span><br>&#125;<br>myfunc<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Outside: <span class="hljs-variable">$var</span>&quot;</span>   <span class="hljs-comment"># var ä¸å­˜åœ¨</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Shell</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Shell V grep sed awk</title>
    <link href="/2025/04/09/Shell-V-grep-sed-awk/"/>
    <url>/2025/04/09/Shell-V-grep-sed-awk/</url>
    
    <content type="html"><![CDATA[<h1 id="ç®¡é“"><a href="#ç®¡é“" class="headerlink" title="ç®¡é“"></a>ç®¡é“</h1><p>Shellä¸­ æä¾›äº†â€œ|â€ çš„ç®¡é“å®ç°ï¼Œæ¥å¸®åŠ©ç”¨æˆ·æ›´å¿«æ·çš„å¤„ç†è¿‡ç¨‹æµ</p><p>å½“è¿è¡Œ a | b | c åï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">Parent Process<br>â”œâ”€â”€ fork() --&gt; Child 1 runs `a`<br>â”‚    stdout --&gt; pipe1[1]<br>â”œâ”€â”€ fork() --&gt; Child 2 runs `b`<br>â”‚    stdin &lt;-- pipe1[0], stdout --&gt; pipe2[1]<br>â”œâ”€â”€ fork() --&gt; Child 3 runs `c`<br>     stdin &lt;-- pipe2[0]<br></code></pre></td></tr></table></figure><p>å½“aå‘½ä»¤åœ¨å‘bè¿›è¡Œè¾“å‡ºåï¼Œbå°±å·²ç»å¼€å§‹æ‰§è¡Œäº†ã€‚</p><p>é€šè¿‡ç®¡é“çš„è¿æ¥ï¼Œå¯ä»¥è®©æˆ‘ä»¬æ›´åŠ çµæ´»çš„è·å–ç›®æ ‡å€¼</p><h1 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h1><p>grep æ”¯æŒå…¨å±€çš„æ–‡æœ¬æŸ¥è¯¢å’Œæ£€ç´¢</p><p>grep æ”¯æŒå®šä¹‰æœç´¢å†…å®¹ + æ–‡ä»¶è¿›è¡Œç­›é€‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">grep <span class="hljs-string">&quot;partten&quot;</span>  file<br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥é€šè¿‡å…¶ä»–å‘½ä»¤å¾—åˆ°stdout ä½¿ç”¨ç®¡é“è¿›è¡Œæ£€ç´¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> file | grep <span class="hljs-string">&quot;partten&quot;</span><br></code></pre></td></tr></table></figure><p>å¸¸ç”¨çš„å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># -i  å¿½ç•¥æŸ¥è¯¢çš„å¤§å°å†™</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt | grep -i a<br>aAbBcCdDeEfF<br><span class="hljs-comment"># -o  åªè¿”å›åŒ¹é…è§„åˆ™çš„å€¼</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt | grep -o a<br>a<br><span class="hljs-comment"># -v  åå‘ç­›é€‰</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt | grep -v a<br>gG hH iI jJ kK lL<br>mM nN<br><span class="hljs-comment"># åŸºæœ¬æ­£åˆ™åŒ¹é…</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt | grep -G [A-Z]<br>aA bB cC dD eE fF<br>gG hH iI jJ kK lL<br>mM nN<br><span class="hljs-comment"># æ‰©å±•æ­£åˆ™åŒ¹é…</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt | grep -E [a-zA-Z]&#123;2&#125;<br>aA bB cC dD eE fF<br>gG hH iI jJ kK lL<br>mM nN<br><br></code></pre></td></tr></table></figure><h1 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h1><p>sed æ˜¯ä¸€ä¸ªæ–‡æœ¬æ›¿æ¢å·¥å…·</p><p>sedä¹Ÿå¯ä»¥è®¾ç½®è§„åˆ™ æ›¿æ¢æ–‡ä»¶å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ hello]# sed <span class="hljs-string">&quot;s/a/A/&quot;</span> hello.txt<br>AA bB cC dD eE fF<br>gG hH iI jJ kK lL<br>mM nN<br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥æ¥æ”¶stdoutï¼Œä¿®æ”¹æµä¸­çš„æ•°æ®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt  | sed  <span class="hljs-string">&#x27;s/a/A/&#x27;</span><br>AA bB cC dD eE fF<br>gG hH iI jJ kK lL<br>mM nN<br></code></pre></td></tr></table></figure><p>æ³¨æ„ç›´æ¥ä½¿ç”¨ sed è¿›è¡Œæ›¿æ¢å¹¶ä¸ä¼šä¿®æ”¹åŸæ–‡æœ¬å†…å®¹ï¼Œéœ€è¦ä¿®æ”¹æ–‡æœ¬å†…å®¹éœ€è¦åŠ â€-iâ€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-string">&#x27;[num]s/old/new/[g]&#x27;</span>  è¿›è¡Œå…¨å±€/æŸä¸€è¡Œæ›¿æ¢ <br><span class="hljs-string">&#x27;[num]d&#x27;</span>              ä¸æ˜¾ç¤º/åˆ é™¤æŸä¸€è¡Œ<br><span class="hljs-string">&#x27;[num][i|a]\[text]&#x27;</span>   åœ¨æŸè¡Œå‰/å è¿½åŠ æ–‡æœ¬<br><span class="hljs-string">&#x27;-n  &quot;[num],[num]p&quot;&#x27;</span>  æ‰“å°è¡ŒåŒºé—´æ–‡æœ¬<br><span class="hljs-string">&#x27;-e&#x27;</span>                  å¤šä¸ªæ‰§è¡Œæ–‡æœ¬è§„åˆ™      <br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#sed &#x27;s/old/new/&#x27;åªæ›¿æ¢æ¯è¡Œç¬¬ä¸€ä¸ªåŒ¹é…</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt  | sed  <span class="hljs-string">&#x27;s/a/A/&#x27;</span><br>AA bB cC dD eE fF<br>AA hH iI jJ kK lL<br>mM nN<br><span class="hljs-comment"># sed &#x27;s/old/new/g&#x27;æ›¿æ¢æ¯è¡Œæ‰€æœ‰åŒ¹é…</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt  | sed  <span class="hljs-string">&#x27;s/b/B/g&#x27;</span><br>aA BB cC dD eE fF<br>aA hH iI jJ kK lL<br>mM nN BB BBB<br><span class="hljs-comment"># sed &#x27;2s/old/new/&#x27;åªæ›¿æ¢ç¬¬3è¡Œçš„åŒ¹é…é¡¹</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt  | sed  <span class="hljs-string">&#x27;3s/b/B/g&#x27;</span><br>aA bB cC dD eE fF<br>aA hH iI jJ kK lL<br>mM nN BB BBB<br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt  | sed  <span class="hljs-string">&#x27;3s/b/B/&#x27;</span><br>aA bB cC dD eE fF<br>aA hH iI jJ kK lL<br>mM nN BB bbb<br><span class="hljs-comment"># sed &#x27;2d&#x27;åˆ é™¤ç¬¬2è¡Œ</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt  | sed  <span class="hljs-string">&#x27;2d&#x27;</span><br>aA bB cC dD eE fF<br>mM nN bB bbb<br><span class="hljs-comment"># sed &#x27;/^$/d&#x27;åˆ é™¤æ‰€æœ‰ç©ºè¡Œ</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt<br>aA bB cC dD eE fF<br><br>aA hH iI jJ kK lL<br>mM nN bB bbb<br><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt  | sed  <span class="hljs-string">&#x27;/^$/d&#x27;</span><br>aA bB cC dD eE fF<br>aA hH iI jJ kK lL<br>mM nN bB bbb<br><span class="hljs-comment">#sed -n &#x27;5p&#x27;åªè¾“å‡ºç¬¬3è¡Œ</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt  | sed  -n 3p<br>aA hH iI jJ kK lL<br><span class="hljs-comment">#sed -n &#x27;5,10p&#x27;è¾“å‡ºç¬¬1åˆ°3è¡Œ</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt  | sed  -n <span class="hljs-string">&#x27;1,3p&#x27;</span><br>aA bB cC dD eE fF<br><br>aA hH iI jJ kK lL<br><span class="hljs-comment"># sed &#x27;1i\This is a new line&#x27;åœ¨ç¬¬1è¡Œå‰æ’å…¥</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt  | sed  <span class="hljs-string">&#x27;1i\hello&#x27;</span><br>hello<br>aA bB cC dD eE fF<br><br>aA hH iI jJ kK lL<br>mM nN bB bbb<br><span class="hljs-comment">#sed &#x27;1a\This is after line 3&#x27;åœ¨ç¬¬1è¡Œåè¿½åŠ </span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt  | sed  <span class="hljs-string">&#x27;1a\hello&#x27;</span><br>aA bB cC dD eE fF<br>hello<br><br>aA hH iI jJ kK lL<br>mM nN bB bbb<br><span class="hljs-comment">#sed -e &#x27;1d&#x27; -e &#x27;s/foo/bar/g&#x27;åˆ é™¤ç¬¬1è¡Œå¹¶æ›¿æ¢æ‰€æœ‰ aAä¸º zZ</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cat</span> hello.txt  | sed  -e <span class="hljs-string">&#x27;1d&#x27;</span> -e  <span class="hljs-string">&#x27;s/aA/zZ/g&#x27;</span><br><br>zZ hH iI jJ kK lL<br>mM nN bB bbb<br><br></code></pre></td></tr></table></figure><h1 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h1><p>awkæ˜¯ä¸€ç§ ç”¨äºæ–‡æœ¬å¤„ç†çš„è„šæœ¬è¯­è¨€ï¼Œå®ƒæ¥æ”¶æ¯ä¸€è¡Œè¾“å…¥ï¼Œå¹¶æŒ‰è§„åˆ™åŒ¹é…ï¼Œæœ€ç»ˆæ‰“å°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">awk <span class="hljs-string">&#x27;pattern &#123; action &#125;&#x27;</span>  filename <br></code></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> filename | awk <span class="hljs-string">&#x27;pattern &#123;action&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>å˜é‡ ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$0</span>å½“å‰è¡Œå†…å®¹<br>$[num]ç¬¬numåˆ—ï¼ˆå­—æ®µï¼‰<br>NFå½“å‰è¡Œçš„å­—æ®µæ•°é‡<br>NRå½“å‰æ˜¯ç¬¬å‡ è¡Œ<br>FSè¾“å…¥å­—æ®µåˆ†éš”ç¬¦ï¼ˆé»˜è®¤æ˜¯ç©ºæ ¼ï¼‰<br>OFSè¾“å‡ºå­—æ®µåˆ†éš”ç¬¦ï¼ˆé»˜è®¤ä¹Ÿæ˜¯ç©ºæ ¼ï¼‰<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># awk å¯ä»¥åˆ†ä¸ºå¤šæ®µæ‰§è¡Œ</span><br>awk <span class="hljs-string">&#x27;BEGIN &#123;&#125; &#123;&#125;  END &#123;&#125;&#x27;</span><br><span class="hljs-comment"># BEGIN å¼€å§‹æ—¶æ‰§è¡Œä¸€æ¬¡çš„ä»£ç æ®µï¼Œ END ç»“æŸæ—¶æ‰§è¡Œä¸€æ¬¡çš„ä»£ç æ®µ</span><br><span class="hljs-comment"># è¡Œä¿¡æ¯æ”¾åœ¨å¤–é¢ï¼Œåˆ—ä¿¡æ¯åœ¨&#123;&#125;ä¸­æ“ä½œ</span><br><span class="hljs-comment"># &#x27;BEGIN&#x27;ï¼Œ&#x27;END&#x27; åªèƒ½è¿›è¡Œ åˆ†éš”ç¬¦å®šä¹‰ï¼Œå˜é‡èµ‹å€¼</span><br><span class="hljs-comment"># åœ¨ä¸­é—´&#123;&#125; å¤–é¢å¯ä»¥è®¾ç½® NR== å®šä¹‰è¡Œå·</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">æ‰“å°ç¬¬ä¹åˆ—<br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">ls</span> -l | awk <span class="hljs-string">&#x27;&#123;print $9&#125;&#x27;</span><br>a<br>ate<br>b<br>c<br>d<br>e<br>f<br>g<br>h<br>hello.txt<br>i<br>j<br>k<br>l<br>m<br>n<br>æ‰“å°ç¬¬ä¸€è¡Œ<br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">ls</span> -l | awk <span class="hljs-string">&#x27;NR==2&#123;print &#125;&#x27;</span><br>-rw-r--r-- 1 root root  0 Apr 10 13:58 a<br><br></code></pre></td></tr></table></figure><h1 id="æ··åˆæŸ¥è¯¢"><a href="#æ··åˆæŸ¥è¯¢" class="headerlink" title="æ··åˆæŸ¥è¯¢"></a>æ··åˆæŸ¥è¯¢</h1><p>æŸ¥è¯¢ä¸€ä¸‹redisçš„å®‰è£…æ—¶é—´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ ~]# ps -aux | grep -v <span class="hljs-string">&quot;grep&quot;</span> | grep redis | sed <span class="hljs-string">&#x27;s/redis/myredis/&#x27;</span> | grep -v <span class="hljs-string">&quot;sed&quot;</span> | awk <span class="hljs-string">&#x27;&#123;print $9&#125;&#x27;</span><br>Apr08<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Shell</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Shell IV ç½‘ç»œç›¸å…³å‘½ä»¤</title>
    <link href="/2025/04/09/Shell-IV-%E7%BD%91%E7%BB%9C%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4/"/>
    <url>/2025/04/09/Shell-IV-%E7%BD%91%E7%BB%9C%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="Shell-IV-ç½‘ç»œç›¸å…³å‘½ä»¤"><a href="#Shell-IV-ç½‘ç»œç›¸å…³å‘½ä»¤" class="headerlink" title="Shell-IV-ç½‘ç»œç›¸å…³å‘½ä»¤"></a>Shell-IV-ç½‘ç»œç›¸å…³å‘½ä»¤</h1><h1 id="ä»€ä¹ˆæ˜¯ç½‘ç»œï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ç½‘ç»œï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ç½‘ç»œï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ç½‘ç»œï¼Ÿ</h1><p>æ˜¯OSIçš„7å±‚æ¨¡å‹ï¼Ÿ è¿˜æ˜¯TCP&#x2F;IP åè®®ç°‡ï¼Ÿwifi&#x2F;ç§»åŠ¨é€šä¿¡çš„ç©ºå£äº’è”ï¼Ÿ åˆæˆ–è€…æ˜¯å†…æ ¸è¿›ç¨‹çš„è™šæ‹Ÿæ•°æ®è½¬å‘ï¼Ÿ</p><ul><li>ç½‘ç»œçš„æœ¬è´¨åŸºäºé¢„å®šä¹‰çš„é€šä¿¡åè®®é€šè¿‡ç‰©ç†ä»‹è´¨ï¼ˆæˆ–è™šæ‹Ÿç‰©ç†ä»‹è´¨å¦‚è™šæ‹Ÿç«¯å£ï¼Œè™šæ‹Ÿmacåœ°å€ï¼‰åœ¨è®¾å¤‡é—´è¿›è¡Œæ•°æ®ä¼ è¾“çš„ä¸€ç§ç»„ç»‡ç»“æ„ã€‚<ul><li>ç½‘ç»œæ˜¯â€œæœ‰å±‚æ¬¡â€çš„ï¼Œæ— è®ºæ˜¯å›ºç½‘é€šä¿¡è¿˜æ˜¯ç©ºå£é€šä¿¡ã€‚æ•°æ®åŒ…çš„ä¼ è¾“éƒ½åœ¨è¿›è¡Œä¸€ä¸ªâ€œå°è£…-è§£å°è£…â€çš„è¿‡ç¨‹</li><li>ç½‘ç»œæ˜¯â€œåŠ¨æ€â€çš„ï¼Œç«¯åˆ°ç«¯çš„ç½‘ç»œé€šä¿¡ï¼Œéœ€è¦ç½‘å¡æŒç»­ç›‘å¬å¤–éƒ¨ç½‘ç»œæ¥æ”¶åˆ°çš„æ•°æ®åŒ…ï¼Œå¹¶é€šè¿‡ä¸­æ–­è§¦å‘å†…æ ¸æ¥å¯¹æ•°æ®åŒ…è¿›è¡Œå¤„ç†</li></ul></li></ul><p>å…·ä½“çš„å¯ä»¥æŸ¥çœ‹åç»­çš„ç½‘ç»œåè®®è§£æ</p><h1 id="IP-ç½‘å¡æŸ¥è¯¢"><a href="#IP-ç½‘å¡æŸ¥è¯¢" class="headerlink" title="IP&#x2F;ç½‘å¡æŸ¥è¯¢"></a>IP&#x2F;ç½‘å¡æŸ¥è¯¢</h1><h2 id="ifconfig-old"><a href="#ifconfig-old" class="headerlink" title="ifconfig (old)"></a>ifconfig (old)</h2><p>ifconfig æä¾›äº†ç®€å•çš„æŸ¥è¯¢ç½‘å¡ä»¥åŠipä¿¡æ¯çš„åŠŸèƒ½</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500 <span class="hljs-comment">#ç½‘ç»œå¸§å¤§å°ï¼Œå†³å®šäº†è½¬å‘çš„äºŒå±‚ç½‘ç»œåŒ…çš„æœ€å¤§é•¿åº¦</span><br>        inet 172.16.243.147  netmask 255.255.240.0  broadcast 172.16.255.255 <br>        <span class="hljs-comment">#  ipv4 åœ°å€         æ©ç                    å¹¿æ’­åœ°å€</span><br>        inet6 fe80::216:3eff:fe4e:4cd3  prefixlen 64  scopeid 0x20&lt;<span class="hljs-built_in">link</span>&gt;<br>        <span class="hljs-comment">#  ipv6 åœ°å€                    æ©ç </span><br>        ether 00:16:3e:4e:4c:d3  txqueuelen 1000  (Ethernet)<br>        <span class="hljs-comment">#  ä»¥å¤ªç½‘macåœ°å€                 æœ€å¤§ä¼ è¾“é˜Ÿåˆ—é•¿åº¦</span><br>        RX packets 4986558  bytes 3656623569 (3.4 GiB)<br>        <span class="hljs-comment">#  æ¥æ”¶åˆ°çš„æ•°æ®ç»Ÿè®¡</span><br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        <span class="hljs-comment">#  å¼‚å¸¸ï¼Œä¸¢åŒ…ç»Ÿè®¡</span><br>        TX packets 3390873  bytes 827044117 (788.7 MiB)<br>        <span class="hljs-comment">#  å‘é€çš„æ•°æ®ç»Ÿè®¡</span><br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><span class="hljs-comment">#  å¼‚å¸¸ï¼Œä¸¢åŒ…ç»Ÿè®¡</span><br></code></pre></td></tr></table></figure><h2 id="ip-addr"><a href="#ip-addr" class="headerlink" title="ip addr"></a>ip addr</h2><p>æ–°ä¸€ä»£çš„ip ç½‘ç»œæŸ¥è¯¢&#x2F;é…ç½®å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000<br>    <span class="hljs-built_in">link</span>/ether 00:16:3e:4e:4c:d3 brd ff:ff:ff:ff:ff:ff<br>    altname enp0s5<br>    altname ens5<br>    inet 172.16.243.147/20 brd 172.16.255.255 scope global dynamic noprefixroute eth0<br>       valid_lft 1891653623sec preferred_lft 1891653623sec<br>    inet6 fe80::216:3eff:fe4e:4cd3/64 scope <span class="hljs-built_in">link</span><br>       valid_lft forever preferred_lft forever<br>       <br>       <br>ip addr add 10.0.0.1/24 dev eth0          <span class="hljs-comment"># æ·»åŠ  IP</span><br>ip addr del 10.0.0.1/24 dev eth0          <span class="hljs-comment"># åˆ é™¤ IP</span><br>ip addr flush dev eth0                    <span class="hljs-comment"># æ¸…ç©º IP</span><br>ip addr show                              <span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰åœ°å€</span><br>ip addr show dev eth0                     <span class="hljs-comment"># æŸ¥çœ‹æŸç½‘å¡çš„åœ°å€ä¿¡æ¯         </span><br><br></code></pre></td></tr></table></figure><h2 id="ip-link"><a href="#ip-link" class="headerlink" title="ip link"></a>ip link</h2><p>æŸ¥è¯¢ ç½‘ç»œé“¾è·¯çŠ¶æ€ï¼Œè™šæ‹Ÿç½‘å¡é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ _posts]# ip <span class="hljs-built_in">link</span> show<br>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000<br>    <span class="hljs-built_in">link</span>/ether 00:16:3e:4e:4c:d3 brd ff:ff:ff:ff:ff:ff<br>    altname enp0s5<br>    altname ens5<br>   <br>ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> veth-c up                      <span class="hljs-comment"># è®¾ç½®ç½‘ç»œæ¥å£æ‰“å¼€</span><br>ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> veth-c down                    <span class="hljs-comment"># è®¾ç½®ç½‘ç»œæ¥å£å…³é—­</span><br>ip <span class="hljs-built_in">link</span> add veth-c <span class="hljs-built_in">type</span> veth peer name veth-br  <span class="hljs-comment"># è®¾ç½®è™šæ‹Ÿç½‘ç»œï¼ˆå®šä¹‰çš„ä¸€å¯¹peer vethç½‘ç»œï¼‰</span><br>ip <span class="hljs-built_in">link</span> del veth-c                         <span class="hljs-comment"># åˆ é™¤ç½‘ç»œ</span><br></code></pre></td></tr></table></figure><h2 id="ip-netns"><a href="#ip-netns" class="headerlink" title="ip netns"></a>ip netns</h2><p>åˆ›å»º&#x2F;è®¾ç½® linux ç½‘ç»œå‘½åç©ºé—´ </p><p>ç½‘ç»œå‘½åå¯ä»¥å°†å…¶æ‰€åœ¨è¿›ç¨‹çš„ç½‘ç»œä¸å®¿ä¸»æœºè¿›è¡Œéš”ç¦»</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ip netns add net1                          <span class="hljs-comment"># æ·»åŠ ç½‘ç»œå‘½åç©ºé—´</span><br>ip netns <span class="hljs-built_in">exec</span> net1 ip addr                 <span class="hljs-comment"># åœ¨å®¿ä¸»æœºå‘å‘½åç©ºé—´å†…æ‰§è¡Œå‘½ä»¤</span><br></code></pre></td></tr></table></figure><h1 id="å¯»å€-è·¯ç”±"><a href="#å¯»å€-è·¯ç”±" class="headerlink" title="å¯»å€&#x2F;è·¯ç”±"></a>å¯»å€&#x2F;è·¯ç”±</h1><p>IPæ‰€å¤„çš„ç½‘ç»œå±‚ ä¸»è¦è´Ÿè´£æ¥å…¥ç½‘ç»œçš„è®¾å¤‡å¯»å€å’Œæ•°æ®è½¬å‘</p><h2 id="arp"><a href="#arp" class="headerlink" title="arp"></a>arp</h2><p>arp åè®®æ˜¯å·¥ä½œåœ¨æ•°æ®é“¾è·¯å±‚-ç½‘ç»œå±‚ä¸­é—´çš„ æ•°æ®åè®®ï¼Œå…¶é€šè¿‡å¹¿æ’­æ¨¡å¼å‘å¹¿æ’­åŸŸå†…æ‰€æœ‰è®¾å¤‡è¯·æ±‚å…¶æ‰€éœ€ipåœ°å€å¯¹åº”çš„macåœ°å€ï¼Œé€šå¸¸ç”¨äºç½‘ç»œæ¥å…¥ï¼ˆæŸ¥æ‰¾ç½‘å…³ï¼‰ï¼Œå’Œå†²çªæ£€æµ‹ï¼ˆæ˜¯å¦æœ‰åŒipè®¾å¤‡ä¸Šçº¿åŒä¸€å±€åŸŸç½‘ï¼‰ã€‚ä½¿ç”¨arp å‘½ä»¤å¯ä»¥æŸ¥çœ‹æœ¬åœ°çš„ipåœ°å€æ˜ å°„è¡¨é¡¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ _posts]# arp -a<br>? (10.88.0.11) at be:34:94:fb:34:f6 [ether] on cni-podman0<br>? (10.88.0.10) at &lt;incomplete&gt; on cni-podman0<br><br></code></pre></td></tr></table></figure><h2 id="ip-route"><a href="#ip-route" class="headerlink" title="ip route"></a>ip route</h2><p>æä¾›äº†æœ¬åœ°è·¯ç”±çš„æŸ¥è¯¢åŠŸèƒ½</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>[root@iZbp19tqlmjz1dmnm8w43uZ _posts]# ip route<br>default via 172.16.255.253 dev eth0 proto dhcp src 172.16.243.147 metric 100<br><span class="hljs-comment"># ç½‘æ®µ  ç½‘å…³                   ç½‘å¡                æºåœ°å€</span><br>10.88.0.0/16 dev cni-podman0 proto kernel scope <span class="hljs-built_in">link</span> src 10.88.0.1<br>172.16.240.0/20 dev eth0 proto kernel scope <span class="hljs-built_in">link</span> src 172.16.243.147 metric 100<br><br>ip route add 10.0.0.0/24 via 192.168.1.1 dev eth0  <span class="hljs-comment"># æ·»åŠ è·¯ç”±</span><br>ip route del 10.0.0.0/24                           <span class="hljs-comment"># åˆ é™¤è·¯ç”±</span><br><br></code></pre></td></tr></table></figure><h1 id="ç½‘ç»œçŠ¶æ€"><a href="#ç½‘ç»œçŠ¶æ€" class="headerlink" title="ç½‘ç»œçŠ¶æ€"></a>ç½‘ç»œçŠ¶æ€</h1><h2 id="netstat"><a href="#netstat" class="headerlink" title="netstat"></a>netstat</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash">netstat -tuln        <span class="hljs-comment">#æ˜¾ç¤ºæ‰€æœ‰æ­£åœ¨ç›‘å¬çš„ TCP/UDP ç«¯å£ï¼ˆæ•°å­—æ˜¾ç¤ºï¼‰</span><br>netstat -tulnp      <span class="hljs-comment">#æ˜¾ç¤ºç›‘å¬ç«¯å£åŠå¯¹åº”è¿›ç¨‹ PID/åç§°</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ _posts]# netstat -tulnp<br>Active Internet connections (only servers)<br>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name<br><span class="hljs-comment">#åè®® æ¥æ”¶é˜Ÿåˆ— å‘é€é˜Ÿåˆ—  åœ°å€                   ä¼ è¾“çš„å¤–éƒ¨åœ°å€                    è¿›ç¨‹å·/è¿›ç¨‹</span><br>tcp        0      0 0.0.0.0:6380            0.0.0.0:*               LISTEN      1018202/redis-serve<br>tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      1/systemd<br><br>netstat -an          <span class="hljs-comment">#æ˜¾ç¤ºæ‰€æœ‰è¿æ¥ï¼ˆåŒ…æ‹¬ç›‘å¬ + æ´»è·ƒè¿æ¥ï¼‰</span><br>Proto RefCnt Flags       Type       State         I-Node   Path<br><span class="hljs-comment">#åè®® å¼•ç”¨æ¬¡æ•° çŠ¶æ€      ä¼ è¾“ç±»å‹    çŠ¶æ€          inodeç¼–å· è·¯å¾„</span><br>unix  2      [ ACC ]     STREAM     LISTENING     18400306 /run/systemd/private<br>unix  2      [ ]         DGRAM                    17763560 /run/user/0/systemd/notify<br><br>netstat -r          <span class="hljs-comment">#æ˜¾ç¤ºè·¯ç”±è¡¨ï¼ˆç­‰åŒäº route -nï¼‰</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ _posts]# netstat -r<br>Kernel IP routing table<br>Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface<br><span class="hljs-comment">#ç›®çš„ç½‘æ®µ       ç½‘å…³            æ©ç          TCPæœ€å¤§ä¼ è¾“å¤§å°å’Œçª—å£å¤§å°     æ¥å£</span><br>default         _gateway        0.0.0.0         UG        0 0          0 eth0<br>10.88.0.0       0.0.0.0         255.255.0.0     U         0 0          0 cni-podman0<br>172.16.240.0    0.0.0.0         255.255.240.0   U         0 0          0 eth0<br><br>netstat -i           <span class="hljs-comment">#æ˜¾ç¤ºæ‰€æœ‰ç½‘å¡æ¥å£çš„ç»Ÿè®¡æ•°æ®ï¼ˆæ”¶å‘åŒ…ã€ä¸¢åŒ…ç­‰ï¼‰</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ _posts]# netstat -i<br>Kernel Interface table<br>Iface             MTU    RX-OK RX-ERR RX-DRP RX-OVR    TX-OK TX-ERR TX-DRP TX-OVR Flg<br><span class="hljs-comment">#æ¥å£         æœ€å¤§ä¼ è¾“ æ¥æ”¶æ­£å¸¸  å¼‚å¸¸   ä¸¢åŒ…   æº¢å‡º    å‘é€æ­£å¸¸   å¼‚å¸¸  ä¸¢åŒ…   æº¢å‡º</span><br>cni-podman0      1500    44683      0      0 0         53354      0      0      0 BMRU<br>eth0             1500  4990035      0      0 0       3393020      0      0      0 BMRU<br>lo              65536  1215234      0      0 0       1215234      0      0      0 LRU<br>vethfcdc13a0     1500    37461      0      0 0         45818      0      0      0 BMRU<br><br>netstat -s          <span class="hljs-comment">#æ˜¾ç¤ºåè®®æ•°æ®ç»Ÿè®¡ï¼ˆTCP/UDP/ICMPç­‰ï¼‰</span><br></code></pre></td></tr></table></figure><h2 id="ss"><a href="#ss" class="headerlink" title="ss"></a>ss</h2><p>socket ä¿¡æ¯æŸ¥è¯¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">ss -t        <span class="hljs-comment"># æŸ¥è¯¢tcp ä¿¡æ¯</span><br>ss -u        <span class="hljs-comment"># æŸ¥è¯¢udp ä¿¡æ¯</span><br>ss -tulnp    <span class="hljs-comment"># æŸ¥è¯¢tcp/udp ä»¥åŠç«¯å£å’Œè¿›ç¨‹ä¿¡æ¯</span><br>Netid     State      Recv-Q     Send-Q         Local Address:Port           Peer Address:Port     Process<br><span class="hljs-comment">#åè®®id    çŠ¶æ€      æ¥æ”¶ç»Ÿè®¡    å‘é€ç»Ÿè®¡          æœ¬åœ°ipåœ°å€:ç«¯å£              å¯¹ç«¯ipåœ°å€:ç«¯å£      è¿›ç¨‹ä¿¡æ¯                         </span><br>udp       UNCONN     0          0                    0.0.0.0:111                 0.0.0.0:*         <span class="hljs-built_in">users</span>:((&quot;rpcbind&quot;,pid=<span class="hljs-number">537</span>,fd=<span class="hljs-number">5</span>),(&quot;systemd&quot;,pid=<span class="hljs-number">1</span>,fd=<span class="hljs-number">34</span>))<br>udp       UNCONN     0          0                  127.0.0.1:323                 0.0.0.0:*         <span class="hljs-built_in">users</span>:((&quot;chronyd&quot;,pid=<span class="hljs-number">574</span>,fd=<span class="hljs-number">5</span>))<br>udp       UNCONN     0          0                       [::]:111                    [::]:*         <span class="hljs-built_in">users</span>:((&quot;rpcbind&quot;,pid=<span class="hljs-number">537</span>,fd=<span class="hljs-number">7</span>),(&quot;systemd&quot;,pid=<span class="hljs-number">1</span>,fd=<span class="hljs-number">36</span>))<br>udp       UNCONN     0          0                      [::1]:323                    [::]:*         <span class="hljs-built_in">users</span>:((&quot;chronyd&quot;,pid=<span class="hljs-number">574</span>,fd=<span class="hljs-number">6</span>))<br>tcp       LISTEN     0          511                  0.0.0.0:6380                0.0.0.0:*         <span class="hljs-built_in">users</span>:((&quot;redis-server&quot;,pid=<span class="hljs-number">1018202</span>,fd=<span class="hljs-number">6</span>))<br>tcp       LISTEN     0          4096                 0.0.0.0:111                 0.0.0.0:*         <span class="hljs-built_in">users</span>:((&quot;rpcbind&quot;,pid=<span class="hljs-number">537</span>,fd=<span class="hljs-number">4</span>),(&quot;systemd&quot;,pid=<span class="hljs-number">1</span>,fd=<span class="hljs-number">33</span>))<br>tcp       LISTEN     0          511                  0.0.0.0:80                  0.0.0.0:*         <span class="hljs-built_in">users</span>:((&quot;nginx&quot;,pid=<span class="hljs-number">990145</span>,fd=<span class="hljs-number">6</span>),(&quot;nginx&quot;,pid=<span class="hljs-number">990144</span>,fd=<span class="hljs-number">6</span>),(&quot;nginx&quot;,pid=<span class="hljs-number">990143</span>,fd=<span class="hljs-number">6</span>))<br>tcp       LISTEN     0          128                  0.0.0.0:22                  0.0.0.0:*         <span class="hljs-built_in">users</span>:((&quot;sshd&quot;,pid=<span class="hljs-number">1021</span>,fd=<span class="hljs-number">3</span>))<br>tcp       LISTEN     0          4096                    [::]:111                    [::]:*         <span class="hljs-built_in">users</span>:((&quot;rpcbind&quot;,pid=<span class="hljs-number">537</span>,fd=<span class="hljs-number">6</span>),(&quot;systemd&quot;,pid=<span class="hljs-number">1</span>,fd=<span class="hljs-number">35</span>))<br>tcp       LISTEN     0          511                     [::]:80                     [::]:*         <span class="hljs-built_in">users</span>:((&quot;nginx&quot;,pid=<span class="hljs-number">990145</span>,fd=<span class="hljs-number">7</span>),(&quot;nginx&quot;,pid=<span class="hljs-number">990144</span>,fd=<span class="hljs-number">7</span>),(&quot;nginx&quot;,pid=<span class="hljs-number">990143</span>,fd=<span class="hljs-number">7</span>))<br>tcp       LISTEN     0          128                     [::]:22                     [::]:*         <span class="hljs-built_in">users</span>:((&quot;sshd&quot;,pid=<span class="hljs-number">1021</span>,fd=<span class="hljs-number">4</span>))<br><br></code></pre></td></tr></table></figure><h1 id="è¿é€šæ€§-è¯·æ±‚æŸ¥è¯¢"><a href="#è¿é€šæ€§-è¯·æ±‚æŸ¥è¯¢" class="headerlink" title="è¿é€šæ€§&#x2F;è¯·æ±‚æŸ¥è¯¢"></a>è¿é€šæ€§&#x2F;è¯·æ±‚æŸ¥è¯¢</h1><h2 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h2><p>pingå‘½ä»¤ç”¨æ¥æ£€æŸ¥ipæ˜¯å¦å¯ä»¥ä¸å¯¹ç«¯æ­£å¸¸é€šä¿¡ï¼Œåº•å±‚ä½¿ç”¨çš„æ˜¯icmpåè®®ã€‚icmpåè®®ä¸­å®šä¹‰äº†ä¸€ä¸ªå­—æ®µï¼ˆttl  time to live å­˜æ´»æ—¶é—´ï¼‰ã€‚è¿™é‡Œçš„time æ˜¯åœ¨ç½‘ç»œä¸­ä¼ è¾“æ—¶ï¼Œæ²¡ç»è¿‡ä¸€ä¸ªç½‘ç»œè®¾å¤‡åˆ™ä¼š-1ã€‚å½“ä¸º0æ—¶æ•°æ®åŒ…è¢«ä¸¢å¼ƒã€‚linuxä¸­çš„pingæŒç»­æ‰§è¡Œï¼Œwindow ä¼šè¯·æ±‚4æ¬¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">ping 8.8.8.8<br>64 bytes from 8.8.8.8: icmp_seq=1 ttl=54 <span class="hljs-keyword">time</span>=30.4 ms<br>ping -c 5  8.8.8.8         <span class="hljs-comment">#  å‘8.8.8.8 ip å‘èµ·5æ¬¡ping è¯·æ±‚</span><br>ping -I eth0 8.8.8.8       <span class="hljs-comment">#  æŒ‡å®šç½‘å¡eth0 å‘èµ·ping è¯·æ±‚</span><br></code></pre></td></tr></table></figure><h2 id="nslookup"><a href="#nslookup" class="headerlink" title="nslookup"></a>nslookup</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ _posts]# nslookup baidu.com<br>Server:         100.100.2.136<br>Address:        100.100.2.136#53<br><br>Non-authoritative answer:<br>Name:   baidu.com<br>Address: 39.156.66.10<br>Name:   baidu.com<br>Address: 110.242.68.66<br><br></code></pre></td></tr></table></figure><h2 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h2><p>é€šè¿‡å‘½ä»¤è¡Œåˆ›å»ºhttpè¯·æ±‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl www.baidu.com<br><br>curl -d <span class="hljs-string">&quot;username=user&amp;password=pass&quot;</span> https://example.com/login<br><span class="hljs-comment"># æºå¸¦æ¶ˆæ¯ä½“å‘é€post è¯·æ±‚</span><br>curl -X POST https://api.example.com/data \<br>     -H <span class="hljs-string">&quot;Content-Type: application/json&quot;</span> \<br>     -d <span class="hljs-string">&#x27;&#123;&quot;name&quot;: &quot;Alice&quot;, &quot;age&quot;: 30&#125;&#x27;</span><br><span class="hljs-comment"># ä¼ é€’json æ•°æ®</span><br>curl -o file.txt https://example.com/file.txt<br><span class="hljs-comment"># ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°</span><br>curl --cookie <span class="hljs-string">&quot;session=abc123&quot;</span> https://example.com<br><span class="hljs-comment"># å®šä¹‰cookieä¿¡æ¯</span><br>curl -I https://example.com<br><span class="hljs-comment"># è·å–å“åº”å¤´</span><br>curl -i https://example.com<br><span class="hljs-comment"># è·å–å“åº”</span><br>curl -L https://short.url/link<br><span class="hljs-comment"># è·Ÿè¸ªé‡å®šå‘</span><br>curl -F <span class="hljs-string">&quot;file=@localfile.txt&quot;</span> https://example.com/upload<br><span class="hljs-comment"># ä¸Šä¼ æ–‡ä»¶</span><br><span class="hljs-comment"># å…¶ä»–å‚æ•° :</span><br><span class="hljs-comment"># -vï¼šè¯¦ç»†æ¨¡å¼ï¼ˆdebug ä¿¡æ¯ï¼‰</span><br><span class="hljs-comment"># -sï¼šé™é»˜æ¨¡å¼ï¼ˆä¸è¾“å‡ºè¿›åº¦æ¡ï¼‰</span><br><span class="hljs-comment"># -sSï¼šé™é»˜ä½†å‡ºé”™æ—¶æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼ˆå¸¸ç”¨ç»„åˆï¼‰</span><br><span class="hljs-comment"># -w &#x27;%&#123;http_code&#125;&#x27;ï¼šè¾“å‡º HTTP çŠ¶æ€ç </span><br><span class="hljs-comment"># -kï¼šå¿½ç•¥ HTTPS è¯ä¹¦é”™è¯¯ï¼ˆæµ‹è¯•ç”¨ï¼‰</span><br></code></pre></td></tr></table></figure><h2 id="wget"><a href="#wget" class="headerlink" title="wget"></a>wget</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://example.com/file.zip<br><span class="hljs-comment"># è·å–æ–‡ä»¶</span><br>wget -O newname.zip https://example.com/file.zip<br><span class="hljs-comment"># ä¿å­˜æ–‡ä»¶</span><br>wget -c https://example.com/large.iso<br><span class="hljs-comment"># æ–­ç‚¹ç»­ä¼ </span><br>wget -r https://example.com/<br><span class="hljs-comment"># é€’å½’ä¸‹è½½</span><br>wget --mirror --convert-links --adjust-extension --page-requisites --no-parent https://example.com<br><span class="hljs-comment"># ä¸‹è½½åˆ°æœ¬åœ°ï¼Œç¦»çº¿æµè§ˆ</span><br>wget --header=<span class="hljs-string">&quot;Authorization: Bearer TOKEN123&quot;</span> https://api.example.com/data.json<br>wget --user=admin --password=123 https://example.com/protected/file.zip<br><span class="hljs-comment"># é…ç½®è®¤è¯ä¿¡æ¯</span><br>wget -i urls.txt<br><br></code></pre></td></tr></table></figure><h2 id="netcat"><a href="#netcat" class="headerlink" title="netcat"></a>netcat</h2><p>ç®€æ˜“tcpè¿æ¥å·¥å…· </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -l 1234         <span class="hljs-comment"># åˆ›å»ºTCP æœåŠ¡å™¨</span><br>nc localhost 1234  <span class="hljs-comment"># è¿æ¥</span><br>nc -l 1234 &gt; received.txt <span class="hljs-comment"># å¼€å¯çª—å£å‘é€æ•°æ®</span><br>nc [ip] 1234 &lt; file.txt   <span class="hljs-comment"># å‘æœåŠ¡ç«¯ç«¯å£å‘é€çš„æ•°æ®</span><br><br></code></pre></td></tr></table></figure><h2 id="iperf"><a href="#iperf" class="headerlink" title="iperf"></a>iperf</h2><p>æµé‡æ€§èƒ½æµ‹è¯•å·¥å…·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">iperf -s                     <span class="hljs-comment">#å¼€å¯æœåŠ¡ç«¯ï¼Œé»˜è®¤ç›‘å¬5021ç«¯å£</span><br>iperf -c  [ip]               <span class="hljs-comment">#å‘ç›®çš„ç«¯å£å‘é€10s tcpæµé‡</span><br>iperf -c server_ip -u -b 100M#å‘æœåŠ¡ç«¯å‘é€100Mçš„ udpæµé‡<br><br>-r  <span class="hljs-comment">#åŒå‘æµ‹è¯•</span><br>-P  <span class="hljs-comment">#å¤šçº¿ç¨‹</span><br></code></pre></td></tr></table></figure><h2 id="tcpdump"><a href="#tcpdump" class="headerlink" title="tcpdump"></a>tcpdump</h2><p>æ•°æ®æµé‡æ•è·å·¥å…·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">tcpdump -i eth0    <span class="hljs-comment"># æ•è·æŒ‡å®šç«¯å£</span><br>tcpdump host [ip]  <span class="hljs-comment"># è·å–ç›®æ ‡ipçš„æµé‡</span><br>tcpdump port       <span class="hljs-comment"># ç›‘å¬æŒ‡å®šç«¯å£ </span><br>tcpdump -i eth0 src 192.168.1.1 and dst port 80  <span class="hljs-comment">#æ¥æ”¶æºä¸º192.168.1.1çš„ ç›®çš„ç«¯å£ä¸º80çš„åŒ…</span><br>tcpdump -w capture.pcap -i eth0  <span class="hljs-comment">#æ•è·åŒ…åˆ°æ–‡ä»¶</span><br>tcpdump -i eth0 udp port 53   <span class="hljs-comment">#æ•è·dns æµé‡åŒ…</span><br><br><span class="hljs-comment"># -i &lt;æ¥å£&gt;: æŒ‡å®šè¦ç›‘å¬çš„ç½‘ç»œæ¥å£ï¼ˆå¦‚ eth0, wlan0ï¼‰</span><br><span class="hljs-comment"># -c &lt;æ•°é‡&gt;: é™åˆ¶æ•è·çš„æ•°æ®åŒ…æ•°é‡</span><br><span class="hljs-comment"># -n: ä¸å°†åœ°å€è§£æä¸ºä¸»æœºåï¼ˆæé«˜æ€§èƒ½ï¼‰</span><br><span class="hljs-comment"># -t: ä¸æ˜¾ç¤ºæ—¶é—´æˆ³</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Shell</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Shell III å†…å­˜/IO/æ–‡ä»¶ç³»ç»Ÿç›¸å…³å‘½ä»¤</title>
    <link href="/2025/04/09/Shell-III-%E5%86%85%E5%AD%98-IO-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4/"/>
    <url>/2025/04/09/Shell-III-%E5%86%85%E5%AD%98-IO-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="free-æŸ¥çœ‹å†…å­˜ä½¿ç”¨"><a href="#free-æŸ¥çœ‹å†…å­˜ä½¿ç”¨" class="headerlink" title="free æŸ¥çœ‹å†…å­˜ä½¿ç”¨"></a>free æŸ¥çœ‹å†…å­˜ä½¿ç”¨</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ ~]# free -h<br>              total        used        free      shared  buff/cache   available<br>Mem:          1.8Gi       499Mi       747Mi       2.0Mi       784Mi       1.3Gi<br>Swap:            0B          0B          0B<br><br></code></pre></td></tr></table></figure><h1 id="iostat-æŸ¥çœ‹-CPU-å’Œç£ç›˜-I-O-æ€§èƒ½"><a href="#iostat-æŸ¥çœ‹-CPU-å’Œç£ç›˜-I-O-æ€§èƒ½" class="headerlink" title="iostat æŸ¥çœ‹ CPU å’Œç£ç›˜ I&#x2F;O æ€§èƒ½"></a>iostat æŸ¥çœ‹ CPU å’Œç£ç›˜ I&#x2F;O æ€§èƒ½</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ ~]# iostat<br>Linux 5.10.134-18.al8.x86_64 (iZbp19tqlmjz1dmnm8w43uZ)  04/10/2025      _x86_64_        (2 CPU)<br><br>avg-cpu:  %user   %<span class="hljs-built_in">nice</span> %system %iowait  %steal   %idle<br>           0.87    0.00    0.49    0.01    0.00   98.62<br><br>Device             tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn<br>vda               0.82         6.03        12.57   10324570   21525204<br><br></code></pre></td></tr></table></figure><h1 id="lsblk-æ˜¾ç¤ºå—è®¾å¤‡ä¿¡æ¯"><a href="#lsblk-æ˜¾ç¤ºå—è®¾å¤‡ä¿¡æ¯" class="headerlink" title="lsblk æ˜¾ç¤ºå—è®¾å¤‡ä¿¡æ¯"></a>lsblk æ˜¾ç¤ºå—è®¾å¤‡ä¿¡æ¯</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ ~]# lsblk<br>NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>vda    253:0    0   40G  0 disk<br>â”œâ”€vda1 253:1    0    2M  0 part<br>â”œâ”€vda2 253:2    0  200M  0 part /boot/efi<br>â””â”€vda3 253:3    0 39.8G  0 part /<br><br></code></pre></td></tr></table></figure><h1 id="df-æŸ¥çœ‹è®¾å¤‡ä¸ç›®å½•çš„æŒ‚è½½å…³ç³»ï¼Œä½¿ç”¨æƒ…å†µ"><a href="#df-æŸ¥çœ‹è®¾å¤‡ä¸ç›®å½•çš„æŒ‚è½½å…³ç³»ï¼Œä½¿ç”¨æƒ…å†µ" class="headerlink" title="df æŸ¥çœ‹è®¾å¤‡ä¸ç›®å½•çš„æŒ‚è½½å…³ç³»ï¼Œä½¿ç”¨æƒ…å†µ"></a>df æŸ¥çœ‹è®¾å¤‡ä¸ç›®å½•çš„æŒ‚è½½å…³ç³»ï¼Œä½¿ç”¨æƒ…å†µ</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ ~]# <span class="hljs-built_in">df</span> -h<br>Filesystem      Size  Used Avail Use% Mounted on<br>devtmpfs        916M     0  916M   0% /dev<br>tmpfs           936M   84K  936M   1% /dev/shm<br>tmpfs           936M  764K  935M   1% /run<br>tmpfs           936M     0  936M   0% /sys/fs/cgroup<br>/dev/vda3        40G   14G   25G  36% /<br>/dev/vda2       200M  5.8M  195M   3% /boot/efi<br>tmpfs           188M     0  188M   0% /run/user/0<br>shm              63M     0   63M   0% /var/lib/containers/storage/overlay-containers/1936bab81ca270b4558231e4a09ddb43a3274744bbfcf280791138efb612ffd0/userdata/shm<br>overlay          40G   14G   25G  36% /var/lib/containers/storage/overlay/0a4e05c5de62dfb74f643f918af2c216ef814b2a8ad5cd1b60ac96d4c514c654/merged<br><br></code></pre></td></tr></table></figure><h1 id="du-path-h-éå†æ–‡ä»¶ç›®å½•ï¼ŒæŸ¥çœ‹å ç”¨ç©ºé—´å¤§å°"><a href="#du-path-h-éå†æ–‡ä»¶ç›®å½•ï¼ŒæŸ¥çœ‹å ç”¨ç©ºé—´å¤§å°" class="headerlink" title="du [path] -h éå†æ–‡ä»¶ç›®å½•ï¼ŒæŸ¥çœ‹å ç”¨ç©ºé—´å¤§å°"></a>du [path] -h éå†æ–‡ä»¶ç›®å½•ï¼ŒæŸ¥çœ‹å ç”¨ç©ºé—´å¤§å°</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ codfish]# <span class="hljs-built_in">du</span> /home/codfish/hello/ -h<br>12K     /home/codfish/hello/<br><br></code></pre></td></tr></table></figure><h1 id="lsof-æŸ¥çœ‹å“ªäº›è¿›ç¨‹åœ¨è®¿é—®å½“å‰æ–‡ä»¶ç›®å½•"><a href="#lsof-æŸ¥çœ‹å“ªäº›è¿›ç¨‹åœ¨è®¿é—®å½“å‰æ–‡ä»¶ç›®å½•" class="headerlink" title="lsof æŸ¥çœ‹å“ªäº›è¿›ç¨‹åœ¨è®¿é—®å½“å‰æ–‡ä»¶ç›®å½•"></a>lsof æŸ¥çœ‹å“ªäº›è¿›ç¨‹åœ¨è®¿é—®å½“å‰æ–‡ä»¶ç›®å½•</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">COMMAND     PID USER   FD   TYPE DEVICE SIZE/OFF    NODE NAME<br>bash    1022674 root  cwd    DIR  253,3     4096 1184776 .   <span class="hljs-comment"># shell åœ¨å½“å‰ç›®å½•æ‰§è¡Œ</span><br>lsof    1022812 root  cwd    DIR  253,3     4096 1184776 .   <span class="hljs-comment"># shelæ‰§è¡Œlsofåˆ›å»ºçš„è¿›ç¨‹åœ¨å½“å‰ç›®å½•</span><br>lsof    1022813 root  cwd    DIR  253,3     4096 1184776 .   <span class="hljs-comment"># lsof åˆ›å»ºçš„å­è¿›ç¨‹</span><br><br>COMMANDå‘èµ·è¯¥æ–‡ä»¶è®¿é—®çš„è¿›ç¨‹åï¼ˆå¯æ‰§è¡Œæ–‡ä»¶åï¼‰<br>PID    è¿›ç¨‹ ID<br>TID    çº¿ç¨‹ IDï¼ˆThread IDï¼‰â€” æŸäº›å·¥å…·å¦‚ lsof -T æˆ– proc å·¥å…·å¯èƒ½åˆ—å‡ºå…·ä½“çº¿ç¨‹<br>TASKCMDå¦‚æœæœ‰çº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹çš„åå­—ï¼ˆæ¯”å¦‚ Java çº¿ç¨‹åã€C++çš„ pthread åç§°ç­‰ï¼‰<br>USER  æ‹¥æœ‰è¯¥è¿›ç¨‹çš„ç”¨æˆ·<br>FD    æ–‡ä»¶æè¿°ç¬¦ï¼ˆFile Descriptorï¼‰ï¼Œæ¯”å¦‚ cwd, mem, txt, 0u, 1w ç­‰<br>TYPE  æ‰“å¼€çš„æ–‡ä»¶ç±»å‹ï¼Œæ¯”å¦‚ï¼šREGï¼ˆæ™®é€šæ–‡ä»¶ï¼‰ï¼ŒDIRï¼ˆç›®å½•ï¼‰ï¼ŒCHRï¼ˆå­—ç¬¦è®¾å¤‡ï¼‰ï¼ŒFIFOï¼ˆç®¡é“ï¼‰ç­‰<br>DEVICEæ–‡ä»¶æ‰€åœ¨è®¾å¤‡çš„ä¸»æ¬¡è®¾å¤‡å·ï¼Œæ ¼å¼é€šå¸¸ä¸º major:minorï¼ˆæ¯”å¦‚ 8:1 ä»£è¡¨ /dev/sda1ï¼‰<br>SIZE/OFFæ–‡ä»¶çš„å¤§å°æˆ–æ–‡ä»¶åç§»é‡<br>NODE  æ–‡ä»¶åœ¨è®¾å¤‡ä¸Šçš„ inode ç¼–å·<br>NAME  æ–‡ä»¶åï¼ˆæˆ–èµ„æºåï¼‰ï¼Œå³è¢«è®¿é—®çš„å®é™…å¯¹è±¡è·¯å¾„<br></code></pre></td></tr></table></figure><h1 id="mount-å®Œæˆ-å—è®¾å¤‡-æ–‡ä»¶ç³»ç»Ÿ-èµ„æºæŒ‚è½½"><a href="#mount-å®Œæˆ-å—è®¾å¤‡-æ–‡ä»¶ç³»ç»Ÿ-èµ„æºæŒ‚è½½" class="headerlink" title="mount å®Œæˆ å—è®¾å¤‡-æ–‡ä»¶ç³»ç»Ÿ-èµ„æºæŒ‚è½½"></a>mount å®Œæˆ å—è®¾å¤‡-æ–‡ä»¶ç³»ç»Ÿ-èµ„æºæŒ‚è½½</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">mkfs.ext4 /dev/sdb1  <span class="hljs-comment"># å®šä¹‰å—è®¾å¤‡çš„æ–‡ä»¶ç³»ç»Ÿ</span><br>mount /dev/sdb1 /mnt/mydisk  <span class="hljs-comment"># æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿåˆ°æŒ‚è½½ç‚¹</span><br><br><span class="hljs-comment"># æˆ–è€…ç›´æ¥ æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿåˆ°æŒ‚è½½ç‚¹</span><br>mount -t &lt;æ–‡ä»¶ç³»ç»Ÿç±»å‹&gt; &lt;è®¾å¤‡&gt; &lt;æŒ‚è½½ç‚¹&gt;<br>mount -t proc proc /proc<br><span class="hljs-comment"># æŒ‚è½½è¿›ç¨‹ è¿™é‡Œçš„/proc</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Shell</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Shell II è¿›ç¨‹ç›¸å…³å‘½ä»¤</title>
    <link href="/2025/04/09/%E8%BF%9B%E7%A8%8B%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4/"/>
    <url>/2025/04/09/%E8%BF%9B%E7%A8%8B%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ</h1><blockquote><p>è¿›ç¨‹å¯ä»¥çœ‹ä½œæ˜¯æ“ä½œç³»ç»Ÿå¯¹èµ„æºçš„åŸºæœ¬è°ƒåº¦å•ä½ï¼Œé€šè¿‡è¿›ç¨‹çš„è°ƒåº¦æœºåˆ¶ï¼Œç³»ç»Ÿå¾—ä»¥åè°ƒå„é¡¹ä»»åŠ¡çš„æ‰§è¡Œã€‚</p></blockquote><p>è¿›ç¨‹çš„è°ƒç”¨æµç¨‹ â†’ é€šè¿‡çˆ¶è¿›ç¨‹åˆ›å»ºå­è¿›ç¨‹åˆ›å»ºæ–°çš„å †æ ˆç»“æ„ â†’ å­è¿›ç¨‹åŠ è½½è‡ªèº«éœ€è¦çš„èµ„æºåˆ°å †æ ˆä¸­ â†’ å †æ ˆä¸­æ‰§è¡Œå‘½ä»¤ â†’ æ‰§è¡Œåˆ°mainå‡½æ•°è¿”å›æˆ–è€…è¿›ç¨‹å¼‚å¸¸é€€å‡º</p><h1 id="ps-æŸ¥çœ‹è¿›ç¨‹æŒ‡ä»¤"><a href="#ps-æŸ¥çœ‹è¿›ç¨‹æŒ‡ä»¤" class="headerlink" title="ps  æŸ¥çœ‹è¿›ç¨‹æŒ‡ä»¤"></a>ps  æŸ¥çœ‹è¿›ç¨‹æŒ‡ä»¤</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">å‚æ•°åˆ—è¡¨<br>-e æˆ– -A  æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹<br>-f        å®Œæ•´æ ¼å¼<br>-u        æŒ‡å®šç”¨æˆ·è¿›ç¨‹<br>-x        æ— ç»ˆç«¯è¿›ç¨‹<br>-o      è‡ªå®šä¹‰è¾“å‡ºå­—æ®µ<br>-C        æŒ‡å®šç¨‹åºè¿›ç¨‹<br><br>ps -ef    å…¨éƒ¨è¿›ç¨‹<br>ps aux    å…¨éƒ¨è¿›ç¨‹ BSDé£æ ¼<br>ps -u     æŒ‡å®šç”¨æˆ·è¿›ç¨‹<br><br>ps aux | awk <span class="hljs-string">&quot;NR&lt;=2&quot;</span><br>USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND<br>root           1  0.0  0.5  21500 11112 ?        Ss   Mar21   0:16 /usr/lib/systemd/systemd --system --deserialize 23<br><br>å­—æ®µä¿¡æ¯<br>USER :  ç”¨æˆ·å<br>PID :   è¿›ç¨‹å·<br>%CPU :  CPUå ç”¨ç‡<br>%MEM :  å†…å­˜ä½¿ç”¨ç‡<br>VSZ  :  è™šæ‹Ÿå†…å­˜å¤§å°<br>RSS  :  å®é™…å ç”¨å†…å­˜<br>TTY  :  æ— ç»ˆç«¯ä¸º ï¼Ÿ<br>START : å¯åŠ¨æ—¶é—´<br>TIME  : å ç”¨CPUçš„æ—¶é—´<br>CMD  :  æ‰§è¡Œçš„å‘½ä»¤<br>STAT :  è¿›ç¨‹çŠ¶æ€<br><br>STATçŠ¶æ€å«ä¹‰<br>Ræ­£åœ¨è¿è¡Œ<br>Sä¼‘çœ ä¸­ï¼ˆå¯ä¸­æ–­ï¼‰<br>Dä¸å¯ä¸­æ–­çš„ä¼‘çœ <br>Tåœæ­¢ï¼ˆå¦‚ Ctrl+Zï¼‰<br>Zåƒµå°¸è¿›ç¨‹<br>Xæ­»äº¡çŠ¶æ€<br><br></code></pre></td></tr></table></figure><h1 id="top-åŠ¨æ€æ‰“å°æ‰€æœ‰è¿›ç¨‹çš„æ€§èƒ½æŒ‡æ ‡"><a href="#top-åŠ¨æ€æ‰“å°æ‰€æœ‰è¿›ç¨‹çš„æ€§èƒ½æŒ‡æ ‡" class="headerlink" title="top åŠ¨æ€æ‰“å°æ‰€æœ‰è¿›ç¨‹çš„æ€§èƒ½æŒ‡æ ‡"></a>top åŠ¨æ€æ‰“å°æ‰€æœ‰è¿›ç¨‹çš„æ€§èƒ½æŒ‡æ ‡</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash">top - 22:12:10 up 19 days,  8:24,  1 user,  load average: 0.00, 0.00, 0.00<br><span class="hljs-comment"># 22:12:10 â†’ å½“å‰ç³»ç»Ÿæ—¶é—´ã€‚</span><br><span class="hljs-comment"># up 19 days, 8:24 â†’ ç³»ç»Ÿå·²ç»è¿è¡Œäº† 19 å¤© 8 å°æ—¶ 24 åˆ†é’Ÿã€‚</span><br><span class="hljs-comment"># 1 user â†’ å½“å‰ç™»å½•ç³»ç»Ÿçš„ç”¨æˆ·æ•°ã€‚</span><br><span class="hljs-comment"># load average: 0.00, 0.00, 0.00 â†’ ç³»ç»Ÿå¹³å‡è´Ÿè½½ï¼š</span><br><span class="hljs-comment"># åˆ†åˆ«è¡¨ç¤ºè¿‡å» 1 åˆ†é’Ÿã€5 åˆ†é’Ÿã€15 åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½ï¼ˆä»»åŠ¡é˜Ÿåˆ—é•¿åº¦ï¼‰ã€‚ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡ä¸ªæ•°</span><br> <br>Tasks: 111 total,   1 running, 110 sleeping,   0 stopped,   0 zombie<br><span class="hljs-comment"># 111 total â†’ å½“å‰ç³»ç»Ÿæ€»å…±çš„è¿›ç¨‹æ•°ã€‚</span><br><span class="hljs-comment"># 1 running â†’ æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼ˆçŠ¶æ€æ˜¯ Rï¼‰ã€‚</span><br><span class="hljs-comment"># 110 sleeping â†’ ä¼‘çœ çŠ¶æ€çš„è¿›ç¨‹ï¼ˆå¤§å¤šæ•°è¿›ç¨‹å¤„äºè¿™ä¸ªçŠ¶æ€ï¼‰ã€‚</span><br><span class="hljs-comment"># 0 stopped â†’ è¢«ç»ˆæ­¢æˆ–æŒ‚èµ·ï¼ˆTï¼‰çš„è¿›ç¨‹æ•°ã€‚</span><br><span class="hljs-comment"># 0 zombie â†’ åƒµå°¸è¿›ç¨‹æ•°ï¼Œåº”è¯¥ä¸º 0ï¼Œé 0 å¯èƒ½ä»£è¡¨çˆ¶è¿›ç¨‹æ²¡å¤„ç†å­è¿›ç¨‹é€€å‡ºçŠ¶æ€ã€‚</span><br>%Cpu(s):  0.3 us,  0.2 sy,  0.0 ni, 99.2 <span class="hljs-built_in">id</span>,  0.0 wa,  0.2 hi,  0.2 si,  0.0 st<br><span class="hljs-comment"># usç”¨æˆ·æ€ï¼ˆuserï¼‰è¿›ç¨‹å ç”¨ CPU ç™¾åˆ†æ¯”ï¼ˆä¸åŒ…æ‹¬ niceï¼‰</span><br><span class="hljs-comment"># syå†…æ ¸æ€ï¼ˆsystemï¼‰è¿›ç¨‹å ç”¨ CPU ç™¾åˆ†æ¯”</span><br><span class="hljs-comment"># niç”¨æˆ·è¿›ç¨‹ nice ä¼˜å…ˆçº§è°ƒæ•´åå ç”¨çš„ CPU ç™¾åˆ†æ¯”</span><br><span class="hljs-comment"># idç©ºé—²ï¼ˆidleï¼‰CPU ç™¾åˆ†æ¯”ï¼ˆè¶Šé«˜è¶Šç©ºé—²ï¼‰</span><br><span class="hljs-comment"># waç­‰å¾… I/O çš„æ—¶é—´å æ¯”ï¼ˆä¾‹å¦‚ç£ç›˜æ…¢æ—¶ï¼‰</span><br><span class="hljs-comment"># hiç¡¬ä¸­æ–­ï¼ˆhardware IRQï¼‰å ç”¨</span><br><span class="hljs-comment"># siè½¯ä¸­æ–­ï¼ˆsoftware IRQï¼‰å ç”¨</span><br><span class="hljs-comment"># stè¢«è™šæ‹Ÿæœºå·èµ°çš„ CPUï¼ˆsteal timeï¼‰</span><br>MiB Mem :   1871.0 total,    761.0 free,    498.8 used,    770.9 buff/cache<br><span class="hljs-comment"># totalæ€»å†…å­˜</span><br><span class="hljs-comment"># freeæœªä½¿ç”¨çš„å†…å­˜</span><br><span class="hljs-comment"># usedå®é™…å·²ç”¨çš„å†…å­˜ï¼ˆä¸åŒ…æ‹¬ cache/bufferï¼‰</span><br><span class="hljs-comment"># buff/cacheç³»ç»Ÿç¼“å­˜å’Œç¼“å†²ä½¿ç”¨çš„å†…å­˜ï¼ˆå¯å›æ”¶ï¼‰</span><br>MiB Swap:      0.0 total,      0.0 free,      0.0 used.   1372.2 avail Mem<br><span class="hljs-comment"># totaläº¤æ¢åˆ†åŒºæ€»é‡ï¼ˆä½ è¿™é‡Œæ²¡æœ‰å¯ç”¨ swapï¼‰</span><br><span class="hljs-comment"># freeç©ºé—²çš„ swap ç©ºé—´</span><br><span class="hljs-comment"># usedå·²ç”¨ swap ç©ºé—´</span><br><span class="hljs-comment"># avail Memå¯ç”¨å†…å­˜ï¼šåŒ…å« free + reclaimable cacheï¼Œæ›´çœŸå®åœ°åæ˜ å¯ç”¨å†…å­˜</span><br><br> PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND<br> 1239 root      20   0  222028  97448   7212 S   0.7   5.1 216:30.97 AliYunDunMonito<br><br></code></pre></td></tr></table></figure><h1 id="vmstat-æŸ¥çœ‹ç³»ç»Ÿå†…å­˜ï¼ŒIO-CPUä¿¡æ¯"><a href="#vmstat-æŸ¥çœ‹ç³»ç»Ÿå†…å­˜ï¼ŒIO-CPUä¿¡æ¯" class="headerlink" title="vmstat  æŸ¥çœ‹ç³»ç»Ÿå†…å­˜ï¼ŒIO, CPUä¿¡æ¯"></a>vmstat  æŸ¥çœ‹ç³»ç»Ÿå†…å­˜ï¼ŒIO, CPUä¿¡æ¯</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs bash">vmstat<br>procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----<br> r  b   swpd   free   buff  cache   si   so    bi    bo   <span class="hljs-keyword">in</span>   cs us sy <span class="hljs-built_in">id</span> wa st<br> 2  0      0 778652 103472 686320    0    0     3     6    7    8  1  0 99  0  0<br><br>procs è¿›ç¨‹<br>rå¯è¿è¡Œè¿›ç¨‹æ•°ï¼ˆrun queueï¼‰ï¼Œè¡¨ç¤º CPU ç­‰å¾…é˜Ÿåˆ—é•¿åº¦<br>bæ­£åœ¨ç­‰å¾… I/O çš„è¿›ç¨‹æ•°é‡ï¼ˆblockedï¼‰<br><br>memory å†…å­˜<br>swpdä½¿ç”¨çš„ swap ç©ºé—´ï¼ˆå•ä½ KBï¼‰<br>freeç©ºé—²ç‰©ç†å†…å­˜<br>buffç”¨ä½œ buffer çš„å†…å­˜ï¼ˆä¸»è¦ç¼“å­˜å—è®¾å¤‡å…ƒæ•°æ®ï¼‰<br>cacheç”¨ä½œ cache çš„å†…å­˜ï¼ˆä¸»è¦ç¼“å­˜æ–‡ä»¶å†…å®¹ï¼‰<br><br>swap äº¤æ¢<br>siä» swap ä¸­è¯»å…¥çš„æ•°æ®é‡ï¼ˆKB/sï¼‰<br>soå†™å…¥ swap çš„æ•°æ®é‡ï¼ˆKB/sï¼‰<br><br>io ç£ç›˜è¯»å†™<br>biä»å—è®¾å¤‡è¯»å…¥æ•°æ®çš„é€Ÿç‡ï¼ˆblock <span class="hljs-keyword">in</span>ï¼ŒKB/sï¼‰<br>boå†™åˆ°å—è®¾å¤‡çš„æ•°æ®é€Ÿç‡ï¼ˆblock outï¼ŒKB/sï¼‰<br><br>system ç³»ç»Ÿçº§æ“ä½œ<br><span class="hljs-keyword">in</span>æ¯ç§’ä¸­æ–­æ¬¡æ•°ï¼ˆåŒ…æ‹¬ç¡¬ä»¶ä¸­æ–­ + è½¯ä»¶ä¸­æ–­ï¼‰<br>csæ¯ç§’ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°ï¼ˆcontext switchï¼‰<br><br>cpu  cpuæ—¶é—´ç™¾åˆ†æ¯”<br>usç”¨æˆ·æ€ CPU ä½¿ç”¨ç™¾åˆ†æ¯”<br>syå†…æ ¸æ€ CPU ä½¿ç”¨ç™¾åˆ†æ¯”<br><span class="hljs-built_in">id</span>ç©ºé—²æ—¶é—´ç™¾åˆ†æ¯”<br>waç­‰å¾… I/O ç™¾åˆ†æ¯”ï¼ˆé«˜è¯´æ˜ I/O æ…¢ï¼‰<br>stè¢«è™šæ‹Ÿæœºâ€œå·èµ°â€çš„ CPU æ—¶é—´ï¼ˆåªåœ¨è™šæ‹ŸåŒ–ç¯å¢ƒä¸­æœ‰ç”¨ï¼‰<br></code></pre></td></tr></table></figure><h1 id="pidstat"><a href="#pidstat" class="headerlink" title="pidstat"></a>pidstat</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">pidstat -p 1239 1 1<br>æŸ¥è¯¢ è¿›ç¨‹å·1239çš„ä¿¡æ¯<br>Linux 5.10.134-18.al8.x86_64 (iZbp19tqlmjz1dmnm8w43uZ)  04/09/2025      _x86_64_        (2 CPU)<br><br>10:56:06 PM   UID       PID    %usr %system  %guest   %<span class="hljs-built_in">wait</span>    %CPU   CPU  Command<br>10:56:07 PM     0      1239    0.99    0.00    0.00    0.00    0.99     1  AliYunDunMonito<br><br>UIDæ‹¥æœ‰è¯¥è¿›ç¨‹çš„ç”¨æˆ· ID<br>PIDè¿›ç¨‹ ID<br>%usrç”¨æˆ·æ€ CPU ä½¿ç”¨ç™¾åˆ†æ¯”<br>%systemå†…æ ¸æ€ CPU ä½¿ç”¨ç™¾åˆ†æ¯”<br>%CPUæ€» CPU å ç”¨ï¼ˆusr + systemï¼‰<br>CPUè¿è¡Œè¯¥è¿›ç¨‹çš„ CPU æ ¸å¿ƒç¼–å·<br>Commandå¯æ‰§è¡Œæ–‡ä»¶åï¼ˆè¿›ç¨‹åï¼‰<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Shell</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Shell I æ¦‚å¿µä¸åŸºæœ¬å‘½ä»¤</title>
    <link href="/2025/04/09/Shell-1/"/>
    <url>/2025/04/09/Shell-1/</url>
    
    <content type="html"><![CDATA[<h1 id="Shell"><a href="#Shell" class="headerlink" title="Shell"></a>Shell</h1><h1 id="ä»€ä¹ˆæ˜¯Shell"><a href="#ä»€ä¹ˆæ˜¯Shell" class="headerlink" title="ä»€ä¹ˆæ˜¯Shell ?"></a>ä»€ä¹ˆæ˜¯Shell ?</h1><p>Shell æ˜¯ä¸€ç§åº”ç”¨äºlinuxç³»ç»Ÿçš„å‘½ä»¤è¡Œè§£é‡Šå™¨å·¥å…·çš„é€šç§°ã€‚ï¼ˆåŠŸèƒ½å®ç°å±‚é¢ï¼‰</p><ul><li>ç”¨æˆ·å‘shell å‘å‡ºå‘½ä»¤æ—¶<ul><li>1 å¦‚æœæ˜¯å†…ç½®å‘½ä»¤ï¼Œåˆ™ç›´æ¥åœ¨å½“å‰è¿›ç¨‹æ‰§è¡Œå†…ç½®å‘½ä»¤ã€‚ï¼ˆå†…ç½®å‘½ä»¤å¦‚cd,echo,å¯ä»¥ä½¿ç”¨typeæŸ¥è¯¢ï¼‰</li><li>2å¦‚æœæ˜¯éå†…ç½®å‘½ä»¤ï¼Œåˆ™fork() ä¸€ä¸ªå­è¿›ç¨‹ï¼Œåœ¨å­è¿›ç¨‹ä¸­æ‰§è¡Œç”¨æˆ·è¾“å…¥çš„å‘½ä»¤ã€‚</li></ul></li></ul><p>Shell æ˜¯æ–°ç”¨æˆ·æ¥å…¥æœåŠ¡å™¨åå¯åŠ¨çš„é»˜è®¤æŒ‚èµ·ç¨‹åºã€‚ ï¼ˆåº”ç”¨å±‚é¢ï¼‰</p><ul><li>åº”ç”¨æ‰§è¡Œå®Œæ¯•åï¼Œä¼šå…³é—­è¿›ç¨‹ã€‚ä¸ºäº†ä½¿ç”¨æˆ·å¯ä»¥æ­£å¸¸ä¸æœåŠ¡å™¨äº¤äº’ï¼Œ<ul><li>éœ€è¦ä¸€ä¸ªè¿›ç¨‹åœ¨å‰å°æŒ‚èµ·ï¼ŒæŒç»­ç­‰å¾…ç”¨æˆ·è¾“å…¥å‘½ä»¤</li></ul></li></ul><p>Shell æ˜¯ä½œç”¨äºç”¨æˆ·å’Œæ“ä½œç³»ç»Ÿå†…æ ¸é—´çš„ä¸­é—´ç¨‹åºï¼Œä¸ºç”¨æˆ·æä¾›æœåŠ¡ï¼Œæ‰§è¡Œæ“ä½œç³»ç»ŸåŠŸèƒ½ã€‚ï¼ˆç³»ç»Ÿæ¶æ„å±‚é¢ï¼‰</p><ul><li>è®¸å¤šç¨‹åºéœ€è¦é€šè¿‡ç³»ç»Ÿè°ƒç”¨æ¥å®ç°å…¶åŠŸèƒ½ï¼Œè€Œå…è®¸ç”¨æˆ·ç›´æ¥è®¿é—®å†…æ ¸åŠŸèƒ½æ˜¯ä¸å®‰å…¨çš„ã€‚æ‰€ä»¥é€šè¿‡shellå‘½ä»¤æ¥è¿›è¡Œç³»ç»Ÿè°ƒç”¨å®Œæˆç³»ç»Ÿã€‚</li></ul><p><img src="https://i.111666.best/image/P9kPm8BDRhogLaekV6yAYq.png" alt="image"></p><h1 id="Shell-çš„æ‰§è¡Œæ ¼å¼"><a href="#Shell-çš„æ‰§è¡Œæ ¼å¼" class="headerlink" title="Shell çš„æ‰§è¡Œæ ¼å¼"></a>Shell çš„æ‰§è¡Œæ ¼å¼</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">    <span class="hljs-comment">#               command                                - parameter                 value </span><br><br><span class="hljs-comment">#ç³»ç»Ÿæç¤ºç¬¦         shellå‘½ä»¤æˆ–å…¶ä»–å¯æ‰§è¡Œç¨‹åº               é€‰é¡¹                        ä¼ å…¥çš„å‚æ•°</span><br></code></pre></td></tr></table></figure><p>ç‹¬ç«‹çš„å‘½ä»¤çš„å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#  å½“é€šè¿‡ yum , dnf (centos)æˆ–è€… apt(ubuntu) è¿›è¡Œå‘½ä»¤å®‰è£…å</span><br><span class="hljs-comment">#  å¯¹åº”çš„å‘½ä»¤ä¼šæ”¾ç½®åœ¨/user/bin æ–‡ä»¶ç›®å½•ä¸‹ã€‚ shellå‘½ä»¤æ‰§è¡Œæ—¶ä¼šå»è¯¥ç›®å½•ä¸‹å¯»æ‰¾</span><br><span class="hljs-comment">#  å¦‚ [root@iZbp19tqlmjz1dmnm8w43uZ ~]# unzip</span><br><span class="hljs-comment">#  -bash: /usr/bin/unzip: No such file or directory</span><br><span class="hljs-comment">#  æœ‰äº›ç¨‹åºå®‰è£…å å¹¶ä¸ä¼šç›´æ¥å®‰è£…åˆ°/user/bin éœ€è¦åˆ›å»ºè½¯é“¾æ¥ å°†ç¨‹åºæ˜ å°„åˆ°/user/bin ç›®å½•</span><br>   <span class="hljs-built_in">ln</span>             -s            /user/local/bin/xxx   /user/bin/xxx<br><span class="hljs-comment">#  åˆ›å»ºé“¾æ¥      æŒ‡å®šä¸ºè½¯é“¾æ¥    å®‰è£…ç›®å½•               é“¾æ¥</span><br></code></pre></td></tr></table></figure><h1 id="åŸºç¡€å‘½ä»¤"><a href="#åŸºç¡€å‘½ä»¤" class="headerlink" title="åŸºç¡€å‘½ä»¤"></a>åŸºç¡€å‘½ä»¤</h1><h2 id="æ¸…ç©ºå±å¹•æ‰“å°-clear"><a href="#æ¸…ç©ºå±å¹•æ‰“å°-clear" class="headerlink" title="æ¸…ç©ºå±å¹•æ‰“å° - clear"></a>æ¸…ç©ºå±å¹•æ‰“å° - clear</h2><ul><li>åªæ˜¯å°†è¾“å…¥ç½®äºé¡¶ç«¯</li></ul><h2 id="å›æ˜¾æ‰“å°-echo"><a href="#å›æ˜¾æ‰“å°-echo" class="headerlink" title="å›æ˜¾æ‰“å° - echo"></a>å›æ˜¾æ‰“å° - echo</h2><h2 id="æŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•-pwd"><a href="#æŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•-pwd" class="headerlink" title="æŸ¥çœ‹å½“å‰å·¥ä½œç›®å½• - pwd"></a>æŸ¥çœ‹å½“å‰å·¥ä½œç›®å½• - pwd</h2><h2 id="æŸ¥çœ‹è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶å-basename"><a href="#æŸ¥çœ‹è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶å-basename" class="headerlink" title="æŸ¥çœ‹è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶å - basename"></a>æŸ¥çœ‹è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶å - basename</h2><ul><li>basename [ path ] [ suffix ]</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ ~]# <span class="hljs-built_in">touch</span> hello.world<br>[root@iZbp19tqlmjz1dmnm8w43uZ ~]# <span class="hljs-built_in">basename</span> /root/hello.world .world<br>hello<br><br></code></pre></td></tr></table></figure><h2 id="æŸ¥è¯¢ç›®å½•ä¸‹çš„å†…å®¹-ls"><a href="#æŸ¥è¯¢ç›®å½•ä¸‹çš„å†…å®¹-ls" class="headerlink" title="æŸ¥è¯¢ç›®å½•ä¸‹çš„å†…å®¹ - ls"></a>æŸ¥è¯¢ç›®å½•ä¸‹çš„å†…å®¹ - ls</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">-l <span class="hljs-comment">#ä»¥é•¿æ ¼å¼æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯ï¼ˆæƒé™ã€æ‰€æœ‰è€…ã€ç»„ã€å¤§å°ã€ä¿®æ”¹æ—¶é—´ç­‰ï¼‰</span><br>-a <span class="hljs-comment">#æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ï¼ˆä»¥ . å¼€å¤´çš„æ–‡ä»¶ï¼‰</span><br>-h <span class="hljs-comment">#ä¸ -l ä¸€èµ·ä½¿ç”¨ï¼Œä»¥äººç±»å¯è¯»çš„æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤§å°ï¼ˆKBã€MBã€GBï¼‰</span><br>-t <span class="hljs-comment">#æŒ‰ä¿®æ”¹æ—¶é—´æ’åºï¼ˆæœ€æ–°çš„åœ¨å‰ï¼‰</span><br>-r <span class="hljs-comment">#åå‘æ’åº</span><br>-R <span class="hljs-comment">#é€’å½’åœ°åˆ—å‡ºå­ç›®å½•ä¸­çš„æ–‡ä»¶</span><br></code></pre></td></tr></table></figure><h2 id="ä¿®æ”¹æ–‡ä»¶æƒé™"><a href="#ä¿®æ”¹æ–‡ä»¶æƒé™" class="headerlink" title="ä¿®æ”¹æ–‡ä»¶æƒé™"></a>ä¿®æ”¹æ–‡ä»¶æƒé™</h2><p>linuxä¸­ æ–‡ä»¶çš„ è¯»ï¼Œå†™ï¼Œæ‰§è¡Œæƒé™ è¢«è®¾ç½®ä¸ºäº†3ç§ ï¼š æ‰€æœ‰è€…ï¼Œæ‰€å±ç”¨æˆ·ç»„ï¼Œå…¶ä»–ç”¨æˆ·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å½“ä½¿ç”¨ls -l æ—¶,å¯ä»¥çœ‹åˆ°å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶æƒé™æè¿°</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">ls</span> -l<br>total 4<br>-rw-r--r-- 1 root root 7 Mar 28 00:44 hello.txt<br><br><span class="hljs-comment"># &quot;-&quot; è¡¨ç¤ºæ˜¯ä¸€ä¸ªæ–‡ä»¶ å…¶ä»–ç±»å‹å¦‚ d:ç›®å½•ï¼Œl:é“¾æ¥ï¼Œb:å—è®¾å¤‡ï¼Œc:å­—ç¬¦è®¾å¤‡æ–‡ä»¶</span><br><span class="hljs-comment"># rwx  åˆ†åˆ«ä»£è¡¨r å¯è¯» w å¯å†™ x å¯æ‰§è¡Œ</span><br><span class="hljs-comment"># æ‰€ä»¥ä¸Šè¿° hello.txt æ–‡ä»¶ ä»£è¡¨ å½“å‰æ–‡ä»¶æ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶ï¼Œå¯ä»¥è¢«ç”¨æˆ·æ‰€æœ‰è€…è¯»å†™ï¼Œæ‰€å±ç”¨æˆ·ç»„å’Œå…¶ä»–ç”¨æˆ·å¯è¯»</span><br><span class="hljs-comment"># ä½¿ç”¨chmod æ¥ä¿®æ”¹ç”¨æˆ·æƒé™ æƒé™è¡¨ç¤ºä¸ºæ¯”ç‰¹ç½®ä½ã€‚å½“æˆäºˆæ‰€æœ‰æƒé™æ—¶ä¸º 4+2+1 = 7</span><br><span class="hljs-comment"># æ‰€ä»¥ æˆäºˆæ‰€æœ‰è€…æ‰§è¡Œæƒé™ä¸º:</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">chmod</span> +100 hello.txt<br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">ls</span> -l<br>total 4<br>-rwxr--r-- 1 root root 7 Mar 28 00:44 hello.txt<br><span class="hljs-comment"># æˆäºˆå…¶ä»–ç”¨æˆ·è¯»å†™æƒé™ä¸º:</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">chmod</span> +006 hello.txt<br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">ls</span> -l<br>total 4<br>-rwxr--rw- 1 root root 7 Mar 28 00:44 hello.txt<br><span class="hljs-comment"># å»é™¤æ‰€å±ç”¨æˆ·ç»„è¯»æƒé™ä¸º:</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">ls</span> -l<br>total 4<br>-rwx---rw- 1 root root 7 Mar 28 00:44 hello.txt<br><br></code></pre></td></tr></table></figure><h2 id="ç”¨æˆ·è®¿é—®æƒé™"><a href="#ç”¨æˆ·è®¿é—®æƒé™" class="headerlink" title="ç”¨æˆ·è®¿é—®æƒé™"></a>ç”¨æˆ·è®¿é—®æƒé™</h2><p>åœ¨æ–‡ä»¶çš„inodeä¸­å­˜å‚¨äº†4å­—èŠ‚çš„æ–‡ä»¶æƒé™å†…å®¹æè¿°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">        -             <br><span class="hljs-comment">#æ–‡ä»¶ç±»å‹(1 å­—èŠ‚ -,d,l,b,c)  #uid gid sticky(3ä½)  rwx rwx rwx  </span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥å½“æˆ‘ä»¬æƒ³è¦è®¿é—®æ–‡ä»¶æ—¶</p><ol><li>æŸ¥çœ‹å½“å‰ç”¨æˆ·æ˜¯å¦å…·æœ‰å½“å‰æ–‡ä»¶çš„è¯»å†™æ‰§è¡Œæƒé™ï¼Œä½¿ç”¨chmod æ·»åŠ å¯¹åº”çš„æƒé™ï¼ˆå½±å“æœ€å°</li><li>ä½¿ç”¨chown ï¼Œ chgrp ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€… ï¼Œæ‰€å±ç»„ æ¥è·å¾—æƒé™</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">ls</span> -l<br>total 4<br>-rwx---rw- 1 root root 7 Mar 28 00:44 hello.txt<br><span class="hljs-comment"># å½“å‰æ–‡ä»¶ æ‰€æœ‰è€…å…·æœ‰è¯»å†™æ‰§è¡Œæƒé™ï¼Œå…¶ä»–ç”¨æˆ·å…·æœ‰è¯»å†™æƒé™</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">chmod</span> -006 hello.txt<br><span class="hljs-comment"># æ¸…é™¤å…¶ä»–ç”¨æˆ·æƒé™</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# su cod<br><span class="hljs-comment"># åˆ‡æ¢åˆ°å…¶ä»–ç”¨æˆ·ï¼Œç”¨æˆ·æ— æ³•æ‰§è¡Œè¯»å†™</span><br>[cod@iZbp19tqlmjz1dmnm8w43uZ hello]$ <span class="hljs-built_in">cat</span> hello.txt<br><span class="hljs-built_in">cat</span>: hello.txt: Permission denied<br>[cod@iZbp19tqlmjz1dmnm8w43uZ hello]$ <span class="hljs-built_in">echo</span> hello &gt;hello.txt<br>bash: hello.txt: Permission denied<br>[cod@iZbp19tqlmjz1dmnm8w43uZ hello]$ <span class="hljs-built_in">exit</span><br><span class="hljs-built_in">exit</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">chown</span> cod hello.txt<br><span class="hljs-comment"># åˆ‡æ¢æ–‡ä»¶æ‰€æœ‰è¿™ä¸ºcod, codç”¨æˆ·å¾—åˆ°äº†è¯»å†™æƒé™</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# su cod<br>[cod@iZbp19tqlmjz1dmnm8w43uZ hello]$ <span class="hljs-built_in">cat</span> hello.txt<br>ä½ å¥½<br>[cod@iZbp19tqlmjz1dmnm8w43uZ hello]$ <span class="hljs-built_in">echo</span> hello &gt; hello.txt<br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">chmod</span> +070 hello.txt<br><span class="hljs-comment"># å‘æ–‡ä»¶æ·»åŠ æ‰€å±ç»„çš„è®¿é—®æƒé™</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">ls</span> -l<br>total 4<br>-rwxrwx--- 1 root root 6 Apr  9 17:45 hello.txt<br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">chgrp</span> cod hello.txt<br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">chown</span> root hello.txt<br><span class="hljs-comment"># ä¿®æ”¹æ‰€å±ç»„ä¸ºcod,æ‰€æœ‰è€…ä¸ºroot,ä½¿ç”¨æ‰€å±ç»„è®¿é—®</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">ls</span> -l<br>total 4<br>-rwxrwx--- 1 root cod 6 Apr  9 17:45 hello.txt<br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# su cod<br>[cod@iZbp19tqlmjz1dmnm8w43uZ hello]$ <span class="hljs-built_in">cat</span> hello.txt<br>hello<br>[cod@iZbp19tqlmjz1dmnm8w43uZ hello]$ <span class="hljs-built_in">echo</span> ä½ å¥½ &gt;hello.txt<br>[cod@iZbp19tqlmjz1dmnm8w43uZ hello]$ <span class="hljs-built_in">cat</span> hello.txt<br>ä½ å¥½<br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">chmod</span>+7777 hello.txt<br><span class="hljs-comment"># ä¿®æ”¹æ‰€æœ‰ç½®ä½ï¼Œå¯ä»¥çœ‹åˆ°æ‰€æœ‰è€…å’Œæ‰€å±ç»„å˜ä¸ºs</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">ls</span> -l<br>total 4<br>-rwsrwsrwt 1 root cod 7 Apr  9 18:07 hello.txt<br><br></code></pre></td></tr></table></figure><h2 id="åˆ‡æ¢ç›®å½•-cd"><a href="#åˆ‡æ¢ç›®å½•-cd" class="headerlink" title="åˆ‡æ¢ç›®å½• - cd"></a>åˆ‡æ¢ç›®å½• - cd</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ codfish]# <span class="hljs-built_in">cd</span> hello/<br><span class="hljs-comment"># ç§»åŠ¨åˆ°helloç›®å½•</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ hello]# <span class="hljs-built_in">cd</span> ..<br><span class="hljs-comment"># è¿”å›ä¸Šçº§ç›®å½•</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ codfish]# <span class="hljs-built_in">cd</span> ~<br><span class="hljs-comment"># è¿”å›homeç›®å½•</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ ~]#<br><br></code></pre></td></tr></table></figure><h2 id="æ‹·è´æ–‡ä»¶æˆ–ç›®å½•-cp"><a href="#æ‹·è´æ–‡ä»¶æˆ–ç›®å½•-cp" class="headerlink" title="æ‹·è´æ–‡ä»¶æˆ–ç›®å½• - cp"></a>æ‹·è´æ–‡ä»¶æˆ–ç›®å½• - cp</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">cp</span> hello hello2<br>[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">ls</span><br>hello  hello2<br><br></code></pre></td></tr></table></figure><h2 id="åˆ›å»ºæ–‡ä»¶ç›®å½•-mkdir"><a href="#åˆ›å»ºæ–‡ä»¶ç›®å½•-mkdir" class="headerlink" title="åˆ›å»ºæ–‡ä»¶ç›®å½• - mkdir"></a>åˆ›å»ºæ–‡ä»¶ç›®å½• - mkdir</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">mkdir</span> hi<br>[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">mkdir</span> -p one/two<br><span class="hljs-comment"># é€’å½’åˆ›å»º</span><br>[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">cd</span> one/two/<br>[root@iZbp19tqlmjz1dmnm8w43uZ two]#<br><br></code></pre></td></tr></table></figure><h2 id="ç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•-mv"><a href="#ç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•-mv" class="headerlink" title="ç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•  - mv"></a>ç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•  - mv</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">ls</span><br>hello2  hello<br>[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">mv</span> hello hi<br>[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">ls</span><br>hello2  hi<br><br></code></pre></td></tr></table></figure><h2 id="åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•-rm"><a href="#åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•-rm" class="headerlink" title="åˆ é™¤æ–‡ä»¶æˆ–ç›®å½• - rm"></a>åˆ é™¤æ–‡ä»¶æˆ–ç›®å½• - rm</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">rm</span> hi<br><span class="hljs-built_in">rm</span>: remove regular empty file <span class="hljs-string">&#x27;hi&#x27;</span>? y<br>[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">mkdir</span> hi<br>[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">rm</span> -r hi<br><span class="hljs-built_in">rm</span>: remove directory <span class="hljs-string">&#x27;hi&#x27;</span>? y<br>[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">rm</span> -rf hi<br><span class="hljs-comment"># é€’å½’åˆ é™¤ç›®å½•åŠæ–‡ä»¶</span><br><br></code></pre></td></tr></table></figure><h2 id="åˆ›å»ºç©ºæ–‡ä»¶-touch"><a href="#åˆ›å»ºç©ºæ–‡ä»¶-touch" class="headerlink" title="åˆ›å»ºç©ºæ–‡ä»¶ - touch"></a>åˆ›å»ºç©ºæ–‡ä»¶ - touch</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">touch</span> file<br>[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">ls</span><br>file<br></code></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹æ–‡ä»¶å†…å®¹"><a href="#æŸ¥çœ‹æ–‡ä»¶å†…å®¹" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶å†…å®¹"></a>æŸ¥çœ‹æ–‡ä»¶å†…å®¹</h2><p>cat  ç›´æ¥æŸ¥çœ‹æ•´ä¸ªæ–‡ä»¶çš„å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">cat</span> file<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br></code></pre></td></tr></table></figure><p>more  äº¤äº’å¼æŸ¥çœ‹æ–‡ä»¶å†…å®¹</p><p>less</p><p>head  ä»å¤´éƒ¨æŸ¥çœ‹æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">head</span> -n 3 file<br>1<br>2<br>3<br><br></code></pre></td></tr></table></figure><p>tail ä»å°¾éƒ¨æŸ¥çœ‹æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">tail</span> -n 3 file<br>8<br>9<br>10<br></code></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹æ–‡ä»¶-ç›®å½•-å®é™…ä¿¡æ¯-ï¼ˆinode-block-åœ°å€ï¼‰-stat"><a href="#æŸ¥çœ‹æ–‡ä»¶-ç›®å½•-å®é™…ä¿¡æ¯-ï¼ˆinode-block-åœ°å€ï¼‰-stat" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶&#x2F;ç›®å½• å®é™…ä¿¡æ¯ ï¼ˆinode&#x2F;block åœ°å€ï¼‰- stat"></a>æŸ¥çœ‹æ–‡ä»¶&#x2F;ç›®å½• å®é™…ä¿¡æ¯ ï¼ˆinode&#x2F;block åœ°å€ï¼‰- stat</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ cod]# <span class="hljs-built_in">stat</span> file<br>  File: file<br>  Size: 21              Blocks: 8          IO Block: 4096   regular file<br>Device: fd03h/64771d    Inode: 1224103     Links: 1<br>Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)<br>Access: 2025-04-09 21:05:51.065782226 +0800<br>Modify: 2025-04-09 21:05:49.079699125 +0800<br>Change: 2025-04-09 21:05:49.081699209 +0800<br> Birth: 2025-04-09 21:05:49.079699125 +0800<br><br></code></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯-file"><a href="#æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯-file" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯ - file"></a>æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯ - file</h2><h2 id="å‹ç¼©-è§£å‹ç¼©-tar-czf-xzf"><a href="#å‹ç¼©-è§£å‹ç¼©-tar-czf-xzf" class="headerlink" title="å‹ç¼©&#x2F;è§£å‹ç¼©  - tar(czf&#x2F;xzf)"></a>å‹ç¼©&#x2F;è§£å‹ç¼©  - tar(czf&#x2F;xzf)</h2>]]></content>
    
    
    <categories>
      
      <category>Shell</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®¹å™¨ç½‘ç»œ</title>
    <link href="/2025/04/06/%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C/"/>
    <url>/2025/04/06/%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C/</url>
    
    <content type="html"><![CDATA[<h1 id="Dockerç½‘ç»œ"><a href="#Dockerç½‘ç»œ" class="headerlink" title="Dockerç½‘ç»œ"></a>Dockerç½‘ç»œ</h1><h2 id="Veth"><a href="#Veth" class="headerlink" title="Veth"></a>Veth</h2><p>vethï¼ˆVirtual Ethernetï¼‰æ˜¯Linuxä¸­çš„ä¸€ç§è™šæ‹Ÿç½‘ç»œè®¾å¤‡ï¼Œå®ƒå·¥ä½œåœ¨ç¬¬äºŒå±‚ï¼ˆæ•°æ®é“¾è·¯å±‚ï¼‰ï¼Œä¸»è¦ç”¨äºè¿æ¥ä¸åŒçš„ç½‘ç»œå‘½åç©ºé—´ï¼ˆnetwork namespacesï¼‰ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><p>vethè®¾å¤‡æ€»æ˜¯æˆå¯¹å‡ºç°ï¼Œç±»ä¼¼äºä¸€æ ¹ç½‘çº¿çš„ä¸¤ç«¯ã€‚å½“æ•°æ®åŒ…ä»ä¸€ç«¯å‘å‡ºåï¼Œä¼šç«‹å³ä»å¦ä¸€ç«¯æ”¶åˆ°ã€‚è¿™ç§ç‰¹æ€§ä½¿å®ƒæˆä¸ºè¿æ¥ä¸åŒç½‘ç»œå‘½åç©ºé—´çš„ç†æƒ³å·¥å…·ã€‚</p><h3 id="ä¸»è¦ç‰¹ç‚¹"><a href="#ä¸»è¦ç‰¹ç‚¹" class="headerlink" title="ä¸»è¦ç‰¹ç‚¹"></a>ä¸»è¦ç‰¹ç‚¹</h3><ol><li><strong>æˆå¯¹åˆ›å»º</strong>ï¼švethè®¾å¤‡å¿…é¡»æˆå¯¹åˆ›å»ºï¼Œä¸€ç«¯å‘é€çš„æ•°æ®ä¼šä»å¦ä¸€ç«¯æ¥æ”¶ã€‚</li><li><strong>è·¨å‘½åç©ºé—´é€šä¿¡</strong>ï¼švethå¯¹çš„ä¸¤ç«¯å¯ä»¥ä½äºä¸åŒçš„ç½‘ç»œå‘½åç©ºé—´ä¸­ï¼Œæ˜¯Linuxå®ç°ç½‘ç»œè™šæ‹ŸåŒ–çš„åŸºç¡€è®¾æ–½ã€‚</li><li><strong>æ— çŠ¶æ€</strong>ï¼švethè®¾å¤‡æœ¬èº«ä¸å­˜å‚¨ä»»ä½•çŠ¶æ€ä¿¡æ¯ï¼Œä»…ä½œä¸ºæ•°æ®çš„ä¼ è¾“é€šé“ã€‚</li><li><strong>æ”¯æŒæ ‡å‡†ç½‘ç»œæ“ä½œ</strong>ï¼šå¯ä»¥ä¸ºvethè®¾å¤‡é…ç½®IPåœ°å€ã€æ·»åŠ è·¯ç”±ã€è®¾ç½®é˜²ç«å¢™è§„åˆ™ç­‰ã€‚</li></ol><h3 id="Vethå·¥ä½œæ¨¡å¼"><a href="#Vethå·¥ä½œæ¨¡å¼" class="headerlink" title="Vethå·¥ä½œæ¨¡å¼"></a>Vethå·¥ä½œæ¨¡å¼</h3><p><img src="https://i.111666.best/image/cd1vfax0o2HRKQWO1OAGwY.png" alt="image"></p><p>veth çš„å®¿ä¸»ç«¯æ¥å£ï¼Œåœ¨æœªæ¥å…¥ bridge ä¸”é…ç½® IP æ—¶ï¼Œå¯ç±»æ¯”ä¸º VLAN å­ç½‘çš„é»˜è®¤ç½‘å…³ï¼›</p><p>è€Œå½“åŠ å…¥ bridge æ—¶ï¼Œå®ƒå°±é€€åŒ–æˆçº¯äºŒå±‚æ¥å…¥å£ï¼Œæˆä¸º bridge å†…éƒ¨ä»¥å¤ªå¸§è½¬å‘çš„ç«¯å£ï¼Œä¸åº”å†æ‰¿æ‹… IP å±‚é€šä¿¡è§’è‰²ã€‚</p><h3 id="Vethè®¾å¤‡ç«¯é…ç½®"><a href="#Vethè®¾å¤‡ç«¯é…ç½®" class="headerlink" title="Vethè®¾å¤‡ç«¯é…ç½®"></a>Vethè®¾å¤‡ç«¯é…ç½®</h3><p>å®¿ä¸»æœºé…ç½®ç½‘ç»œâ†’åˆ›å»ºå®¹å™¨â†’å°†ç½‘ç»œåŠ å…¥å®¹å™¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#å®¿ä¸»æœº </span><br><span class="hljs-built_in">sudo</span> ip <span class="hljs-built_in">link</span> add veth-c <span class="hljs-built_in">type</span> veth peer name veth-br  <span class="hljs-comment"># é…ç½®ç»“ä¼´ç½‘ç»œ</span><br><span class="hljs-built_in">sudo</span> ip addr add  192.168.100.100/24  dev  veth-br <span class="hljs-comment">#é…ç½®ip ä¿¡æ¯</span><br><span class="hljs-built_in">sudo</span> ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> veth-br up<br><br><span class="hljs-comment">#åˆ›å»ºå®¹å™¨åï¼Œåœ¨å®¿ä¸»æœºæŸ¥è¯¢å®¹å™¨è¿›ç¨‹ï¼Œæ·»åŠ ç½‘ç»œåˆ°å®¿ä¸»æœº</span><br><span class="hljs-built_in">sudo</span> ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> veth-c netns 968998<br><br><span class="hljs-comment">#å®¹å™¨</span><br>ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> veth-c up<br>ip addr add 192.168.100.100/24 dev veth-c<br></code></pre></td></tr></table></figure><p>åˆ›å»ºç½‘ç»œå‘½åç©ºé—´â†’åˆ›å»ºvethç½‘ç»œâ†’æ·»åŠ vethç½‘ç»œåˆ°ç½‘ç»œå‘½åç©ºç©ºé—´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å®¿ä¸»æœºæ·»åŠ ç½‘ç»œå‘½åç©ºé—´ net1</span><br>ip netns add net1<br><span class="hljs-comment"># æ·»åŠ veth ç½‘ç»œ</span><br>ip <span class="hljs-built_in">link</span> add veth1 <span class="hljs-built_in">type</span> veth peer name veth1_p<br><span class="hljs-comment"># ç»‘å®švethç½‘ç»œåˆ°ç½‘ç»œå‘½åç©ºé—´ net1</span><br>ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> veth1 netns net1<br>ip addr add 192.168.100.100/24 dev veth1_p<br><br><span class="hljs-comment">#é€šè¿‡å‘½ä»¤æ‰§è¡Œ</span><br>ip netns <span class="hljs-built_in">exec</span> net1 ip addr<br>ip netns <span class="hljs-built_in">exec</span> net1 ip addr add 192.168.100.102/24 dev veth1<br>ip netns <span class="hljs-built_in">exec</span> net1 ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> veth1 up<br></code></pre></td></tr></table></figure><p>ç½‘æ¡¥é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å®¿ä¸»æœº åˆ›å»º namespace</span><br>ip netns add ns1<br>ip netns add ns2<br><br><span class="hljs-comment"># åˆ›å»º veth pair</span><br>ip <span class="hljs-built_in">link</span> add veth-a <span class="hljs-built_in">type</span> veth peer name veth-a-ns<br>ip <span class="hljs-built_in">link</span> add veth-b <span class="hljs-built_in">type</span> veth peer name veth-b-ns<br><br><span class="hljs-comment"># æ”¾è¿› namespace</span><br>ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> veth-a-ns netns ns1<br>ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> veth-b-ns netns ns2<br><br><span class="hljs-comment"># è®¾ç½® IP</span><br>ip netns <span class="hljs-built_in">exec</span> ns1 ip addr add 192.168.100.10/24 dev veth-a-ns<br>ip netns <span class="hljs-built_in">exec</span> ns2 ip addr add 192.168.100.20/24 dev veth-b-ns<br><br><span class="hljs-comment"># å¯åŠ¨æ¥å£</span><br>ip netns <span class="hljs-built_in">exec</span> ns1 ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> veth-a-ns up<br>ip netns <span class="hljs-built_in">exec</span> ns2 ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> veth-b-ns up<br>ip netns <span class="hljs-built_in">exec</span> ns1 ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> lo up<br>ip netns <span class="hljs-built_in">exec</span> ns2 ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> lo up<br><br><span class="hljs-comment"># å®¿ä¸»æœºæ¥å£ up</span><br>ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> veth-a up<br>ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> veth-b up<br><br><span class="hljs-comment"># åˆ›å»º bridge</span><br>ip <span class="hljs-built_in">link</span> add br0 <span class="hljs-built_in">type</span> bridge<br>ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> br0 up<br>ip addr add 192.168.100.1/24 dev br0<br><br><span class="hljs-comment"># åŠ å…¥ bridge</span><br>ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> veth-a master br0<br>ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> veth-b master br0<br><br>ip netns <span class="hljs-built_in">exec</span> ns1 ping -c 3 192.168.100.20<br>ip netns <span class="hljs-built_in">exec</span> ns1 ping -c 3 192.168.100.1<br><br></code></pre></td></tr></table></figure><h2 id="å®¹å™¨å¤–éƒ¨ç½‘ç»œè®¿é—®"><a href="#å®¹å™¨å¤–éƒ¨ç½‘ç»œè®¿é—®" class="headerlink" title="å®¹å™¨å¤–éƒ¨ç½‘ç»œè®¿é—®"></a>å®¹å™¨å¤–éƒ¨ç½‘ç»œè®¿é—®</h2><p>è®¾ç½®ç½‘ç»œè½¬å‘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> iptables -A FORWARD -j ACCEPT<br>ç½®ä½  /proc/sys/net/ipv4/ip_forward<br></code></pre></td></tr></table></figure><p>Docker é€šè¿‡å‘iptableså†™å…¥è§„åˆ™ æ¥æ§åˆ¶ ç«¯å£æ˜ å°„è½¬å‘</p><h3 id="NATï¼ˆnetwork-address-translationï¼‰"><a href="#NATï¼ˆnetwork-address-translationï¼‰" class="headerlink" title="NATï¼ˆnetwork address translationï¼‰"></a>NATï¼ˆnetwork address translationï¼‰</h3><p>NAT (Network Address Translation) æ˜¯ä¸€ç§ç½‘ç»œæŠ€æœ¯ï¼Œå®ƒå…è®¸å¤šå°è®¾å¤‡é€šè¿‡å•ä¸ªå…¬å…± IP åœ°å€è®¿é—®äº’è”ç½‘ã€‚é€šè¿‡ä¸€å¼ æ˜ å°„è¡¨å®Œæˆå†…ç½‘å’Œå¤–ç½‘IPï¼Œç«¯å£é—´çš„è½¬æ¢</p><p>NAT çš„ä¸»è¦åŠŸèƒ½å’Œç‰¹ç‚¹ï¼š</p><ol><li>åœ°å€è½¬æ¢ï¼šNAT å°†å†…éƒ¨ç½‘ç»œä¸­çš„ç§æœ‰ IP åœ°å€è½¬æ¢ä¸ºå…¬å…± IP åœ°å€ï¼Œä½¿å¾—å†…éƒ¨ç½‘ç»œçš„è®¾å¤‡èƒ½å¤Ÿè®¿é—®äº’è”ç½‘</li><li>èŠ‚çº¦ IP åœ°å€èµ„æºï¼šç”±äº IPv4 åœ°å€èµ„æºæœ‰é™ï¼ŒNAT æŠ€æœ¯å¯ä»¥ä½¿å¤šå°è®¾å¤‡å…±äº«ä¸€ä¸ªå…¬å…± IP åœ°å€ï¼Œç¼“è§£äº† IP åœ°å€çŸ­ç¼ºé—®é¢˜</li><li>éšè—å†…éƒ¨ç½‘ç»œç»“æ„ï¼šNAT å¯ä»¥éšè—å†…éƒ¨ç½‘ç»œçš„çœŸå® IP åœ°å€ï¼Œæé«˜ç½‘ç»œå®‰å…¨æ€§</li></ol><p>NAT çš„ä¸»è¦ç±»å‹ï¼š</p><ol><li>é™æ€ NATï¼šä¸€å¯¹ä¸€æ˜ å°„ï¼Œæ¯ä¸ªç§æœ‰ IP åœ°å€å¯¹åº”ä¸€ä¸ªå›ºå®šçš„å…¬å…± IP åœ°å€</li><li>åŠ¨æ€ NATï¼šä»å…¬å…± IP åœ°å€æ± ä¸­åŠ¨æ€åˆ†é…åœ°å€</li><li>ç½‘ç»œåœ°å€ç«¯å£è½¬æ¢ï¼ˆNAPT&#x2F;PATï¼‰ï¼šæœ€å¸¸ç”¨çš„ç±»å‹ï¼Œå¤šä¸ªç§æœ‰ IP åœ°å€å…±äº«ä¸€ä¸ªå…¬å…± IP åœ°å€ï¼Œé€šè¿‡ä¸åŒçš„ç«¯å£å·åŒºåˆ†ä¸åŒçš„è¿æ¥</li></ol><h3 id="1-filterè¡¨"><a href="#1-filterè¡¨" class="headerlink" title="1.filterè¡¨"></a>1.filterè¡¨</h3><p>filteråŒ…å«3ä¸ªå†…ç½®é“¾ç”¨äºè¿‡æ»¤æ•°æ®åŒ…ï¼ŒåŒ…å«ä¸‰ä¸ªå†…ç½®é“¾ï¼š</p><ul><li>INPUTï¼šå¤„ç†å‘å¾€æœ¬æœºçš„æ•°æ®åŒ…</li><li>FORWARDï¼šå¤„ç†ç»è¿‡æœ¬æœºè½¬å‘çš„æ•°æ®åŒ…</li><li>OUTPUTï¼šå¤„ç†æœ¬æœºå‘å‡ºçš„æ•°æ®åŒ…</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å…è®¸å·²å»ºç«‹çš„è¿æ¥</span><br>iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT<br><span class="hljs-comment"># å…è®¸æœ¬åœ°å›ç¯æ¥å£</span><br>iptables -A INPUT -i lo -j ACCEPT<br><span class="hljs-comment"># å…è®¸ SSH è¿æ¥</span><br>iptables -A INPUT -p tcp --dport 22 -j ACCEPT<br><span class="hljs-comment"># é»˜è®¤æ‹’ç»å…¶ä»–æ‰€æœ‰å…¥ç«™è¿æ¥</span><br>iptables -P INPUT DROP<br><span class="hljs-comment"># æŸ¥è¯¢è¡¨ç»“æ„</span><br>iptables -L -v<br><span class="hljs-comment"># æŒ‡å®šfilterè¡¨æŸ¥è¯¢</span><br>iptables -t filter -L -v<br></code></pre></td></tr></table></figure><h3 id="2-nat-è¡¨"><a href="#2-nat-è¡¨" class="headerlink" title="2. nat è¡¨"></a>2. nat è¡¨</h3><p>nat è¡¨ç”¨äºç½‘ç»œåœ°å€è½¬æ¢ï¼ŒåŒ…å«ä¸‰ä¸ªå†…ç½®é“¾ï¼š</p><ul><li>PREROUTINGï¼šåœ¨è·¯ç”±å†³ç­–å‰å¤„ç†æ•°æ®åŒ…</li><li>OUTPUTï¼šå¤„ç†æœ¬æœºäº§ç”Ÿçš„æ•°æ®åŒ…</li><li>POSTROUTINGï¼šåœ¨è·¯ç”±å†³ç­–åå¤„ç†æ•°æ®åŒ…</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å°†å†…ç½‘ä¸»æœºçš„æµé‡ NAT åˆ°å…¬ç½‘ IP</span><br>iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o eth0 -j MASQUERADE<br><span class="hljs-comment"># ç«¯å£è½¬å‘</span><br>iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j DNAT --to-destination 192.168.1.100:8080<br><span class="hljs-comment"># æŸ¥è¯¢natè¡¨</span><br>iptables -t nat -L -v<br></code></pre></td></tr></table></figure><h3 id="3-mangle-è¡¨"><a href="#3-mangle-è¡¨" class="headerlink" title="3. mangle è¡¨"></a>3. mangle è¡¨</h3><p>mangle è¡¨ç”¨äºç‰¹æ®Šçš„æ•°æ®åŒ…ä¿®æ”¹ï¼ŒåŒ…å«äº”ä¸ªå†…ç½®é“¾ï¼š</p><ul><li>PREROUTINGï¼šæ•°æ®åŒ…è¿›å…¥ç³»ç»Ÿæ—¶</li><li>INPUTï¼šæ•°æ®åŒ…è¢«è·¯ç”±åˆ°æœ¬åœ°æ—¶</li><li>FORWARDï¼šè½¬å‘æ•°æ®åŒ…æ—¶</li><li>OUTPUTï¼šæœ¬åœ°ç”Ÿæˆçš„æ•°æ®åŒ…æ—¶</li><li>POSTROUTINGï¼šæ•°æ®åŒ…ç¦»å¼€ç³»ç»Ÿæ—¶</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ä¿®æ”¹æ•°æ®åŒ…çš„ TTL å€¼</span><br>iptables -t mangle -A POSTROUTING -o eth0 -j TTL --ttl-set 64<br><span class="hljs-comment"># è®¾ç½®æ•°æ®åŒ…çš„ä¼˜å…ˆçº§</span><br>iptables -t mangle -A PREROUTING -p tcp --dport 22 -j TOS --set-tos 0x10<br><span class="hljs-comment"># æŸ¥è¯¢mangleè¡¨</span><br>iptables -t mangle -L -v<br></code></pre></td></tr></table></figure><h3 id="4-raw-è¡¨"><a href="#4-raw-è¡¨" class="headerlink" title="4. raw è¡¨"></a>4. raw è¡¨</h3><p>raw è¡¨ç”¨äºé…ç½®å…äºè¿æ¥è·Ÿè¸ªçš„ä¾‹å¤–ï¼ŒåŒ…å«ä¸¤ä¸ªå†…ç½®é“¾ï¼š</p><ul><li>PREROUTINGï¼šå¤„ç†åˆšåˆ°è¾¾çš„æ•°æ®åŒ…</li><li>OUTPUTï¼šå¤„ç†æœ¬åœ°ç”Ÿæˆçš„æ•°æ®åŒ…</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å¯¹ DNS æŸ¥è¯¢å…é™¤è¿æ¥è·Ÿè¸ª</span><br>iptables -t raw -A OUTPUT -p udp --dport 53 -j NOTRACK<br><span class="hljs-comment"># å¯¹æŸäº› IP å…é™¤è¿æ¥è·Ÿè¸ª</span><br>iptables -t raw -A PREROUTING -s 192.168.1.100 -j NOTRACK<br><span class="hljs-comment"># æŸ¥è¯¢rawè¡¨</span><br>iptables -t raw -L -v<br></code></pre></td></tr></table></figure><h3 id="5-security-è¡¨"><a href="#5-security-è¡¨" class="headerlink" title="5. security è¡¨"></a>5. security è¡¨</h3><p>security è¡¨ç”¨äºå¼ºåˆ¶è®¿é—®æ§åˆ¶ç½‘ç»œè§„åˆ™ï¼ˆå¦‚ SELinuxï¼‰ï¼ŒåŒ…å«ä¸‰ä¸ªå†…ç½®é“¾ï¼š</p><ul><li>INPUTï¼šå¤„ç†å…¥ç«™æ•°æ®åŒ…</li><li>OUTPUTï¼šå¤„ç†å‡ºç«™æ•°æ®åŒ…</li><li>FORWARDï¼šå¤„ç†è½¬å‘æ•°æ®åŒ…</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># è®¾ç½® SELinux å®‰å…¨ä¸Šä¸‹æ–‡æ ‡è®°</span><br>iptables -t security -A INPUT -p tcp --dport 80 -j SECMARK --selctx system_u:object_r:http_server_packet_t:s0<br><span class="hljs-comment"># æŸ¥è¯¢securityè¡¨</span><br>iptables -t security -L -v<br></code></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å¤–éƒ¨ç½‘ç»œ - å®¿ä¸»æœº - å®¹å™¨ ï¼š</p><p>åˆ›å»º vethç½‘ç»œï¼Œå°†vethç½‘ç»œä¸¤ç«¯ç»‘å®šåœ¨å®¿ä¸»æœºå’Œå®¹å™¨ä¸¤ç«¯</p><p>é…ç½®ç½‘æ¡¥ï¼Œå°†å®¿ä¸»æœºä¸­çš„vethç«¯åŠ å…¥åˆ°ç½‘æ¡¥ä¸­ï¼Œvethè‡ªåŠ¨é€€åŒ–ä¸ºè™šæ‹Ÿç«¯å£</p><p>å®¿ä¸»æœºä½¿ç”¨iptables é…ç½® æ”¶å‘è¯·æ±‚çš„ç½‘ç»œæ•°æ®æµé‡ æ˜ å°„åˆ°å®¹å™¨ç½‘ç»œã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>è™šæ‹ŸåŒ–æŠ€æœ¯</tag>
      
      <tag>ç½‘ç»œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>task-struct</title>
    <link href="/2025/04/01/task-struct/"/>
    <url>/2025/04/01/task-struct/</url>
    
    <content type="html"><![CDATA[<h1 id="Linux-å†…æ ¸ä¸­çš„-task-struct-ç»“æ„è¯¦è§£"><a href="#Linux-å†…æ ¸ä¸­çš„-task-struct-ç»“æ„è¯¦è§£" class="headerlink" title="Linux å†…æ ¸ä¸­çš„ task_struct ç»“æ„è¯¦è§£"></a>Linux å†…æ ¸ä¸­çš„ <code>task_struct</code> ç»“æ„è¯¦è§£</h1><p>task_struct æ˜¯ Linux å†…æ ¸ä¸­ç”¨æ¥è¡¨ç¤º <strong>è¿›ç¨‹ï¼ˆæˆ–è€…çº¿ç¨‹ï¼‰</strong> çš„æ ¸å¿ƒç»“æ„ä½“ï¼Œæ˜¯æ“ä½œç³»ç»Ÿè°ƒåº¦ã€ç®¡ç†å’Œè¿½è¸ªè¿›ç¨‹çš„åŸºç¡€ã€‚è¯¥ç»“æ„ä½“éå¸¸åºå¤§ï¼ŒåŒ…å«äº†å¤§é‡å­—æ®µï¼Œç”¨äºç®¡ç†è¿›ç¨‹çš„å„ç§çŠ¶æ€ã€‚</p><hr><h2 id="ğŸ§ -task-struct-çš„ä¸»è¦ç»„æˆç»“æ„ï¼ˆæŒ‰åŠŸèƒ½åˆ†ç±»ï¼‰"><a href="#ğŸ§ -task-struct-çš„ä¸»è¦ç»„æˆç»“æ„ï¼ˆæŒ‰åŠŸèƒ½åˆ†ç±»ï¼‰" class="headerlink" title="ğŸ§  task_struct çš„ä¸»è¦ç»„æˆç»“æ„ï¼ˆæŒ‰åŠŸèƒ½åˆ†ç±»ï¼‰"></a>ğŸ§  <code>task_struct</code> çš„ä¸»è¦ç»„æˆç»“æ„ï¼ˆæŒ‰åŠŸèƒ½åˆ†ç±»ï¼‰</h2><h3 id="1-è¿›ç¨‹æ ‡è¯†"><a href="#1-è¿›ç¨‹æ ‡è¯†" class="headerlink" title="1. è¿›ç¨‹æ ‡è¯†"></a>1. è¿›ç¨‹æ ‡è¯†</h3><p>ç”¨äºæ ‡è¯†è¿›ç¨‹çš„å”¯ä¸€æ€§ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">pid_t</span> pid;                      <span class="hljs-comment">// è¿›ç¨‹ID</span><br><span class="hljs-type">pid_t</span> tgid;                     <span class="hljs-comment">// çº¿ç¨‹ç»„IDï¼ˆä¸»çº¿ç¨‹çš„pidï¼‰</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">pid</span> *<span class="hljs-title">thread_pid</span>;</span>        <span class="hljs-comment">// çº¿ç¨‹IDï¼ˆæ¯ä¸ªçº¿ç¨‹å”¯ä¸€ï¼‰</span><br></code></pre></td></tr></table></figure><hr><h3 id="2-è¿›ç¨‹çŠ¶æ€ä¸è°ƒåº¦ç›¸å…³"><a href="#2-è¿›ç¨‹çŠ¶æ€ä¸è°ƒåº¦ç›¸å…³" class="headerlink" title="2. è¿›ç¨‹çŠ¶æ€ä¸è°ƒåº¦ç›¸å…³"></a>2. è¿›ç¨‹çŠ¶æ€ä¸è°ƒåº¦ç›¸å…³</h3><p>åŒ…æ‹¬è¿›ç¨‹çŠ¶æ€ã€ä¼˜å…ˆçº§ã€è°ƒåº¦å™¨ç­–ç•¥ç­‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> state;           <span class="hljs-comment">// å½“å‰è¿›ç¨‹çŠ¶æ€ï¼ˆå¦‚ TASK_RUNNING ç­‰ï¼‰</span><br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flags;            <span class="hljs-comment">// æ ‡å¿—ä½ï¼ˆPF_å¼€å¤´ï¼‰</span><br><span class="hljs-type">int</span> prio;                      <span class="hljs-comment">// åŠ¨æ€ä¼˜å…ˆçº§</span><br><span class="hljs-type">int</span> static_prio;               <span class="hljs-comment">// é™æ€ä¼˜å…ˆçº§</span><br><span class="hljs-type">int</span> policy;                    <span class="hljs-comment">// è°ƒåº¦ç­–ç•¥ï¼ˆå¦‚ SCHED_NORMALï¼‰</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sched_entity</span> <span class="hljs-title">se</span>;</span>        <span class="hljs-comment">// CFSè°ƒåº¦å®ä½“</span><br></code></pre></td></tr></table></figure><hr><h3 id="3-çˆ¶å­è¿›ç¨‹å…³ç³»"><a href="#3-çˆ¶å­è¿›ç¨‹å…³ç³»" class="headerlink" title="3. çˆ¶å­è¿›ç¨‹å…³ç³»"></a>3. çˆ¶å­è¿›ç¨‹å…³ç³»</h3><p>è®°å½•è¿›ç¨‹ä¹‹é—´çš„å±‚çº§å…³ç³»ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">task_struct</span> *<span class="hljs-title">real_parent</span>;</span>   <span class="hljs-comment">// åˆ›å»ºå®ƒçš„è¿›ç¨‹</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">task_struct</span> *<span class="hljs-title">parent</span>;</span>        <span class="hljs-comment">// å½“å‰çˆ¶è¿›ç¨‹</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">list_head</span> <span class="hljs-title">children</span>;</span>         <span class="hljs-comment">// å­è¿›ç¨‹é“¾è¡¨</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">list_head</span> <span class="hljs-title">sibling</span>;</span>          <span class="hljs-comment">// å…„å¼Ÿè¿›ç¨‹é“¾è¡¨</span><br></code></pre></td></tr></table></figure><hr><h3 id="4-å†…å­˜ç®¡ç†"><a href="#4-å†…å­˜ç®¡ç†" class="headerlink" title="4. å†…å­˜ç®¡ç†"></a>4. å†…å­˜ç®¡ç†</h3><p>ä¸åœ°å€ç©ºé—´å’Œè™šæ‹Ÿå†…å­˜ç›¸å…³çš„ä¿¡æ¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">mm_struct</span> *<span class="hljs-title">mm</span>;</span>             <span class="hljs-comment">// è¿›ç¨‹çš„å†…å­˜æè¿°ç¬¦ï¼ˆç”¨æˆ·æ€ï¼‰</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">mm_struct</span> *<span class="hljs-title">active_mm</span>;</span>      <span class="hljs-comment">// å½“å‰æ´»è·ƒçš„ mmï¼ˆå†…æ ¸çº¿ç¨‹ä¹Ÿä¼šè®¾ç½®ï¼‰</span><br></code></pre></td></tr></table></figure><hr><h3 id="5-æ–‡ä»¶ç³»ç»Ÿä¸æ–‡ä»¶æè¿°ç¬¦è¡¨"><a href="#5-æ–‡ä»¶ç³»ç»Ÿä¸æ–‡ä»¶æè¿°ç¬¦è¡¨" class="headerlink" title="5. æ–‡ä»¶ç³»ç»Ÿä¸æ–‡ä»¶æè¿°ç¬¦è¡¨"></a>5. æ–‡ä»¶ç³»ç»Ÿä¸æ–‡ä»¶æè¿°ç¬¦è¡¨</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">fs_struct</span> *<span class="hljs-title">fs</span>;</span>             <span class="hljs-comment">// æ–‡ä»¶ç³»ç»Ÿä¿¡æ¯ï¼ˆå½“å‰ç›®å½•ç­‰ï¼‰</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">files_struct</span> *<span class="hljs-title">files</span>;</span>       <span class="hljs-comment">// æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦è¡¨</span><br></code></pre></td></tr></table></figure><hr><h3 id="6-ä¿¡å·å¤„ç†"><a href="#6-ä¿¡å·å¤„ç†" class="headerlink" title="6. ä¿¡å·å¤„ç†"></a>6. ä¿¡å·å¤„ç†</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">signal_struct</span> *<span class="hljs-title">signal</span>;</span>     <span class="hljs-comment">// æ‰€å±çº¿ç¨‹ç»„çš„ä¿¡å·å¤„ç†ç»“æ„</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sighand_struct</span> *<span class="hljs-title">sighand</span>;</span>   <span class="hljs-comment">// ä¿¡å·å¤„ç†å‡½æ•°</span><br><span class="hljs-type">sigset_t</span> blocked;                 <span class="hljs-comment">// å½“å‰å±è”½çš„ä¿¡å·</span><br></code></pre></td></tr></table></figure><hr><h3 id="7-å‘½åç©ºé—´ï¼ˆNamespaceï¼‰"><a href="#7-å‘½åç©ºé—´ï¼ˆNamespaceï¼‰" class="headerlink" title="7. å‘½åç©ºé—´ï¼ˆNamespaceï¼‰"></a>7. å‘½åç©ºé—´ï¼ˆNamespaceï¼‰</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">nsproxy</span> *<span class="hljs-title">nsproxy</span>;</span>          <span class="hljs-comment">// å„ç±»å‘½åç©ºé—´çš„ç»Ÿä¸€æ¥å£</span><br></code></pre></td></tr></table></figure><hr><h3 id="8-CPU-å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ç›¸å…³"><a href="#8-CPU-å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ç›¸å…³" class="headerlink" title="8. CPU å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ç›¸å…³"></a>8. CPU å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ç›¸å…³</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">thread_struct</span> <span class="hljs-title">thread</span>;</span>      <span class="hljs-comment">// å­˜å‚¨CPUå¯„å­˜å™¨ç­‰ä¸Šä¸‹æ–‡ä¿¡æ¯</span><br><span class="hljs-type">int</span> on_cpu;                       <span class="hljs-comment">// æ˜¯å¦åœ¨CPUä¸Šè¿è¡Œ</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cpumask</span> *<span class="hljs-title">cpus_allowed</span>;</span>     <span class="hljs-comment">// å…è®¸è¿è¡Œåœ¨å“ªäº›CPUä¸Š</span><br></code></pre></td></tr></table></figure><hr><h3 id="9-æ—¶é—´ç»Ÿè®¡"><a href="#9-æ—¶é—´ç»Ÿè®¡" class="headerlink" title="9. æ—¶é—´ç»Ÿè®¡"></a>9. æ—¶é—´ç»Ÿè®¡</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">u64 utime;                        <span class="hljs-comment">// ç”¨æˆ·æ€è¿è¡Œæ—¶é—´</span><br>u64 stime;                        <span class="hljs-comment">// å†…æ ¸æ€è¿è¡Œæ—¶é—´</span><br></code></pre></td></tr></table></figure><hr><h3 id="10-Cgroup-ä¸èµ„æºé™åˆ¶"><a href="#10-Cgroup-ä¸èµ„æºé™åˆ¶" class="headerlink" title="10. Cgroup ä¸èµ„æºé™åˆ¶"></a>10. Cgroup ä¸èµ„æºé™åˆ¶</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">css_set</span> *<span class="hljs-title">cgroups</span>;</span>          <span class="hljs-comment">// æ‰€å±çš„ cgroup é›†åˆ</span><br></code></pre></td></tr></table></figure><hr><h3 id="11-è°ƒè¯•ä¸è¿½è¸ª"><a href="#11-è°ƒè¯•ä¸è¿½è¸ª" class="headerlink" title="11. è°ƒè¯•ä¸è¿½è¸ª"></a>11. è°ƒè¯•ä¸è¿½è¸ª</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> ptrace;             <span class="hljs-comment">// æ˜¯å¦è¢« ptrace è¿½è¸ª</span><br></code></pre></td></tr></table></figure><hr><h3 id="12-å†…æ ¸åŒæ­¥ä¸é”"><a href="#12-å†…æ ¸åŒæ­¥ä¸é”" class="headerlink" title="12. å†…æ ¸åŒæ­¥ä¸é”"></a>12. å†…æ ¸åŒæ­¥ä¸é”</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">spinlock_t</span> alloc_lock;            <span class="hljs-comment">// ç”¨äºä¿æŠ¤ä»»åŠ¡ç»“æ„ä¸­çš„å…³é”®åŒºåŸŸ</span><br></code></pre></td></tr></table></figure><hr><h3 id="13-å…¶ä»–å¸¸ç”¨å­—æ®µ"><a href="#13-å…¶ä»–å¸¸ç”¨å­—æ®µ" class="headerlink" title="13. å…¶ä»–å¸¸ç”¨å­—æ®µ"></a>13. å…¶ä»–å¸¸ç”¨å­—æ®µ</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span> comm[TASK_COMM_LEN];         <span class="hljs-comment">// è¿›ç¨‹åï¼ˆæœ€å¤š16å­—èŠ‚ï¼‰</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">task_struct</span> *<span class="hljs-title">group_leader</span>;</span> <span class="hljs-comment">// çº¿ç¨‹ç»„çš„ leader</span><br><span class="hljs-type">int</span> exit_code;                    <span class="hljs-comment">// é€€å‡ºä»£ç </span><br></code></pre></td></tr></table></figure><hr><h2 id="ğŸ”§-å°ç»“å›¾è§£ï¼ˆç®€ç•¥ï¼‰"><a href="#ğŸ”§-å°ç»“å›¾è§£ï¼ˆç®€ç•¥ï¼‰" class="headerlink" title="ğŸ”§ å°ç»“å›¾è§£ï¼ˆç®€ç•¥ï¼‰"></a>ğŸ”§ å°ç»“å›¾è§£ï¼ˆç®€ç•¥ï¼‰</h2><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs pf">task_struct<br>â”œâ”€â”€ è¿›ç¨‹æ ‡è¯†ï¼špid, tgid<br>â”œâ”€â”€ çŠ¶æ€ä¸è°ƒåº¦ï¼š<span class="hljs-keyword">state</span>, <span class="hljs-keyword">prio</span>, policy, se<br>â”œâ”€â”€ çˆ¶å­å…³ç³»ï¼š<span class="hljs-keyword">parent</span>, children<br>â”œâ”€â”€ å†…å­˜ç®¡ç†ï¼šmm, active_mm<br>â”œâ”€â”€ æ–‡ä»¶ç³»ç»Ÿï¼šfiles, fs<br>â”œâ”€â”€ ä¿¡å·å¤„ç†ï¼šsignal, sighand<br>â”œâ”€â”€ å‘½åç©ºé—´ï¼šnsproxy<br>â”œâ”€â”€ CPUè°ƒåº¦ï¼šthread, on_cpu<br>â”œâ”€â”€ æ—¶é—´ç»Ÿè®¡ï¼šutime, stime<br>â”œâ”€â”€ C<span class="hljs-keyword">group</span>ï¼šcgroups<br>â”œâ”€â”€ åŒæ­¥é”ï¼šalloc_lock<br>â”œâ”€â”€ è°ƒè¯•è¿½è¸ªï¼šptrace<br>â””â”€â”€ é€šç”¨ä¿¡æ¯ï¼šcomm, exit_code<br></code></pre></td></tr></table></figure><hr><p>è¯¥ç»“æ„ä½“å¯èƒ½ä¼šåœ¨ä¸åŒç‰ˆæœ¬çš„å†…æ ¸ä¸­æœ‰æ‰€å˜åŠ¨ï¼Œä½†æ•´ä½“ç»“æ„å’Œè¿™äº›åŠŸèƒ½æ¨¡å—æ˜¯æ ¸å¿ƒã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>æ“ä½œç³»ç»Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®¹å™¨çš„å®ç°åŸç†</title>
    <link href="/2025/04/01/%E5%AE%B9%E5%99%A8%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/"/>
    <url>/2025/04/01/%E5%AE%B9%E5%99%A8%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1 id="å®¹å™¨å®ç°çš„åŸç†"><a href="#å®¹å™¨å®ç°çš„åŸç†" class="headerlink" title="å®¹å™¨å®ç°çš„åŸç†"></a>å®¹å™¨å®ç°çš„åŸç†</h1><p>åœ¨Linuxç³»ç»Ÿä¸­ï¼Œå®¹å™¨çš„å®ç°æœ¬èº«å°±æ˜¯ä¸€ç§èµ„æºéš”ç¦»çš„æ–¹å¼ã€‚å®ƒé€šè¿‡æ§åˆ¶è¿›ç¨‹çš„èµ„æºè°ƒåº¦ï¼Œè®¿é—®æƒé™æ¥ç¡®å®šä¸€é¡¹è¿›ç¨‹å¯ä»¥æ“ä½œçš„èµ„æºèŒƒå›´ï¼Œæ¥è¾¾åˆ°éš”ç¦»çš„ç›®çš„</p><p>è¿™å…¶ä¸­ä¸»è¦ä½¿ç”¨åˆ°3ä¸ªæŠ€æœ¯ ï¼š namespaceï¼Œunionfs å’Œcgroups</p><h1 id="namespace"><a href="#namespace" class="headerlink" title="namespace"></a>namespace</h1><p>namespace æ˜¯ä¸€ç§æ§åˆ¶è¿›ç¨‹è®¿é—®èŒƒå›´çš„ç»“æ„ä½“ã€‚åœ¨è¿›ç¨‹ç»“æ„ä½“ï¼ˆtask_structï¼‰ä¸­ï¼Œé€šè¿‡nsproxy ç»“æ„ æŒ‡å‘ä¸€ä¸ªåŒ…å«å¤šç§èµ„æºç»“æ„æŒ‡é’ˆçš„ç»“æ„ä½“ã€‚</p><p>struct nsproxy :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">nsproxy</span> &#123;</span><br>    <span class="hljs-type">atomic_t</span> count;                  <span class="hljs-comment">// å¼•ç”¨è®¡æ•°</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">uts_namespace</span> *<span class="hljs-title">uts_ns</span>;</span>   <span class="hljs-comment">// UTS å‘½åç©ºé—´ï¼ˆä¸»æœºåã€åŸŸåï¼‰</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ipc_namespace</span> *<span class="hljs-title">ipc_ns</span>;</span>   <span class="hljs-comment">// IPC å‘½åç©ºé—´ï¼ˆä¿¡å·é‡ã€å…±äº«å†…å­˜ã€æ¶ˆæ¯é˜Ÿåˆ—ï¼‰</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">mnt_namespace</span> *<span class="hljs-title">mnt_ns</span>;</span>   <span class="hljs-comment">// æŒ‚è½½å‘½åç©ºé—´ï¼ˆæ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹ï¼‰</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">pid_namespace</span> *<span class="hljs-title">pid_ns_for_children</span>;</span> <span class="hljs-comment">// PID å‘½åç©ºé—´ï¼ˆç”¨äºå­è¿›ç¨‹ï¼‰</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">net</span> *<span class="hljs-title">net_ns</span>;</span>             <span class="hljs-comment">// ç½‘ç»œå‘½åç©ºé—´</span><br><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> CONFIG_CGROUPS</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cgroup_namespace</span> *<span class="hljs-title">cgroup_ns</span>;</span> <span class="hljs-comment">// æ§åˆ¶ç»„å‘½åç©ºé—´</span><br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> CONFIG_TIME_NS</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">time_namespace</span> *<span class="hljs-title">time_ns</span>;</span>     <span class="hljs-comment">// æ—¶é—´å‘½åç©ºé—´</span><br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br>&#125;;<br><br></code></pre></td></tr></table></figure><h2 id="å„ä¸ªå­—æ®µçš„å«ä¹‰ï¼š"><a href="#å„ä¸ªå­—æ®µçš„å«ä¹‰ï¼š" class="headerlink" title="å„ä¸ªå­—æ®µçš„å«ä¹‰ï¼š"></a>å„ä¸ªå­—æ®µçš„å«ä¹‰ï¼š</h2><table><thead><tr><th>å­—æ®µå</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>count</code></td><td>å¼•ç”¨è®¡æ•°ï¼Œé¿å…ç»“æ„ä½“è¢«è¿‡æ—©é‡Šæ”¾</td></tr><tr><td><code>uts_ns</code></td><td>UTS å‘½åç©ºé—´ï¼ˆ<code>uname -n</code>ã€ä¸»æœºåç­‰ï¼‰</td></tr><tr><td><code>ipc_ns</code></td><td>IPC å‘½åç©ºé—´ï¼ˆSysV IPCï¼Œå¦‚ä¿¡å·é‡ã€å…±äº«å†…å­˜ï¼‰</td></tr><tr><td><code>mnt_ns</code></td><td>æŒ‚è½½å‘½åç©ºé—´ï¼ˆéš”ç¦»çš„æŒ‚è½½è§†å›¾ï¼‰</td></tr><tr><td><code>pid_ns_for_children</code></td><td>å½“å‰è¿›ç¨‹çš„å­è¿›ç¨‹å°†è¿›å…¥çš„ PID å‘½åç©ºé—´</td></tr><tr><td><code>net_ns</code></td><td>ç½‘ç»œå‘½åç©ºé—´ï¼ˆå¦‚ç½‘ç»œè®¾å¤‡ã€IP åœ°å€ã€è·¯ç”±ç­‰ï¼‰</td></tr><tr><td><code>cgroup_ns</code></td><td>æ§åˆ¶ç»„å‘½åç©ºé—´ï¼ˆæ§åˆ¶ç»„çš„åå­—ç©ºé—´éš”ç¦»ï¼‰</td></tr><tr><td><code>time_ns</code></td><td>æ—¶é—´å‘½åç©ºé—´ï¼ˆæ¯ä¸ªå®¹å™¨&#x2F;å‘½åç©ºé—´è‡ªå·±çš„æ—¶é—´è§†å›¾ï¼‰</td></tr></tbody></table><p>å½“è¿›ç¨‹è¢«åˆ›å»ºæ—¶ï¼Œæœªå®šä¹‰çš„å‘½åç©ºé—´ ä¼šé»˜è®¤ä½¿ç”¨çˆ¶è¿›ç¨‹çš„ç»“æ„ä½“ä¿¡æ¯ï¼ˆå¯ä»¥é€šè¿‡clone()æ¥æŒ‡å®šå­è¿›ç¨‹éœ€è¦ç»‘å®šçš„å‘½åç©ºé—´ï¼‰ã€‚æ‰€ä»¥å½“æ–°çš„å­è¿›ç¨‹è¢«åˆ›å»ºæ—¶ï¼Œé»˜è®¤ç›´æ¥å¯ä»¥è®¿é—®çˆ¶è¿›ç¨‹æ‰€èƒ½ä½¿ç”¨çš„èµ„æºã€‚</p><h2 id="åˆ›å»ºæ–°çš„å‘½åç©ºé—´"><a href="#åˆ›å»ºæ–°çš„å‘½åç©ºé—´" class="headerlink" title="åˆ›å»ºæ–°çš„å‘½åç©ºé—´"></a>åˆ›å»ºæ–°çš„å‘½åç©ºé—´</h2><p>é€šè¿‡ä½¿ç”¨ unshare å‘½ä»¤æ¥åˆ›å»ºæ–°çš„å‘½åç©ºé—´ã€‚æ“ä½œç³»ç»Ÿä¼šå¯¹æ¯ç§èµ„æºè¿›è¡Œç›¸åº”çš„åˆå§‹åŒ–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">unshare --fork --pid --mount --uts --ipc --net --user --map-root-user /bin/bash<br></code></pre></td></tr></table></figure><p><code>unshare</code> å¯ä»¥è®©ä½ ä¸ºè¿›ç¨‹å•ç‹¬åˆ›å»ºä»¥ä¸‹å‘½åç©ºé—´ï¼š</p><table><thead><tr><th>å‘½åç©ºé—´</th><th>å‚æ•°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>UTS</td><td><code>--uts</code></td><td>ä¸»æœºå&#x2F;åŸŸåéš”ç¦»ï¼ˆå¯ä»¥æ”¹ hostnameï¼‰</td></tr><tr><td>PID</td><td><code>--pid</code></td><td>è¿›ç¨‹å·éš”ç¦»ï¼ˆæ–°çš„è¿›ç¨‹æ ‘ï¼Œå½“å‰è¿›ç¨‹æ˜¯ PID 1ï¼‰</td></tr><tr><td>Mount</td><td><code>--mount</code></td><td>æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹éš”ç¦»</td></tr><tr><td>Net</td><td><code>--net</code></td><td>ç½‘ç»œæ ˆéš”ç¦»ï¼ˆç‹¬ç«‹çš„ç½‘ç»œæ¥å£ï¼‰</td></tr><tr><td>IPC</td><td><code>--ipc</code></td><td>è¿›ç¨‹é—´é€šä¿¡éš”ç¦»</td></tr><tr><td>User</td><td><code>--user</code></td><td>ç”¨æˆ·&#x2F;æƒé™éš”ç¦»ï¼ˆuid&#x2F;gid æ˜ å°„ï¼‰</td></tr><tr><td>Cgroup</td><td><code>--cgroup</code></td><td>æ§åˆ¶ç»„éš”ç¦»</td></tr><tr><td>Time</td><td><code>--time</code></td><td>ç³»ç»Ÿæ—¶é—´å‘½åç©ºé—´ï¼ˆè¾ƒæ–°å†…æ ¸ï¼‰</td></tr></tbody></table><p> ä½¿ç”¨ - -mount ä¼šå°†å½“å‰è¿›ç¨‹çš„æŒ‚è½½ç³»ç»Ÿè§†å›¾åŠ è½½åˆ°æ–°çš„è¿›ç¨‹ä¸­å»</p><p>ä½¿ç”¨  - -mount-proc ä¼šåˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„&#x2F;proc æ–‡ä»¶ç³»ç»Ÿ</p><p>è¿›å…¥æ–°çš„å‘½åç©ºé—´åï¼Œè¿›è¡Œèµ„æºæŒ‚è½½</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">unshare --mount --net --user --map-root-user bash<br><br>mount -t tmpfs tmpfs /mnt/tmp  <span class="hljs-comment">#æ–‡ä»¶ç³»ç»ŸæŒ‚è½½</span><br>ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> lo up <span class="hljs-comment">#ç½‘ç»œæŒ‚è½½</span><br>mount -t proc proc /proc <span class="hljs-comment">#è™šæ‹Ÿæ–‡ä»¶ç³»ç»ŸæŒ‚è½½</span><br><span class="hljs-comment"># --user è¦ä¹ˆç”¨ --map-root-userï¼Œè¦ä¹ˆè‡ªå·±å†™ uid_map</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªè‡ªå®šä¹‰èµ„æºé¢„è®¾å‘½åç©ºé—´çš„è¿›ç¨‹</p><h2 id="QA"><a href="#QA" class="headerlink" title="QA"></a>QA</h2><h3 id="unshare-â€”uts-â€”pid-bin-bash-éœ€è¦é€šè¿‡â€”forkåˆ›å»ºæ–°çš„å‘½åç©ºé—´"><a href="#unshare-â€”uts-â€”pid-bin-bash-éœ€è¦é€šè¿‡â€”forkåˆ›å»ºæ–°çš„å‘½åç©ºé—´" class="headerlink" title="unshare  â€”uts â€”pid  &#x2F;bin&#x2F;bash éœ€è¦é€šè¿‡â€”forkåˆ›å»ºæ–°çš„å‘½åç©ºé—´"></a>unshare  â€”uts â€”pid  &#x2F;bin&#x2F;bash éœ€è¦é€šè¿‡â€”forkåˆ›å»ºæ–°çš„å‘½åç©ºé—´</h3><p>ä½¿ç”¨ <code>unshare --pid</code> åˆ›å»ºæ–°çš„ PID å‘½åç©ºé—´åï¼Œå½“å‰è¿›ç¨‹ä¾ç„¶å¤„äºæ—§å‘½åç©ºé—´ï¼Œå®ƒçš„ PID æ— æ³•æ›´æ”¹ã€‚å› æ­¤å¿…é¡»é€šè¿‡ <code>--fork</code> åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ï¼Œå®ƒæ‰èƒ½çœŸæ­£è¿è¡Œåœ¨æ–°çš„ PID å‘½åç©ºé—´ä¸­ï¼Œå¹¶æˆä¸ºè¯¥å‘½åç©ºé—´å†…çš„ PID 1ã€‚</p><h3 id="å¦‚ä½•è¿›å…¥ä¸€ä¸ªå‘½åç©ºé—´"><a href="#å¦‚ä½•è¿›å…¥ä¸€ä¸ªå‘½åç©ºé—´" class="headerlink" title="å¦‚ä½•è¿›å…¥ä¸€ä¸ªå‘½åç©ºé—´"></a>å¦‚ä½•è¿›å…¥ä¸€ä¸ªå‘½åç©ºé—´</h3><p>Linux æŠŠæ¯ä¸ªè¿›ç¨‹å½“å‰æ‰€åœ¨çš„å‘½åç©ºé—´æš´éœ²åœ¨äº† <code>/proc/[pid]/ns/</code> ç›®å½•ä¸‹ï¼Œä½ å¯ä»¥é€šè¿‡è®¿é—®å®ƒæ¥â€œè¿›å…¥â€å‘½åç©ºé—´ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash<br><span class="hljs-built_in">sudo</span> nsenter --target &lt;PID&gt; --net --uts --pid --mount --ipc /bin/bash<br></code></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡ <code>bind mount</code> çš„æ–¹å¼æŠŠ namespace æ–‡ä»¶æŒ‚åˆ°ä¸€ä¸ªè·¯å¾„ä¸Šï¼Œå®ç°â€œå‘½åç©ºé—´æŒä¹…åŒ–â€ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> -p /var/run/my_ns<br><span class="hljs-built_in">touch</span> /var/run/my_ns/net<br>mount --<span class="hljs-built_in">bind</span> /proc/&lt;pid&gt;/ns/net /var/run/my_ns/net<br><br></code></pre></td></tr></table></figure><h3 id="è¿›ç¨‹åœ¨ä¸åŒå‘½åç©ºé—´å…·æœ‰ä¸åŒçš„PIDä¿¡æ¯"><a href="#è¿›ç¨‹åœ¨ä¸åŒå‘½åç©ºé—´å…·æœ‰ä¸åŒçš„PIDä¿¡æ¯" class="headerlink" title="è¿›ç¨‹åœ¨ä¸åŒå‘½åç©ºé—´å…·æœ‰ä¸åŒçš„PIDä¿¡æ¯"></a>è¿›ç¨‹åœ¨ä¸åŒå‘½åç©ºé—´å…·æœ‰ä¸åŒçš„PIDä¿¡æ¯</h3><p>å…³é”®ç»“æ„ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">pid</span> &#123;</span><br><span class="hljs-type">atomic_t</span> count;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> level;  <span class="hljs-comment">// å‘½åç©ºé—´å±‚çº§ï¼ˆ0 = rootï¼‰</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">hlist_head</span> <span class="hljs-title">tasks</span>[<span class="hljs-title">PIDTYPE_MAX</span>];</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">upid</span> <span class="hljs-title">numbers</span>[1];</span> <span class="hljs-comment">// å®é™…çš„ PID æ•°ç»„ï¼ˆå¤šä¸ªå‘½åç©ºé—´çš„ PIDï¼‰</span><br>&#125;;<br></code></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">upid</span> &#123;</span><br>    <span class="hljs-type">int</span> nr;                      <span class="hljs-comment">// å½“å‰ namespace ä¸‹çš„ PID</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">pid_namespace</span> *<span class="hljs-title">ns</span>;</span>   <span class="hljs-comment">// å±äºå“ªä¸ª namespace</span><br>&#125;;<br></code></pre></td></tr></table></figure><p>ç”±æ­¤ æˆ‘ä»¬å¯ä»¥çœ‹åˆ° unshare æ˜¯ä¸€ä¸ªå¯¹è¿›ç¨‹çš„èµ„æºæƒé™è¿›è¡Œåˆ›å»ºç»‘å®šçš„è¿‡ç¨‹</p><h1 id="overlayfs"><a href="#overlayfs" class="headerlink" title="overlayfs"></a>overlayfs</h1><p>åœ¨å®ç°å®¹å™¨æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œå¸¸ä½¿ç”¨çš„æ˜¯ <code>overlayfs</code>ï¼ˆå±äº unionfs ç±»å‹çš„èšåˆæ–‡ä»¶ç³»ç»Ÿï¼‰ã€‚ç”¨æ¥å°†å®¹å™¨æ‰€éœ€è¦çš„æ–‡ä»¶èµ„æºâ€œèšåˆâ€åœ¨åŒä¸€ä¸ªèµ„æºç›®å½•ä¸‹ã€‚</p><p>é€šè¿‡mount åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> mount -t overlay overlay \<br>  -o lowerdir=/mnt/lower,upperdir=/mnt/upper,workdir=/mnt/work \<br>  /mnt/merged<br><br></code></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>-t overlay</code></td><td>æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿç±»å‹æ˜¯ <code>overlay</code></td></tr><tr><td><code>overlay</code></td><td>è®¾å¤‡åï¼ˆè¿™é‡Œå¯ä»¥éšä¾¿å†™ï¼Œæ¯”å¦‚ä¹Ÿå¯ä»¥å†™æˆ <code>none</code>ï¼‰</td></tr><tr><td><code>-o lowerdir=...</code></td><td>æŒ‡å®šåªè¯»çš„åº•å±‚ç›®å½•ï¼ˆå¯å¤šä¸ªï¼‰</td></tr><tr><td><code>upperdir=...</code></td><td>æŒ‡å®šå¯å†™çš„ä¸Šå±‚ç›®å½•</td></tr><tr><td><code>workdir=...</code></td><td>overlayfs éœ€è¦çš„å·¥ä½œç›®å½•ï¼ˆä¸­é—´ç¼“å­˜ç”¨ï¼‰</td></tr><tr><td>æœ€åçš„ <code>rootfs_chat/merged</code></td><td>æ˜¯æŒ‚è½½ç‚¹ï¼Œå³æœ€ç»ˆç»„åˆå‡ºæ¥çš„ç›®å½•è§†å›¾</td></tr></tbody></table><p>æŒ‚è½½åˆ›å»ºå¥½åï¼Œå› ä¸ºè¯¥æŒ‚è½½å­˜åœ¨äºçˆ¶è¿›ç¨‹ä¹‹ä¸­ï¼Œæ‰€ä»¥ä½¿ç”¨â€”mountåˆ›å»ºåï¼Œæ–°çš„å­è¿›ç¨‹å¯ä»¥è®¿é—®åˆ°è¯¥æŒ‚è½½è·¯å¾„</p><p>ä½†æ˜¯æ­¤æ—¶çš„æ ¹è·¯å¾„ä¾ç„¶ç»§æ‰¿è‡ªçˆ¶è¿›ç¨‹ï¼Œæ‰€ä»¥éœ€è¦å°†æ–°è¿›ç¨‹çš„æ ¹è¿›ç¨‹ä¿®æ”¹ä¸ºâ€œ&#x2F;â€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chroot</span> rootfs_chat/merged/ <br></code></pre></td></tr></table></figure><p><code>chroot</code> æœ¬èº«å¹¶ä¸å®‰å…¨ï¼Œä¸èƒ½å®Œå…¨éš”ç¦»æ–‡ä»¶ç³»ç»Ÿï¼Œéœ€è¦ç»“åˆ mount namespace æ‰èƒ½ä¿è¯éš”ç¦»æ€§ã€‚å¦åˆ™è¿›ç¨‹å¯ä»¥ escape chrootã€‚</p><h2 id="QA-1"><a href="#QA-1" class="headerlink" title="QA"></a>QA</h2><p>chroot é€šè¿‡ä¿®æ”¹è¿›ç¨‹ç»“æ„ä½“ä¸­çš„â€œrootâ€ å˜é‡ï¼Œæ¥å¸®åŠ©è¿›ç¨‹è¯†åˆ«å¯¹åº”çš„æ ¹ç›®å½•çš„</p><p>{</p><p>struct fs_struct {<br>struct path root;     &#x2F;&#x2F; å½“å‰çš„æ ¹ç›®å½•ï¼ˆå¯¹åº” <code>/</code>ï¼‰<br>struct path pwd;      &#x2F;&#x2F; å½“å‰å·¥ä½œç›®å½•ï¼ˆå¯¹åº” <code>.</code>ï¼‰<br>};</p><h1 id="cgroups"><a href="#cgroups" class="headerlink" title="cgroups"></a>cgroups</h1><p>cgroup æ˜¯ä¸€ä¸ªå†…æ ¸ä¸­çš„â€œèµ„æºæ§åˆ¶æ ‘ç»“æ„â€ï¼Œè¿›ç¨‹â€œåŠ å…¥â€åˆ°è¿™ä¸ªæ ‘ç»“æ„çš„æŸä¸ªèŠ‚ç‚¹ä¸‹ï¼Œè¿›è€Œæ¥å—æ§åˆ¶å™¨çš„çº¦æŸã€‚</p><p>ç»“æ„ä½“å®šä¹‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cgroup</span> &#123;</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">kernfs_node</span> *<span class="hljs-title">kn</span>;</span>         <span class="hljs-comment">// åœ¨ cgroupfs ä¸­å¯¹åº”çš„ç›®å½•èŠ‚ç‚¹</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cgroup_subsys_state</span> __<span class="hljs-title">rcu</span> *<span class="hljs-title">subsys</span>[<span class="hljs-title">CGROUP_SUBSYS_COUNT</span>];</span> <span class="hljs-comment">// æ§åˆ¶å™¨çŠ¶æ€</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cgroup_parent</span> *<span class="hljs-title">parent</span>;</span>   <span class="hljs-comment">// çˆ¶ cgroup</span><br>    ...<br>&#125;;<br></code></pre></td></tr></table></figure><p>æ§åˆ¶å™¨ç»“æ„ ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cgroup_subsys_state</span> &#123;</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cgroup</span> *<span class="hljs-title">cgroup</span>;</span>       <span class="hljs-comment">// å±äºå“ªä¸ª cgroup èŠ‚ç‚¹</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cgroup_subsys</span> *<span class="hljs-title">ss</span>;</span>    <span class="hljs-comment">// å±äºå“ªä¸ªæ§åˆ¶å™¨ï¼ˆmemory, cpuç­‰ï¼‰</span><br>    ...<br>&#125;;<br></code></pre></td></tr></table></figure><p>è¿›ç¨‹ç»“æ„ä½“ä¸­å¯¹cgroupçš„å¼•ç”¨ ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">task_struct</span> &#123;</span><br>    ...<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">css_set</span> *<span class="hljs-title">cgroups</span>;</span>    <span class="hljs-comment">// è¿›ç¨‹æ‰€å±çš„ cgroup é›†åˆï¼ˆcss_setï¼‰</span><br>    ...<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="cgroupsé™åˆ¶å†™å…¥"><a href="#cgroupsé™åˆ¶å†™å…¥" class="headerlink" title="cgroupsé™åˆ¶å†™å…¥"></a>cgroupsé™åˆ¶å†™å…¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> /sys/fs/cgroup/mygroup<br><span class="hljs-built_in">echo</span> 1234 &gt; /sys/fs/cgroup/mygroup/cgroup.procs  <span class="hljs-comment">#å°†æŸä¸ªè¿›ç¨‹åŠ å…¥èµ„æºç»„</span><br><span class="hljs-built_in">echo</span> 50M &gt; /sys/fs/cgroup/mygroup/memory.max  <span class="hljs-comment">#åœ¨å¯¹åº”çš„è™šæ‹Ÿæ–‡ä»¶ä¸­è®¾ç½®é™åˆ¶å€¼çš„å¤§å°</span><br><br></code></pre></td></tr></table></figure><h2 id="é™åˆ¶æ–¹å¼"><a href="#é™åˆ¶æ–¹å¼" class="headerlink" title="é™åˆ¶æ–¹å¼"></a>é™åˆ¶æ–¹å¼</h2><h3 id="1-å†…å­˜é™åˆ¶ï¼ˆmemory-controllerï¼‰"><a href="#1-å†…å­˜é™åˆ¶ï¼ˆmemory-controllerï¼‰" class="headerlink" title="1. å†…å­˜é™åˆ¶ï¼ˆmemory controllerï¼‰"></a>1. <strong>å†…å­˜é™åˆ¶ï¼ˆmemory controllerï¼‰</strong></h3><h3 id="æ§åˆ¶æ–‡ä»¶ï¼ˆcgroups-v2ï¼‰ï¼š"><a href="#æ§åˆ¶æ–‡ä»¶ï¼ˆcgroups-v2ï¼‰ï¼š" class="headerlink" title="æ§åˆ¶æ–‡ä»¶ï¼ˆcgroups v2ï¼‰ï¼š"></a>æ§åˆ¶æ–‡ä»¶ï¼ˆcgroups v2ï¼‰ï¼š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">memory.max        <span class="hljs-comment"># æœ€å¤§å†…å­˜</span><br>memory.current    <span class="hljs-comment"># å½“å‰å†…å­˜ä½¿ç”¨é‡</span><br>memory.swap.max   <span class="hljs-comment"># æœ€å¤§ swap ä½¿ç”¨</span><br><br></code></pre></td></tr></table></figure><h3 id="é™åˆ¶æœºåˆ¶ï¼š"><a href="#é™åˆ¶æœºåˆ¶ï¼š" class="headerlink" title="é™åˆ¶æœºåˆ¶ï¼š"></a>é™åˆ¶æœºåˆ¶ï¼š</h3><ul><li>æ¯æ¬¡è¿›ç¨‹åˆ†é…å†…å­˜ï¼ˆ<code>malloc</code> &#x2F; <code>brk</code> &#x2F; <code>mmap</code>ï¼‰ï¼Œå†…æ ¸ä¼šé€šè¿‡ cgroup è¿½è¸ªå®ƒçš„é¡µæ•°</li><li>å†…æ ¸ç»´æŠ¤ä¸€ä¸ªâ€œ<strong>å†…å­˜è´¦æˆ·</strong>â€ï¼Œè®°å½•æ¯ä¸ª cgroup å½“å‰ä½¿ç”¨äº†å¤šå°‘å†…å­˜</li><li>å½“ä½¿ç”¨è¶…è¿‡ <code>memory.max</code>ï¼š<ul><li>å¦‚æœæ˜¯è½¯é™åˆ¶ï¼ˆmemory.highï¼‰ï¼šå†…æ ¸ä¼˜å…ˆå›æ”¶ç¼“å­˜é¡µ</li><li>å¦‚æœæ˜¯ç¡¬é™åˆ¶ï¼ˆmemory.maxï¼‰ï¼šå†…æ ¸ä¼šæ‹’ç»åˆ†é…ï¼Œæˆ–è€…ç›´æ¥ OOM æ€æ­»è¿›ç¨‹</li></ul></li></ul><hr><h3 id="2-CPU-é™åˆ¶ï¼ˆcpu-controllerï¼‰"><a href="#2-CPU-é™åˆ¶ï¼ˆcpu-controllerï¼‰" class="headerlink" title="2. CPU é™åˆ¶ï¼ˆcpu controllerï¼‰"></a>2. <strong>CPU é™åˆ¶ï¼ˆcpu controllerï¼‰</strong></h3><h3 id="æ§åˆ¶æ–‡ä»¶ï¼š"><a href="#æ§åˆ¶æ–‡ä»¶ï¼š" class="headerlink" title="æ§åˆ¶æ–‡ä»¶ï¼š"></a>æ§åˆ¶æ–‡ä»¶ï¼š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">cpu.max           <span class="hljs-comment"># æ ¼å¼ä¸º &quot;quota period&quot;ï¼Œå¦‚ &quot;50000 100000&quot; è¡¨ç¤º 50%</span><br>cpu.weight        <span class="hljs-comment"># æ¯”ä¾‹è°ƒåº¦ï¼ˆç±»ä¼¼ nice å€¼ï¼‰</span><br><br></code></pre></td></tr></table></figure><h3 id="é™åˆ¶æœºåˆ¶ï¼š-1"><a href="#é™åˆ¶æœºåˆ¶ï¼š-1" class="headerlink" title="é™åˆ¶æœºåˆ¶ï¼š"></a>é™åˆ¶æœºåˆ¶ï¼š</h3><ul><li>Linux ç”¨ <strong>CFSï¼ˆå®Œå…¨å…¬å¹³è°ƒåº¦å™¨ï¼‰</strong> ç®¡ç† CPU æ—¶é—´</li><li>cgroups ä¸­æ¯ä¸ªç»„éƒ½ç»´æŠ¤ä¸€ä¸ªâ€œè™šæ‹Ÿæ—¶é—´â€å’Œâ€œå®é™…ç”¨é‡â€</li><li>å½“æŸä¸ª cgroup è¶…è¿‡åˆ†é…çš„ quotaï¼Œ<strong>è°ƒåº¦å™¨ä¼šâ€œè·³è¿‡â€å®ƒçš„è¿›ç¨‹ï¼Œè®©å‡º CPU</strong></li><li>å®ç°ç±»ä¼¼â€œé™é€Ÿâ€ï¼šæ¯”å¦‚æ¯ 100ms æœ€å¤šç”¨ 50msï¼Œå°±ç­‰äº 50% CPU</li></ul><hr><h3 id="3-IO-é™åˆ¶ï¼ˆio-controllerï¼‰"><a href="#3-IO-é™åˆ¶ï¼ˆio-controllerï¼‰" class="headerlink" title="3. IO é™åˆ¶ï¼ˆio controllerï¼‰"></a>3. <strong>IO é™åˆ¶ï¼ˆio controllerï¼‰</strong></h3><h3 id="æ§åˆ¶æ–‡ä»¶ï¼š-1"><a href="#æ§åˆ¶æ–‡ä»¶ï¼š-1" class="headerlink" title="æ§åˆ¶æ–‡ä»¶ï¼š"></a>æ§åˆ¶æ–‡ä»¶ï¼š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">o.max            <span class="hljs-comment"># é™åˆ¶è¯»å†™é€Ÿç‡</span><br>io.weight         <span class="hljs-comment"># ç›¸å¯¹ä¼˜å…ˆçº§</span><br><br></code></pre></td></tr></table></figure><h3 id="é™åˆ¶æœºåˆ¶ï¼š-2"><a href="#é™åˆ¶æœºåˆ¶ï¼š-2" class="headerlink" title="é™åˆ¶æœºåˆ¶ï¼š"></a>é™åˆ¶æœºåˆ¶ï¼š</h3><ul><li>å½“è¿›ç¨‹è®¿é—®ç£ç›˜ï¼ˆè¯»&#x2F;å†™ï¼‰æ—¶ï¼Œå†…æ ¸é€šè¿‡ block å±‚æ£€æŸ¥å®ƒæ‰€åœ¨çš„ cgroup</li><li>å¦‚æœå½“å‰ç»„å·²è¾¾åˆ°é€Ÿç‡ä¸Šé™ï¼Œåˆ™æ’é˜Ÿ</li><li>ç”¨çš„æ˜¯<strong>èŠ‚æµç®—æ³•ï¼ˆtoken bucket + deadlineï¼‰</strong>ï¼ŒæŒ‰æ¯”ä¾‹åˆ†å‘ IO æœºä¼š</li></ul><hr><h3 id="4-è¿›ç¨‹æ•°é™åˆ¶ï¼ˆpids-controllerï¼‰"><a href="#4-è¿›ç¨‹æ•°é™åˆ¶ï¼ˆpids-controllerï¼‰" class="headerlink" title="4. è¿›ç¨‹æ•°é™åˆ¶ï¼ˆpids controllerï¼‰"></a>4. <strong>è¿›ç¨‹æ•°é™åˆ¶ï¼ˆpids controllerï¼‰</strong></h3><h3 id="æ§åˆ¶æ–‡ä»¶ï¼š-2"><a href="#æ§åˆ¶æ–‡ä»¶ï¼š-2" class="headerlink" title="æ§åˆ¶æ–‡ä»¶ï¼š"></a>æ§åˆ¶æ–‡ä»¶ï¼š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">pids.max         <span class="hljs-comment"># æœ€å¤§å¯åˆ›å»ºè¿›ç¨‹æ•°</span><br>pids.current     <span class="hljs-comment"># å½“å‰å·²åˆ›å»ºçš„è¿›ç¨‹æ•°</span><br><br></code></pre></td></tr></table></figure><h2 id="å¤„ç†æµç¨‹"><a href="#å¤„ç†æµç¨‹" class="headerlink" title="å¤„ç†æµç¨‹"></a>å¤„ç†æµç¨‹</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">è¿›ç¨‹è°ƒç”¨ç³»ç»Ÿèµ„æºï¼ˆå¦‚å†…å­˜åˆ†é…ã€CPUæ‰§è¡Œã€ç£ç›˜è¯»å†™ï¼‰  <br>      â†“  <br>å†…æ ¸è§¦å‘èµ„æºæ§åˆ¶å™¨çš„é’©å­å‡½æ•°ï¼ˆå¦‚ memory, cpu, io, pidsï¼‰  <br>      â†“  <br>å†…æ ¸æŸ¥æ‰¾è¯¥è¿›ç¨‹æ‰€å±çš„ cgroup èŠ‚ç‚¹  <br>      â†“  <br>è¯»å–å½“å‰ä½¿ç”¨ç»Ÿè®¡ï¼ˆå¦‚ memory.currentã€cpu.statï¼‰  <br>      â†“  <br>ä¸é…ç½®çš„é™åˆ¶ï¼ˆå¦‚ memory.maxã€cpu.maxï¼‰åšæ¯”è¾ƒ  <br>      â†“  <br>æ ¹æ®æ§åˆ¶å™¨çš„é€»è¾‘æ‰§è¡Œï¼š<br>    â”œâ”€â”€ âœ… å…è®¸ï¼ˆèµ„æºæœªè¶…é™ï¼‰<br>    â”œâ”€â”€ ğŸš« æ‹’ç»ï¼ˆå¦‚ fork è¢«æ‹’ç»ï¼‰<br>    â”œâ”€â”€ ğŸ§¹ è§¦å‘å›æ”¶ï¼ˆå¦‚å†…å­˜å›æ”¶ç¼“å­˜é¡µï¼‰<br>    â””â”€â”€ ğŸ’£ æ€æ­»è¿›ç¨‹ï¼ˆå¦‚ OOM killerï¼‰<br><br></code></pre></td></tr></table></figure><h3 id="ä¸åŒèµ„æºçš„æ§åˆ¶æ–¹å¼ç¤ºæ„ï¼š"><a href="#ä¸åŒèµ„æºçš„æ§åˆ¶æ–¹å¼ç¤ºæ„ï¼š" class="headerlink" title="ä¸åŒèµ„æºçš„æ§åˆ¶æ–¹å¼ç¤ºæ„ï¼š"></a>ä¸åŒèµ„æºçš„æ§åˆ¶æ–¹å¼ç¤ºæ„ï¼š</h3><table><thead><tr><th>èµ„æºç±»å‹</th><th>é’©å­ç‚¹ï¼ˆå†…æ ¸è¡Œä¸ºï¼‰</th><th>æ§åˆ¶è¡Œä¸º</th></tr></thead><tbody><tr><td>Memory</td><td>åˆ†é…é¡µï¼ˆ<code>alloc_pages</code>ï¼‰</td><td>æ‹’ç»åˆ†é… &#x2F; å›æ”¶ &#x2F; OOM</td></tr><tr><td>CPU</td><td>è°ƒåº¦å™¨ï¼ˆ<code>schedule</code>ï¼‰</td><td>è·³è¿‡è°ƒåº¦ &#x2F; é™é€Ÿ</td></tr><tr><td>IO</td><td><code>submit_bio()</code> &#x2F; IOè°ƒåº¦</td><td>èŠ‚æµ &#x2F; æ’é˜Ÿ</td></tr><tr><td>PIDs</td><td>åˆ›å»ºè¿›ç¨‹ï¼ˆ<code>fork()</code>ï¼‰</td><td>ç›´æ¥å¤±è´¥</td></tr><tr><td>NetCls</td><td>å‘åŒ…ã€Qos åˆ†ç±»</td><td>åŠ æ ‡ç­¾é™æµ</td></tr><tr><td>Devices</td><td>æ‰“å¼€æ–‡ä»¶ï¼ˆ<code>open()</code>ï¼‰</td><td>æ‹’ç»è®¿é—®è®¾å¤‡</td></tr></tbody></table><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å®¹å™¨çš„åˆ›å»ºè¿‡ç¨‹</p><ol><li>åˆ›å»ºèšåˆæ–‡ä»¶ç³»ç»Ÿï¼Œå°†å®¹å™¨æ‰€éœ€è¦çš„æ–‡ä»¶ç»Ÿä¸€åˆ°ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ä¸‹</li><li>åˆ›å»ºå‘½åç©ºé—´ï¼Œåˆå§‹åŒ–å‘½åç©ºé—´ä¸­çš„èµ„æºè·¯å¾„</li><li>å°†çˆ¶è¿›ç¨‹ä¸­åˆ›å»ºçš„æ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°å­è¿›ç¨‹ä¸­ï¼Œå°†å­è¿›ç¨‹æ ¹ç›®å½•æŒ‡å‘æŒ‚è½½ç›®å½•</li><li>æŸ¥è¯¢è¿›ç¨‹çš„PIDå·ï¼Œåˆ›å»ºcgroupæ–‡ä»¶ï¼Œæ·»åŠ å¯¹è¯¥è¿›ç¨‹çš„èµ„æºé™åˆ¶ã€‚</li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>è™šæ‹ŸåŒ–æŠ€æœ¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Difyçš„Chatflowå®ç°</title>
    <link href="/2025/03/28/Dify%E7%9A%84Chatflow%E5%AE%9E%E7%8E%B0/"/>
    <url>/2025/03/28/Dify%E7%9A%84Chatflow%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<p>åœ¨ä¸Šä¸€æ¬¡çš„åŸºç¡€ä¸Šè¿›è¡Œä¸€äº›åŠŸèƒ½å®ç°ã€‚</p><p>é€šè¿‡å‘å¤§æ¨¡å‹æè¿°è¯·æ±‚æ¥å®Œæˆä¸€äº›æœåŠ¡å™¨ç«¯çš„åŠŸèƒ½</p><h2 id="è®¾è®¡"><a href="#è®¾è®¡" class="headerlink" title="è®¾è®¡"></a>è®¾è®¡</h2><p>æµç¨‹ Dify Chatflow ä»»åŠ¡æµ â†’ è‡ªå®šä¹‰æ’ä»¶æ„å»ºå®¢æˆ·ç«¯è¯·æ±‚ â†’ æœåŠ¡å™¨ç«¯ç›‘å¬è¯·æ±‚ï¼Œè§£æè¯·æ±‚å¹¶å¤„ç† â†’æ’ä»¶æ¥æ”¶è¯·æ±‚å“åº”ï¼Œä¼ é€’ç»“æœç»™LLM è¿›è¡Œä¼˜åŒ–å±•ç¤ºã€‚</p><h2 id="åˆ›å»ºä»»åŠ¡æµ"><a href="#åˆ›å»ºä»»åŠ¡æµ" class="headerlink" title="åˆ›å»ºä»»åŠ¡æµ"></a>åˆ›å»ºä»»åŠ¡æµ</h2><p>åˆ›å»ºç©ºç™½åº”ç”¨â†’Chatflow</p><p>ChatFlowæ˜¯ç”±å¤šä¸ªç»„ä»¶æ„æˆçš„å·¥ä½œæµç¨‹</p><p><img src="https://i.111666.best/image/4MRRqKxQVG504FjR2SaGTk.png" alt="image"></p><p>åœ¨è¿™ä¸ªå·¥ä½œæµç¨‹ä¸­ï¼Œæ¯æ¬¡çš„å¯¹è¯ä¼šè¢«ä½œä¸ºè¾“å…¥å‚æ•°ä¼ å…¥åˆ°å·¥ä½œæµä¸­è¿›è¡Œå¤„ç†</p><p>å½“å‰å®ç°çš„åŠŸèƒ½ ï¼š </p><ol><li>æŸ¥è¯¢æœåŠ¡å™¨å…è®¸æ‰§è¡Œçš„å‘½ä»¤è¡Œå·¥å…·</li><li>ç”±å¤§æ¨¡å‹åˆ†æç”¨æˆ·æŒ‡ä»¤ï¼Œä»æä¾›çš„å‘½ä»¤åˆ—è¡¨ä¸­ç»„ç»‡å‘½ä»¤æµç¨‹ä¸‹å‘åˆ°æœåŠ¡å™¨ç«¯æ‰§è¡Œ</li></ol><p>è¿™é‡Œçš„ç¼–æ’</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">å¼€å§‹-é—®é¢˜åˆ†ç±»å™¨-æƒ…å†µ1(å‘æœåŠ¡å™¨ç«¯è¯·æ±‚æŸ¥è¯¢åŠŸèƒ½)-äº¤ç”±æ’ä»¶å‘æœåŠ¡å™¨ç«¯å‘é€æŸ¥è¯¢è¯·æ±‚-å¤„ç†å“åº”-å›å¤<br>              -æƒ…å†µ2(åˆ†æç”¨æˆ·éœ€æ±‚ç”Ÿæˆå¯¹åº”æŒ‡ä»¤)-ç”±æ’ä»¶æ„å»ºè¯·æ±‚å‘æœåŠ¡å™¨è¯·æ±‚æ‰§è¡Œ-å¤„ç†å“åº”-å›å¤<br></code></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰æ’ä»¶å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚"><a href="#è‡ªå®šä¹‰æ’ä»¶å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚" class="headerlink" title="è‡ªå®šä¹‰æ’ä»¶å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚"></a>è‡ªå®šä¹‰æ’ä»¶å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚</h2><p>ç”± ä¸Šä¸€èŠ‚ä¸­çš„è®¾è®¡æµç¨‹æ¥çœ‹æˆ‘ä»¬è‡³å°‘éœ€è¦æ„å»ºä¸¤ä¸ªè¯·æ±‚ ï¼š</p><p>1 . Get è¯·æ±‚  å‘æœåŠ¡ç«¯è¯·æ±‚åº”ç”¨ç¨‹åºåˆ—è¡¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Desktop_get</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> json<br><br>FetchKey = <span class="hljs-string">&quot;/key&quot;</span><br>Command = <span class="hljs-string">&quot;/command&quot;</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DestopHTool</span>(<span class="hljs-title class_ inherited__">Tool</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_invoke</span>(<span class="hljs-params">self, tool_parameters: <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]</span>) -&gt; Generator[ToolInvokeMessage]:<br>        ip = tool_parameters.get(<span class="hljs-string">&quot;ip&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br>        port = tool_parameters.get(<span class="hljs-string">&quot;port&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br>        key = <span class="hljs-variable language_">self</span>.fetch_key(ip,port)<br>        url = <span class="hljs-string">f&quot;http://<span class="hljs-subst">&#123;ip&#125;</span>:<span class="hljs-subst">&#123;port&#125;</span><span class="hljs-subst">&#123;Command&#125;</span>&quot;</span><br>        headers=&#123;<span class="hljs-string">&quot;X-Api-Key&quot;</span>:key&#125;<br>        res = requests.get(url=url,headers=headers,timeout=<span class="hljs-number">30</span>).json()<br>        <span class="hljs-keyword">yield</span> <span class="hljs-variable language_">self</span>.create_text_message(<span class="hljs-built_in">str</span>(res[<span class="hljs-string">&quot;commands&quot;</span>])<br>        )<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">fetch_key</span>(<span class="hljs-params">self,ip,port</span>) : <br>        url = <span class="hljs-string">f&quot;http://<span class="hljs-subst">&#123;ip&#125;</span>:<span class="hljs-subst">&#123;port&#125;</span><span class="hljs-subst">&#123;FetchKey&#125;</span>&quot;</span><br><br>        js = requests.get(url=url,timeout=<span class="hljs-number">30</span>).json()<br>        <span class="hljs-keyword">return</span> js[<span class="hljs-string">&quot;key&quot;</span>]<br></code></pre></td></tr></table></figure><ol start="2"><li>Post è¯·æ±‚ å‘æœåŠ¡ç«¯å‘é€å‘½ä»¤æ‰§è¡Œåˆ—è¡¨ï¼Œç”±æœåŠ¡ç«¯è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> json<br><br>EXEC=<span class="hljs-string">&quot;/execute&quot;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DestopHelperTool</span>(<span class="hljs-title class_ inherited__">Tool</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_invoke</span>(<span class="hljs-params">self, tool_parameters: <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]</span>) -&gt; Generator[ToolInvokeMessage]:<br>        content = tool_parameters.get(<span class="hljs-string">&quot;text&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br>        ip = tool_parameters.get(<span class="hljs-string">&quot;ip&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br>        port = tool_parameters.get(<span class="hljs-string">&quot;port&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br>        url = <span class="hljs-string">f&quot;http://<span class="hljs-subst">&#123;ip&#125;</span>:<span class="hljs-subst">&#123;port&#125;</span><span class="hljs-subst">&#123;EXEC&#125;</span>&quot;</span><br>        <span class="hljs-built_in">print</span>(url)<br>        key = tool_parameters.get(<span class="hljs-string">&quot;key&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br>        headers=&#123;<span class="hljs-string">&quot;X-Api-Key&quot;</span>:key,<span class="hljs-string">&quot;Content-Type&quot;</span>:<span class="hljs-string">&quot;application/json&quot;</span>&#125;<br>        <span class="hljs-built_in">print</span>(headers)<br>        res = requests.post(url=url,json=json.loads(content),headers=headers,timeout=<span class="hljs-number">30</span>).text<br>        <span class="hljs-keyword">yield</span> <span class="hljs-variable language_">self</span>.create_text_message(res)<br><br></code></pre></td></tr></table></figure><h2 id="æ„å»ºæœåŠ¡å™¨ç«¯æ¥å£"><a href="#æ„å»ºæœåŠ¡å™¨ç«¯æ¥å£" class="headerlink" title="æ„å»ºæœåŠ¡å™¨ç«¯æ¥å£"></a>æ„å»ºæœåŠ¡å™¨ç«¯æ¥å£</h2><p>ä½¿ç”¨flask æ„å»ºä¸€ä¸ªæ¥æ”¶ä»¥ä¸Šè¯·æ±‚çš„æœåŠ¡ç¨‹åºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, jsonify, request<br><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> wraps<br><span class="hljs-keyword">import</span> uuid<br><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">import</span> pexpect<br><br>app = Flask(__name__)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">require_key</span>(<span class="hljs-params">f</span>):<br><span class="hljs-meta">    @wraps(<span class="hljs-params">f</span>)</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decorated_function</span>(<span class="hljs-params">*args, **kwargs</span>):<br>        <span class="hljs-built_in">print</span>(request.headers)<br>        key = request.headers.get(<span class="hljs-string">&#x27;X-API-KEY&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(keys)<br>        <span class="hljs-keyword">if</span> key <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> keys:<br>            <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;error&#x27;</span>: <span class="hljs-string">&#x27;Invalid API key&#x27;</span>&#125;), <span class="hljs-number">401</span><br>        <span class="hljs-keyword">return</span> f(*args, **kwargs)<br>    <span class="hljs-keyword">return</span> decorated_function<br><br><span class="hljs-comment"># å¯†é’¥åˆ›å»ºè·¯ç”±</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/key&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_key</span>():<br>    key = <span class="hljs-built_in">str</span>(uuid.uuid4())<br>    keys[key] = <span class="hljs-literal">True</span><br>    <span class="hljs-built_in">print</span>(keys)<br>    <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;key&#x27;</span>: key&#125;)<br><br><span class="hljs-comment"># è·å–æ‰€æœ‰åŠŸèƒ½è·¯ç”±</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/command&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-meta">@require_key</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_functions</span>():<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># è·å–PATHç¯å¢ƒå˜é‡ä¸­çš„æ‰€æœ‰å¯æ‰§è¡Œæ–‡ä»¶</span><br>        result = subprocess.run([<span class="hljs-string">&#x27;ls&#x27;</span>, <span class="hljs-string">&#x27;/server/bin&#x27;</span>], capture_output=<span class="hljs-literal">True</span>, text=<span class="hljs-literal">True</span>)<br>        commands = result.stdout.split(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;status&#x27;</span>: <span class="hljs-string">&#x27;success&#x27;</span>, <span class="hljs-string">&#x27;commands&#x27;</span>: commands&#125;)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;status&#x27;</span>: <span class="hljs-string">&#x27;error&#x27;</span>, <span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-built_in">str</span>(e)&#125;)<br><span class="hljs-comment"># æ‰§è¡Œå‘½ä»¤è·¯ç”±</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/execute&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-meta">@require_key</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    æ‰§è¡Œä¼ å…¥çš„å‘½ä»¤å¹¶è¿”å›ç»“æœ</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    data = request.json<br>    <span class="hljs-built_in">print</span>(data)<br>    commands = data.get(<span class="hljs-string">&#x27;commands&#x27;</span>)<br>    result = []<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> commands:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;status&#x27;</span>: <span class="hljs-string">&#x27;error&#x27;</span>, <span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;No command provided&#x27;</span>&#125;)<br>    <br>    <span class="hljs-keyword">try</span>:<br>        shell = pexpect.spawn(<span class="hljs-string">&#x27;/bin/bash&#x27;</span>)<br>        <span class="hljs-keyword">for</span> command <span class="hljs-keyword">in</span> commands:<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(command, <span class="hljs-built_in">dict</span>):<br>                <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;status&#x27;</span>: <span class="hljs-string">&#x27;error&#x27;</span>,<span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;Invalid command format&#x27;</span>&#125;)<br>            command_line = []<br>            command_line.append(command[<span class="hljs-string">&quot;command&quot;</span>])<br>            command_line.extend(command[<span class="hljs-string">&quot;args&quot;</span>])<br>            cmd = <span class="hljs-string">&quot; &quot;</span>.join(command_line)<br>            marker = <span class="hljs-string">f&quot;CMD_END_<span class="hljs-subst">&#123;<span class="hljs-built_in">hash</span>(cmd)&#125;</span>&quot;</span><br>            shell.sendline(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;cmd&#125;</span>; echo &#x27;<span class="hljs-subst">&#123;marker&#125;</span>&#x27;&quot;</span>)<br>            shell.expect(marker)<br>            <span class="hljs-comment"># è·å–è¾“å‡º</span><br>            output = shell.before.decode().strip()<br>            <span class="hljs-built_in">print</span>(output)<br>            result.append( &#123;<br>                <span class="hljs-string">&#x27;command&#x27;</span>: cmd,<br>                <span class="hljs-string">&#x27;status&#x27;</span>:<span class="hljs-string">&#x27;success&#x27;</span>,<br>                <span class="hljs-string">&#x27;stdout&#x27;</span>: output,<br>            &#125;)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;status&#x27;</span>: <span class="hljs-string">&#x27;error&#x27;</span>, <span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-built_in">str</span>(e)&#125;)<br>    shell.close()<br>    <span class="hljs-built_in">print</span>(result)<br>    <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&quot;result&quot;</span>: result&#125;)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">5000</span>, debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><p>Get è¯·æ±‚è¿”å›çš„æ¶ˆæ¯ä½“</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;commands&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-string">&quot;hexo&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;ls&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;lscpu&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;python&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;zip&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;success&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>Postè¯·æ±‚æ¥æ”¶çš„æ¶ˆæ¯ä½“</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;commands&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;command&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ls&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;args&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;-l&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;/home/codfish&quot;</span><span class="hljs-punctuation">]</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å¯åŠ¨æœ¬åœ°æ’ä»¶è°ƒè¯•å’ŒæœåŠ¡ç«¯</p><h2 id="æ‰§è¡Œå·¥ä½œæµ"><a href="#æ‰§è¡Œå·¥ä½œæµ" class="headerlink" title="æ‰§è¡Œå·¥ä½œæµ"></a>æ‰§è¡Œå·¥ä½œæµ</h2><p>å‘æœºå™¨äººè¯·æ±‚æŸ¥çœ‹æœåŠ¡ç«¯æä¾›çš„åº”ç”¨åˆ—è¡¨ ï¼š </p><p><img src="https://i.111666.best/image/lgRg7jkIDaRm4Fs8moXWkk.png" alt="image"></p><p>å‘æœºå™¨äººè¯·æ±‚æŸ¥è¯¢æŸä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ä¿¡æ¯ï¼š</p><p><img src="https://i.111666.best/image/PI0vurDrzyzDKmIyPWrGCh.jpg" alt="image"></p><p>è¯·æ±‚å®‰è£…python åº“ï¼š</p><p><img src="https://i.111666.best/image/fY63mSee5VABzV7CFrSHuu.png" alt="image"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å®Œæˆäº†åŸºæœ¬åŠŸèƒ½çš„å®ç°</p><p>åœ¨æŸäº›æƒ…å†µä¸‹æç¤ºè¯è¿˜æ˜¯ä¼šå‡ºç°å¼‚å¸¸ï¼Œéœ€è¦è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>ç¯å¢ƒæ­å»º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WSL2+Dify é…ç½®å¤§æ¨¡å‹æ¡Œé¢ç«¯èµ„æºè®¿é—®(ç®€å•åº”ç”¨)</title>
    <link href="/2025/03/25/WSL2-Dify-%E9%85%8D%E7%BD%AE%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%A1%8C%E9%9D%A2%E7%AB%AF%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE-%E7%AE%80%E5%8D%95%E5%BA%94%E7%94%A8/"/>
    <url>/2025/03/25/WSL2-Dify-%E9%85%8D%E7%BD%AE%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%A1%8C%E9%9D%A2%E7%AB%AF%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE-%E7%AE%80%E5%8D%95%E5%BA%94%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘ä½¿ç”¨WSL2 åšäº†difyçš„æœ¬åœ°åŒ–éƒ¨ç½²ã€‚è¯•ç€ä½¿ç”¨å·¥ä½œæµçš„æ–¹å¼å®ç°ä¸€ä¸ªå·¥ä½œæµæ¥é€šè¿‡å’Œå¤§æ¨¡å‹å¯¹è¯å®Œæˆå¯¹æœ¬åœ°èµ„æºçš„è®¿é—®ã€‚</p><h1 id="é¢„é…ç½®"><a href="#é¢„é…ç½®" class="headerlink" title="é¢„é…ç½®"></a>é¢„é…ç½®</h1><h2 id="WSL2çš„æœ¬åœ°éƒ¨ç½²"><a href="#WSL2çš„æœ¬åœ°éƒ¨ç½²" class="headerlink" title="WSL2çš„æœ¬åœ°éƒ¨ç½²"></a>WSL2çš„æœ¬åœ°éƒ¨ç½²</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">wsl --list  <span class="hljs-comment"># æŸ¥è¯¢æ”¯æŒçš„wslå­ç³»ç»Ÿå‘è¡Œç‰ˆæœ¬</span><br>wsl --install <span class="hljs-comment"># å®‰è£…é»˜è®¤çš„wslå­ç³»ç»Ÿ</span><br></code></pre></td></tr></table></figure><p>éƒ¨ç½²å®Œæˆåï¼Œé…ç½®å®‰è£…aptæº ï¼ŒDockeræºï¼ˆé•œåƒæœ‰é—®é¢˜å¯ä»¥æŸ¥è¯¢ä¹‹å‰çš„æ–‡ç« ï¼‰ï¼ŒGité…ç½®ï¼Œä»¥åŠ ä¸€äº›åŸºæœ¬çš„å‘½ä»¤è¡Œå·¥å…·</p><h2 id="Dify-æœ¬åœ°éƒ¨ç½²"><a href="#Dify-æœ¬åœ°éƒ¨ç½²" class="headerlink" title="Dify æœ¬åœ°éƒ¨ç½²"></a>Dify æœ¬åœ°éƒ¨ç½²</h2><p>Github ä¸Š <a href="https://github.com/langgenius/dify">https://github.com/langgenius/dify</a> æœ‰éƒ¨ç½²æ•™ç¨‹ï¼Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> dify<br><span class="hljs-built_in">cd</span> docker<br><span class="hljs-built_in">cp</span> .env.example .<span class="hljs-built_in">env</span><br>docker compose up -d<br></code></pre></td></tr></table></figure><p>å®‰è£…å®Œæ¯•å è®¿é—®æœ¬åœ°çš„<a href="http://localhost/install">http://localhost/install</a>  è¿›è¡Œç®¡ç†å‘˜é…ç½®</p><p>è‡³æ­¤æˆ‘ä»¬è·å¾—äº†ä¸€ä¸ªéƒ¨ç½²åœ¨æœ¬åœ°windowså­ç³»ç»Ÿä¸Šçš„difyç¯å¢ƒ</p><h1 id="è®¾è®¡"><a href="#è®¾è®¡" class="headerlink" title="è®¾è®¡"></a>è®¾è®¡</h1><p><img src="https://i.111666.best/image/YNLclFRYQ3PLOr79iU1PyH.png" alt="image"></p><p>ç›®æ ‡æ˜¯é€šè¿‡å’Œå¤§æ¨¡å‹å¯¹è¯ï¼Œè¯†åˆ«å…¶ä¸­çš„å…³é”®è¯æ¥å®Œæˆå’Œè‡ªå®šä¹‰æ’ä»¶ä¸­çš„åŠŸèƒ½çš„æ˜ å°„å…³ç³»ã€‚å‘æœ¬åœ°çš„HTTPæœåŠ¡å™¨å‘é€å¯¹åº”è¯·æ±‚ã€‚å®ŒæˆåŠŸèƒ½çš„æ‰§è¡Œ</p><p>ä¸€äº›æœªæ¥å¯è¡Œçš„æ‰©å±•é¡¹</p><ol><li>æ›´å¥½çš„æœåŠ¡é€šä¿¡æ–¹å¼ã€‚wsl2 å­ç³»ç»Ÿå¯ä»¥ç›´æ¥å¯¹æŒ‚è½½åˆ°è¯¥ç³»ç»Ÿçš„windowsç³»ç»Ÿä¸Šçš„æ–‡ä»¶è¿›è¡Œæ“ä½œã€‚æ‰€ä»¥å­˜åœ¨æ›´å¿«æ·æ–¹æ³•è°ƒç”¨æœ¬åœ°èµ„æºã€‚ä½†æ˜¯è¿™å¯èƒ½éœ€è¦difyæä¾›æ›´ä¸°å¯Œçš„è°ƒç”¨æ–¹å¼æˆ–è€…åœ¨dockerå±‚é¢ä¸Šè¿›è¡Œä¸€äº›åŠŸèƒ½å®šåˆ¶ï¼Œå½“å‰åªæ˜¯ä¸€ä¸ªå¯è¡Œæ€§å°è¯•ã€‚æ‰€ä»¥ä½¿ç”¨äº† httpçš„è°ƒç”¨-å“åº”æ¨¡å¼</li><li>æ³¨å†Œï¼Œ æä¾›ä¸€ä¸ªé€šç”¨çš„PCå¹³å°åº”ç”¨å‘ç°æœåŠ¡ã€‚è€Œä¸æ˜¯é€šè¿‡å°†æ‰€æœ‰çš„å¯æ‰§è¡Œç¨‹åºæ³¨å†Œä¸ºDifyçš„è‡ªå®šä¹‰æ’ä»¶åŠŸèƒ½ã€‚è¿™æ ·æ›´åŠ çµæ´»</li><li>æœ¬åœ°çš„éƒ¨ç½²+è‡ªç„¶è¯­è¨€çš„è¯·æ±‚+æ’ä»¶è‡ªå®šä¹‰åŠŸèƒ½çš„è§£è€¦ ç›®å‰æ¥çœ‹ç›¸å¯¹è¿˜æ˜¯æ¯”è¾ƒå®‰å…¨ã€‚å¦‚æœéœ€è¦å®ç°è¿œç¨‹çš„è¯·æ±‚è°ƒç”¨å¯èƒ½éœ€è¦æ›´åŠ å®‰å…¨çš„ä¿¡æ¯ä¼ è¾“æ–¹å¼</li><li>åœ¨æœ¬åœ°æ·»åŠ åº”ç”¨ç¨‹åºå’Œæ–‡ä»¶èµ„æºçš„è°ƒç”¨è®°å½•ã€‚</li></ol><h1 id="Difyçš„è‡ªå®šä¹‰æ’ä»¶"><a href="#Difyçš„è‡ªå®šä¹‰æ’ä»¶" class="headerlink" title="Difyçš„è‡ªå®šä¹‰æ’ä»¶"></a>Difyçš„è‡ªå®šä¹‰æ’ä»¶</h1><h2 id="è„šæ‰‹æ¶å·¥å…·åˆå§‹åŒ–"><a href="#è„šæ‰‹æ¶å·¥å…·åˆå§‹åŒ–" class="headerlink" title="è„šæ‰‹æ¶å·¥å…·åˆå§‹åŒ–"></a>è„šæ‰‹æ¶å·¥å…·åˆå§‹åŒ–</h2><p>å®˜æ–¹æ–‡æ¡£</p><p><a href="https://docs.dify.ai/zh-hans/plugins/quick-start/develop-plugins/initialize-development-tools">https://docs.dify.ai/zh-hans/plugins/quick-start/develop-plugins/initialize-development-tools</a></p><p>ä¸‹è½½ Difyçš„æ’ä»¶è„šæ‰‹æ¶å·¥å…· <a href="https://github.com/langgenius/dify-plugin-daemon/tags">https://github.com/langgenius/dify-plugin-daemon/tags</a></p><p>ä»¥tools ç±»å‹ä¸ºä¾‹  åˆå§‹åŒ– æ’ä»¶é¡¹ç›®ç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">dify-plugin-windows-amd64 plugin init <br></code></pre></td></tr></table></figure><p><img src="https://i.111666.best/image/36KrL8MFwMSB0kHm0M7VGs.png" alt="image"><br>name åˆ›å»º æ’ä»¶å</p><p>author æ’ä»¶ä½œè€…</p><p>description æ’ä»¶åŠŸèƒ½æè¿°</p><p>è¯­è¨€ : python</p><p>å·¥å…· : tools  (è‡ªå®šä¹‰tools ç±»å‹æ’ä»¶</p><p><img src="https://i.111666.best/image/htD6C2oNrddvAuEyXVdmep.png" alt="image"></p><p>ä¸€äº›æƒé™çš„è®¾ç½®</p><p>æœ€ç»ˆæˆ‘ä»¬å¾—åˆ°çš„æ˜¯ä¸€ä¸ªè¿™æ ·çš„å·¥ç¨‹</p><p>ä»¥ä¸‹æ˜¯ä¸€äº›æ¯”è¾ƒé‡è¦çš„æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">- _assets  <span class="hljs-comment"># å­˜æ”¾ä¸€äº›å¼•ç”¨èµ„æº</span><br>- provider <span class="hljs-comment"># </span><br>  - someplugin.py <span class="hljs-comment"># è¿›è¡Œä¸€äº›å¼‚å¸¸å¤„ç†</span><br>- someplugin.yaml <span class="hljs-comment"># æ’ä»¶åŠŸèƒ½/èµ„æºæè¿° </span><br>- tools    <span class="hljs-comment"># å…·ä½“çš„toolsåŠŸèƒ½å®ç°</span><br>- somefunction.py <span class="hljs-comment"># å…·ä½“çš„åŠŸèƒ½å®ç°</span><br>- somefunction.yaml <span class="hljs-comment"># åŠŸèƒ½/èµ„æºæè¿°</span><br>- main.py <span class="hljs-comment"># å‡½æ•°å…¥å£</span><br>- manifest.yaml <span class="hljs-comment">#  æ’ä»¶æè¿°</span><br> <br></code></pre></td></tr></table></figure><h2 id="æ’ä»¶åŠŸèƒ½å®šä¹‰"><a href="#æ’ä»¶åŠŸèƒ½å®šä¹‰" class="headerlink" title="æ’ä»¶åŠŸèƒ½å®šä¹‰"></a>æ’ä»¶åŠŸèƒ½å®šä¹‰</h2><p>æ’ä»¶é€šè¿‡è°ƒç”¨çš„æ˜¯_invokeæ–¹æ³•æ¥æ‰§è¡Œå¯¹åº”çš„åŠŸèƒ½</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> collections.abc <span class="hljs-keyword">import</span> Generator<br><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Any</span><br><br><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-keyword">from</span> dify_plugin <span class="hljs-keyword">import</span> Tool<br><span class="hljs-keyword">from</span> dify_plugin.entities.tool <span class="hljs-keyword">import</span> ToolInvokeMessage<br><br>BASE_URL =<span class="hljs-string">&quot;&lt;http://localhost:8080&gt;&quot;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DestopHTool</span>(<span class="hljs-title class_ inherited__">Tool</span>):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_invoke</span>(<span class="hljs-params">self, tool_parameters: <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]</span>) -&gt; Generator[ToolInvokeMessage]:<br>        method = tool_parameters.get(<span class="hljs-string">&quot;method&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br>        result = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">if</span> method == <span class="hljs-string">&quot;desktop_get&quot;</span> :<br>            result = requests.get(BASE_URL).text<br>        <span class="hljs-keyword">yield</span>  <span class="hljs-variable language_">self</span>.create_text_message(<span class="hljs-string">f&#x27;è°ƒç”¨äº†<span class="hljs-subst">&#123;method&#125;</span>,è¿”å›<span class="hljs-subst">&#123;result&#125;</span>&#x27;</span>)<br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œç»™å‡ºäº†ä¸€ä¸ªç®€å•çš„httpè¯·æ±‚è°ƒç”¨ï¼Œä½¿ç”¨requestæ¨¡æ‹Ÿhttp get è¯·æ±‚ã€‚å¹¶è¿”å›æ¥æ”¶åˆ°çš„æ¶ˆæ¯</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">identity:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">desktop_get</span>      <span class="hljs-comment"># æ–¹æ³•å</span><br>  <span class="hljs-attr">author:</span> <span class="hljs-string">codfish</span><br>  <span class="hljs-attr">label:</span><br>    <span class="hljs-attr">en_US:</span> <span class="hljs-string">destop_get</span><br>    <span class="hljs-attr">zh_Hans:</span> <span class="hljs-string">destop_get</span><br>    <span class="hljs-attr">pt_BR:</span> <span class="hljs-string">destop_get</span><br><span class="hljs-attr">description:</span><br>  <span class="hljs-attr">human:</span><br>    <span class="hljs-attr">en_US:</span> <span class="hljs-string">a</span> <span class="hljs-string">interface</span> <span class="hljs-string">design</span> <span class="hljs-string">for</span> <span class="hljs-string">destop_application_oprating</span> <br>    <span class="hljs-attr">zh_Hans:</span> <span class="hljs-string">a</span> <span class="hljs-string">interface</span> <span class="hljs-string">design</span> <span class="hljs-string">for</span> <span class="hljs-string">destop_application_oprating</span> <br>    <span class="hljs-attr">pt_BR:</span> <span class="hljs-string">a</span> <span class="hljs-string">interface</span> <span class="hljs-string">design</span> <span class="hljs-string">for</span> <span class="hljs-string">destop_application_oprating</span> <br>  <span class="hljs-attr">llm:</span> <span class="hljs-string">a</span> <span class="hljs-string">interface</span> <span class="hljs-string">design</span> <span class="hljs-string">for</span> <span class="hljs-string">destop_application_oprating</span> <br><span class="hljs-attr">parameters:</span>       <span class="hljs-comment">#è‡ªå®šä¹‰å‚æ•°</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">url</span>     <span class="hljs-comment">#å‚æ•°å</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>  <span class="hljs-comment">#å‚æ•°ç±»å‹</span><br>    <span class="hljs-attr">required:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">label:</span><br>      <span class="hljs-attr">en_US:</span> <span class="hljs-string">Query</span> <span class="hljs-string">string</span><br>      <span class="hljs-attr">zh_Hans:</span> <span class="hljs-string">æŸ¥è¯¢è¯­å¥</span><br>      <span class="hljs-attr">pt_BR:</span> <span class="hljs-string">Query</span> <span class="hljs-string">string</span><br>    <span class="hljs-attr">human_description:</span><br>      <span class="hljs-attr">en_US:</span> <span class="hljs-string">a</span> <span class="hljs-string">interface</span> <span class="hljs-string">design</span> <span class="hljs-string">for</span> <span class="hljs-string">destop_application_oprating</span> <br>      <span class="hljs-attr">zh_Hans:</span> <span class="hljs-string">a</span> <span class="hljs-string">interface</span> <span class="hljs-string">design</span> <span class="hljs-string">for</span> <span class="hljs-string">destop_application_oprating</span> <br>      <span class="hljs-attr">pt_BR:</span> <span class="hljs-string">a</span> <span class="hljs-string">interface</span> <span class="hljs-string">design</span> <span class="hljs-string">for</span> <span class="hljs-string">destop_application_oprating</span> <br>    <span class="hljs-attr">llm_description:</span> <span class="hljs-string">a</span> <span class="hljs-string">interface</span> <span class="hljs-string">design</span> <span class="hljs-string">for</span> <span class="hljs-string">destop_application_oprating</span> <br>    <span class="hljs-attr">form:</span> <span class="hljs-string">llm</span><br><span class="hljs-attr">extra:</span><br>  <span class="hljs-attr">python:</span><br>    <span class="hljs-attr">source:</span> <span class="hljs-string">tools/desktop_get.py</span>  <span class="hljs-comment">#å¯¹åº”çš„pythonå®ç°æ–‡ä»¶</span><br><br></code></pre></td></tr></table></figure><p>æ¯ä¸ªtools æ’ä»¶å…è®¸æ·»åŠ å¤šä¸ªæ–¹æ³•ï¼Œæ¯ä¸ªæ–¹æ³•éœ€è¦å®šä¹‰è‡ªå·±çš„æ¨¡å—æ–‡ä»¶(.py)å’Œèµ„æºæè¿°æ–‡ä»¶ï¼ˆ.yamlï¼‰</p><p>å…¶ç»“æ„ä¸º</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">tools\\</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">somefunction1.py</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">somefunction1.yaml</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">somefunction2.py</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">somefunction2.yaml</span><br>  <span class="hljs-string">...</span><br></code></pre></td></tr></table></figure><h2 id="æ’ä»¶è°ƒè¯•"><a href="#æ’ä»¶è°ƒè¯•" class="headerlink" title="æ’ä»¶è°ƒè¯•"></a>æ’ä»¶è°ƒè¯•</h2><p>é€šè¿‡ä¿®æ”¹å·¥ä½œç›®å½•ä¸­çš„.env.example ä¸º.env</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">INSTALL_METHOD=remote</span><br><span class="hljs-string">REMOTE_INSTALL_HOST=debug.dify.ai</span><br><span class="hljs-string">REMOTE_INSTALL_PORT=5003</span><br><span class="hljs-string">REMOTE_INSTALL_KEY=some_install_key</span><br></code></pre></td></tr></table></figure><p>å°†difyæ’ä»¶é¡µçš„è°ƒè¯•ä¿¡æ¯å¡«å……åˆ°.envä¸­ï¼Œæœ¬åœ°æ‰§è¡Œmainæ–¹æ³•ï¼Œæ’ä»¶ä¼šè¢«åŠ è½½åˆ°difyçš„æ’ä»¶åˆ—è¡¨ä¸­</p><p><img src="https://i.111666.best/image/TmrbwxdMkhWRuygRCXbdGp.png" alt="image"></p><h2 id="åˆ›å»ºCHATä»»åŠ¡æµ"><a href="#åˆ›å»ºCHATä»»åŠ¡æµ" class="headerlink" title="åˆ›å»ºCHATä»»åŠ¡æµ"></a>åˆ›å»ºCHATä»»åŠ¡æµ</h2><p><img src="https://i.111666.best/image/2IgA1P69jBp6amaeczz6ZT.png" alt="image"></p><p>åˆ›å»ºå¤§æ¨¡å‹ç»„ä»¶ï¼Œå¹¶å¡«å…¥æ¨¡å‹ï¼Œå›½å†…æ¨èä½¿ç”¨ç¡…åŸºæµåŠ¨ã€‚</p><p>åœ¨å¤§æ¨¡å‹ç»„ä»¶ä¸­å¡«å…¥æ¨¡å‹ï¼Œå¡«å…¥ç³»ç»Ÿæç¤ºè¯ï¼Œæ ¸å¿ƒç›®çš„æ˜¯é¢„æœŸè¾“å‡ºåˆç†ä¸”å¯æ§ï¼Œä¸è¦æœ‰å¤šä½™çš„è¾“å‡ºï¼Œæµ‹è¯•çš„ç³»ç»Ÿæç¤ºè¯å¦‚ä¸‹(å¹¶ä¸èƒ½å¾ˆå¥½çš„è·å–åˆ°ç›®æ ‡æ–¹æ³•åï¼Œéœ€è¦åæœŸå†è°ƒè¯•)</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">## è§’è‰²</span><br><span class="hljs-string">ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„æ¡Œé¢åŠ©ç†</span><br><span class="hljs-comment">## ä»»åŠ¡</span><br><span class="hljs-string">å½“ç”¨æˆ·å‘é€æŸ¥è¯¢æ¡Œé¢çš„è¯·æ±‚æ—¶ï¼Œä½ å¯ä»¥æ ¹æ®å¯¹è¯ä¿¡æ¯æ£€æŸ¥æ˜¯å¦è¿”å›ä¸€ä¸ªè°ƒç”¨æ–¹æ³•</span><br><span class="hljs-comment">## å½“å‰æ”¯æŒçš„æ–¹æ³•è¡¨</span><br><span class="hljs-string">å‘èµ·æ¡Œé¢è¯·æ±‚</span> <span class="hljs-string">=</span> <span class="hljs-string">destop_get</span><br><span class="hljs-comment">## æ³¨æ„</span><br><span class="hljs-string">ä¸éœ€è¦</span> <span class="hljs-string">ç›´æ¥å›ç­”ç”¨æˆ·è¯·æ±‚ï¼Œåªéœ€è¦è¿”å›ä¸€ä¸ªå…·ä½“çš„æ‰§è¡Œæ–¹æ³•</span><br></code></pre></td></tr></table></figure><p>åœ¨åç»­æ·»åŠ è‡ªå®šä¹‰ç»„ä»¶ä½œä¸ºèŠ‚ç‚¹ï¼Œ æ¥æ”¶å¤§æ¨¡å‹çš„è¿”å›ä½œä¸ºè¾“å…¥çš„å‚æ•°ï¼Œè¿›è¡Œåç»­æ‰§è¡Œ</p><p><img src="https://i.111666.best/image/TUxQf8y6eXGsVkuHSLivNL.png" alt="image"></p><p>ä¸€ä¸ªåŸºç¡€çš„å·¥ä½œé“¾æ¡  å¯åŠ¨å¤§æ¨¡å‹â†’å‘èµ·è¯·æ±‚â†’ æ ¹æ®è¯·æ±‚ç»™å‡ºéœ€è¦æ‰§è¡Œçš„æ–¹æ³•â†’ä¼ é€’ç»™æ’ä»¶æ‰§è¡Œæ–¹æ³•â†’è¿”å›æ‰§è¡Œç»“æœ</p><p>å¤§æ¨¡å‹æ­£ç¡®è¯†åˆ«æ–¹æ³•åï¼Œæ’ä»¶è§£ææ–¹æ³•ï¼Œæ‰§è¡Œå¯¹åº”æ–¹æ³•ã€‚å‘æœ¬åœ°å¯åŠ¨çš„æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚å¾—åˆ°å“åº”è¿”å›ç»“æœåˆ°å¯¹è¯æ¡†</p><p><img src="https://i.111666.best/image/hdRpQxHTCHkU6fLsuc3BTm.png" alt="image"></p>]]></content>
    
    
    
    <tags>
      
      <tag>ç¯å¢ƒæ­å»º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dockerå®¹å™¨é•œåƒæº</title>
    <link href="/2025/03/21/Docker%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F%E6%BA%90/"/>
    <url>/2025/03/21/Docker%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F%E6%BA%90/</url>
    
    <content type="html"><![CDATA[<h2 id="Docker-å®¹å™¨é•œåƒæ‹‰å–çš„é—®é¢˜"><a href="#Docker-å®¹å™¨é•œåƒæ‹‰å–çš„é—®é¢˜" class="headerlink" title="Docker å®¹å™¨é•œåƒæ‹‰å–çš„é—®é¢˜"></a>Docker å®¹å™¨é•œåƒæ‹‰å–çš„é—®é¢˜</h2><p>ä½¿ç”¨docker pull æˆ–è€… docker compose up -d æ‹‰å–é•œåƒæ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°ä»¥ä¸‹é—®é¢˜ã€‚</p><p>Error response from daemon: Get â€œ<a href="https://registry-1.docker.io/v2/">https://registry-1.docker.io/v2/</a>â€œ: net&#x2F;http: request canceled while waiting for connection (Client.Timeout exceeded while awaiting headers)</p><p>åŸå› æ˜¯é•œåƒæºå¤±æ•ˆæˆ–è€…é€Ÿç‡ä¸å¤Ÿå¯¼è‡´è¶…æ—¶</p><p>ç»å¤§éƒ¨åˆ†çš„æ–‡ç« éƒ½ä¸ç”¨çœ‹ï¼Œå› ä¸ºå¤±æ•ˆå¾ˆå¿«</p><p>å¯ä»¥åœ¨Githubä¸Šå…³æ³¨è¿™ä¸ªé¡¹ç›®éšæ—¶æ›´æ–°æº</p><p><a href="https://github.com/dongyubin/DockerHub">https://github.com/dongyubin/DockerHub</a></p><p>ç„¶åä¿®æ”¹æœ¬åœ°daemon.json é…ç½®</p><p>cat &#x2F;etc&#x2F;docker&#x2F;daemon.json</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;registry-mirrors&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>   <span class="hljs-string">&quot;https://docker.mybacc.com&quot;</span><span class="hljs-punctuation">,</span><br>   <span class="hljs-string">&quot;https://docker.1ms.run&quot;</span><span class="hljs-punctuation">,</span><br>   <span class="hljs-string">&quot;https://dytt.online&quot;</span><br> <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>é‡å¯daemonå’Œdocker æœåŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">systemctl daemon-reload<br>systemctl restart docker <br></code></pre></td></tr></table></figure><h2 id="é¡ºä¾¿è®°å½•ä¸‹Podmançš„æºé…ç½®"><a href="#é¡ºä¾¿è®°å½•ä¸‹Podmançš„æºé…ç½®" class="headerlink" title="é¡ºä¾¿è®°å½•ä¸‹Podmançš„æºé…ç½®"></a>é¡ºä¾¿è®°å½•ä¸‹Podmançš„æºé…ç½®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp19tqlmjz1dmnm8w43uZ containers]# <span class="hljs-built_in">cat</span> /etc/containers/registries.conf | grep -v <span class="hljs-string">&quot;#&quot;</span><br><br>unqualified-search-registries = [<span class="hljs-string">&quot;registry.access.redhat.com&quot;</span>, <span class="hljs-string">&quot;registry.redhat.io&quot;</span>, <span class="hljs-string">&quot;docker.io&quot;</span>]<br><br><br><br>[[registry]]<br>prefix = <span class="hljs-string">&quot;docker.io&quot;</span><br>location = <span class="hljs-string">&quot;docker.1ms.run&quot;</span><br>insecure = <span class="hljs-literal">false</span><br><br>[[registry.mirror]]<br>location = <span class="hljs-string">&quot;docker.mybacc.com&quot;</span><br>insecure = <span class="hljs-literal">false</span><br><br>[[registry.mirror]]<br>location = <span class="hljs-string">&quot;docker.1ms.run&quot;</span><br>insecure = <span class="hljs-literal">false</span><br><br>[[registry.mirror]]<br>location = <span class="hljs-string">&quot;dytt.online&quot;</span><br>insecure = <span class="hljs-literal">false</span><br><br><br><br>short-name-mode = <span class="hljs-string">&quot;permissive&quot;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>ç¯å¢ƒæ­å»º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸºäºHEXOçš„åšå®¢æ­å»º</title>
    <link href="/2025/03/21/%E5%9F%BA%E4%BA%8EHEXO%E7%9A%84%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"/>
    <url>/2025/03/21/%E5%9F%BA%E4%BA%8EHEXO%E7%9A%84%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="åŸºäºHEXO-FLUID-æ ·å¼çš„åšå®¢æ­å»º"><a href="#åŸºäºHEXO-FLUID-æ ·å¼çš„åšå®¢æ­å»º" class="headerlink" title="åŸºäºHEXO+FLUID æ ·å¼çš„åšå®¢æ­å»º"></a>åŸºäºHEXO+FLUID æ ·å¼çš„åšå®¢æ­å»º</h1><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><ol><li><p>7.3ç‰ˆæœ¬çš„Hexo è¦æ±‚node.js çš„ç‰ˆæœ¬åœ¨18.0ä»¥ä¸Šï¼Œcentos7 æ‰€èƒ½æ‹‰å–åˆ°çš„node.js ç‰ˆæœ¬åœ¨11.0 ã€‚è€ƒè™‘åˆ°éœ€è¦å¤„ç†ä¾èµ–æ‰€ä»¥ç›´æ¥æ¢æˆäº†alibaba cloud ç³»ç»Ÿ</p></li><li><p>å®‰è£… npmå’Œhexo-cli å‘½ä»¤è¡Œå·¥å…·</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">dnf install npm<br>npm install hexo-cli -g<br></code></pre></td></tr></table></figure></li><li><p>Github é›†æˆ</p><p> å› ä¸ºåç»­éœ€è¦è®¾ç½®åˆ°github page ï¼Œæ‰€ä»¥å…ˆé…ç½®gitå’Œå¯†é’¥</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>ssh-keygen  <span class="hljs-comment"># ä½¿ç”¨ssh-keygen åˆ›å»ºå¯†é’¥</span><br><span class="hljs-built_in">cat</span> /root/.ssh/id_rsa.pub  <span class="hljs-comment"># ä»ç›®å½•æ–‡ä»¶å¤¹æŸ¥è¯¢å…¬é’¥ï¼Œ </span><br><span class="hljs-comment"># é…ç½®åˆ°github  -&gt; settings -&gt; SSH and GPG keys -&gt; New SSH key</span><br><br>dnf install git   <span class="hljs-comment"># å®‰è£…git</span><br><br>git config --global user.name <span class="hljs-string">&quot;ç”¨æˆ·å&quot;</span><br>git config --global user.email <span class="hljs-string">&quot;é‚®ç®±&quot;</span><br>    <br>ssh -T git@github.com  <span class="hljs-comment"># æµ‹è¯•åˆ°githubçš„è¿æ¥</span><br><br></code></pre></td></tr></table></figure></li></ol><h2 id="HEXO-æ¡†æ¶å®‰è£…"><a href="#HEXO-æ¡†æ¶å®‰è£…" class="headerlink" title="HEXO æ¡†æ¶å®‰è£…"></a>HEXO æ¡†æ¶å®‰è£…</h2><p>åˆå§‹åŒ–hexo ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">hexo init myhexo/  <span class="hljs-comment">#  åˆå§‹åŒ–æ–‡ä»¶å¤¹</span><br><span class="hljs-built_in">cd</span> myhexo  <span class="hljs-comment"># ç§»åŠ¨åˆ°åšå®¢ç›®å½•</span><br>npm install hexo-deployer-git --save  <span class="hljs-comment"># å®‰è£…å¹¶å­˜å‚¨hexoé¡¹ç›®</span><br></code></pre></td></tr></table></figure><p>ä¿®æ”¹éƒ¨ç½²æ–¹å¼ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">deploy:</span><br>  <span class="hljs-attr">type:</span> <span class="hljs-string">git</span>         <span class="hljs-comment"># ç±»å‹æ˜¯ git</span><br>  <span class="hljs-attr">repo:</span> <span class="hljs-string">git@github.com:username/username.github.io.git</span>    <br>  <span class="hljs-comment">#åœ¨githubä¸Šåˆ›å»ºusername.github.ioçš„ä»“åº“,ç¡®è®¤ä»“åº“åæ˜¯å¦ä¸€è‡´ï¼ </span><br>  <span class="hljs-comment">#è¿™é‡Œå¯ä»¥ä½¿ç”¨sshçš„æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨httpsçš„æ–¹å¼ï¼Œä½†æ˜¯sshæ›´ç¨³å®š</span><br>  <span class="hljs-attr">branch:</span> <span class="hljs-string">master</span> <span class="hljs-comment"># è®¾ç½®åˆ†æ”¯ä¸ºmaster</span><br><br></code></pre></td></tr></table></figure><p>ä¿®æ”¹å ä½¿ç”¨ hexo deploy è¿›è¡Œå®‰è£…ï¼Œå®‰è£…è¿‡ç¨‹ä¸­ä¼šæç¤ºè¾“å…¥ç”¨æˆ·åå’Œå¯†ç â€˜</p><p>ç”¨æˆ·åå°±æ˜¯ç™»å½•è´¦æˆ·çš„åç§°</p><p>å¯†ç éœ€è¦é€šè¿‡ settings â†’ Developer Settings â†’ Personal access tokens â†’ Generate new token åˆ›å»ºtoken  ä½œä¸ºå¯†ç  </p><p>ç­‰å¾…å‡ åˆ†é’Ÿå¯ä»¥é€šè¿‡è®¿é—® <a href="https://username.github.io/">https://username.github.io</a> æŸ¥çœ‹æ˜¯å¦åˆ›å»ºæˆåŠŸ</p><h2 id="æ’ä»¶å®‰è£…"><a href="#æ’ä»¶å®‰è£…" class="headerlink" title="æ’ä»¶å®‰è£…"></a>æ’ä»¶å®‰è£…</h2><p>hexo æ”¯æŒå¤šç§æ ·å¼é£æ ¼çš„æ’ä»¶</p><p>ä»¥å®‰è£…fluidä¸ºä¾‹ ï¼Œ å®‰è£…æ’ä»¶ ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">npm</span> <span class="hljs-string">install</span> <span class="hljs-string">--save</span> <span class="hljs-string">hexo-theme-fluid</span><br></code></pre></td></tr></table></figure><p>è¿™æ—¶å¯ä»¥å°† ä¸‹è½½å¯¹åº”ä¸»é¢˜æ–‡ä»¶ æ”¾åˆ°theme æ–‡ä»¶å¤¹ï¼Œåœ¨_config.ymlé…ç½®theme ä¸ºfluid</p><p>æˆ–è€…ç›´æ¥åœ¨æ ¹ç›®å½•åˆ›å»º _config.fluid.yml  æ¥è¿›è¡Œé…ç½®ã€‚ _config.fluid.yml çš„é…ç½®ä¼˜å…ˆçº§é«˜äº _config.yml  ã€‚ ä¸€äº›åŸºæœ¬é…ç½® ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">title:</span> <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-comment">#æ ‡ç­¾é¡µä¸»é¢˜</span><br><span class="hljs-attr">language:</span> <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-comment">#è¯­è¨€</span><br><span class="hljs-attr">timezone:</span> <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-comment">#æ—¶åŒº</span><br><span class="hljs-attr">theme:</span> <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-comment">#ä¸»é¢˜</span><br><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hexo new page about  <span class="hljs-comment"># å…³äºé¡µéœ€è¦è‡ªè¡Œåˆ›å»º</span><br></code></pre></td></tr></table></figure><p>æ‰©å±•é…ç½®å¯ä»¥å‚è€ƒ ï¼š <a href="https://fluid-dev.github.io/hexo-fluid-docs/">https://fluid-dev.github.io/hexo-fluid-docs/</a></p><p>åœ¨è°ƒè¯•æ—¶ å¯ä»¥é€šè¿‡</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">hexo</span> <span class="hljs-string">g</span> <span class="hljs-string">--debug</span> <span class="hljs-string">æ¥æŸ¥çœ‹å…·ä½“çš„é…ç½®ä¿¡æ¯</span>  <span class="hljs-string">å¦‚å½’æ¡£æ ‡ç­¾é¡µçš„é…ç½®ä¿¡æ¯</span><br><br>  <span class="hljs-attr">&quot;archive&quot;:</span> &#123;<br>    <span class="hljs-attr">&quot;banner_img&quot;:</span> <span class="hljs-string">&quot;/img/default.png&quot;</span>,   <span class="hljs-comment"># æŒ‡å®šèƒŒæ™¯å›¾ç‰‡</span><br>    <span class="hljs-attr">&quot;banner_img_height&quot;:</span> <span class="hljs-number">60</span>,  <span class="hljs-comment"># å›¾ç‰‡å å…¨å±çš„æ¯”ä¾‹</span><br>    <span class="hljs-attr">&quot;banner_mask_alpha&quot;:</span> <span class="hljs-number">0.3</span>   <span class="hljs-comment"># ä¸é€æ˜åº¦</span><br>  &#125;<span class="hljs-string">,</span><br><br></code></pre></td></tr></table></figure><p>æ¯æ¬¡ä¿®æ”¹åéœ€è¦ä½¿ç”¨hexo clean å†è¿›è¡Œ ç”Ÿæˆå’Œéƒ¨ç½²ã€‚</p><p>ç„¶åå°±å¯ä»¥å¼€å§‹ åˆ›å»ºæ–‡ç« äº†,åˆ›å»ºåä¼šæç¤ºä½ mdæ–‡ä»¶çš„åœ°å€ï¼Œå°±å¯ä»¥è¿›è¡Œç¼–è¾‘äº†ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">hexo</span> <span class="hljs-string">new</span> <span class="hljs-string">&quot;hello world&quot;</span><br></code></pre></td></tr></table></figure><p>ç›¸å…³å†…å®¹ ï¼š <a href="https://hexo.io/zh-cn/">https://hexo.io/zh-cn/</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>ç¯å¢ƒæ­å»º</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
