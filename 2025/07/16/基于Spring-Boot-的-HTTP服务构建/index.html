

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/%5Bobject%20Object%5D">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Codfish">
  <meta name="keywords" content="">
  
    <meta name="description" content="如何构建一个Web服务架构与实现web服务本身是一种 基于BS（Browser-Server）架构的服务提供模式。其中包含了 Browser（Web Proxy）： 面向客户的本地应用，提供连接管理，HTTP请求解析，本地存储等功能 HTTP ： 客户与服务器间通信的应用层协议，用于规范 用户和服务器间的请求&#x2F;响应格式和响应逻辑 Server  ： 运行于远端的监听程序，监听来自网络HT">
<meta property="og:type" content="article">
<meta property="og:title" content="基于Spring Boot 的 HTTP服务构建">
<meta property="og:url" content="http://gadoid.io/2025/07/16/%E5%9F%BA%E4%BA%8ESpring-Boot-%E7%9A%84-HTTP%E6%9C%8D%E5%8A%A1%E6%9E%84%E5%BB%BA/index.html">
<meta property="og:site_name" content="西北有高楼">
<meta property="og:description" content="如何构建一个Web服务架构与实现web服务本身是一种 基于BS（Browser-Server）架构的服务提供模式。其中包含了 Browser（Web Proxy）： 面向客户的本地应用，提供连接管理，HTTP请求解析，本地存储等功能 HTTP ： 客户与服务器间通信的应用层协议，用于规范 用户和服务器间的请求&#x2F;响应格式和响应逻辑 Server  ： 运行于远端的监听程序，监听来自网络HT">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.111666.best/image/y21Ppv4vvuAX3DPm1Qso4e.png">
<meta property="article:published_time" content="2025-07-16T12:52:51.000Z">
<meta property="article:modified_time" content="2025-07-17T11:59:22.175Z">
<meta property="article:author" content="Codfish">
<meta property="article:tag" content="Spring Boot">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.111666.best/image/y21Ppv4vvuAX3DPm1Qso4e.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>基于Spring Boot 的 HTTP服务构建 - 西北有高楼</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"gadoid.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>西北有高楼</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/downloads" target="_self">
                
                <span>资源下载</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="基于Spring Boot 的 HTTP服务构建"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-07-16 20:52" pubdate>
          2025年7月16日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          5k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          42 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">基于Spring Boot 的 HTTP服务构建</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="如何构建一个Web服务"><a href="#如何构建一个Web服务" class="headerlink" title="如何构建一个Web服务"></a>如何构建一个Web服务</h1><h2 id="架构与实现"><a href="#架构与实现" class="headerlink" title="架构与实现"></a>架构与实现</h2><p>web服务本身是一种 基于BS（Browser-Server）架构的服务提供模式。其中包含了</p>
<p>Browser（Web Proxy）： 面向客户的本地应用，提供连接管理，HTTP请求解析，本地存储等功能</p>
<p>HTTP ： 客户与服务器间通信的应用层协议，用于规范 用户和服务器间的请求&#x2F;响应格式和响应逻辑</p>
<p>Server  ： 运行于远端的监听程序，监听来自网络HTTP请求，并根据请求内心进行对应的动态或静态资源响应</p>
<p>数据过程</p>
<p><img src="https://i.111666.best/image/y21Ppv4vvuAX3DPm1Qso4e.png" srcset="/img/loading.gif" lazyload alt="数据通信传输过程"></p>
<p>MAC（Media Access Controll）:  用于设备入网的唯一标识信息。（定义唯一性）</p>
<p>IP（Internet Protocol）: 用于网络寻址的设备网络信息。（入网后的可识别地址方便其他设备更好的查询到目标设备）</p>
<p>TCP（Transmission Control Protocol）:  用于承载上层的信息传输，它是可靠的（即提供了相关的机制保证了数据的一致性（但是无法解决网络故障导致的数据不一致）），流式的（通过滑动窗口完成的服务端-设备端的 数据写入&#x2F;写出过程）。</p>
<p>UDP （User Datagram Protocol）： 同样用于承载上层信息，但是它是不可靠的，只负责对上层数据进行简单封装，将其转发到对端，包式的（以数据包的形式进行数据传输）</p>
<p>SOCKET （套接字）： 用于完成对网络层的抽象，使上层只需要通过传递 网络协议族&#x2F;网络协议&#x2F;具体协议信息。 就可以完成网络连接的创建，它通过四元组来特别定义某一个具体的连接（源IP，源端口，目的IP，目的端口）。</p>
<p>I&#x2F;O  ：  由SOCKET 接收&#x2F;写入的内容会被存放在内核缓冲区，最终被通过网卡转发出去或被复制写入用户空间的缓冲区。这时受到的内容是一个字节数组。后续的应用层处理过程就需要对这些字节信息进行解释。</p>
<h2 id="应用层处理"><a href="#应用层处理" class="headerlink" title="应用层处理"></a>应用层处理</h2><p>如上所属。后续的处理过程主要是如何将接收到的字节数组进行反序列化的过程。</p>
<p>所以在现代服务器的实现和处理上 一般会分为两阶段</p>
<p>1.将字节数组 反序列化为符合目标协议的序列化内容 （如json）</p>
<p>2.对序列化内容进行识别处理</p>
<p>这里分别考虑 Java和Python的两种实现</p>
<h3 id="Python的web-规范——WSGI"><a href="#Python的web-规范——WSGI" class="headerlink" title="Python的web 规范——WSGI"></a>Python的web 规范——WSGI</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">application</span>(<span class="hljs-params">environ, start_response</span>):<br>    ...<br>    <span class="hljs-keyword">return</span> [<span class="hljs-string">b&quot;response body&quot;</span>]<br></code></pre></td></tr></table></figure>

<p>通过wsgi规范，我们可以只关注 传递过来的 environ 即对请求的对象化封装和一个回调方法start_response , 这样只需要专注于处理请求中的内容，而不必再去考虑具体的解析过程。</p>
<h3 id="Java的web规范-———-Servlet"><a href="#Java的web规范-———-Servlet" class="headerlink" title="Java的web规范 ——— Servlet"></a>Java的web规范 ——— Servlet</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> &#123;<br>    <span class="hljs-comment">// 处理 GET 请求</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>servlet 接口定义了 http的处理过程， 接收一个HttpServletRequest 对象，并最终响应</p>
<p>一个HttpServletResponse 返回对象。然后 Servlet的容器（如tomcat，jetty）就可以遵守这个规范完成前置和后续的信息处理。</p>
<h1 id="Spring-Boot的HTTP服务构建"><a href="#Spring-Boot的HTTP服务构建" class="headerlink" title="Spring Boot的HTTP服务构建"></a>Spring Boot的HTTP服务构建</h1><p>Spring 相比传统的Servlet 实现-装配过程提供了</p>
<ol>
<li>内置Servlet容器。通过集成Servlet容器，到springboot 可以直接启动服务作为HTTP服务，不再需要打包为war包安装到servlet容器中</li>
<li>提供了丰富的过程化管理，通过接口实现可以完成对基础HTTP服务的功能扩展</li>
<li>提供了集成到外部sevlet容器的，扩展方案， 方便多场景下部署</li>
</ol>
<h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><p><strong>一个基础的Spring Boot Web应用目录结构 ：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java">--- java  <br>		--- com.codfish.springweb <br>				--- controller<br>				<span class="hljs-comment">//接收客户端请求（HTTP、RPC等）</span><br>				<span class="hljs-comment">//参数校验与转换</span><br>				<span class="hljs-comment">//调用 Service 层处理业务逻辑</span><br>				<span class="hljs-comment">//将业务处理结果封装为响应结果返回（如 JSON、XML）</span><br>				--- service<br>				<span class="hljs-comment">//封装业务逻辑（处理、计算、组合等）</span><br>				<span class="hljs-comment">//协调多个 DAO 或远程服务调用</span><br>			  <span class="hljs-comment">//处理事务管理（如增删改）</span><br>			  --- repository<br>				<span class="hljs-comment">//执行增删改查操作（CRUD）</span><br>				<span class="hljs-comment">//屏蔽底层数据源的复杂性</span><br>		--- entity<br>				<span class="hljs-comment">// 自配置类</span><br>--- resources<br>		--- application.properties <br>				<span class="hljs-comment">// 放置服务所需的配置项信息</span><br></code></pre></td></tr></table></figure>

<h2 id="请求处理过程"><a href="#请求处理过程" class="headerlink" title="请求处理过程"></a>请求处理过程</h2><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">浏览器请求<br>   ↓<br>前端控制器 DispatcherServlet（统一入口）<br>   ↓<br>HandlerMapping：查找匹配的控制器和拦截器链<br>   ↓<br>HandlerInterceptor（前置拦截器 preHandle）<br>   ↓<br>Controller（业务控制器）<br>   ↓<br>Service（业务逻辑）<br>   ↓<br>Repository/DAO（数据访问层）<br>   ↓<br>Controller 返回 ModelAndView 或 <span class="hljs-built_in">JSON</span> 对象<br>   ↓<br>HandlerInterceptor（后置拦截器 postHandle/afterCompletion）<br>   ↓<br>ViewResolver（视图解析器）<br>   ↓<br>视图层渲染（JSP/Thymeleaf/Freemarker 等）或直接返回 <span class="hljs-built_in">JSON</span><br>   ↓<br>DispatcherServlet 响应客户端<br></code></pre></td></tr></table></figure>

<h2 id="数据类"><a href="#数据类" class="headerlink" title="数据类"></a>数据类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer id ;<br>    <span class="hljs-keyword">private</span> String location ;<br><br>    <span class="hljs-keyword">public</span>  <span class="hljs-title function_">User</span><span class="hljs-params">(Integer id,String name,String location)</span>&#123;<br>        <span class="hljs-built_in">this</span>.id = id;<br>        <span class="hljs-built_in">this</span>.name = name;<br>        <span class="hljs-built_in">this</span>.location = location;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">User</span><span class="hljs-params">(String name,String location)</span>&#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>        <span class="hljs-built_in">this</span>.location = location;<br>    &#125;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br>    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> id;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(Integer id)</span> &#123;<br>        <span class="hljs-built_in">this</span>.id = id;<br>    &#125;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getLocation</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> location;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setLocation</span><span class="hljs-params">(String location)</span> &#123;<br>        <span class="hljs-built_in">this</span>.location = location;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> entity;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Result</span>&lt;T&gt; &#123;<br>    <span class="hljs-keyword">private</span> Integer code;<br>    <span class="hljs-keyword">private</span> String message;<br>    <span class="hljs-keyword">private</span> T data;<br><br>    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">getCode</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> code;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setCode</span><span class="hljs-params">(Integer code)</span> &#123;<br>        <span class="hljs-built_in">this</span>.code = code;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getMessage</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> message;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setMessage</span><span class="hljs-params">(String message)</span> &#123;<br>        <span class="hljs-built_in">this</span>.message = message;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">getData</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> data;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setData</span><span class="hljs-params">(T data)</span> &#123;<br>        <span class="hljs-built_in">this</span>.data = data;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Result</span><span class="hljs-params">(Integer code, String message, T data)</span>&#123;<br>        <span class="hljs-built_in">this</span>.code = code;<br>        <span class="hljs-built_in">this</span>.message = message;<br>        <span class="hljs-built_in">this</span>.data = data;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Result</span><span class="hljs-params">(Integer code, String message)</span>&#123;<br>        <span class="hljs-built_in">this</span>.code = code;<br>        <span class="hljs-built_in">this</span>.message = message;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Result</span><span class="hljs-params">()</span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Result&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;code=&quot;</span> + code +<br>                <span class="hljs-string">&quot;, message=&#x27;&quot;</span> + message + <span class="hljs-string">&#x27;\\&#x27;</span><span class="hljs-string">&#x27; +</span><br><span class="hljs-string">                &quot;, data=&quot; + data +</span><br><span class="hljs-string">                &#x27;</span>&#125;<span class="hljs-string">&#x27;;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>

<h2 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderController</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> RestTemplate restTemplate;<br>		<span class="hljs-comment">// 定义一个 restTemplate 对象来收发HTTP请求</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">OrderController</span><span class="hljs-params">(RestTemplateBuilder restTemplateBuilder)</span> &#123;<br>        <span class="hljs-built_in">this</span>.restTemplate = restTemplateBuilder.build();<br>        <span class="hljs-comment">// 通过构造器获取restTemplate对象</span><br>    &#125;<br><br>    <span class="hljs-meta">@RequestMapping(&quot;/order&quot;)</span><br>    <span class="hljs-comment">// 绑定请求路径</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">order</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&lt;http://localhost:8085/user/1&gt;&quot;</span>;<br>        <span class="hljs-type">Result</span> <span class="hljs-variable">forobject</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.restTemplate.getForObject(url, Result.class,<span class="hljs-number">1</span>);<br>        <span class="hljs-comment">// 使用 getForObject 将响应体转换为一个传入的对象结构</span><br>        <span class="hljs-keyword">return</span> forobject.getData().toString();<br>    &#125;<br>    <span class="hljs-meta">@RequestMapping(&quot;/add&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">add</span><span class="hljs-params">()</span>&#123;<br>		    <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;codfish&quot;</span>,<span class="hljs-string">&quot;hangzhou&quot;</span>);<br>		    ResponseEntity&lt;Result&gt; responoseentity = <span class="hljs-built_in">this</span>.restTemplate.postForEntity(<span class="hljs-string">&quot;&lt;http://localhost:8085/user/add&quot;</span>,user,Result.class<span class="hljs-string">&quot;&gt;);</span><br><span class="hljs-string">		    // 传输一个携带包头，响应状态码，响应体信息的结构</span><br><span class="hljs-string">		    return responseentity.getBody().getData().toString();</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">  </span><br><span class="hljs-string">    @RequestMapping(&quot;</span>/put<span class="hljs-string">&quot;)</span><br><span class="hljs-string">    public String put()&#123;</span><br><span class="hljs-string">		    User user = new User(1,&quot;</span>codfish<span class="hljs-string">&quot;,&quot;</span>hangzhou<span class="hljs-string">&quot;);</span><br><span class="hljs-string">		    HttpEntity&lt;User&gt; httpEntity = new HttpEntity&lt;&gt;(user);</span><br><span class="hljs-string">		    // 创建一个 http 请求对象。解析user为json</span><br><span class="hljs-string">		    ResponseEntity&lt;Result&gt; resultResponseEntity = restTemplate.exchange(&quot;</span>&lt;http:<span class="hljs-comment">//localhost:8085/user/&gt;&quot;+user.getId(), HttpMethod.PUT,httpentity,Result.class)</span><br>			  <span class="hljs-comment">// 使用exchange 裸发送http 请求,指定 URL,请求方法,以及响应体中的json 转换定义。</span><br>			  <span class="hljs-keyword">return</span> responseEntity.getBody().getData().toString();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 单元测试中使用 TestRestTemplate 创建对象</span><br><br><span class="hljs-meta">@SpringBootTest()</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Application</span>&#123;<br>		<span class="hljs-meta">@Test</span><br>		<span class="hljs-keyword">void</span> <span class="hljs-title function_">contextLoads</span><span class="hljs-params">()</span>&#123;<br>			<span class="hljs-type">TestRestTemplate</span> <span class="hljs-variable">restTemplate</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestRestTemplate</span>();<br>			ResponseEntity&lt;Result&gt;  resultResponseEntity = restTemplate.exchange(url,HTTP.get,result.class);<br>			<span class="hljs-keyword">return</span> resultResponseEntity.getBody().toString();<br>		  <br>		&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h2 id="应用于HTTP服务的一些注解"><a href="#应用于HTTP服务的一些注解" class="headerlink" title="应用于HTTP服务的一些注解"></a>应用于HTTP服务的一些注解</h2><p>@Controller	标识一个类为控制器组件，返回的是视图</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(&quot;/codfish&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CodfishController</span> &#123;<br>    <span class="hljs-meta">@GetMapping(&quot;/test&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;codfish&quot;</span>;<br>    &#125;<br>&#125; <span class="hljs-comment">// 这里不会响应codfish 字段，而是查询对应的codfish 视图</span><br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Codfish</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">View</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getContentType</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;text/html&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">render</span><span class="hljs-params">(Map&lt;String, ?&gt; model, HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        response.getWriter().write(<span class="hljs-string">&quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Codfish&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span>);<br>    &#125;<br>&#125; <span class="hljs-comment">// 视图实现</span><br><br></code></pre></td></tr></table></figure>

<p>@RestController	是 @Controller + @ResponseBody 的缩写，用于构建 RESTful API，方法返回数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/codfish&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CodfishController</span> &#123;<br>    <span class="hljs-meta">@GetMapping(&quot;/test&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;codfish&quot;</span>;<br>    &#125;<br>&#125; <span class="hljs-comment">// 最终将字符串&quot;codfish&quot; 作为返回响应</span><br></code></pre></td></tr></table></figure>

<p>@RequestMapping	用于映射请求路径和方法（支持 GET&#x2F;POST&#x2F;PUT&#x2F;DELETE 等）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(&quot;/codfish&quot;)</span>  <span class="hljs-comment">// 映射 &lt;http://x.x.x.x/codfish&gt; </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CodfishController</span> &#123;<br>    <span class="hljs-meta">@RequestMapping(method = RequestMethod.GET ,&quot;/test&quot;)</span>  <span class="hljs-comment">// 映射 &lt;http://x.x.x.x/codfish/test&gt; GET</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;codfish&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@GetMapping	简化版 @RequestMapping(method &#x3D; RequestMethod.GET)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(&quot;/codfish&quot;)</span>  <span class="hljs-comment">// 映射 &lt;http://x.x.x.x/codfish&gt; </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CodfishController</span> &#123;<br>    <span class="hljs-meta">@GetMapping(&quot;/test&quot;)</span>  <span class="hljs-comment">// 映射 &lt;http://x.x.x.x/codfish/test&gt; GET</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;codfish&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@PostMapping	简化版 @RequestMapping(method &#x3D; RequestMethod.POST)<br>@PutMapping	简化版 @RequestMapping(method &#x3D; RequestMethod.PUT)<br>@DeleteMapping	简化版 @RequestMapping(method &#x3D; RequestMethod.DELETE)<br>@PatchMapping	简化版 @RequestMapping(method &#x3D; RequestMethod.PATCH)</p>
<p>@RequestParam	绑定请求参数到方法参数（通常用于 GET&#x2F;POST 表单字段）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/search&quot;)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">search</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;keyword&quot;)</span> String keyword)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;搜索关键字是：&quot;</span> + keyword;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@PathVariable	绑定 URI 路径中的变量</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/user/&#123;id&#125;&quot;)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> Long userId)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;用户ID：&quot;</span> + userId;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@RequestBody	将请求体 JSON&#x2F;XML 数据绑定到方法参数（通常用于 POST&#x2F;PUT）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;/user&quot;)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">createUser</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> User user)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;用户名：&quot;</span> + user.getName();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@ResponseBody	将返回值作为响应体输出，不经过视图解析器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/hello&quot;)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">sayHello</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello, World!&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@ModelAttribute	用于绑定表单提交的对象数据，也可用于提前在方法调用前处理模型数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;/register&quot;)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">register</span><span class="hljs-params">(<span class="hljs-meta">@ModelAttribute</span> User user)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;注册用户：&quot;</span> + user.getName();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@RequestHeader	绑定请求头字段</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/agent&quot;)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">userAgent</span><span class="hljs-params">(<span class="hljs-meta">@RequestHeader(&quot;User-Agent&quot;)</span> String agent)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;你的浏览器信息是：&quot;</span> + agent;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@CookieValue	绑定 Cookie 中的值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/showCookie&quot;)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getCookie</span><span class="hljs-params">(<span class="hljs-meta">@CookieValue(&quot;token&quot;)</span> String token)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Cookie中的Token值为：&quot;</span> + token;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@RequestPart	用于处理 multipart&#x2F;form-data 请求中的文件或字段</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;/upload&quot;)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">uploadFile</span><span class="hljs-params">(<span class="hljs-meta">@RequestPart(&quot;file&quot;)</span> MultipartFile file)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;上传文件名：&quot;</span> + file.getOriginalFilename();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@ResponseStatus	自定义响应状态码（如返回 201、404 等）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ResponseStatus(HttpStatus.NOT_FOUND)</span><br><span class="hljs-meta">@GetMapping(&quot;/notfound&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notFound</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// 返回 404</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>@ExceptionHandler	处理控制器层抛出的异常（单个异常处理）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ExceptionHandler(ArithmeticException.class)</span><br><span class="hljs-keyword">public</span> ResponseEntity&lt;String&gt; <span class="hljs-title function_">handleArithmetic</span><span class="hljs-params">(Exception e)</span> &#123;<br>    <span class="hljs-keyword">return</span> ResponseEntity.status(<span class="hljs-number">400</span>).body(<span class="hljs-string">&quot;出现数学错误: &quot;</span> + e.getMessage());<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@ControllerAdvice	全局异常处理器、数据绑定、模型属性注入等的集中配置组件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalControllerAdvice</span> &#123;<br>    <span class="hljs-meta">@ExceptionHandler(NullPointerException.class)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">handleNPE</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;error/npe&quot;</span>; <span class="hljs-comment">// 跳转视图页面</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@RestControllerAdvice	@ControllerAdvice + @ResponseBody，用于构建 REST 风格全局处理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalRestAdvice</span> &#123;<br><br>    <span class="hljs-meta">@ExceptionHandler(RuntimeException.class)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">handleRuntime</span><span class="hljs-params">(RuntimeException ex)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;全局异常：&quot;</span> + ex.getMessage();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>@SessionAttributes	将模型属性存入 Session 范围中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@SessionAttributes(&quot;user&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SessionController</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/store&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">store</span><span class="hljs-params">(Model model)</span> &#123;<br>        model.addAttribute(<span class="hljs-string">&quot;user&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;Tom&quot;</span>, <span class="hljs-number">20</span>));<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>@SessionAttribute	从 Session 中获取属性绑定到方法参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/getUser&quot;)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUserFromSession</span><span class="hljs-params">(<span class="hljs-meta">@SessionAttribute(&quot;user&quot;)</span> User user)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;从Session中获取到用户：&quot;</span> + user.getName();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@RequestAttribute	绑定 request.setAttribute 设置的属性到方法参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/useAttr&quot;)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">useAttr</span><span class="hljs-params">(<span class="hljs-meta">@RequestAttribute(&quot;attr&quot;)</span> String value)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;请求中的属性值：&quot;</span> + value;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@InitBinder	初始化数据绑定器，用于自定义参数绑定格式（如日期格式转换）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@InitBinder</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initBinder</span><span class="hljs-params">(WebDataBinder binder)</span> &#123;<br>    binder.registerCustomEditor(Date.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomDateEditor</span>(<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;yyyy-MM-dd&quot;</span>), <span class="hljs-literal">false</span>));<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h2><p>在SpringMVC 中可以通过实现 HandlerInterceptor接口创建一个拦截器。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TimeInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerInterceptor</span> &#123;<br>    <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(TimeInterceptor.class);<br>    LocalDateTime startTime;<br>    LocalDateTime endTime;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        startTime = LocalDateTime.now();<br>        logger.info(<span class="hljs-string">&quot;请求&quot;</span> + request.getRequestURI()+<span class="hljs-string">&quot;开始执行&quot;</span>+startTime+<span class="hljs-string">&quot;时间&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, <span class="hljs-meta">@Nullable</span> ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception  &#123;<br>        endTime = LocalDateTime.now();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">Duration</span> <span class="hljs-variable">duration</span> <span class="hljs-operator">=</span> Duration.between(startTime, endTime);<br>        <span class="hljs-type">long</span> <span class="hljs-variable">l</span> <span class="hljs-operator">=</span> duration.toMillis();<br>        logger.info(<span class="hljs-string">&quot;请求&quot;</span> + request.getRequestURI()+<span class="hljs-string">&quot;执行时间&quot;</span>+ l+<span class="hljs-string">&quot;毫秒&quot;</span>);<br>    &#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>再通过实现WebMvcConfigurer 接口完成注册过程</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyWebMvcConfigurer</span>  <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addViewControllers</span><span class="hljs-params">(ViewControllerRegistry registry)</span>&#123;<br>        registry.addViewController(<span class="hljs-string">&quot;/tuling&quot;</span>).setViewName(<span class="hljs-string">&quot;hello&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addInterceptors</span><span class="hljs-params">(InterceptorRegistry  registry)</span>&#123;<br>        registry.addInterceptor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TimeInterceptor</span>())<br>                .addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>)<br>                .excludePathPatterns(<span class="hljs-string">&quot;/pages/**&quot;</span>);<br>        registry.addInterceptor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LocaleChangeInterceptor</span>())<br>                .addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> LocaleResolver <span class="hljs-title function_">localeResolver</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">CookieLocaleResolver</span> <span class="hljs-variable">localeResolver</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CookieLocaleResolver</span>();<br>        localeResolver.setCookieMaxAge(<span class="hljs-number">3600</span>);<br>        localeResolver.setCookieName(<span class="hljs-string">&quot;locale&quot;</span>);<br>        <span class="hljs-keyword">return</span> localeResolver;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="注册消息转换器"><a href="#注册消息转换器" class="headerlink" title="注册消息转换器"></a>注册消息转换器</h2><p>Spring MVC 中允许 JSON 或XML 数据类型的请求格式可以自动转换为Java Bean对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration(proxyBeanMethods = false)</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">JacksonHttpMessageConvertersConfiguration</span>&#123;<br>	<span class="hljs-meta">@Configuration(proxyBeanMethods = false)</span><br>	<span class="hljs-meta">@ConditionalOnClass(ObjectMapper.class)</span><br>	<span class="hljs-meta">@ConditionalOnBean(ObjectMapper.class)</span><br>	<span class="hljs-meta">@ConditionalOnProperty(name = HttpMessageConvertersAutoConfiguration.PREFERRD_MAPPER_PROPERTY,</span><br><span class="hljs-meta">		havingValue = &quot;jackson&quot;, matchIfMissing = true 	)</span><br>	<span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MappingJackSon2HttpMessageConverterConfiguration</span>&#123;<br>			<span class="hljs-meta">@Bean</span><br>			<span class="hljs-meta">@ConditionalOnMissingBean(value = MappingJackson2HttpMessageConverter.class ,</span><br><span class="hljs-meta">				ignoredType = &#123;</span><br><span class="hljs-meta">					&quot;org.springframework.hateoas.server.mvc.TypeConstrainedMappingJackson2HttpMessageConverter&quot;,</span><br><span class="hljs-meta">					&quot;org.springframework.data.rest.webmvc.alps.AplsJsonHttpMessageConverter&quot;&#125;)</span><br>			MappingJackson2HttpMessageConverter <span class="hljs-title function_">mappingJackson2HttpMessageConverter</span><span class="hljs-params">(ObjectMapper objectMapper)</span>&#123;<br>					<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MappingJackson2HttpMessageConverter</span>(objectMapper);<br>			&#125;<br>	&#125;<br>	<span class="hljs-meta">@Configuration(proxyBeanMethods = false)</span><br>	<span class="hljs-meta">@ConditionalOnClass(XmlMapper.class)</span><br>	<span class="hljs-meta">@ConditionalOnBean(Jaconson2ObjectMapperBuilder.class)</span><br>	<span class="hljs-keyword">protected</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MappingJackson2XmlHttpMessageConverterConfiguration</span>&#123;<br>			<span class="hljs-meta">@Bean</span><br>			<span class="hljs-meta">@ConditionOnMissingBean</span><br>			<span class="hljs-keyword">public</span> MappingJackson2XmlHttpMessageConverter <span class="hljs-title function_">mappingJackson2XmlHttpMessageConverter</span><span class="hljs-params">(</span><br><span class="hljs-params">					Jackson2ObjectMapperBuilder builder)</span>&#123;<br>						<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MappingJackson2XmlHttpMessageConverter</span>(builder.createXmlMapper(<span class="hljs-literal">true</span>).build());<br>			&#125;			<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="注册类型转换器"><a href="#注册类型转换器" class="headerlink" title="注册类型转换器"></a>注册类型转换器</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span>&#123;<br>		<span class="hljs-meta">@Override</span><br>		<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addFormatters</span><span class="hljs-params">(FormatterRegistry registry)</span>&#123;<br>				registry.addCoverter(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomConverter</span>());<br>		&#125;<br>&#125;<br><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomConverter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Converter</span>&lt;String,String&gt;&#123;<br>		<span class="hljs-meta">@Override</span><br>		<span class="hljs-keyword">public</span> String <span class="hljs-title function_">convert</span><span class="hljs-params">(String source)</span>&#123;<br>			<span class="hljs-keyword">if</span>(StringUtils.isNotEmpty(source))&#123;<br>					source = source.trim();<br>			&#125;<br>			<span class="hljs-keyword">return</span> source ;	<br>		&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="注册MVC组件"><a href="#注册MVC组件" class="headerlink" title="注册MVC组件"></a>注册MVC组件</h2><h3 id="静态注册-Servlet"><a href="#静态注册-Servlet" class="headerlink" title="静态注册 Servlet"></a>静态注册 Servlet</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RegisterServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HttpServlet</span>&#123;<br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">service</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>			<span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> getServletConfig().getInitParameter(<span class="hljs-string">&quot;name&quot;</span>);<br>			<span class="hljs-type">String</span> <span class="hljs-variable">sex</span> <span class="hljs-operator">=</span> getServletConfig().getInitParameter(<span class="hljs-string">&quot;sex&quot;</span>);<br>		<br>			resp.getOutputStream().println(<span class="hljs-string">&quot;name is&quot;</span> + name);<br>			resp.getOutputStream().println(<span class="hljs-string">&quot;sex is&quot;</span> + sex);<br>	&#125;<br>&#125;<br><br><span class="hljs-comment">//创建Bean对servlet进行注册</span><br><br><span class="hljs-meta">@Bean</span><br><span class="hljs-keyword">public</span> ServletRegistrationBean <span class="hljs-title function_">registerServlet</span><span class="hljs-params">()</span>&#123;<br>		<span class="hljs-type">ServletRegistrationBean</span> <span class="hljs-variable">servletRegistrationBean</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServletRegistrationBean</span>(<br>			<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegisterServlet</span>(),<span class="hljs-string">&quot;/registerServlet&quot;</span>);<br>			servletRegistrationBean.addInitParameter(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;javastack&quot;</span>);<br>			servletRegistrationBean.addInitParameter(<span class="hljs-string">&quot;sex&quot;</span>, <span class="hljs-string">&quot;male&quot;</span>);<br>			<span class="hljs-keyword">return</span> servletRegistrationBean;<br>		)<br>	<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="动态注册-Servlet"><a href="#动态注册-Servlet" class="headerlink" title="动态注册 Servlet"></a>动态注册 Servlet</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InitServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HttpServlet</span>&#123;<br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">service</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse reps)</span> <span class="hljs-keyword">throws</span> IOException&#123;<br>		<span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> getServletConfig().getInitParameter(<span class="hljs-string">&quot;name&quot;</span>);<br>		<span class="hljs-type">String</span> <span class="hljs-variable">sex</span> <span class="hljs-operator">=</span> getServletConfig().getInitParameter(<span class="hljs-string">&quot;sex&quot;</span>);<br>	<br>		resp.getOutputStream().println(<span class="hljs-string">&quot;name is &quot;</span>+ name);<br>		resp.getOutputStream().println(<span class="hljs-string">&quot;sex is &quot;</span> + sex);<br>	&#125;<br>&#125;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ServetletConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ServletContextInitializer</span>&#123;<br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onStartup</span><span class="hljs-params">(ServletContext servletContext)</span>&#123;<br>			<span class="hljs-type">ServletRegistration</span> <span class="hljs-variable">initServlet</span> <span class="hljs-operator">=</span> servletContext<br>				.addServlet(<span class="hljs-string">&quot;initServlet&quot;</span>, InitServlet.class);<br>			initServlet.addMapping(<span class="hljs-string">&quot;/initServlet&quot;</span>);<br>			initServlet.setInitParameter(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;initServlet&quot;</span>);<br>			initServlet.setInitParameter(<span class="hljs-string">&quot;sex&quot;</span>,<span class="hljs-string">&quot;male&quot;</span>);<br>	&#125;<br>&#125;<br><br><span class="hljs-meta">@Bean</span><br><span class="hljs-keyword">public</span> ServletContextInitializer <span class="hljs-title function_">servleContextInitializer</span><span class="hljs-params">()</span>&#123;<br>	<span class="hljs-keyword">return</span> (servletContext) -&gt; &#123;<br>			<span class="hljs-type">ServletRegistration</span> <span class="hljs-variable">initServlet</span> <span class="hljs-operator">=</span> servletContext.addServlet(<span class="hljs-string">&quot;initServlet&quot;</span>, InitServlet.class);<br>			initServlet.addMapping(<span class="hljs-string">&quot;/initServlet&quot;</span>);<br>			initServlet.setInitParameter(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;initServlet&quot;</span>);<br>			initServlet.setInitParameter(<span class="hljs-string">&quot;sex&quot;</span>,<span class="hljs-string">&quot;male&quot;</span>);		<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><h3 id="使用ControllerAdvice进行全局异常处理"><a href="#使用ControllerAdvice进行全局异常处理" class="headerlink" title="使用ControllerAdvice进行全局异常处理"></a>使用ControllerAdvice进行全局异常处理</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalExceptionHandler</span>&#123;<br>	<span class="hljs-meta">@ResponseBody</span><br>	<span class="hljs-meta">@ExceptionHandler(value = &#123; Exception.class &#125;)</span><br>	<span class="hljs-keyword">public</span> ResponseEntity&lt;?&gt; handleException(HttpServletRequest request, Throwable ex)&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResponseEntity</span>&lt;&gt;(<span class="hljs-string">&quot;global exception&quot;</span>, HttpStatus.OK);<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>使用视图或restapi接口响应异常</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(produces = MediaType.TEXT_HTML_VALUE)</span><br><span class="hljs-comment">// 当请求的资源类型为TEXT_HTML_VALUE时进行的处理</span><br><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title function_">errorHtml</span><span class="hljs-params">(HttpServletRequest request , HttpServletResponse response)</span>&#123;<br>	<span class="hljs-comment">// 定义一个函数，最终响应一个视图作为返回</span><br>	<span class="hljs-type">HttpStatus</span> <span class="hljs-variable">status</span> <span class="hljs-operator">=</span> getStatus(request);<br>	Map&lt;String,Object&gt; model = Collections <br>			.unmodifiableMap(getErrorAttributes(request , getErrorAttributeOptions(request,MediaType.TEXT_HTML)));<br>	response.setStatus(status.value());<br>	<span class="hljs-type">ModelAndView</span> <span class="hljs-variable">modelAndView</span> <span class="hljs-operator">=</span> resolveErrorView(request, response, status ,model);<br>	<span class="hljs-comment">// 查询对应的异常视图</span><br>	<span class="hljs-keyword">return</span> (modelAndView !=<span class="hljs-literal">null</span>) ? modelAndView : <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModelAndView</span>(<span class="hljs-string">&quot;error&quot;</span>, model) ; <br>	<span class="hljs-comment">// 如果视图为空则使用指定视图，如果存在 则返回视图给客户端</span><br>&#125;<br>...<br><span class="hljs-keyword">protected</span> ModelAndView <span class="hljs-title function_">resolveErrorView</span><span class="hljs-params">(HttpServletRequest request , HttpServletResponse response ,</span><br><span class="hljs-params">		Map&lt;String ,Object&gt; model )</span>&#123;<br>		<span class="hljs-keyword">for</span> (ErrorViewResolver resolver : <span class="hljs-built_in">this</span>.errorViewResolvers)&#123;<br>				<span class="hljs-comment">// 遍历所有的视图解释器</span><br>			 <span class="hljs-type">ModelAndView</span> <span class="hljs-variable">modelAndView</span>  <span class="hljs-operator">=</span> resolver.resolverErrorView(request, status , model);<br>			 <span class="hljs-keyword">if</span>(modelAndView !=<span class="hljs-literal">null</span>)&#123;<br>					 <span class="hljs-keyword">return</span> modelAndView ;<br>			 &#125;<br>		&#125;<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span> ;<br>&#125;<br>...<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title function_">resolveErrorView</span><span class="hljs-params">(HttpServletRequest request ,  HttpStataus status , Map&lt;String ,Object&gt; model)</span>&#123;<br>		<span class="hljs-type">ModelAndView</span> <span class="hljs-variable">modelAndView</span> <span class="hljs-operator">=</span> resolve(String.valueOf(status.value()),model);<br>		<span class="hljs-keyword">if</span>(modelAndView == <span class="hljs-literal">null</span> &amp;&amp; SERIES_VIEWS.containsKey(status.series()))&#123;<br>				<span class="hljs-comment">// 在每个具体的视图解释器中查询响应信息，匹配响应信息并返回</span><br>				modelAndView = resolve(SERIES_VIEW.get(status.series()),model);<br>		&#125;<br>		<span class="hljs-keyword">return</span> modelAndView ;<br>&#125;<br>...<br><span class="hljs-keyword">private</span>  ModelAndView <span class="hljs-title function_">resolve</span><span class="hljs-params">(String viewName , Map&lt;String, Object&gt; model)</span>&#123;<br>		<span class="hljs-type">String</span> <span class="hljs-variable">errorViewName</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;error/&quot;</span> + viewName;<br>		<span class="hljs-comment">// Spring 默认的 异常视图处理</span><br>		<span class="hljs-type">TemplateAvailabilityProvider</span> <span class="hljs-variable">provider</span> <span class="hljs-operator">=</span>  <span class="hljs-built_in">this</span>.templateAvailabilityProviders.getProvider(errorViewName,<br>				<span class="hljs-built_in">this</span>.applicationContext);<br>		<span class="hljs-keyword">if</span>(provider != <span class="hljs-literal">null</span>)&#123;<br>				<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModelAndView</span>(errorViewName , model);<br>		&#125;<br>		<span class="hljs-keyword">return</span> resolveResource(errorViewName , model);<br>&#125;<br>...<br><span class="hljs-keyword">private</span> ModelAndView <span class="hljs-title function_">resolveResoure</span><span class="hljs-params">(String viewName, Map&lt;String , Object&gt; model)</span>&#123;<br>		<span class="hljs-keyword">for</span>(String location : <span class="hljs-built_in">this</span>.resourceProperties.getStaticLocations())&#123;<br>				<span class="hljs-keyword">try</span>&#123;<br>						<span class="hljs-type">Resource</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.applicationContext.getResource(location);<br>						resource = resource.createRelative(viewName + <span class="hljs-string">&quot;.html&quot;</span>);<br>						<span class="hljs-comment">// 从资源地址查询静态资源</span><br>						<span class="hljs-keyword">if</span>(resource.exists())&#123;<br>								<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModelAndView</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlResourceView</span>(resource),model);<br>						&#125;<br>				&#125;<br>				<span class="hljs-keyword">catch</span>(Exception ex)&#123;<br>				&#125;<br>		&#125;<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span> ;<br>&#125;<br>...<br><span class="hljs-keyword">protected</span> ErrorAttributeOptions <span class="hljs-title function_">getErrorAttributeOptions</span><span class="hljs-params">(HttpServletRequest request,MediaType mediaType)</span>&#123;<br>		<span class="hljs-type">ErrorAttributeOptions</span> <span class="hljs-variable">options</span> <span class="hljs-operator">=</span> ErrorAttributeOptions.defaults();<br>		<span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.errorProperties.isIncludeException())&#123;<br>			options = options.including(Include.EXCEPTION);<br>		&#125;<br>		<span class="hljs-keyword">if</span>(isIncludeStatckTrace(request), mediaType)&#123;<br>			options = options.including(Include.STACK_TRACE);<br>		&#125;<br>		<span class="hljs-keyword">if</span>(isIncludeMessag(request,mediaType))&#123;<br>			options = options.including(Include.MESSAGE);<br>		&#125;<br>		<span class="hljs-keyword">if</span>(isIncludeBindingErrors(request,mediaType))&#123;<br>			options = options.including(Include.BINDING_ERRORS);<br>		&#125;<br>		<span class="hljs-keyword">return</span> options ;<br>&#125;<br>...<br><br><span class="hljs-meta">@RequestMapping</span><br><span class="hljs-keyword">public</span> ResponseEntity&lt;Map&lt;String , Object&gt;&gt; <span class="hljs-title function_">error</span><span class="hljs-params">(HttpServletRequest request)</span>&#123;<br>	<span class="hljs-type">HttpStatus</span> <span class="hljs-variable">status</span> <span class="hljs-operator">=</span> getStatus(request);<br>	<span class="hljs-keyword">if</span>(status == HttpStatus.NO_CONTENT)&#123;<br>			<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResponseEntity</span>&lt;&gt;(status);<br>	&#125;<br>	Map&lt;String,Object&gt; body = getErrorAttributes(request,getErrorAttributeOptions(request, MediaType.ALL));<br>	<span class="hljs-comment">// 获取 异常信息</span><br>	<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResponseEntity</span>&lt;&gt;(body,status);<br>	<span class="hljs-comment">// 直接返回接口响应</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="国际化"><a href="#国际化" class="headerlink" title="国际化"></a>国际化</h2><p>国际化是指根据用户请求，向用户响应不同的响应信息</p>
<p><strong>请求语言获取途径</strong></p>
<ol>
<li>通过头部携带的session,cookie,accept-languaget Header等字段  检索&#x2F;确认国际化请求</li>
<li>通过get请求中的 “?locale&#x3D; “字段 确认国家化请求</li>
</ol>
<p><strong>核心实现</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@AutoConfiguration</span><br><span class="hljs-meta">@ConditionalOnMissingBean(name = AbstractApplicationContext.MESSAGE_SOURCE_BEAN_NAME, search = SerarchStrategy.CURRENT)</span><br><span class="hljs-meta">@AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE)</span><br><span class="hljs-comment">// @Conditional 自定义条件匹配，会传入一个实现了Condition接口的类-ResouceBudleCondition</span><br><span class="hljs-comment">// ResourceBundleCondition 会重写matches 方法，自定义匹配规则，返回true 则成功</span><br><span class="hljs-meta">@Conditional(ResourceBundleCondition.class)</span><br><span class="hljs-meta">@EnableConfigurationProperties</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageSourceAutoConfiguration</span> &#123;<br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Resource[] NO_RESOURCES = &#123;&#125;;<br><br>	<span class="hljs-meta">@Bean</span><br>	<span class="hljs-meta">@ConfigurationProperties(prefix = &quot;spring.messages&quot;)</span><br>	<span class="hljs-keyword">public</span> MessageSourceProperties <span class="hljs-title function_">messageSourceProperties</span><span class="hljs-params">()</span>&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageSourceProperties</span>();<br>	&#125;<br><br>	<span class="hljs-meta">@Bean</span><br>	<span class="hljs-keyword">public</span> MessageSource <span class="hljs-title function_">messageSource</span><span class="hljs-params">(MessageSourceProperties properties)</span>&#123;<br>		<span class="hljs-type">ResourceBundleMessageSource</span> <span class="hljs-variable">messageSource</span> <span class="hljs-operator">=</span>  <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResourceBundleMessageSource</span>();<br>		<span class="hljs-keyword">if</span>(StringUtils.hasText(properties.getBasename()))&#123;<br>			messageSource.setBasenames(StringUtils.commaDelimitedListToStringArray(StringUtils.trimAllWhitespace(properties.getBasename())));<br>		<span class="hljs-keyword">if</span>(properties.getEncoding()!= <span class="hljs-literal">null</span>)&#123;<br>			messageSource.setDefaultEncoding(properties.getEncoding().name());<br>		&#125;<br>		messageSource.setFallbackToSystemlocale(prperties.isFallbackToSystemLocaole());<br>		<span class="hljs-type">Duration</span> <span class="hljs-variable">cacheDuration</span> <span class="hljs-operator">=</span> properties.getCacheDuration();<br>		<span class="hljs-keyword">if</span>(cacheDuration != <span class="hljs-literal">null</span>)&#123;<br>			messageSource.setCacheMillis(cacheDuration.toMillis());<br>		&#125;<br>		messageSource.setFallbackToSystemLocale(properties.isFallbackToSystemLocale());<br>		<span class="hljs-type">Duration</span> <span class="hljs-variable">cacheDuration</span> <span class="hljs-operator">=</span> properties.getCacheDuration();<br>		<span class="hljs-keyword">if</span>(cacheDuration != <span class="hljs-literal">null</span>) &#123;<br>			messageSource.setCacheMillis(cacheDuration.toMillis());	<br>		&#125;<br>		messageSource.setAlwaysUseMessageFormat(properties.isAlwaysUseMessageFormat());<br>		messageSource.setUseCodeAsDefaultMessage(properites.isUseCodeAsDefaultMessage());<br>		<span class="hljs-keyword">return</span> messageSource;<br>	&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>通过注册一个MessageSource 实例，使用spring.message.*完成自动配置</p>
<p>通过match 方法来查询是否存在对应的语言配置文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">matches</span><span class="hljs-params">(ConditionContext context , AnnotatedTypeMetadata metdata)</span>&#123;<br>	<span class="hljs-type">String</span> <span class="hljs-variable">classOrMethodName</span> <span class="hljs-operator">=</span> getClassOrMethodName(metadata);<br>	<span class="hljs-keyword">try</span> &#123;<br>			<span class="hljs-type">ConditionOutcome</span> <span class="hljs-variable">outcome</span> <span class="hljs-operator">=</span> getMatchOutcome(context , metadata);<br>			<span class="hljs-comment">// 通过getMatchOutcone 方法获取匹配结果</span><br>			logOutcome(classOrMethodName , outcome);<br>			recordEvaluation(context , classOrMethodName,outcome);<br>			<span class="hljs-keyword">return</span> outcome.isMatch(); <br>	&#125;<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> ConditionOutcome <span class="hljs-title function_">getMatchOutcome</span><span class="hljs-params">(ConditionContext context , AnnotatedTypeMetadata metadata)</span>&#123;<br>		<span class="hljs-type">String</span> <span class="hljs-variable">basename</span> <span class="hljs-operator">=</span> context.getEnviroment().getProperty(<span class="hljs-string">&quot;spring.message.basename&quot;</span>,<span class="hljs-string">&quot;message&quot;</span>);<br>		<span class="hljs-comment">// 获取环境信息中存储的对应的国际化资源文件</span><br>		<span class="hljs-type">ConditionOutcome</span> <span class="hljs-variable">outcome</span> <span class="hljs-operator">=</span> cache.get(basename);<br>		<span class="hljs-comment">// 加载到内存</span><br>		<span class="hljs-keyword">if</span>(outcome == <span class="hljs-literal">null</span>) &#123;<br>				outcome = getMatchOutcomeForBasename(context,basename);<br>				<span class="hljs-comment">// 调用getMatchOutcomeForBasename 检查是否存在资源文件</span><br>				cache.put(basename,outcome);<br>		&#125;<br>		<span class="hljs-keyword">return</span> outcome ;<br>&#125;<br><br><span class="hljs-keyword">private</span> ConditionOutcome <span class="hljs-title function_">getMatchOutcomeForBasename</span><span class="hljs-params">(ConditionContext context , String basename)</span>&#123;<br>		ConditionMessage.<span class="hljs-type">Builder</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> ConditionMessage.forCondition(<span class="hljs-string">&quot;ResourceBundle&quot;</span>);<br>		<span class="hljs-keyword">for</span> (String name : StringUtils.commaDelimitedListToStringArray(StringUtils.trimAllWhitespace(basename)))&#123;<br>			<span class="hljs-keyword">for</span>(Resource resource : getResouce(context.getClassLoader(),name))&#123;<br>					<span class="hljs-keyword">if</span>(resouce.exists())&#123;<br>						<span class="hljs-comment">// 检查路径中是否存在资源文件</span><br>						<span class="hljs-keyword">return</span> ConditionOutcome.match(message.found(<span class="hljs-string">&quot;bundle&quot;</span>).items(resource));<br>					&#125;<br>			&#125;<br>		&#125;<br>		<span class="hljs-keyword">return</span> ConditionOutcome.noMatch(message.didNotFind(<span class="hljs-string">&quot;bundle with basename&quot;</span>+basename).atAll());<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>通过注册LocaleResolver 区域解析器完成 国际化切换</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-meta">@ConditionalOnMissingBean</span><br><span class="hljs-meta">@ConditionOnProperty(prefix = &quot;spring.mvc&quot;, name = &quot;locale&quot;)</span><br><span class="hljs-keyword">public</span> LocaleResolver <span class="hljs-title function_">localeResolver</span><span class="hljs-params">()</span>&#123;<br>	<span class="hljs-comment">// 配置spring.mvc.locale-resolver=fixed</span><br>	<span class="hljs-comment">// spring.mvc.locale= en_US </span><br>	<span class="hljs-comment">// 使用配置文件中的本地化语言</span><br>	<span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.mvcProperties.getLocaleResolver() == WebMvcProperties.LocaleResolver.FIXED)&#123;<br>			<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FixedLocaleResolver</span>(<span class="hljs-built_in">this</span>.mvcProperties.getLocale());<br>	&#125; <br>	<span class="hljs-comment">// 默认使用AcceptHeaderLocaleResolver作为本地化解析器</span><br>	<span class="hljs-type">AcceptHeaderLocaleResolver</span> <span class="hljs-variable">localeResolver</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AcceptHeaderLocaleResolver</span>();<br>	<span class="hljs-comment">// 设置 sping.mvc.locale = en_US 作为默认本地化语言</span><br>	localeResolver.setDefaultLocale(<span class="hljs-built_in">this</span>.mvcProperties.getLocale());<br>	<span class="hljs-keyword">return</span> localResolver; <br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="Servlet容器加载过程"><a href="#Servlet容器加载过程" class="headerlink" title="Servlet容器加载过程"></a>Servlet容器加载过程</h1><p>servlet 容器注入的多种方法</p>
<p><strong>实现WebServerFactoryCustomizer 接口，对内置容器进行配置</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">customize</span><span class="hljs-params">(ConfigurableServletWebServerFactory factory)</span> &#123;<br>    factory.setContextPath(<span class="hljs-string">&quot;&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    <span class="hljs-type">SpringApplication</span> <span class="hljs-variable">springApplication</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SpringApplication</span>(CustomizationBean.class);<br>    springApplication.run(args);<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>自行定义一个容器 ，作为bean纳入spring 管理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyWebMvcConfigurer</span> &#123;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> ServletRegistrationBean&lt;BeanServlet&gt; <span class="hljs-title function_">servletRegistrationBean</span><span class="hljs-params">()</span>&#123;<br>        ServletRegistrationBean&lt;BeanServlet&gt; bean = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServletRegistrationBean</span>&lt;&gt;();<br>        <span class="hljs-comment">//声明一个注册器bean</span><br>        bean.setServlet(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BeanServlet</span>());<br>        <span class="hljs-comment">//设置Servlet</span><br>        bean.setName(<span class="hljs-string">&quot;BeanServlet&quot;</span>);<br>        <span class="hljs-comment">// 设置名字</span><br>        bean.addUrlMappings(<span class="hljs-string">&quot;/BeanServlet&quot;</span>);<br>        <span class="hljs-comment">// 设置资源绑定路径</span><br>        <span class="hljs-keyword">return</span> bean;<br>    &#125;;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>实现一个HttpServlet接口，即自定义一套路由处理逻辑</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(name=&quot;HelloServlet&quot;,urlPatterns = &quot;/hello&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HttpServlet</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>        <span class="hljs-type">PrintWriter</span> <span class="hljs-variable">writer</span> <span class="hljs-operator">=</span> resp.getWriter();<br>        writer.println(<span class="hljs-string">&quot;HelloServlet.doGet&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Servlet的自动装配 由@EnableAutoConfiguration注解触发</p>
<p>@EnableAutoConfiguration 会触发AutoConfigurationImportselector 检索SPI路径中声明的需要装备的配置类。调用 ServletWebServerFactoryAutoConfiguration 完成Servlet容器的自动装配过程</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration(proxyBeanMethods = false)</span><br><span class="hljs-meta">@AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE)</span><br><span class="hljs-meta">@ConditionOnClass(ServletRequest.class)</span><br><span class="hljs-comment">// 在类路径中存在ServletRequest.class 才会被加载</span><br><span class="hljs-meta">@ConditionOnWebApplication(type = Type.SERVLET)</span><br><span class="hljs-meta">@EnableConfigurationProperties(ServerProperties.class)</span><br><span class="hljs-meta">@Import(&#123;ServletWebServerFactoryAutoConfiguration.BeanPostProcessorsRegistrar.class,</span><br><span class="hljs-meta">			ServletWebServerFactoryConfiguration.EmbeddedTomcat.class,</span><br><span class="hljs-meta">			ServletWebServerFactoryConfiguration.EmbeddedJetty.class,</span><br><span class="hljs-meta">			ServletWebServerFactoryConfiguration.EmbeddedUndertow.class,</span><br><span class="hljs-meta">		&#125;)</span><br><span class="hljs-comment">// 导入嵌入的servlet 容器类，进行初始化过程</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ServletWebServerFactoryAutoConfiguration</span>&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>对应的servlet容器初始化过程</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration(</span><br><span class="hljs-meta">    proxyBeanMethods = false</span><br><span class="hljs-meta">)</span><br><span class="hljs-meta">@ConditionalOnClass(&#123;Servlet.class, Tomcat.class, UpgradeProtocol.class&#125;)</span><br><span class="hljs-meta">@ConditionalOnMissingBean(</span><br><span class="hljs-meta">    value = &#123;ServletWebServerFactory.class&#125;,</span><br><span class="hljs-meta">    search = SearchStrategy.CURRENT</span><br><span class="hljs-meta">)</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmbeddedTomcat</span> &#123;<br>    <span class="hljs-meta">@Bean</span><br>    TomcatServletWebServerFactory <span class="hljs-title function_">tomcatServletWebServerFactory</span><span class="hljs-params">(ObjectProvider&lt;TomcatConnectorCustomizer&gt; connectorCustomizers, ObjectProvider&lt;TomcatContextCustomizer&gt; contextCustomizers, ObjectProvider&lt;TomcatProtocolHandlerCustomizer&lt;?&gt;&gt; protocolHandlerCustomizers)</span> &#123;<br>        <span class="hljs-type">TomcatServletWebServerFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TomcatServletWebServerFactory</span>();<br>        factory.getTomcatConnectorCustomizers().addAll(connectorCustomizers.orderedStream().toList());<br>        <span class="hljs-comment">// 获取容器配置信息，完成配置</span><br>        factory.getTomcatContextCustomizers().addAll(contextCustomizers.orderedStream().toList());<br>        factory.getTomcatProtocolHandlerCustomizers().addAll(protocolHandlerCustomizers.orderedStream().toList());<br>        <span class="hljs-keyword">return</span> factory;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>当存在ServletWebServerFactory时 ， 不再加载内置容器 。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-keyword">public</span> ServiceWebServerFactoryCustomizer <span class="hljs-title function_">servletWebServerFactoryCustomizer</span><span class="hljs-params">(ServerProperties serverProperties)</span>&#123;<br>	<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServicetWebServerFactoryCustomizer</span>(serverProperties);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>自定义的容器类和内嵌tomcat 都继承自 <code>WebServerFactory</code> 创建对应的容器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">customize</span><span class="hljs-params">(ConfigurationServletWebServerFactory factory)</span>&#123;<br>		<span class="hljs-type">PropertyMapper</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> PropertyMapper.get().alwaysApplyingWhenNonNull();<br>		<span class="hljs-comment">/* if(serverProperties.getPort()!=null)&#123;</span><br><span class="hljs-comment">						factor.serPort(serverProperties.getPort())</span><br><span class="hljs-comment">		&#125; */</span><br>		map.from(<span class="hljs-built_in">this</span>.serverProperties::getPort).to(factory::setPort);<br>		map.from(<span class="hljs-built_in">this</span>.serverProperties::getAddress).to(factory::setAddress);<br>		map.from(<span class="hljs-built_in">this</span>.serverProperties::getServlet()::getContextPath).to(factory::setContextPath);<br>		map.from(<span class="hljs-built_in">this</span>.serverProperties::getServlet()::getApplicationDisplayName).to(factory::setDisplayName);<br>		map.from(<span class="hljs-built_in">this</span>.serverProperties::getServlet()::isRegisterDefaultServlet).to(factory::setRegisterDefaultServlet);<br>		map.from(<span class="hljs-built_in">this</span>.serverProperties::getServlet()::getSession).to(factory::setSession);<br>		map.from(<span class="hljs-built_in">this</span>.serverProperties::getSsl).to(factory::setSsl);<br>		map.from(<span class="hljs-built_in">this</span>.serverProperties.getServlet()::getJsp).to(factory::setJsp);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>从配置文件中获取信息，配置到容器中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerBeanDefinitions</span><span class="hljs-params">(AnnotationMetadata importingClassMetadata,</span><br><span class="hljs-params">					BeanDefinitionRegistry registry)</span>&#123;<br>			<span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.beanFactory == <span class="hljs-literal">null</span>)&#123;<br>					<span class="hljs-keyword">return</span> ;<br>			&#125;<br>			registerSyntheticBeanIfMissing(registry, WebServerFactoryCustomizerBeanPostProcessor.class);<br>			registerSyntheticBeanIfMissing(registry, ErrorPageRegistrarBeanPostProcessor.class);		<br>&#125;<br></code></pre></td></tr></table></figure>

<p>使用注册器，将对应的servlet容器 加入到Spring中进行管理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> Collection&lt;WebServerFactoryCustomizer&lt;?&gt;&gt; getCustomizers()&#123;<br>	<span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.customizers == <span class="hljs-literal">null</span>)&#123;<br>			<span class="hljs-built_in">this</span>.customizers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(getWebServerFactoryCustomizerBeans());<br>			<span class="hljs-built_in">this</span>.customizers.sort(AnnotationAwareOrderComparator.INSTANCE);<br>			<span class="hljs-built_in">this</span>.customizers = Collections.unmodifiableList(<span class="hljs-built_in">this</span>.customizers);<br>	&#125;<br>	<span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.customizers;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>将所有servlet容器 放入容器中管理，之后调用 每个具体容器实现的customize()方法完成响应容器的配置初始化</p>
<p>在对应embedding启动时， 会在里面配置一个WebServerFactory类型的一个Bean 负责对应的容器和启动</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> Object <span class="hljs-title function_">postProcessBeforeInitialization</span><span class="hljs-params">(Object bean , String beanName)</span> <span class="hljs-keyword">throws</span> BeansException&#123;<br>		<span class="hljs-comment">// 判断当前创建的bean 是不是配置类型</span><br>		<span class="hljs-keyword">if</span>(bean instance of WebServerFactory)&#123;<br>				postProcessBeforeInitialization((WebServerFactory) bean);<br>		&#125;<br>		<span class="hljs-keyword">return</span> bean ;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>自动配置中根据不同的依赖，启动对应的一个Embeded ， 然后配置了一个对应的servlet容器工厂类</p>
<p>在springboot应用启动的时候 就回调用容器refresh方法，调用getWebServer 并启动</p>
<h1 id="使用外部servlet-容器"><a href="#使用外部servlet-容器" class="headerlink" title="使用外部servlet 容器"></a>使用外部servlet 容器</h1><p>1 下载tomcat服务</p>
<p>2 设置maven打包方式</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">packaging</span>&gt;</span>war<span class="hljs-tag">&lt;/<span class="hljs-name">packaging</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>3 设置tomcat相关依赖不参与打包部署</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>4 配置启动类定义</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml">public class TomcatStartSpringBoot extends SpringBootServletInitializer&#123;<br>		@Override<br>		protected SpringApplicationBuilder configure(SpringApplicationBuilder builder)&#123;<br>			return builder.sources(Application.class);<br>		&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>5 在idea中运行</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml">配置 URL <br>选择tomcat版本<br>指定 部署war包<br></code></pre></td></tr></table></figure>

<p>外部容器启动原理</p>
<p>打包后指定启动类 对java程序进行启动</p>
<p>tomcat不会主动启动Spring 应用，所以在启动过程中tomcat 调用了SpringBootServletInitializer的SpringApplicationBuilder 。</p>
<p>当servlet容器启动的时候 就会去META-INF&#x2F;services文件夹中找到javax.servlet.ServletContainerInitializer 这个文件对应绑定了ServletContainerInitalizer.从该文件中找到对应的实现类创建实例，调用 on startup</p>
<p>tomcat → 启动WEB-INF&#x2F;lib  → 查找对应接口的实现类</p>
<p>WebApplicationInitializer</p>
<p>AbstractContextLoaderInitialzer  SpringBootServletInitializer</p>
<p>AbstractDispatcherServerletInitializer TomcatStartSpringBoot</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Spring-Boot/" class="category-chain-item">Spring Boot</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Spring-Boot/" class="print-no-link">#Spring Boot</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>基于Spring Boot 的 HTTP服务构建</div>
      <div>http://gadoid.io/2025/07/16/基于Spring-Boot-的-HTTP服务构建/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Codfish</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年7月16日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/07/23/%E4%BB%8E%E7%BC%96%E7%A0%81%E5%88%B0%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%9A%E7%B3%BB%E7%BB%9F%E6%98%AF%E5%A6%82%E4%BD%95%E8%A2%AB%E7%BB%84%E7%BB%87%E7%9A%84/" title="从编码到设计模式：系统是如何被组织的?">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">从编码到设计模式：系统是如何被组织的?</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/07/15/Spring-Boot-%E5%9F%BA%E7%A1%80%EF%BC%8C%E9%85%8D%E7%BD%AE%E4%B8%8E%E5%90%AF%E5%8A%A8/" title="Spring Boot  基础，配置与启动">
                        <span class="hidden-mobile">Spring Boot  基础，配置与启动</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
      &copy; 2025 - 2025 <a target="_blank" rel="noopener" href="https://github.com/username">CODFISH</a>
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<!-- hexo injector body_end start --><script src="/js/chatbot-loader.js" defer></script><!-- hexo injector body_end end --></body>
</html>
